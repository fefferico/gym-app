import{Y as g}from"./chunk-DKF37G4Q.js";import{Ba as A,M as y}from"./chunk-RAZEFHXM.js";import{g as f}from"./chunk-GAL4ENT6.js";var V=class u{transform(t,e="dd/MM/yy HH:mm"){if(t==null||!isFinite(t))return"";try{let i=new Date(t);return g(i,e)}catch(i){return console.error(`Error formatting date from milliseconds value: ${t}`,i),"Invalid Date"}}static \u0275fac=function(e){return new(e||u)};static \u0275pipe=A({name:"millisecondsDate",type:u,pure:!0})};var w=class u{_lastTickTime=0;audioCtx=null;_userInteracted=!1;constructor(){window.addEventListener("pointerdown",this._unlockAudioContext,{once:!0}),window.addEventListener("keydown",this._unlockAudioContext,{once:!0})}_unlockAudioContext=()=>{this.initializeAudioContext(),this.audioCtx&&this.audioCtx.state==="suspended"&&this.audioCtx.resume(),this._userInteracted=!0};playSound(t){return f(this,null,function*(){if(this.initializeAudioContext(),!!this.audioCtx){if(this._userInteracted||(this._userInteracted=!0),this.audioCtx.state==="suspended")try{yield this.audioCtx.resume()}catch{return}switch(t){case"countdown":this.playCountdownSound();break;case"end":this.playEndSound();break;case"error":this.playErrorSound();break;case"correct":this.playCorrectSound();break;case"untoggle":this.playUntoggleSound();break;case"whoosh":this.playWhooshSound();break;case"tada":this.playTadaSound();break;case"tatatada":this.playTaTaTaDaSound();break;case"magic":{this.playMagicRestoreSound();break}case"pop":{this.playPopSound();break}case"referee":this.playRefereeSound();break;case"tick":{this.playTickSound();break}}}})}initializeAudioContext(){if(!this.audioCtx)try{this.audioCtx=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}}playMagicRestoreSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=[622.25,783.99,932.33],i=this.audioCtx.createGain();i.gain.setValueAtTime(.3,t),i.connect(this.audioCtx.destination),e.forEach((a,n)=>{if(!this.audioCtx)return;let c=this.audioCtx.createOscillator(),s=this.audioCtx.createGain();c.type="sine",c.frequency.setValueAtTime(a,t),c.connect(s),s.connect(i);let r=t+n*.08;s.gain.setValueAtTime(0,r),s.gain.linearRampToValueAtTime(.4,r+.05),s.gain.exponentialRampToValueAtTime(1e-4,r+1.5),c.start(r),c.stop(r+1.5)})}playPopSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createGain();e.type="sine";let a=880,n=150,c=.1;e.frequency.setValueAtTime(a,t),e.frequency.exponentialRampToValueAtTime(n,t+c),i.gain.setValueAtTime(.8,t),i.gain.exponentialRampToValueAtTime(1e-4,t+.2),e.connect(i),i.connect(this.audioCtx.destination),e.start(t),e.stop(t+.25)}playTickSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createGain();e.type="square";let a=.018;e.frequency.setValueAtTime(3500,t),e.frequency.exponentialRampToValueAtTime(800,t+a),i.gain.setValueAtTime(0,t),i.gain.linearRampToValueAtTime(1,t+.001),i.gain.exponentialRampToValueAtTime(1e-4,t+a),e.connect(i),i.connect(this.audioCtx.destination),e.start(t),e.stop(t+a)}playCountdownSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createGain();e.type="sine",e.frequency.setValueAtTime(880,t),i.gain.setValueAtTime(0,t),i.gain.linearRampToValueAtTime(1,t+.001),i.gain.exponentialRampToValueAtTime(1e-4,t+.15),e.connect(i),i.connect(this.audioCtx.destination),e.start(t),e.stop(t+.15)}playEndSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createGain();e.gain.setValueAtTime(.8,t),e.gain.exponentialRampToValueAtTime(1e-4,t+2);let i=this.audioCtx.createOscillator(),a=this.audioCtx.createOscillator(),n=this.audioCtx.createOscillator();i.type="sine",i.frequency.setValueAtTime(110,t),a.type="sine",a.frequency.setValueAtTime(220,t),n.type="sine",n.frequency.setValueAtTime(330,t),i.connect(e),a.connect(e),n.connect(e),e.connect(this.audioCtx.destination),i.start(t),i.stop(t+2),a.start(t),a.stop(t+2),n.start(t),n.stop(t+2)}playErrorSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createGain();e.type="sawtooth",e.frequency.setValueAtTime(600,t),e.frequency.linearRampToValueAtTime(300,t+.25),i.gain.setValueAtTime(.4,t),i.gain.exponentialRampToValueAtTime(1e-4,t+.25),e.connect(i),i.connect(this.audioCtx.destination),e.start(t),e.stop(t+.25)}playCorrectSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createOscillator(),a=this.audioCtx.createGain(),n=this.audioCtx.createGain();a.gain.setValueAtTime(.5,t),a.gain.exponentialRampToValueAtTime(1e-4,t+.7),e.type="sine",e.frequency.setValueAtTime(784,t),i.type="sine",i.frequency.setValueAtTime(1568,t),n.gain.setValueAtTime(.5,t),e.connect(a),i.connect(n),n.connect(a),a.connect(this.audioCtx.destination),e.start(t),e.stop(t+.7),i.start(t),i.stop(t+.7)}playWhooshSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=.3,i=this.audioCtx.createGain();i.gain.setValueAtTime(1,t),i.gain.exponentialRampToValueAtTime(1e-4,t+e);let a=this.audioCtx.createBiquadFilter();a.type="bandpass",a.Q.value=15,a.frequency.setValueAtTime(4e3,t),a.frequency.exponentialRampToValueAtTime(100,t+e);let n=this.audioCtx.sampleRate*e,c=this.audioCtx.createBuffer(1,n,this.audioCtx.sampleRate),s=c.getChannelData(0);for(let o=0;o<n;o++)s[o]=Math.random()*2-1;let r=this.audioCtx.createBufferSource();r.buffer=c,r.connect(a),a.connect(i),i.connect(this.audioCtx.destination),r.start(t),r.stop(t+e)}playTadaSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createGain();e.gain.setValueAtTime(.6,t),e.gain.exponentialRampToValueAtTime(1e-4,t+1.2),e.connect(this.audioCtx.destination);let i=this.audioCtx.createOscillator();i.type="triangle",i.frequency.setValueAtTime(523.25,t),i.connect(e),i.start(t),i.stop(t+.15);let a=this.audioCtx.createOscillator();a.type="triangle",a.frequency.setValueAtTime(783.99,t+.15),a.connect(e),a.start(t+.15),a.stop(t+.3);let n=this.audioCtx.createOscillator();n.type="triangle",n.frequency.setValueAtTime(1046.5,t+.3),n.connect(e),n.start(t+.3),n.stop(t+1.2)}playTaTaTaDaSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createGain();e.gain.setValueAtTime(.6,t),e.gain.exponentialRampToValueAtTime(1e-4,t+3.5),e.connect(this.audioCtx.destination);let i=261.63,a=392,n=523.25,c=783.99,s=.15,r=.1,o=t,x=(R,T,d)=>{if(!this.audioCtx)return;let m=this.audioCtx.createOscillator(),h=this.audioCtx.createGain();m.type="triangle",m.frequency.setValueAtTime(R,d),h.gain.setValueAtTime(0,d),h.gain.linearRampToValueAtTime(1,d+.01),h.gain.exponentialRampToValueAtTime(1e-4,d+T),m.connect(h),h.connect(e),m.start(d),m.stop(d+T)};x(i,s,o),o+=s+r,x(a,s,o),o+=s+r,x(n,s,o),o+=s+r;let C=2,l=this.audioCtx.createOscillator(),p=this.audioCtx.createGain();l.type="triangle",l.frequency.setValueAtTime(c,o),p.gain.setValueAtTime(0,o),p.gain.linearRampToValueAtTime(1,o+.05),p.gain.exponentialRampToValueAtTime(1e-4,o+C+.5),l.connect(p),p.connect(e),l.start(o),l.stop(o+C+.5)}playRefereeSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=.4,i=this.audioCtx.createGain();i.gain.setValueAtTime(0,t),i.gain.linearRampToValueAtTime(.8,t+.05),i.gain.setValueAtTime(.8,t+e-.05),i.gain.linearRampToValueAtTime(1e-4,t+e),i.connect(this.audioCtx.destination);let a=this.audioCtx.createOscillator();a.type="triangle",a.frequency.setValueAtTime(3e3,t),a.connect(i);let n=this.audioCtx.createOscillator();n.type="triangle",n.frequency.setValueAtTime(3080,t),n.connect(i),a.start(t),a.stop(t+e),n.start(t),n.stop(t+e)}playUntoggleSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=this.audioCtx.createOscillator(),i=this.audioCtx.createGain();i.gain.setValueAtTime(.3,t),i.gain.exponentialRampToValueAtTime(1e-4,t+.1),e.type="triangle",e.frequency.setValueAtTime(120,t),e.connect(i),i.connect(this.audioCtx.destination),e.start(t),e.stop(t+.1)}static \u0275fac=function(e){return new(e||u)};static \u0275prov=y({token:u,factory:u.\u0275fac,providedIn:"root"})};export{V as a,w as b};

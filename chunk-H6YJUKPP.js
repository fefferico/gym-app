import{a as v,b as ne}from"./chunk-KGGST2UH.js";import{a as ee}from"./chunk-6RF7ARCE.js";import{c as B,d as K,f as k,g as w,h as A}from"./chunk-4PTIEP3X.js";import{b as te,e as S,g as re}from"./chunk-FLS2LWEB.js";import{f as Z,h as x,n as oe,o as C}from"./chunk-SLSCPQOQ.js";import{Aa as D,B as O,Cb as $,Db as q,Eb as J,Ha as b,Ia as u,Ja as h,Ka as H,N as j,Nb as Q,R as _,Ra as L,Sa as y,Ta as f,Ua as U,V as E,Va as T,W,X as P,Yb as X,cb as z,eb as Y,fa as R,ma as I,na as g,va as F,ya as G}from"./chunk-D3NR7SGY.js";import{g as V}from"./chunk-GAL4ENT6.js";var he={label:"Pause",actionKey:"pause",iconName:"pause",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-yellow-500"},ye={label:"Add Exercise",actionKey:"addExercise",iconName:"plus-circle",iconClass:"w-8 h-8 mr-2",buttonClass:"hover:bg-blue-700"},ke={label:"Jump to exercise",actionKey:"jumpToExercise",iconName:"dumbbell",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-fuchsia-600 "},we={label:"Switch",actionKey:"switchExercise",iconName:[{name:"dumbbell"},{name:"none",display:"filled-padded",position:"bottom-right",class:"bg-white dark:bg-gray-800"},{name:"change",position:"bottom-right",size:"w-4 h-4",class:"text-primary",strokeWidth:2.5}],iconClass:"w-8 h-8 mr-2",buttonClass:"hover:bg-cyan-600"},xe={label:"Session insight",actionKey:"insight",iconName:"schedule",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-green-600 "},ve={label:"Exit",actionKey:"exit",iconName:"exit-door",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-red-800 "},Ce={label:"Warmup set",actionKey:"warmup",iconName:[{name:"flame"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-sky-600 "},Se={label:"Skip set",actionKey:"skipSet",iconName:"skip",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-blue-600 "},Me={label:"Skip exercise",actionKey:"skipExercise",iconName:"skip",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-indigo-600 "},_e={label:"Do later",actionKey:"later",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-orange-600 "},Ee={label:"Finish early",actionKey:"finish",iconName:"done",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-teal-600 "},We={label:"Create Superset",actionKey:"create_superset",iconName:[{name:"link"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},De={label:"Add to Superset",actionKey:"add_to_superset",iconName:"link",buttonClass:" hover:bg-primary ",iconClass:"w-8 h-8 mr-2"},Ne={label:"Remove from Superset",actionKey:"remove_from_superset",iconName:[{name:"unlink"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"minus-circle",class:"text-primary",strokeWidth:3}],buttonClass:" hover:bg-red-800 ",iconClass:"w-8 h-8 mr-2"},Ie={label:"Remove Exercise",actionKey:"remove",iconName:"trash",buttonClass:" hover:bg-red-800 ",iconClass:"w-8 h-8 mr-2"},Le={label:"Add Set",actionKey:"add_set",iconName:[{name:"dumbbell"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],buttonClass:" hover:bg-teal-800 ",iconClass:"w-8 h-8 mr-2"},Te={label:"Resume",actionKey:"play",iconName:"play",buttonClass:" bg-yellow-800 ",iconClass:"w-8 h-8 mr-2"},Be={label:"Session notes",actionKey:"session_notes",iconName:"clipboard-list",buttonClass:" hover:bg-green-600 ",iconClass:"w-8 h-8 mr-2"},Ke={label:"HIDE",actionKey:"hide",iconName:"eye-off",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ae={label:"UNHIDE",actionKey:"unhide",iconName:"eye",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ve={label:"MARK",actionKey:"markAsFavourite",iconName:"favourite",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Oe={label:"UNMARK",actionKey:"unmarkAsFavourite",iconName:"unmark",iconClass:"w-8 h-8",buttonClass:" hover:bg-primary truncate"},je={label:"LOGS",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Pe={label:"VIEW",actionKey:"view",iconName:"eye",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Re={label:"START",actionKey:"start",iconName:"play",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Fe={label:"EDIT",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ge={label:"CLONE",actionKey:"clone",iconName:"copy",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},He={label:"DELETE",actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-red-600 hover:animate-pulse"},Ue={label:"CREATE ROUTINE",actionKey:"create_routine",iconName:"create-folder",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},ze={label:"ROUTINE",actionKey:"routine",iconName:"routines",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "};var ae=class r{transform(t){return t?.sets?.length?t.sets.some(e=>typeof e.weightUsed=="number"||typeof e.weight=="number"||typeof e.targetWeight=="number"):!1}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=G({name:"isWeighted",type:r,pure:!0})};var de=["*",[["","modal-footer",""]]],pe=["*","[modal-footer]"];function fe(r,t){if(r&1&&(u(0,"h3",11),z(1),h()),r&2){let e=f(3);g(),Y(" ",e.modalTitle()," ")}}function be(r,t){if(r&1){let e=L();u(0,"div",6),D(1,fe,2,1,"h3",7),u(2,"button",8),y("click",function(){E(e);let n=f(2);return W(n.closeModal())}),P(),u(3,"svg",9),H(4,"path",10),h()()()}if(r&2){let e=f(2);g(),b("ngIf",e.modalTitle())}}function ge(r,t){if(r&1){let e=L();u(0,"div",1),y("click",function(){E(e);let n=f();return W(n.closeModal())}),u(1,"div",2),y("click",function(n){E(e);let a=f();return W(a.onDialogClick(n))}),D(2,be,5,1,"div",3),u(3,"div",4),T(4),h(),u(5,"div",5),T(6,1),h()()()}if(r&2){let e=f();b("@modalAnimation",e.animationState),g(),b("@dialogAnimation",e.animationState),g(),b("ngIf",e.modalTitle()||!0)}}var se=class r{elementRef=_(R);isOpen=J(!1);modalTitle=q();closed=$();get animationState(){return this.isOpen()?"open":"closed"}closeModal(){this.isOpen.set(!1),this.closed.emit()}onDialogClick(t){t.stopPropagation()}onDocumentMouseDown(t){this.isOpen()&&this.elementRef.nativeElement.contains(t.target)&&t.target.classList.contains("modal-container")&&this.closeModal()}onEscapeKey(){this.isOpen()&&this.closeModal()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-modal"]],hostBindings:function(e,o){e&1&&y("mousedown",function(a){return o.onDocumentMouseDown(a)},I)("keydown.escape",function(){return o.onEscapeKey()},I)},inputs:{isOpen:[1,"isOpen"],modalTitle:[1,"modalTitle"]},outputs:{isOpen:"isOpenChange",closed:"closed"},ngContentSelectors:pe,decls:1,vars:1,consts:[["class","modal-container fixed inset-0 z-[1000] flex items-center justify-center bg-black bg-opacity-60",3,"click",4,"ngIf"],[1,"modal-container","fixed","inset-0","z-[1000]","flex","items-center","justify-center","bg-black","bg-opacity-60",3,"click"],[1,"modal-dialog","mx-2","bg-white","dark:bg-gray-800","rounded-md","shadow-xl","min-w-[300px]","w-full","max-w-lg","md:max-w-xl","lg:max-w-2xl","max-h-[90vh]","flex","flex-col","overflow-hidden",3,"click"],["class","modal-header flex items-center justify-between ml-1 p-1 md:p-1 border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"modal-body","p-1","md:p-1","space-y-4","overflow-y-auto","flex-grow"],[1,"modal-footer","flex","items-center","p-4","md:p-5","border-t","border-gray-200","dark:border-gray-700","rounded-b"],[1,"modal-header","flex","items-center","justify-between","ml-1","p-1","md:p-1","border-gray-200","dark:border-gray-700"],["class","text-xl font-semibold text-gray-900 dark:text-white",4,"ngIf"],["type","button","aria-label","Close modal",1,"modal-close-button","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","dark:hover:bg-gray-600","dark:hover:text-white","rounded-md","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"]],template:function(e,o){e&1&&(U(de),D(0,ge,7,3,"div",0)),e&2&&b("ngIf",o.isOpen())},dependencies:[X,Q],styles:[".modal-footer[_ngcontent-%COMP%]:empty{display:none}"],data:{animation:[B("modalAnimation",[w("closed",k({opacity:0,visibility:"hidden"})),w("open",k({opacity:1,visibility:"visible"})),A("closed <=> open",[K("300ms ease-in-out")])]),B("dialogAnimation",[w("closed",k({opacity:0,transform:"scale(0.95) translateY(20px)",visibility:"hidden"})),w("open",k({opacity:1,transform:"scale(1) translateY(0)",visibility:"visible"})),A("closed <=> open",[K("300ms ease-in-out")])])]}})};function N(r,t,e){return ee(r,t*7,e)}function le(r){return t=>{let o=(r?Math[r]:Math.trunc)(t);return o===0?0:o}}function ce(r,t,e){let o=te(r,t,e)/7;return le(e?.roundingMethod)(o)}function me(r,t){return Z(r,t?.in).getFullYear()}function M(r,t,e){return N(r,-t,e)}var ue=class r{exerciseService=_(re);constructor(){}calculateSetVolume(t){return(t.repsAchieved||0)*(t.weightUsed||0)}calculateWorkoutVolume(t){let e=0;return t.exercises.forEach(o=>{o.sets.forEach(n=>{e+=this.calculateSetVolume(n)})}),e}calculateTotalVolumeForAllLogs(t){return t.reduce((e,o)=>e+this.calculateWorkoutVolume(o),0)}getWeeklySummaries(t){if(!t||t.length===0)return[];let e=new Map;return t.forEach(o=>{let n=new Date(o.startTime),a=me(n),s=oe(n,{weekStartsOn:1}),i=`${a}-W${String(s).padStart(2,"0")}`,c=x(n,{weekStartsOn:1}),m=`Week ${s}, ${a}`,d=C(c,"dd/MM"),l=C(ne(c,-6),"dd/MM");e.has(i)||e.set(i,{weekNumber:s,year:a,weekLabel:m,weekLabelStart:d,weekLabelEnd:l,workoutCount:0,totalVolume:0});let p=e.get(i);p.workoutCount++,p.totalVolume+=this.calculateWorkoutVolume(o)}),Array.from(e.values()).sort((o,n)=>o.year===n.year?o.weekNumber-n.weekNumber:o.year-n.year)}getWeeklyVolumeForChart(t){return this.getWeeklySummaries(t).map(o=>({date:new Date(o.year,0,o.weekNumber*7-6),weekLabel:o.weekLabel,totalVolume:o.totalVolume})).sort((o,n)=>o.date.getTime()-n.date.getTime())}getPerformanceByMuscleGroup(t){return V(this,null,function*(){if(!t||t.length===0)return[];let e=new Map,o=yield new Promise(a=>{this.exerciseService.getExercises().pipe(O(1)).subscribe(s=>a(s))}),n=new Map(o.map(a=>[a.id,a]));return t.forEach(a=>{let s=new Set;a.exercises.forEach(i=>{let c=n.get(i.exerciseId);if(c&&c.muscleGroups){let m=i.sets.reduce((d,l)=>d+this.calculateSetVolume(l),0);c.muscleGroups.forEach(d=>{let l=d.toLowerCase().trim();e.has(l)||e.set(l,{volume:0,workoutCountSet:new Set});let p=e.get(l);p.volume+=m,s.add(l)})}}),s.forEach(i=>{e.get(i)?.workoutCountSet.add(a.id)})}),Array.from(e.entries()).map(([a,s])=>({muscleGroup:a,volume:Math.round(s.volume),workoutCount:s.workoutCountSet.size})).sort((a,s)=>s.volume-a.volume)})}calculateCurrentWorkoutStreak(t){let e={length:0};if(!t||t.length===0)return e;let o=[...new Set(t.map(l=>C(x(S(l.date),{weekStartsOn:1}),"yyyy-MM-dd")))].map(l=>S(l)).sort((l,p)=>p.getTime()-l.getTime());if(o.length===0)return e;let n=0,a,s,i=x(new Date,{weekStartsOn:1}),c=M(i,1),m;if(o.some(l=>v(l,i)))n=1,a=i,s=i,m=M(i,1);else if(o.some(p=>v(p,c)))n=1,a=c,s=c,m=M(c,1);else return e;for(let l of o.slice(1))if(v(l,m))n++,s=l,m=M(m,1);else if(ce(m,l)>0)break;return{length:n,startDate:s,endDate:a}}calculateLongestWorkoutStreak(t){let e={length:0};if(!t||t.length<1)return e;let o=[...new Set(t.map(i=>C(x(S(i.date),{weekStartsOn:1}),"yyyy-MM-dd")))].map(i=>S(i)).sort((i,c)=>i.getTime()-c.getTime());if(o.length===0)return e;let n={length:0},a=0,s;for(let i=0;i<o.length;i++){let c=o[i];if(i===0)a=1,s=c;else{let m=o[i-1],d=N(m,1);v(c,d)?a++:(a=1,s=c)}a>n.length&&(n={length:a,startDate:s,endDate:c})}return n}static \u0275fac=function(e){return new(e||r)};static \u0275prov=j({token:r,factory:r.\u0275fac,providedIn:"root"})};export{he as a,ye as b,ke as c,we as d,xe as e,ve as f,Ce as g,Se as h,Me as i,_e as j,Ee as k,We as l,De as m,Ne as n,Ie as o,Le as p,Te as q,Be as r,Ke as s,Ae as t,Ve as u,Oe as v,je as w,Pe as x,Re as y,Fe as z,Ge as A,He as B,Ue as C,ze as D,ae as E,se as F,ue as G};

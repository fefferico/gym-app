import{a as ce}from"./chunk-3XIKQN32.js";import{a as oe,b as se}from"./chunk-DVJUZLBZ.js";import{g as ae,h as E}from"./chunk-CQ2BRMIJ.js";import{a as le}from"./chunk-J3OZO76K.js";import{Ca as F,Da as g,Ea as k,Jb as te,Kb as _,L as m,La as j,N as T,O as A,P as h,Pa as n,Q as y,Qa as G,Ra as v,Sa as $,U as M,_a as L,a as O,b as R,ca as p,cb as b,d as U,db as W,eb as H,fb as Y,gb as K,ib as J,ic as re,jc as ie,ka as S,kc as ne,o as V,pa as I,pb as Z,qb as q,qc as P,rb as z,ub as Q,va as u,vb as X,wa as r,xa as i,xb as ee,y as D,ya as x,yb as w}from"./chunk-IY3SH62B.js";var de=(c,e)=>({"bg-primary hover:bg-primary-dark text-white border-primary dark:border-primary":c,"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700":e}),B=class c{workoutService=m(ne);trackingService=m(P);storageService=m(ie);unitsService=m(E);alertService=m(re);spinnerService=m(oe);themeService=m(ce);BACKUP_VERSION=1;BACKUP_KEY="fitTrackPro_backup";currentUnit=this.unitsService.currentUnit;constructor(){window.scrollTo(0,0)}selectUnit(e){this.unitsService.setUnitPreference(e)}exportData(){this.spinnerService.show("Exporting data...");let e={version:this.BACKUP_VERSION,timestamp:new Date().toISOString(),routines:this.workoutService.getDataForBackup(),workoutLogs:this.trackingService.getLogsForBackup(),personalBests:this.trackingService.getPBsForBackup()},t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),l=URL.createObjectURL(a),o=document.createElement("a"),s=ae(new Date,"yyyyMMdd_HHmmss");o.download=`FitTrackPro_backup_${s}.json`,o.href=l,o.click(),URL.revokeObjectURL(l),console.log("Data export initiated."),this.spinnerService.hide()}importData(e){let t=e.target,a=t.files?.[0];if(!a){console.log("No file selected for import.");return}if(a.type!=="application/json"){alert("Invalid file type. Please select a JSON file."),t.value="";return}console.log(`Importing file: ${a.name}`);let l=new FileReader;l.onload=o=>{try{let s=o.target?.result,d=JSON.parse(s);if(typeof d!="object"||d===null){alert("Invalid backup file format. Expected an object."),t.value="";return}if(d.version!==this.BACKUP_VERSION){alert(`Invalid backup file version. Expected ${this.BACKUP_VERSION}, got ${d.version}. Please use a compatible backup file.`),t.value="";return}if(!d.routines||!d.workoutLogs||!d.personalBests){alert("Invalid backup file content. Missing essential data sections (routines, workoutLogs, personalBests)."),t.value="";return}this.alertService.showConfirm("WARNING","Importing data will OVERWRITE your current workout logs, routines, and personal bests. Are you sure you want to proceed?").then(f=>{f&&f.data?(this.workoutService.replaceData(d.routines),this.trackingService.replaceLogs(d.workoutLogs),this.trackingService.replacePBs(d.personalBests),console.log("Data import successful."),this.alertService.showAlert("Info","Data imported successfully!")):(console.log("Data import cancelled by user."),alert("Data import cancelled."))})}catch(s){console.error("Error processing imported file:",s),alert("Error processing backup file. Please ensure it is a valid JSON file.")}finally{t.value=""}},l.onerror=o=>{console.error("File reading error:",o),alert("Error reading file."),t.value=""},l.readAsText(a)}clearAllAppData(){return U(this,null,function*(){let e=yield this.alertService.showConfirmationDialog("WARNING","This will delete ALL your workout data (routines, logs, PBs). This cannot be undone. Are you sure?");e&&e.data&&(this.trackingService.clearAllWorkoutLogs_DEV_ONLY&&(yield this.trackingService.clearAllWorkoutLogs_DEV_ONLY()),this.trackingService.clearAllPersonalBests_DEV_ONLY&&(yield this.trackingService.clearAllPersonalBests_DEV_ONLY()),this.workoutService.clearAllRoutines_DEV_ONLY&&(yield this.workoutService.clearAllRoutines_DEV_ONLY()),yield this.alertService.showAlert("Info","All workout data has been cleared."))})}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=S({type:c,selectors:[["app-profile-settings"]],decls:63,vars:10,consts:[[1,"container","mx-auto","p-4"],[1,"mb-6","pb-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[1,"space-y-8"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-4"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["type","file","accept","application/json",1,"block","w-full","text-sm","text-gray-700","dark:text-gray-300","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-gray-200","file:text-gray-700","hover:file:bg-gray-300","dark:file:bg-gray-700","dark:file:text-gray-200","dark:hover:file:bg-gray-600",3,"change"],[1,"pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-sm","font-medium","text-red-600","dark:text-red-400","mb-2"],[1,"px-4","py-2","bg-red-500","hover:bg-red-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["routerLink","/profile/personal-bests",1,"px-4","py-2","bg-primary","hover:bg-primary-dark","text-white","font-semibold","rounded-md","shadow-sm","transition-colors","inline-flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-4","h-4","ml-2"],["fill-rule","evenodd","d","M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd"],[1,"flex","space-x-4"],[1,"px-4","py-2","border","rounded-md","transition-colors",3,"click","ngClass"],[1,"flex","items-center","justify-between"],[1,"text-md","font-medium","text-gray-700","dark:text-gray-300"],[1,"text-sm","text-gray-500","dark:text-gray-400","mr-1"],["for","theme-toggle",1,"inline-flex","items-center","cursor-pointer"],[1,"sr-only"],["type","checkbox","id","theme-toggle",1,"sr-only","peer",3,"change","checked"],[1,"relative","w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","dark:peer-focus:ring-blue-800","rounded-full","peer","dark:bg-gray-700","peer-checked:after:translate-x-full","rtl:peer-checked:after:-translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:start-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","dark:border-gray-600","peer-checked:bg-primary","dark:peer-checked:bg-primary-dark"],[1,"ms-3","text-sm","font-medium","text-gray-900","dark:text-gray-300"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"header",1)(2,"h1",2),n(3,"Profile & Settings"),i()(),r(4,"div",3)(5,"section",4)(6,"h2",5),n(7,"Data Management"),i(),r(8,"div",6)(9,"div")(10,"p",7),n(11,"Backup your data to a JSON file."),i(),r(12,"button",8),g("click",function(){return a.exportData()}),n(13," Export Data "),i()(),r(14,"div")(15,"p",7),n(16,"Restore your data from a JSON backup file."),i(),r(17,"input",9),g("change",function(o){return a.importData(o)}),i()(),r(18,"div",10)(19,"h3",11),n(20,"Reset / Clear Data"),i(),r(21,"p",12),n(22,"WARNING: This action will delete all your saved data."),i(),r(23,"button",13),g("click",function(){return a.clearAllAppData()}),n(24," Clear All Data "),i()()()(),r(25,"section",4)(26,"h2",5),n(27,"Your Achievements"),i(),r(28,"div")(29,"p",7),n(30,"View all your tracked Personal Bests."),i(),r(31,"a",14),n(32," View Personal Bests "),h(),r(33,"svg",15),x(34,"path",16),i()()()(),y(),r(35,"section",4)(36,"h2",5),n(37,"General Settings"),i(),r(38,"div",6)(39,"div")(40,"p",7),n(41,"Weight Units"),i(),r(42,"div",17)(43,"button",18),g("click",function(){return a.selectUnit("kg")}),n(44," kg "),i(),r(45,"button",18),g("click",function(){return a.selectUnit("lbs")}),n(46," lbs "),i()()()()(),r(47,"section",4)(48,"h2",5),n(49,"Appearance"),i(),r(50,"div",19)(51,"div")(52,"h3",20),n(53,"Dark Mode"),i(),r(54,"p",21),n(55,"Toggle between light and dark themes."),i()(),r(56,"label",22)(57,"span",23),n(58,"Toggle Dark Mode"),i(),r(59,"input",24),g("change",function(){return a.themeService.toggleTheme()}),i(),x(60,"div",25),r(61,"span",26),n(62),i()()()()()()),t&2&&(p(43),u("ngClass",L(4,de,a.currentUnit()==="kg",a.currentUnit()!=="kg")),p(2),u("ngClass",L(7,de,a.currentUnit()==="lbs",a.currentUnit()!=="lbs")),p(14),u("checked",a.themeService.isDarkTheme()),p(3),v(" ",a.themeService.isDarkTheme()?"On":"Off"," "))},dependencies:[w,Z,_],encapsulation:2})};function ue(c,e){if(c&1){let t=F();r(0,"tr",16),g("click",function(){let l=T(t).$implicit,o=k(2);return A(o.navigateToLogDetail(l.workoutLogId))}),r(1,"td",17),n(2),r(3,"span",18),n(4),b(5,"titlecase"),i()(),r(6,"td",19),n(7),i(),r(8,"td",20),n(9),i(),r(10,"td",21),n(11),b(12,"date"),i(),r(13,"td",22),n(14),b(15,"slice"),i(),r(16,"td",23)(17,"button",24),g("click",function(l){let o=T(t).$implicit,s=k(2);return A(s.navigateToLogDetail(o.workoutLogId,l))}),h(),r(18,"svg",25),x(19,"path",26)(20,"path",27),i()()()()}if(c&2){let t=e.$implicit,a=k(2);p(2),v(" ",t.exerciseName," "),p(2),v("(",W(5,8,t.primaryMuscleGroup),")"),p(3),v("",t.pbType," "),p(2),v(" ",a.formatPbValue(t)),p(2),G(H(12,10,t.timestamp,"mediumDate")),p(2),u("title",t.notes),p(),$("",Y(15,13,t.notes,0,50),"",t&&t.notes&&t.notes.length>50?"...":"")}}function fe(c,e){if(c&1&&(r(0,"div")(1,"div",8)(2,"table",9)(3,"thead",10)(4,"tr")(5,"th",11),n(6," Exercise"),i(),r(7,"th",11),n(8," PB Type"),i(),r(9,"th",11),n(10," Best"),i(),r(11,"th",11),n(12," Date"),i(),r(13,"th",11),n(14," Notes"),i(),r(15,"th",12)(16,"span",13),n(17,"View Log"),i()()()(),r(18,"tbody",14),I(19,ue,21,17,"tr",15),i()()()()),c&2){let t=k();p(19),u("ngForOf",t.displayPersonalBests())}}function xe(c,e){c&1&&(r(0,"div",28),h(),r(1,"svg",29),x(2,"path",30),i(),y(),r(3,"h2",31),n(4,"No Personal Bests Yet!"),i(),r(5,"p",32),n(6,"Keep logging your workouts to track your progress and achievements here."),i()())}var C=class c{trackingService=m(P);exerciseService=m(le);unitsService=m(E);router=m(te);toastService=m(se);allPersonalBests=M({});allExercises=M([]);displayPersonalBests=J(()=>{let e=this.allPersonalBests(),t=this.allExercises();if(Object.keys(e).length===0||t.length===0)return[];let a=new Map(t.map(o=>[o.id,o])),l=[];for(let o in e)if(e.hasOwnProperty(o)){let s=a.get(o),d=e[o];s&&d.forEach(f=>{l.push(R(O({},f),{exerciseName:s.name,exerciseCategory:s.category,primaryMuscleGroup:s.primaryMuscleGroup}))})}return l.sort((o,s)=>{let d=o.exerciseName.localeCompare(s.exerciseName);if(d!==0)return d;let f=this.getPbTypeSortOrder(o.pbType),N=this.getPbTypeSortOrder(s.pbType);return f!==N?f-N:o.weightUsed!==void 0&&s.weightUsed!==void 0?(s.weightUsed??0)-(o.weightUsed??0):o.repsAchieved!==void 0&&s.repsAchieved!==void 0&&o.pbType.includes("Max Reps")&&s.pbType.includes("Max Reps")?s.repsAchieved-o.repsAchieved:o.durationPerformed!==void 0&&s.durationPerformed!==void 0&&o.pbType.includes("Max Duration")&&s.pbType.includes("Max Duration")?(s.durationPerformed??0)-(o.durationPerformed??0):o.pbType.localeCompare(s.pbType)})});constructor(){}ngOnInit(){window.scrollTo(0,0),V([this.trackingService.personalBests$.pipe(D(1)),this.exerciseService.getExercises().pipe(D(1))]).subscribe(([e,t])=>{this.allPersonalBests.set(e),this.allExercises.set(t)})}getPbTypeSortOrder(e){return e.includes("1RM (Actual)")?0:e.includes("1RM (Estimated)")?1:e.includes("3RM (Actual)")?2:e.includes("5RM (Actual)")?3:e.includes("Heaviest Lifted")?4:e.includes("Max Reps (Bodyweight)")?5:e.includes("Max Duration")?6:100}formatPbValue(e){let t="";return e.weightUsed!==void 0&&e.weightUsed!==null?(t+=`${e.weightUsed}${this.unitsService.getUnitSuffix()}`,e.repsAchieved>0&&!(e.pbType.includes("RM (Actual)")&&e.repsAchieved===parseInt(e.pbType,10))&&(t+=` x ${e.repsAchieved}`)):e.repsAchieved>0&&e.pbType.includes("Max Reps")?t=`${e.repsAchieved} reps`:e.durationPerformed&&e.durationPerformed>0&&e.pbType.includes("Max Duration")&&(t=`${e.durationPerformed}s`),t||"N/A"}navigateToLogDetail(e,t){t?.stopPropagation(),e?this.router.navigate(["/workout/summary",e]):(this.toastService.error("Could not find the associated workout log for this PB.",0,"Navigation Error"),console.warn("Attempted to navigate to log detail, but workoutLogId is undefined for PB:",t))}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=S({type:c,selectors:[["app-personal-bests"]],decls:10,vars:2,consts:[["noPBs",""],[1,"container","mx-auto","p-4"],[1,"mb-6","flex","items-center"],["routerLink","/profile",1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","-ml-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[4,"ngIf","ngIfElse"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-md","overflow-auto","mb-6"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-750"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider"],["scope","col",1,"relative","px-6","py-3"],[1,"sr-only"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700"],["class","hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors duration-150",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700","cursor-pointer","transition-colors","duration-150",3,"click"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900","dark:text-gray-100"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-300"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-semibold","text-primary","dark:text-primary-light"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","text-sm","text-gray-500","dark:text-gray-400","italic","truncate","max-w-xs",3,"title"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],["title","View Workout Log",1,"text-indigo-600","hover:text-indigo-900","dark:text-indigo-400","dark:hover:text-indigo-300",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5"],["d","M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"],["fill-rule","evenodd","d","M.664 10.59a1.651 1.651 0 0 1 0-1.186A10.004 10.004 0 0 1 10 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0 1 10 17c-4.257 0-7.893-2.66-9.336-6.41ZM14 10a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z","clip-rule","evenodd"],[1,"text-center","py-10","bg-white","dark:bg-gray-800","rounded-lg","shadow-md"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-16","h-16","mx-auto","text-gray-400","dark:text-gray-500","mb-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 3H18M8 3V5C8 7.20914 9.79086 9 12 9C14.2091 9 16 7.20914 16 5V3M10 9V17H14V9M8 20H16"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-gray-500","dark:text-gray-400"]],template:function(t,a){if(t&1&&(r(0,"div",1)(1,"div",2)(2,"button",3),h(),r(3,"svg",4),x(4,"path",5),i()(),y(),r(5,"h1",6),n(6,"Personal Bests"),i()(),I(7,fe,20,1,"div",7)(8,xe,7,0,"ng-template",null,0,K),i()),t&2){let l=j(9);p(7),u("ngIf",a.displayPersonalBests().length>0)("ngIfElse",l)}},dependencies:[w,q,z,ee,Q,X,_],encapsulation:2})};var tt=[{path:"",component:B,title:"Profile & Settings"},{path:"personal-bests",component:C,title:"Personal Bests"}];export{tt as PROFILE_SETTINGS_ROUTES};

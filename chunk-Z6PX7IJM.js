import{a as cn}from"./chunk-QYJGK2J2.js";import{a as hn}from"./chunk-VIBV7W64.js";import{b as _n}from"./chunk-34KTCAO3.js";import{K as pn}from"./chunk-7IB54K3Z.js";import{a as un}from"./chunk-DIVOZARA.js";import{a as ui}from"./chunk-YEWPSQKU.js";import{a as mn,b as gn}from"./chunk-DSYZOOBC.js";import{a as dn}from"./chunk-Y7FT5XKH.js";import{a as di}from"./chunk-VERC57XK.js";import{a as pi}from"./chunk-IRRQWAWJ.js";import{B as ze,C as on,E as ie,F as sn,I as oi,M as si,P as ai,S as li,U as He,V as ci,W as ln,b as Ft,c as Ni,d as $r,e as jr,f as Kr,g as Zr,h as Yr,i as Qr,j as Jr,k as Xr,l as en,m as ti,o as Wi,q as Rt,r as Gi,s as qi,t as tn,u as ii,v as be,w as rn,x as ri,y as Ne,z as nn}from"./chunk-KIB52VSI.js";import{a as ni,s as pe,v as an}from"./chunk-YVG3JICA.js";import{$ as Ye,$a as Le,$b as Tr,$c as Xt,B as tt,Ba as Vi,Bb as ve,Bc as Je,Ca as Mt,Cb as Ie,D as Bi,Da as jt,Dc as Jt,E as qt,Eb as ye,F as ce,Fb as Li,G as De,H as it,Hb as ot,I as zt,Ib as Ge,Ja as g,Jb as yr,Jc as K,K as j,Ka as m,Kb as br,Kc as Rr,L as Ht,La as c,Lb as st,Lc as ut,M as Se,Ma as F,Mb as at,Mc as Oe,N as mr,Na as L,Nb as lt,Nc as pt,O as S,Oa as O,Ob as wr,Oc as Br,Pa as ke,Pb as Sr,Pc as ue,Q as gr,Qa as D,Qb as Cr,Qc as Dt,Ra as E,Rc as mt,Sa as d,Sb as kr,Sc as Pr,T as y,Tb as Yt,Tc as Ar,U as b,Ub as ct,Vc as Vr,Wa as Pe,Wb as Er,X as Ze,Xa as Ae,Xb as Ir,Xc as Lr,Y as _e,Ya as Ve,Yc as Or,Za as Y,Zb as dt,Zc as Nr,_ as R,_a as nt,_c as Wr,a as Me,ab as xr,ad as gt,b as kt,ba as fe,bb as h,bd as ht,c as U,ca as hr,cb as I,d as dr,da as Ut,db as C,dd as Gr,eb as Q,f as Di,fa as _r,fb as Kt,fd as qr,ga as fr,gb as J,gd as ei,h as je,hb as X,hd as _t,i as oe,ib as ee,id as zr,ja as a,jc as Mr,jd as Hr,l as he,la as H,lb as We,ld as ft,m as le,ma as Re,mb as Qe,md as xt,n as ur,na as Pi,nb as se,o as Ke,oa as It,ob as Z,od as qe,p as Wt,pa as rt,pb as Zt,pc as Fr,pd as vt,qa as Ai,qd as yt,ra as Ce,rc as Dr,rd as Ur,sa as Tt,t as pr,tb as _,u as Gt,ua as Be,ub as f,v as et,va as $t,vb as Ee,w as Ri,wa as de,wb as vr,xb as xe,xc as Oi,y as Et,yc as Qt,z as Fe,za as w}from"./chunk-CAUFP2YI.js";import{a as A,b as z,c as cr,g as W}from"./chunk-GAL4ENT6.js";var zi;function io(){if(zi==null){let n=typeof document<"u"?document.head:null;zi=!!(n&&(n.createShadowRoot||n.attachShadow))}return zi}function mi(n){if(io()){let t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Bt(n){return n.composedPath?n.composedPath()[0]:n.target}function fn(n){return n.buttons===0||n.detail===0}function xn(n){let t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}function gi(n,t=0){return ro(n)?Number(n):arguments.length===2?t:0}function ro(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function we(n){return n instanceof fe?n.nativeElement:n}var hi=new WeakMap,vn=(()=>{class n{_appRef;_injector=S(Ze);_environmentInjector=S(gr);load(e){let i=this._appRef=this._appRef||this._injector.get(Vi),r=hi.get(i);r||(r={loaders:new Set,refs:[]},hi.set(i,r),i.onDestroy(()=>{hi.get(i)?.refs.forEach(o=>o.destroy()),hi.delete(i)})),r.loaders.has(e)||(r.loaders.add(e),r.refs.push(br(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Hi;try{Hi=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Hi=!1}var Ui=(()=>{class n{_platformId=S(Ut);isBrowser=this._platformId?Tr(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Hi)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var no=new Se("cdk-dir-doc",{providedIn:"root",factory:oo});function oo(){return S(_e)}var so=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function ao(n){let t=n?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?so.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var $i=(()=>{class n{get value(){return this.valueSignal()}valueSignal=R("ltr");change=new H;constructor(){let e=S(no,{optional:!0});if(e){let i=e.body?e.body.dir:null,r=e.documentElement?e.documentElement.dir:null;this.valueSignal.set(ao(i||r||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var lo=20,yn=(()=>{class n{_ngZone=S(Re);_platform=S(Ui);_renderer=S(rt).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new U;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=lo){return this._platform.isBrowser?new kt(i=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=e>0?this._scrolled.pipe(Ri(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):oe()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){let r=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(et(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(e){let i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,e)&&i.push(o)}),i}_scrollableContainsElement(e,i){let r=we(i),o=e.getElementRef().nativeElement;do if(r==o)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var co=20,bn=(()=>{class n{_platform=S(Ui);_listeners;_viewportSize;_change=new U;_document=S(_e);constructor(){let e=S(Re),i=S(rt).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=o=>this._change.next(o);this._listeners=[i.listen("window","resize",r),i.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,i=this._getWindow(),r=e.documentElement,o=r.getBoundingClientRect(),s=-o.top||e.body.scrollTop||i.scrollY||r.scrollTop||0,l=-o.left||e.body.scrollLeft||i.scrollX||r.scrollLeft||0;return{top:s,left:l}}change(e=co){return e>0?this._change.pipe(Ri(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var wn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=$t({type:n});static \u0275inj=Ht({})}return n})();var ji={},Sn=(()=>{class n{_appId=S(hr);getId(e){return this._appId!=="ng"&&(e+=this._appId),ji.hasOwnProperty(e)||(ji[e]=0),`${e}${ji[e]++}`}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cn(n){return Array.isArray(n)?n:[n]}function Yi(n){let t=n.cloneNode(!0),e=t.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();t.removeAttribute("id");for(let r=0;r<e.length;r++)e[r].removeAttribute("id");return i==="canvas"?In(n,t):(i==="input"||i==="select"||i==="textarea")&&En(n,t),kn("canvas",n,t,In),kn("input, textarea, select",n,t,En),t}function kn(n,t,e,i){let r=t.querySelectorAll(n);if(r.length){let o=e.querySelectorAll(n);for(let s=0;s<r.length;s++)i(r[s],o[s])}}var uo=0;function En(n,t){t.type!=="file"&&(t.value=n.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${uo++}`)}function In(n,t){let e=t.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function ir(n){let t=n.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Qi(n,t,e){let{top:i,bottom:r,left:o,right:s}=n;return e>=i&&e<=r&&t>=o&&t<=s}function po(n,t){let e=t.left<n.left,i=t.left+t.width>n.right,r=t.top<n.top,o=t.top+t.height>n.bottom;return e||i||r||o}function Vt(n,t,e){n.top+=t,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function Tn(n,t,e,i){let{top:r,right:o,bottom:s,left:l,width:u,height:p}=n,x=u*t,v=p*t;return i>r-v&&i<s+v&&e>l-x&&e<o+x}var _i=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:ir(e)})})}handleScroll(t){let e=Bt(t),i=this.positions.get(e);if(!i)return null;let r=i.scrollPosition,o,s;if(e===this._document){let p=this.getViewportScrollPosition();o=p.top,s=p.left}else o=e.scrollTop,s=e.scrollLeft;let l=r.top-o,u=r.left-s;return this.positions.forEach((p,x)=>{p.clientRect&&e!==x&&e.contains(x)&&Vt(p.clientRect,l,u)}),r.top=o,r.left=s,{top:l,left:u}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Wn(n,t){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let i=t.createElement("div");return e.forEach(r=>i.appendChild(r)),i}function rr(n,t,e){for(let i in t)if(t.hasOwnProperty(i)){let r=t[i];r?n.setProperty(i,r,e?.has(i)?"important":""):n.removeProperty(i)}return n}function bt(n,t){let e=t?"":"none";rr(n.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function Mn(n,t,e){rr(n.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function fi(n,t){return t&&t!="none"?n+" "+t:n}function Fn(n,t){n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.transform=Lt(t.left,t.top)}function Lt(n,t){return`translate3d(${Math.round(n)}px, ${Math.round(t)}px, 0)`}function Dn(n){let t=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*t}function mo(n){let t=getComputedStyle(n),e=Ki(t,"transition-property"),i=e.find(l=>l==="transform"||l==="all");if(!i)return 0;let r=e.indexOf(i),o=Ki(t,"transition-duration"),s=Ki(t,"transition-delay");return Dn(o[r])+Dn(s[r])}function Ki(n,t){return n.getPropertyValue(t).split(",").map(i=>i.trim())}var go=new Set(["position"]),Ji=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,e,i,r,o,s,l,u,p,x){this._document=t,this._rootElement=e,this._direction=i,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=l,this._initialTransform=u,this._zIndex=p,this._renderer=x}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),Rn(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return mo(this._preview)}addEventListener(t,e){return this._renderer.listen(this._preview,t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,i=t?t.template:null,r;if(i&&t){let o=t.matchSize?this._initialDomRect:null,s=t.viewContainer.createEmbeddedView(i,t.context);s.detectChanges(),r=Wn(s,this._document),this._previewEmbeddedView=s,t.matchSize?Fn(r,o):r.style.transform=Lt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=Yi(this._rootElement),Fn(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return rr(r.style,{"pointer-events":"none",margin:Rn(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},go),bt(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(o=>r.classList.add(o)):r.classList.add(e)),r}};function Rn(n){return"showPopover"in n}var ho={passive:!0},Bn={passive:!1},_o={passive:!1,capture:!0},fo=800,Pn="cdk-drag-placeholder",An=new Set(["position"]),Xi=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=R(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new U;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Me.EMPTY;_pointerUpSubscription=Me.EMPTY;_scrollSubscription=Me.EMPTY;_resizeSubscription=Me.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>bt(e,t)))}_disabled=!1;beforeStarted=new U;started=new U;released=new U;ended=new U;entered=new U;exited=new U;dropped=new U;moved=this._moveEvents;data;constrainPosition;constructor(t,e,i,r,o,s,l){this._config=e,this._document=i,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._renderer=l,this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new _i(i),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>we(i)),this._handles.forEach(i=>bt(i,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=we(t);if(e!==this._rootElement){this._removeRootElementListeners();let i=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[i.listen(e,"mousedown",this._pointerDown,Bn),i.listen(e,"touchstart",this._pointerDown,ho),i.listen(e,"dragstart",this._nativeDragStart,Bn)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?we(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&po(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),i=0,r=0;e.left<t.left?i=t.left-e.left:e.right>t.right&&(i=t.right-e.right),e.top<t.top?r=t.top-e.top:e.bottom>t.bottom&&(r=t.bottom-e.bottom);let o=this._activeTransform.x,s=this._activeTransform.y,l=o+i,u=s+r;this._rootElement.style.transform=Lt(l,u),this._activeTransform={x:l,y:u},this._passiveTransform={x:l,y:u}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),bt(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),bt(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let r=Math.abs(e.x-this._pickupPositionOnPage.x),o=Math.abs(e.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let l=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),u=this._dropContainer;if(!l){this._endDragSequence(t);return}(!u||!u.isDragging()&&!u.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=i.x-r.x+this._passiveTransform.x,o.y=i.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Pt(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),i=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",xo,_o)}),i){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),l=this._marker=this._marker||this._document.createComment("");o.insertBefore(l,r),this._initialTransform=r.style.transform||"",this._preview=new Ji(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,e)),Mn(r,!1,An),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:t}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let i=this.isDragging(),r=Pt(e),o=!r&&e.button!==0,s=this._rootElement,l=Bt(e),u=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+fo>Date.now(),p=r?xn(e):fn(e);if(l&&l.draggable&&e.type==="mousedown"&&e.preventDefault(),i||o||u||p)return;if(this._handles.length){let k=s.style;this._rootElementTapHighlight=k.webkitTapHighlightColor||"",k.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(k=>this._updateOnScroll(k)),this._boundaryElement&&(this._boundaryRect=ir(this._boundaryElement));let x=this._previewTemplate;this._pickupPositionInElement=x&&x.template&&!x.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let v=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:v.x,y:v.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){Mn(this._rootElement,!0,An),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,i=e.getItemIndex(this),r=this._getPointerPositionOnPage(t),o=this._getDragDistance(r),s=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,s,o,r,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),l=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,l),this._dropContainer=o,this._dropContainer.enter(this,t,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let r=l=>{(!l||this._preview&&Bt(l)===this._preview.element&&l.propertyName==="transform")&&(s(),i(),clearTimeout(o))},o=setTimeout(r,e*1.5),s=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=Wn(this._placeholderRef,this._document)):i=Yi(this._rootElement),i.style.pointerEvents="none",i.classList.add(Pn),i}_getPointerPositionInElement(t,e,i){let r=e===this._rootElement?null:e,o=r?r.getBoundingClientRect():t,s=Pt(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition(),u=s.pageX-o.left-l.left,p=s.pageY-o.top-l.top;return{x:o.left-t.left+u,y:o.top-t.top+p}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),i=Pt(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,r=i.pageX-e.left,o=i.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=o,l.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:r}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:u,height:p}=this._getPreviewRect(),x=l.top+s,v=l.bottom-(p-s),k=l.left+o,T=l.right-(u-o);i=Vn(i,k,T),r=Vn(r,x,v)}return{x:i,y:r}}_updatePointerDirectionDelta(t){let{x:e,y:i}=t,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-o.x),l=Math.abs(i-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=e>o.x?1:-1,o.x=e),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>o.y?1:-1,o.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,bt(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,e){let i=1/this.scale,r=Lt(t*i,e*i),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=fi(r,this._initialTransform)}_applyPreviewTransform(t,e){let i=this._previewTemplate?.template?void 0:this._initialTransform,r=Lt(t,e);this._preview.setTransform(fi(r,i))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||i.width===0&&i.height===0)return;let o=r.left-i.left,s=i.right-r.right,l=r.top-i.top,u=i.bottom-r.bottom;r.width>i.width?(o>0&&(t+=o),s>0&&(t-=s)):t=0,r.height>i.height?(l>0&&(e+=l),u>0&&(e-=u)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:Pt(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let i=Bt(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Vt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=mi(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let i=this._previewContainer||"global";if(i==="parent")return t;if(i==="global"){let r=this._document;return e||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return we(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}_conditionallyInsertAnchor(t,e,i){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let r=this._anchor??=Yi(this._placeholder);r.classList.remove(Pn),r.classList.add("cdk-drag-anchor"),r.style.transform="",i?i.before(r):we(e.element).appendChild(r)}}};function Vn(n,t,e){return Math.max(t,Math.min(e,n))}function Pt(n){return n.type[0]==="t"}function xo(n){n.preventDefault()}function yi(n,t,e){let i=Ln(t,n.length-1),r=Ln(e,n.length-1);if(i===r)return;let o=n[i],s=r<i?-1:1;for(let l=i;l!==r;l+=s)n[l]=n[l+s];n[r]=o}function Ln(n,t){return Math.max(0,Math.min(t,n))}var xi=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,e,i,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,e,i,r);if(s===-1&&o.length>0)return null;let l=this.orientation==="horizontal",u=o.findIndex(M=>M.drag===t),p=o[s],x=o[u].clientRect,v=p.clientRect,k=u>s?1:-1,T=this._getItemOffsetPx(x,v,k),G=this._getSiblingOffsetPx(u,o,k),B=o.slice();return yi(o,u,s),o.forEach((M,N)=>{if(B[N]===M)return;let q=M.drag===t,V=q?T:G,te=q?t.getPlaceholderElement():M.drag.getRootElement();M.offset+=V;let $=Math.round(M.offset*(1/M.drag.scale));l?(te.style.transform=fi(`translate3d(${$}px, 0, 0)`,M.initialTransform),Vt(M.clientRect,0,V)):(te.style.transform=fi(`translate3d(0, ${$}px, 0)`,M.initialTransform),Vt(M.clientRect,V,0))}),this._previousSwap.overlaps=Qi(v,e,i),this._previousSwap.drag=p.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:u,currentIndex:s}}enter(t,e,i,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(t,e,i):r,s=this._activeDraggables,l=s.indexOf(t),u=t.getPlaceholderElement(),p=s[o];if(p===t&&(p=s[o+1]),!p&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(p=s[0]),l>-1&&s.splice(l,1),p&&!this._dragDropRegistry.isDragging(p)){let x=p.getRootElement();x.parentElement.insertBefore(u,x),s.splice(o,0,t)}else this._element.appendChild(u),s.push(t);u.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let i=this._itemPositions.find(r=>r.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(e=>e.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{Vt(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:ir(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,e,i){let r=this.orientation==="horizontal",o=r?e.left-t.left:e.top-t.top;return i===-1&&(o+=r?e.width-t.width:e.height-t.height),o}_getSiblingOffsetPx(t,e,i){let r=this.orientation==="horizontal",o=e[t].clientRect,s=e[t+i*-1],l=o[r?"width":"height"]*i;if(s){let u=r?"left":"top",p=r?"right":"bottom";i===-1?l-=s.clientRect[u]-o[p]:l+=o[u]-s.clientRect[p]}return l}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,r=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let s=i[i.length-1].clientRect;return r?t>=s.right:e>=s.bottom}else{let s=i[0].clientRect;return r?t<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(t,e,i,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:l,clientRect:u})=>{if(l===t)return!1;if(r){let p=o?r.x:r.y;if(l===this._previousSwap.drag&&this._previousSwap.overlaps&&p===this._previousSwap.delta)return!1}return o?e>=Math.floor(u.left)&&e<Math.floor(u.right):i>=Math.floor(u.top)&&i<Math.floor(u.bottom)});return s===-1||!this._sortPredicate(s,t)?-1:s}},er=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,e){this._document=t,this._dragDropRegistry=e}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<e.length;i++){let r=e[i];this._relatedNodes.push([r,r.nextSibling])}this.withItems(t)}sort(t,e,i,r){let o=this._getItemIndexFromPointerPosition(t,e,i),s=this._previousSwap;if(o===-1||this._activeItems[o]===t)return null;let l=this._activeItems[o];if(s.drag===l&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let u=this.getItemIndex(t),p=t.getPlaceholderElement(),x=l.getRootElement();o>u?x.after(p):x.before(p),yi(this._activeItems,u,o);let v=this._getRootNode().elementFromPoint(e,i);return s.deltaX=r.x,s.deltaY=r.y,s.drag=l,s.overlaps=x===v||x.contains(v),{previousIndex:u,currentIndex:o}}enter(t,e,i,r){let o=this._activeItems.indexOf(t);o>-1&&this._activeItems.splice(o,1);let s=r==null||r<0?this._getItemIndexFromPointerPosition(t,e,i):r;s===-1&&(s=this._getClosestItemIndexToPointer(t,e,i));let l=this._activeItems[s];l&&!this._dragDropRegistry.isDragging(l)?(this._activeItems.splice(s,0,t),l.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[r,o]=this._relatedNodes[i];r.parentNode===t&&r.nextSibling!==o&&(o===null?t.appendChild(r):o.parentNode===t&&t.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,i){let r=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(i)),o=r?this._activeItems.findIndex(s=>{let l=s.getRootElement();return r===l||l.contains(r)}):-1;return o===-1||!this._sortPredicate(o,t)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=mi(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let l=this._activeItems[s];if(l!==t){let{x:u,y:p}=l.getRootElement().getBoundingClientRect(),x=Math.hypot(e-u,i-p);x<r&&(r=x,o=s)}}return o}},On=.05,Gn=.05,me=(function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n})(me||{}),ne=(function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n})(ne||{}),tr=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new U;entered=new U;exited=new U;dropped=new U;sorted=new U;receivingStarted=new U;receivingStopped=new U;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Me.EMPTY;_verticalScrollDirection=me.NONE;_horizontalScrollDirection=ne.NONE;_scrollNode;_stopScrollTimers=new U;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,e,i,r,o){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=o;let s=this.element=we(t);this._document=i,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new _i(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,r,o,s,l,u={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:l,event:u})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(r=>r.isDragging()).every(r=>t.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof xi&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new er(this._document,this._dragDropRegistry);else{let e=new xi(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,i)=>this.sortPredicate(e,i,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=we(this.element),i=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(t);return i>-1&&this._scrollableElements.splice(i,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,r){if(this.sortingDisabled||!this._domRect||!Tn(this._domRect,On,e,i))return;let o=this._sortStrategy.sort(t,e,i,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,r=me.NONE,o=ne.NONE;if(this._parentPositions.positions.forEach((s,l)=>{l===this._document||!s.clientRect||i||Tn(s.clientRect,On,t,e)&&([r,o]=vo(l,s.clientRect,this._direction,t,e),(r||o)&&(i=l))}),!r&&!o){let{width:s,height:l}=this._viewportRuler.getViewportSize(),u={width:s,height:l,top:0,right:s,bottom:l,left:0};r=qn(u,e),o=zn(u,t),i=window}i&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=i,(r||o)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),pr(0,Di).pipe(it(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===me.UP?t.scrollBy(0,-e):this._verticalScrollDirection===me.DOWN&&t.scrollBy(0,e),this._horizontalScrollDirection===ne.LEFT?t.scrollBy(-e,0):this._horizontalScrollDirection===ne.RIGHT&&t.scrollBy(e,0)})};_isOverContainer(t,e){return this._domRect!=null&&Qi(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(r=>r._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._domRect||!Qi(this._domRect,e,i)||!this.enterPredicate(t,this))return!1;let r=this._getShadowRoot().elementFromPoint(e,i);return r?r===this._container||this._container.contains(r):!1}_startReceiving(t,e){let i=this._activeSiblings;!i.has(t)&&e.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=mi(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function qn(n,t){let{top:e,bottom:i,height:r}=n,o=r*Gn;return t>=e-o&&t<=e+o?me.UP:t>=i-o&&t<=i+o?me.DOWN:me.NONE}function zn(n,t){let{left:e,right:i,width:r}=n,o=r*Gn;return t>=e-o&&t<=e+o?ne.LEFT:t>=i-o&&t<=i+o?ne.RIGHT:ne.NONE}function vo(n,t,e,i,r){let o=qn(t,r),s=zn(t,i),l=me.NONE,u=ne.NONE;if(o){let p=n.scrollTop;o===me.UP?p>0&&(l=me.UP):n.scrollHeight-p>n.clientHeight&&(l=me.DOWN)}if(s){let p=n.scrollLeft;e==="rtl"?s===ne.RIGHT?p<0&&(u=ne.RIGHT):n.scrollWidth+p>n.clientWidth&&(u=ne.LEFT):s===ne.LEFT?p>0&&(u=ne.LEFT):n.scrollWidth-p>n.clientWidth&&(u=ne.RIGHT)}return[l,u]}var At={capture:!0},Zi={passive:!1,capture:!0},yo=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Be({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,r){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return n})(),nr=(()=>{class n{_ngZone=S(Re);_document=S(_e);_styleLoader=S(vn);_renderer=S(rt).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new U;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=R([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new U;pointerUp=new U;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Zi)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(yo),this._activeDragInstances.update(r=>[...r,e]),this._activeDragInstances().length===1)){let r=i.type.startsWith("touch"),o=l=>this.pointerUp.next(l),s=[["scroll",l=>this._scroll.next(l),At],["selectstart",this._preventDefaultWhileDragging,Zi]];r?s.push(["touchend",o,At],["touchcancel",o,At]):s.push(["mouseup",o,At]),r||s.push(["mousemove",l=>this.pointerMove.next(l),Zi]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([l,u,p])=>this._renderer.listen(this._document,l,u,p))})}}stopDragging(e){this._activeDragInstances.update(i=>{let r=i.indexOf(e);return r>-1?(i.splice(r,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this._scroll];return e&&e!==this._document&&i.push(new kt(r=>this._ngZone.runOutsideAngular(()=>{let o=this._renderer.listen(e,"scroll",s=>{this._activeDragInstances().length&&r.next(s)},At);return()=>{o()}}))),Gt(...i)}registerDirectiveNode(e,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,i)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bo={dragStartThreshold:5,pointerDirectionChangeThreshold:5},or=(()=>{class n{_document=S(_e);_ngZone=S(Re);_viewportRuler=S(bn);_dragDropRegistry=S(nr);_renderer=S(rt).createRenderer(null,null);constructor(){}createDrag(e,i=bo){return new Xi(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new tr(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vi=new Se("CDK_DRAG_PARENT");var Hn=new Se("CdkDragHandle"),qd=(()=>{class n{element=S(fe);_parentDrag=S(vi,{optional:!0,skipSelf:!0});_dragDropRegistry=S(nr);_stateChanges=new U;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let e=this.element.nativeElement.parentElement;for(;e;){let i=this._dragDropRegistry.getDragDirectiveForNode(e);if(i){this._parentDrag=i,i._addHandle(this);break}e=e.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=de({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",Ge]},features:[We([{provide:Hn,useExisting:n}])]})}return n})(),Un=new Se("CDK_DRAG_CONFIG"),$n=new Se("CdkDropList"),jn=(()=>{class n{element=S(fe);dropContainer=S($n,{optional:!0,skipSelf:!0});_ngZone=S(Re);_viewContainerRef=S(Tt);_dir=S($i,{optional:!0});_changeDetectorRef=S(ot);_selfHandle=S(Hn,{optional:!0,self:!0});_parentDrag=S(vi,{optional:!0,skipSelf:!0});_dragDropRegistry=S(nr);_destroyed=new U;_handles=new dr([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new H;released=new H;ended=new H;entered=new H;exited=new H;dropped=new H;moved=new kt(e=>{let i=this._dragRef.moved.pipe(le(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(e);return()=>{i.unsubscribe()}});_injector=S(Ze);constructor(){let e=this.dropContainer,i=S(Un,{optional:!0}),r=S(or);this._dragRef=r.createDrag(this.element,{dragStartThreshold:i&&i.dragStartThreshold!=null?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&i.pointerDirectionChangeThreshold!=null?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(it(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){Pi(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,r=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),r=i.indexOf(e);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):we(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof r=="object"&&r?r:gi(r),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(Fe(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){let r=this._dragDropRegistry.getDragDirectiveForNode(i);if(r){e.withParent(r._dragRef);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:l,draggingDisabled:u,rootElementSelector:p,previewContainer:x}=e;this.disabled=u??!1,this.dragStartDelay=r||0,this.lockAxis=i||null,o&&(this.constrainPosition=o),s&&(this.previewClass=s),l&&(this.boundaryElement=l),p&&(this.rootElementSelector=p),x&&(this.previewContainer=x)}_setupHandlesListener(){this._handles.pipe(zt(e=>{let i=e.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),De(e=>Gt(...e.map(i=>i._stateChanges.pipe(ce(i))))),it(this._destroyed)).subscribe(e=>{let i=this._dragRef,r=e.element.nativeElement;e.disabled?i.disableHandle(r):i.enableHandle(r)})}static \u0275fac=function(i){return new(i||n)};static \u0275dir=de({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){i&2&&Le("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",Ge],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",yr]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[We([{provide:vi,useExisting:n}]),Ye]})}return n})(),Nn=new Se("CdkDropListGroup");var Kn=(()=>{class n{element=S(fe);_changeDetectorRef=S(ot);_scrollDispatcher=S(yn);_dir=S($i,{optional:!0});_group=S(Nn,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new U;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=S(Sn).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new H;entered=new H;exited=new H;sorted=new H;_unsortedItems=new Set;constructor(){let e=S(or),i=S(Un,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let i=this._latestSortedRefs.indexOf(e._dragRef);i>-1&&(this._latestSortedRefs.splice(i,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=n._dropLists.indexOf(this);e>-1&&n._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(ce(this._dir.value),it(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=Cn(this.connectedTo).map(r=>{if(typeof r=="string"){let o=n._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{i.indexOf(r)===-1&&i.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(r)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=gi(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),Gt(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:l}=e;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=l||"vertical",this.lockAxis=i||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=de({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,r){i&2&&(jt("id",r.id),Le("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",Ge],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",Ge],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",Ge],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",Ge]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[We([{provide:Nn,useValue:void 0},{provide:$n,useExisting:n}])]})}return n})();var wo=new Se("CdkDragPlaceholder"),zd=(()=>{class n{templateRef=S(It);_drag=S(vi,{optional:!0});data;constructor(){this._drag?._setPlaceholderTemplate(this)}ngOnDestroy(){this._drag?._resetPlaceholderTemplate(this)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=de({type:n,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[We([{provide:wo,useExisting:n}])]})}return n})();var Zn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=$t({type:n});static \u0275inj=Ht({providers:[or],imports:[wn]})}return n})();var Co=["exerciseSearchFied"],ko=["scrollContainer"],Eo=(n,t,e)=>({"selected-item":n,"bg-gray-200 dark:bg-gray-600":t,"bg-gray-100 dark:bg-gray-500":e}),Io=n=>({count:n}),To=n=>({date:n});function Mo(n,t){if(n&1&&(m(0,"option",41),h(1),_(2,"titlecase"),c()),n&2){let e=t.$implicit;g("value",e),a(),I(f(2,2,e))}}function Fo(n,t){if(n&1&&(m(0,"option",41),h(1),_(2,"titlecase"),c()),n&2){let e=t.$implicit;g("value",e),a(),I(f(2,2,e.name))}}function Do(n,t){if(n&1){let e=D();m(0,"div")(1,"label",42),h(2),_(3,"translate"),c(),m(4,"input",43,1),ee("ngModelChange",function(r){y(e);let o=d(2);return X(o.searchTerm,r)||(o.searchTerm=r),b(r)}),E("keydown.enter",function(){y(e);let r=d(2);return b(r.onSearchEnter())}),c()()}if(n&2){let e=d(2);a(2),I(f(3,3,"exerciseSelectionModal.searchLabel")),a(2),g("placeholder",e.searchPlaceholder()),J("ngModel",e.searchTerm)}}function Ro(n,t){if(n&1){let e=D();m(0,"button",44),E("click",function(){y(e);let r=d(2);return b(r.onFindSimilar())}),h(1),_(2,"translate"),c()}n&2&&(a(),C(" ",f(2,1,"exerciseSelectionModal.showSimilar")," "))}function Bo(n,t){if(n&1){let e=D();m(0,"button",45),E("click",function(){y(e);let r=d(2);return b(r.onBackToSearch())}),F(1,"app-icon",46),h(2),_(3,"translate"),c()}n&2&&(a(2),C(" ",f(3,1,"exerciseSelectionModal.backToSearch")," "))}function Po(n,t){if(n&1&&(m(0,"div",49),h(1),c()),n&2){let e=d().$implicit;a(),C(" ",e.label," ")}}function Ao(n,t){if(n&1&&(m(0,"span",56),h(1),_(2,"titlecase"),_(3,"titlecase"),c()),n&2){let e=d(2).$implicit;a(),Q("",f(2,2,e.category)," ",e.primaryMuscleGroup?f(3,4," - "+e.primaryMuscleGroup):"")}}function Vo(n,t){n&1&&(L(0),h(1),_(2,"translate"),O()),n&2&&(a(),I(f(2,1,"exerciseSelectionModal.custom")))}function Lo(n,t){n&1&&(L(0),h(1," | "),O())}function Oo(n,t){if(n&1&&(L(0),h(1),_(2,"translate"),O()),n&2){let e=d(3).$implicit;a(),I(Ee(2,1,"exerciseSelectionModal.count",se(4,Io,e.usageCount)))}}function No(n,t){n&1&&(L(0),h(1," | "),O())}function Wo(n,t){if(n&1&&(L(0),h(1),_(2,"date"),_(3,"translate"),O()),n&2){let e=d(3).$implicit;a(),I(Ee(3,5,"exerciseSelectionModal.lastUsed",se(8,To,vr(2,1,e.lastUsedAt,"dd-MM-yy","UTC"))))}}function Go(n,t){if(n&1&&(m(0,"span",57),h(1," [ "),w(2,Vo,3,3,"ng-container",23)(3,Lo,2,0,"ng-container",23)(4,Oo,3,6,"ng-container",23)(5,No,2,0,"ng-container",23)(6,Wo,4,10,"ng-container",23),h(7," ] "),c()),n&2){let e=d(2).$implicit;a(2),g("ngIf",e.isCustom),a(),g("ngIf",e.isCustom&&(e.usageCount!=null||e.lastUsedAt)),a(),g("ngIf",e.usageCount!=null),a(),g("ngIf",e.usageCount!=null&&e.lastUsedAt),a(),g("ngIf",e.lastUsedAt)}}function qo(n,t){if(n&1&&(m(0,"span",60),h(1),c()),n&2){let e=t.ngIf;a(),C(" ",e," ")}}function zo(n,t){if(n&1){let e=D();L(0),w(1,qo,2,1,"span",58),m(2,"input",59),E("change",function(){y(e);let r=d(2).$implicit,o=d(2);return b(o.toggleSelection(r))})("click",function(r){return y(e),b(r.stopPropagation())}),c(),O()}if(n&2){let e=d(2).$implicit,i=d(2);a(),g("ngIf",i.getSelectionIndex(e)),a(),g("checked",i.isSelected(e))}}function Ho(n,t){if(n&1&&F(0,"app-icon",61),n&2){let e=d(4);xr("h-6 w-6 mr-1 flex-shrink-0 "+e.itemIconClass()),g("name",e.itemIconName())}}function Uo(n,t){if(n&1){let e=D();m(0,"li",50),E("click",function(){y(e);let r=d().$implicit,o=d(2);return b(o.onExerciseClicked(r))}),m(1,"div",51)(2,"span",52),h(3),c(),w(4,Ao,4,6,"span",53)(5,Go,8,5,"span",54),c(),w(6,zo,3,2,"ng-container",55)(7,Ho,1,3,"ng-template",null,2,xe),c()}if(n&2){let e=Y(8),i=d(),r=i.$implicit,o=i.odd,s=d(2);g("ngClass",Zt(6,Eo,s.isSelected(r),o&&!s.isSelected(r),!o&&!s.isSelected(r))),a(3),I(r.name),a(),g("ngIf",r.category),a(),g("ngIf",r.isCustom||r.lastUsedAt||r.usageCount!=null),a(),g("ngIf",s.isMultiSelect())("ngIfElse",e)}}function $o(n,t){if(n&1&&(L(0),w(1,Po,2,1,"div",47)(2,Uo,9,10,"li",48),O()),n&2){let e=t.$implicit,i=d(2);a(),g("ngIf",!i.isExercise(e)),a(),g("ngIf",i.isExercise(e))}}function jo(n,t){if(n&1&&(m(0,"li",62),h(1),_(2,"translate"),c()),n&2){let e=d(2);a(),C(" ",f(2,1,e.isShowingSimilarView()?"exerciseSelectionModal.noSimilar":"exerciseSelectionModal.noMatches")," ")}}function Ko(n,t){if(n&1){let e=D();m(0,"button",63),E("click",function(){y(e);let r=d(2);return b(r.confirmSelection())}),F(1,"app-icon",64),h(2),_(3,"translate"),c()}if(n&2){let e=d(2);g("disabled",e.selectionCount()===0),a(2),Q(" ",f(3,3,"exerciseSelectionModal.addSelected")," ",e.selectionCount()>0?"("+e.selectionCount()+")":""," ")}}function Zo(n,t){if(n&1){let e=D();m(0,"div",65)(1,"button",66),E("click",function(){y(e);let r=d(2);return b(r.onCreateCustom())}),h(2),_(3,"translate"),c()()}n&2&&(a(2),C(" ",f(3,1,"exerciseSelectionModal.createCustom")," "))}function Yo(n,t){if(n&1){let e=D();m(0,"div",4)(1,"div",5),E("clickOutside",function(){y(e);let r=d();return b(r.onClose())}),m(2,"div",6)(3,"div",7)(4,"h3",8),h(5),c(),m(6,"button",9),E("click",function(){y(e);let r=d();return b(r.onClose())}),F(7,"app-icon",10),c()()(),m(8,"div",11)(9,"div",7)(10,"h4",12),h(11),_(12,"translate"),c(),m(13,"button",13),E("click",function(){y(e);let r=d();return b(r.toggleFilterAccordion())}),F(14,"app-icon",14),c()()(),m(15,"div",15)(16,"div",16)(17,"div",17)(18,"div")(19,"label",18),h(20),_(21,"translate"),c(),m(22,"select",19),E("change",function(r){y(e);let o=d();return b(o.onCategoryChange(r))}),m(23,"option",20),h(24),_(25,"translate"),c(),w(26,Mo,3,4,"option",21),_(27,"async"),c()(),m(28,"div")(29,"label",18),h(30),_(31,"translate"),c(),m(32,"select",19),E("change",function(r){y(e);let o=d();return b(o.onMuscleGroupChange(r))}),m(33,"option",20),h(34),_(35,"translate"),c(),w(36,Fo,3,4,"option",21),_(37,"async"),c()()(),m(38,"div",22),w(39,Do,6,5,"div",23)(40,Ro,3,3,"button",24)(41,Bo,4,3,"button",25),c(),m(42,"div")(43,"label",18),h(44),_(45,"translate"),c(),m(46,"select",19),E("change",function(r){y(e);let o=d();return b(o.onSortModeChange(r))}),m(47,"option",26),h(48),_(49,"translate"),c(),m(50,"option",27),h(51),_(52,"translate"),c(),m(53,"option",28),h(54),_(55,"translate"),c()()(),m(56,"div",29)(57,"button",30),E("click",function(){y(e);let r=d();return b(r.clearFilters())}),F(58,"app-icon",31),h(59),_(60,"translate"),c()()()(),m(61,"div",32,0)(63,"ul",33),w(64,$o,3,2,"ng-container",34)(65,jo,3,3,"li",35),c()(),m(66,"div",36),w(67,Ko,4,5,"button",37)(68,Zo,4,3,"div",38),m(69,"button",39),E("click",function(){y(e);let r=d();return b(r.onClose())}),F(70,"app-icon",40),h(71),_(72,"translate"),c()()()()}if(n&2){let e=d();a(5),I(e.title()),a(6),I(f(12,28,"exerciseSelectionModal.filtersTitle")),a(3),Le("rotate-180",e.isFilterAccordionOpen()),a(),nt("max-height",e.isFilterAccordionOpen()?"600px":"0px"),a(5),I(f(21,30,"exerciseSelectionModal.categoryLabel")),a(2),g("value",e.selectedCategory()||""),a(2),I(f(25,32,"exerciseSelectionModal.allCategories")),a(2),g("ngForOf",f(27,34,e.categories$)),a(4),I(f(31,36,"exerciseSelectionModal.muscleGroupLabel")),a(2),g("value",e.selectedMuscleGroup()||""),a(2),I(f(35,38,"exerciseSelectionModal.allMuscles")),a(2),g("ngForOf",f(37,40,e.primaryMuscleGroups$)),a(3),g("ngIf",!e.isShowingSimilarView()),a(),g("ngIf",e.showSimilarButton()&&!e.isShowingSimilarView()),a(),g("ngIf",e.isShowingSimilarView()),a(3),I(f(45,42,"exerciseSelectionModal.sortByLabel")),a(2),g("value",e.sortMode()),a(2),I(f(49,44,"exerciseSelectionModal.sort.alpha")),a(3),I(f(52,46,"exerciseSelectionModal.sort.lastUsed")),a(3),I(f(55,48,"exerciseSelectionModal.sort.frequency")),a(5),C(" ",f(60,50,"exerciseSelectionModal.clearFilters")),a(5),g("ngForOf",e.processedExercises()),a(),g("ngIf",e.processedExercises().length===0),a(2),g("ngIf",e.isMultiSelect()&&e.selectionCount()>0),a(),g("ngIf",e.showCreateCustomLink()||!e.processedExercises()||!e.processedExercises().length),a(3),C(" ",f(72,52,"exerciseSelectionModal.cancel")," ")}}var bi=class n{constructor(t){this.document=t;Ie(()=>{let e=this.exercises();e&&e.length>0?this.exerciseService.getTranslatedExerciseList(e).pipe(Fe(1)).subscribe(i=>{this.translatedExercises.set(i)}):this.translatedExercises.set([]),this.muscleMapService.getTranslatedMuscles().pipe(Fe(1)).subscribe(i=>{this.translatedMuscles.set(i)})}),Ie(()=>{let e=this.translatedExercises(),i=this.usageCounts(),r=e.map(o=>z(A({},o),{usageCount:i.get(o.id)||0}));this.enrichedExercises.set(r)}),Ie(()=>{this.sortMode(),this.scrollContainer?.nativeElement&&(this.scrollContainer.nativeElement.scrollTop=0),this.sortMode()==="lastUsed"&&this.isFilterAccordionOpen.set(!1)}),Ie(()=>{this.isOpen()?this.document.body.classList.add("overflow-hidden"):this.document.body.classList.remove("overflow-hidden")}),Ie(e=>{e(()=>{this.document.body.classList.remove("overflow-hidden")})})}exerciseService=S(He);trackingService=S(ai);toastService=S(xt);translate=S(qe);muscleMapService=S(li);translatedMuscles=R([]);isMultiSelect=ye(!1);isFocusInputOnStart=ye(!1);exerciseSelected=new H;exercisesSelected=new H;selectedExerciseIds=R([]);selectionCount=ve(()=>this.selectedExerciseIds().length);ngOnChanges(t){t.isOpen&&t.isOpen.currentValue&&(this.isFocusInputOnStart()&&this.checkForInputFocus(),this.clearFilters(!1))}enrichedExercises=R([]);usageCounts=Ft(this.trackingService.getExerciseUsageCounts(),{initialValue:new Map});dataSub;myExerciseInput;scrollContainer;translatedExercises=R([]);isOpen=Li(!1);title=ye("Select Exercise");exercises=ye.required();searchPlaceholder=ye("Search exercises...");itemIconName=ye("done");itemIconClass=ye("text-primary dark:text-primary-light");showSimilarButton=ye(!1);showCreateCustomLink=ye(!1);isShowingSimilarView=ye(!1);close=new H;findSimilarClicked=new H;createCustomClicked=new H;backToSearchClicked=new H;searchTerm=Li("");isFilterAccordionOpen=R(!1);selectedCategory=R(null);selectedMuscleGroup=R(null);sortMode=R("alpha");categories$=this.exerciseService.getUniqueCategories();primaryMuscleGroups$=this.exerciseService.getUniquePrimaryMuscleGroups();processedExercises=ve(()=>{let t=this.searchTerm()?.toLowerCase()??"",e=this.enrichedExercises(),i=this.sortMode(),r=this.selectedCategory(),o=this.selectedMuscleGroup();if(r&&(e=e.filter(s=>s.category===r)),o&&(e=e.filter(s=>s.primaryMuscleGroup===o||Array.isArray(s.muscleGroups)&&s.muscleGroups.includes(o))),t){let s=this.exerciseService.normalizeExerciseNameForSearch(t);e=e.filter(l=>{let u=this.getMuscleNameById(l.primaryMuscleGroup||""),p=(l.muscleGroups||[]).map(x=>this.getMuscleNameById(x)).join(" ");return s.split(" ").every(x=>l.name.toLowerCase().includes(x)||l.category?.toLowerCase().includes(x)||l.description?.toLowerCase().includes(x)||u?.toLowerCase().includes(x)||p.toLowerCase().includes(x))})}switch(i){case"lastUsed":return e.sort((s,l)=>(l.lastUsedAt?new Date(l.lastUsedAt).getTime():0)-(s.lastUsedAt?new Date(s.lastUsedAt).getTime():0)),e;case"frequency":return e.sort((s,l)=>(l.usageCount||0)-(s.usageCount||0)),this.groupExercisesByFrequency(e);case"alpha":default:return e.sort((s,l)=>s.name.localeCompare(l.name)),this.groupExercisesAlphabetically(e)}});groupExercisesAlphabetically(t){if(t.length===0)return[];let e=[],i="";for(let r of t){let o=r.name[0].toUpperCase();o!==i&&(i=o,e.push({isHeader:!0,label:o})),e.push(r)}return e}groupExercisesByFrequency(t){if(t.length===0)return[];let e=[],i="",r=o=>o>=30?this.translate.instant("exerciseSelectionModal.frequencyGroups.gt30"):o>=10?this.translate.instant("exerciseSelectionModal.frequencyGroups.lt30"):o>=5?this.translate.instant("exerciseSelectionModal.frequencyGroups.lt10"):this.translate.instant("exerciseSelectionModal.frequencyGroups.lt5");for(let o of t){let s=o.usageCount||0,l=r(s);l!==i&&(i=l,e.push({isHeader:!0,label:l})),e.push(o)}return e}isExercise(t){return!t.isHeader}onExerciseClicked(t){this.isMultiSelect()?this.toggleSelection(t):(this.exerciseSelected.emit(t),this.onClose())}toggleSelection(t){let e=this.selectedExerciseIds();e.includes(t.id)?this.selectedExerciseIds.set(e.filter(i=>i!==t.id)):this.selectedExerciseIds.set([...e,t.id])}isSelected(t){return this.selectedExerciseIds().includes(t.id)}confirmSelection(){let t=this.selectedExerciseIds();if(t.length===0){this.toastService.info(this.translate.instant("exerciseSelectionModal.toasts.noSelection"));return}let i=this.enrichedExercises().filter(r=>t.includes(r.id));this.exercisesSelected.emit(i),this.onClose()}onClose(){this.isOpen.set(!1),this.selectedExerciseIds.set([]),this.close.emit()}onFindSimilar(){this.findSimilarClicked.emit(),this.isFilterAccordionOpen.set(!1)}onCreateCustom(){this.createCustomClicked.emit()}onBackToSearch(){this.backToSearchClicked.emit()}onSearchEnter(){let t=this.processedExercises().filter(e=>this.isExercise(e));t.length===1&&this.onExerciseClicked(t[0])}ngAfterViewInit(){this.isOpen()&&this.isFocusInputOnStart()&&this.checkForInputFocus()}checkForInputFocus(){setTimeout(()=>{this.myExerciseInput?.nativeElement.focus(),this.myExerciseInput?.nativeElement.select()},100)}toggleFilterAccordion(){this.isFilterAccordionOpen.update(t=>!t)}onCategoryChange(t){this.selectedCategory.set(t.target.value||null)}onMuscleGroupChange(t){let e=this.getMuscleById(t.target.value);if(!e){this.selectedMuscleGroup.set(null);return}this.selectedMuscleGroup.set(this.muscleToMuscleValue(e))}muscleToMuscleValue(t){return t.id}onSortModeChange(t){let e=t.target.value;this.sortMode.set(e)}clearFilters(t=!0){this.selectedCategory.set(null),this.selectedMuscleGroup.set(null),this.searchTerm.set(""),this.sortMode.set("alpha"),this.selectedExerciseIds.set([]),t&&this.toastService.info(this.translate.instant("exerciseSelectionModal.toasts.filtersCleared"))}getMuscleNameById(t){return this.translatedMuscles().find(e=>e.id===t)?.name||t}getMuscleById(t){return this.translatedMuscles().find(e=>e.id===t)||null}getSelectionIndex(t){if(!this.isMultiSelect())return null;let i=this.selectedExerciseIds().findIndex(r=>r===t.id);return i!==-1?i+1:null}static \u0275fac=function(e){return new(e||n)(Ce(_e))};static \u0275cmp=Be({type:n,selectors:[["app-exercise-selection-modal"]],viewQuery:function(e,i){if(e&1&&(Pe(Co,5),Pe(ko,5)),e&2){let r;Ae(r=Ve())&&(i.myExerciseInput=r.first),Ae(r=Ve())&&(i.scrollContainer=r.first)}},inputs:{isMultiSelect:[1,"isMultiSelect"],isFocusInputOnStart:[1,"isFocusInputOnStart"],isOpen:[1,"isOpen"],title:[1,"title"],exercises:[1,"exercises"],searchPlaceholder:[1,"searchPlaceholder"],itemIconName:[1,"itemIconName"],itemIconClass:[1,"itemIconClass"],showSimilarButton:[1,"showSimilarButton"],showCreateCustomLink:[1,"showCreateCustomLink"],isShowingSimilarView:[1,"isShowingSimilarView"],searchTerm:[1,"searchTerm"]},outputs:{exerciseSelected:"exerciseSelected",exercisesSelected:"exercisesSelected",isOpen:"isOpenChange",close:"close",findSimilarClicked:"findSimilarClicked",createCustomClicked:"createCustomClicked",backToSearchClicked:"backToSearchClicked",searchTerm:"searchTermChange"},features:[Ye],decls:1,vars:1,consts:[["scrollContainer",""],["exerciseSearchFied",""],["singleSelectIcon",""],["class","fixed inset-0 z-[70] flex flex-col bg-white dark:bg-gray-800 transition-opacity pb-32",4,"ngIf"],[1,"fixed","inset-0","z-[70]","flex","flex-col","bg-white","dark:bg-gray-800","transition-opacity","pb-32"],[1,"relative","flex","flex-col","w-full","h-full","overflow-hidden","text-left","transition-all",3,"clickOutside"],[1,"px-5","py-2","flex-shrink-0","border-b","border-gray-200","dark:border-gray-600"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","focus:outline-none",3,"click"],["name","cancel",1,"w-6","h-6"],[1,"px-4","pt-2","flex-shrink-0"],[1,"font-semibold","text-gray-700","dark:text-gray-200"],[1,"rounded-md","text-gray-600","dark:text-gray-300","hover:bg-gray-200","dark:hover:bg-gray-700","focus:outline-none","transition-all","duration-300","ease-in-out",3,"click"],["name","filter",1,"w-10","h-10","transition-transform","duration-300"],[1,"overflow-hidden","transition-all","duration-300","ease-in-out","px-4","flex-shrink-0"],[1,"py-4","space-y-4"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],[1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","dark:bg-gray-700","dark:text-gray-200",3,"change","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"text-center"],[4,"ngIf"],["class","justify-center inline-flex items-center mt-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",3,"click",4,"ngIf"],["class","justify-center inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",3,"click",4,"ngIf"],["value","alpha"],["value","lastUsed"],["value","frequency"],[1,"text-right"],[1,"inline-flex","text-sm","text-blue-600","dark:text-blue-400","hover:bg-blue-500","dark:hover:text-white","rounded-xl","p-2",3,"click"],["name","trash",1,"h-6","w-6","mr-1"],[1,"flex-grow","min-h-0","px-4","sm:px-6","py-2","overflow-y-auto","custom-scrollbar"],[1,"space-y-1"],[4,"ngFor","ngForOf"],["class","text-gray-500 dark:text-gray-400 text-center p-4",4,"ngIf"],[1,"bg-gray-50","dark:bg-gray-800","px-4","py-2","sm:flex","sm:flex-row-reverse","sm:px-6","flex-shrink-0","justify-center","gap-2","sticky","bottom-0"],["type","button","class",`inline-flex w-full justify-center items-center rounded-md px-4 py-2 text-xl font-semibold text-white shadow-sm sm:w-auto
                   bg-primary hover:bg-primary-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-focus
                   disabled:opacity-50 disabled:cursor-not-allowed`,3,"disabled","click",4,"ngIf"],["class","px-4 text-center flex-shrink-0",4,"ngIf"],["type","button",1,"mt-3","sm:mt-0","inline-flex","w-full","justify-center","items-center","rounded-md","bg-white","dark:bg-gray-600","px-3","py-2","text-xl","font-semibold","text-gray-900","dark:text-gray-200","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-500","hover:bg-gray-50","dark:hover:bg-gray-500","sm:w-auto",3,"click"],["name","cancel",1,"w-6","h-6","mr-1"],[3,"value"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1","text-left"],["type","text",1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","dark:bg-gray-700","dark:text-gray-200",3,"ngModelChange","keydown.enter","placeholder","ngModel"],[1,"justify-center","inline-flex","items-center","mt-2","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","shadow-sm","text-white","bg-blue-600","hover:bg-blue-700",3,"click"],[1,"justify-center","inline-flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","text-sm","font-medium","rounded-md","shadow-sm","text-gray-700","dark:text-gray-200","bg-white","dark:bg-gray-700","hover:bg-gray-50","dark:hover:bg-gray-600",3,"click"],["name","back",1,"w-5","h-5","mr-2"],["class","py-2 px-3 sticky top-0 bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-200 font-bold text-lg z-10",4,"ngIf"],["appBumpClick","","class","p-3 mx-1 rounded-md cursor-pointer transition-colors duration-150 ease-in-out flex justify-between items-center",3,"ngClass","click",4,"ngIf"],[1,"py-2","px-3","sticky","top-0","bg-gray-200","dark:bg-gray-800","text-gray-600","dark:text-gray-200","font-bold","text-lg","z-10"],["appBumpClick","",1,"p-3","mx-1","rounded-md","cursor-pointer","transition-colors","duration-150","ease-in-out","flex","justify-between","items-center",3,"click","ngClass"],[1,"flex-grow"],[1,"font-medium","text-gray-800","dark:text-gray-200"],["class","block text-xs text-gray-500 dark:text-gray-400",4,"ngIf"],["class","block text-xs text-gray-500 dark:text-gray-400 italic",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"block","text-xs","text-gray-500","dark:text-gray-400"],[1,"block","text-xs","text-gray-500","dark:text-gray-400","italic"],["class","mx-2 inline-flex items-center justify-center rounded-full bg-primary text-white text-xs font-bold w-6 h-6",4,"ngIf"],["type","checkbox",1,"form-checkbox","h-6","w-6","rounded-full","flex-shrink-0","text-primary","dark:text-primary-light","bg-gray-200","dark:bg-gray-800","border-gray-400","dark:border-gray-500","focus:ring-primary-focus","dark:focus:ring-primary-dark","cursor-pointer",3,"change","click","checked"],[1,"mx-2","inline-flex","items-center","justify-center","rounded-full","bg-primary","text-white","text-xs","font-bold","w-6","h-6"],[3,"name"],[1,"text-gray-500","dark:text-gray-400","text-center","p-4"],["type","button",1,"inline-flex","w-full","justify-center","items-center","rounded-md","px-4","py-2","text-xl","font-semibold","text-white","shadow-sm","sm:w-auto","bg-primary","hover:bg-primary-dark","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-focus","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","done",1,"w-6","h-6","mr-2"],[1,"px-4","text-center","flex-shrink-0"],["type","button",1,"inline-flex","w-full","justify-center","items-center","rounded-md","px-4","py-2","text-lg","font-semibold","text-white","shadow-sm","sm:w-auto","bg-green-500","hover:bg-green-700","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-focus","disabled:opacity-50","disabled:cursor-not-allowed",3,"click"]],template:function(e,i){e&1&&w(0,Yo,73,54,"div",3),e&2&&g("ngIf",i.isOpen())},dependencies:[dt,st,at,lt,_t,gt,ht,ut,pt,mt,ft,yt,di,Yt,ct,Er,vt],encapsulation:2})};var wi=class n{constructor(t){this.fb=t}unitsService=S(oi);translate=S(qe);workoutUtilsService=S(pi);appSettingsService=S(ni);injector=S(Ze);createSetFormGroup(t,e=!1,i,r){let o=t&&t.id||(typeof crypto<"u"?crypto.randomUUID():""),s=t?.fieldOrder||[],l=t?.notes||"",u=t?.type||"standard",p="targetTempo"in(t||{})&&t.targetTempo||"",x,v=new Date().toISOString(),k,T,G,B,M,N;if(t){let $=P=>"repsLogged"in P,ae=P=>"targetReps"in P;if(e){let P=t;k=P.repsLogged??null,T=P.weightLogged??null,G=P.durationLogged??null,B=P.distanceLogged??null,M=P.restLogged??null,x=P.plannedSetId,v=P.timestamp}else{let P=t;k=P.targetReps??null,T=P.targetWeight??null,G=P.targetDuration??null,B=P.targetDistance??null,M=P.targetRest??null,x=P.id}}let q=A({},t),V={id:[o],type:[u],notes:[l||""],fieldOrder:[s||[]]};if(e)V.repsLogged=[k??null,[$=>{let ae=$.parent;if(!ae)return null;let P=ae.get("weightLogged")?.value,ge=ae.get("durationLogged")?.value;return(P==null||P==="")&&(ge==null||ge==="")&&typeof i=="function"?i(1)($):null}]],V.weightLogged=[T??null],V.durationLogged=[G??null],V.distanceLogged=[B??null],V.plannedSetId=[x],V.timestamp=[v],V.tempo=[p],V.restLogged=[M];else{let $=null;q.targetReps&&typeof q.targetReps=="object"?$=q.targetReps:q.min!=null&&q.max!=null?$={type:"range",min:q.min,max:q.max}:q.targetReps!=null&&($={type:"exact",value:q.targetReps}),V.targetReps=[$],V.targetWeight=[T??null],V.targetDuration=[G??null],V.targetDistance=[B??null],V.targetRest=[M??null],V.targetTempo=[p??null]}let te=e?{}:{validators:typeof r=="function"?r():null};return this.fb.group(V,te)}createExerciseFormGroup(t,e=!1,i=!1,r,o,s,l,u){let p=t?.exerciseId?r?.find(k=>k.id===t.exerciseId):null,x=t?.sets||[];return this.fb.group({id:[t?.id],exerciseId:[t?.exerciseId],exerciseName:[p?.name||t?.exerciseName],notes:[t?.notes||""],sets:this.fb.array(x.map(k=>this.createSetFormGroup(k,i,l,u))),supersetId:[t?.supersetId||null],supersetOrder:[t?.supersetOrder??null],supersetType:[t?.supersetType??"standard"],emomTimeSeconds:[t?.emomTimeSeconds??null]})}createExerciseFormGroupFromLoggedExercise(t,e,i,r,o,s){let l=e?.find(p=>p.id===t.exerciseId);return this.fb.group({id:[t.id],exerciseId:[t.exerciseId],exerciseName:[l?.name||t.exerciseName],notes:[t.notes||""],sets:this.fb.array(t.sets.map(p=>this.createSetFormGroup(p,!0,o,s))),supersetId:[t.supersetId||null],supersetOrder:[t.supersetOrder??null],supersetType:[t.supersetType??"standard"],emomTimeSeconds:[t.emomTimeSeconds??null]})}getSetsFormArray(t){return t.get("sets")??this.fb.array([])}static \u0275fac=function(e){return new(e||n)(mr(ei))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Si=class n{constructor(t,e){this.renderer=t;this.el=e;this.mouseDownHandler=this.onMouseDown.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.pressEndHandler=this.onPressEnd.bind(this)}longPressEnabled=!0;longPressDelay=300;longPressClass="is-long-pressing";dragHandleSelector;classTargetSelector;longPress=new H;timer;isPressing=!1;mouseDownHandler;touchStartHandler;pressEndHandler;ngOnInit(){let t=this.el.nativeElement;t.addEventListener("mousedown",this.mouseDownHandler),t.addEventListener("mouseup",this.pressEndHandler),t.addEventListener("mouseleave",this.pressEndHandler),t.addEventListener("touchstart",this.touchStartHandler,{passive:!1}),t.addEventListener("touchend",this.pressEndHandler),t.addEventListener("touchcancel",this.pressEndHandler)}onMouseDown(t){!this.longPressEnabled||t.button!==0||this.dragHandleSelector&&!t.target.closest(this.dragHandleSelector)||this.startTimer()}onTouchStart(t){this.longPressEnabled&&(this.dragHandleSelector&&!t.target.closest(this.dragHandleSelector)||this.startTimer())}startTimer(){this.isPressing=!0,this.timer=setTimeout(()=>{this.isPressing&&(this.renderer.addClass(this.el.nativeElement,this.longPressClass),this.longPress.emit())},this.longPressDelay)}onPressEnd(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.isPressing=!1,this.renderer.removeClass(this.el.nativeElement,this.longPressClass)}ngOnDestroy(){let t=this.el.nativeElement;t.removeEventListener("mousedown",this.mouseDownHandler),t.removeEventListener("mouseup",this.pressEndHandler),t.removeEventListener("mouseleave",this.pressEndHandler),t.removeEventListener("touchstart",this.touchStartHandler),t.removeEventListener("touchend",this.pressEndHandler),t.removeEventListener("touchcancel",this.pressEndHandler),this.onPressEnd()}static \u0275fac=function(e){return new(e||n)(Ce(Ai),Ce(fe))};static \u0275dir=de({type:n,selectors:[["","appLongPressDrag",""]],inputs:{longPressEnabled:"longPressEnabled",longPressDelay:"longPressDelay",longPressClass:"longPressClass",dragHandleSelector:"dragHandleSelector",classTargetSelector:"classTargetSelector"},outputs:{longPress:"longPress"}})};var Ci=class n{textAreaElement=S(fe).nativeElement;onInput(){this.adjustHeight()}ngOnInit(){setTimeout(()=>this.adjustHeight(),0)}adjustHeight(){this.textAreaElement.style.height="auto",this.textAreaElement.style.height=`${this.textAreaElement.scrollHeight}px`}static \u0275fac=function(e){return new(e||n)};static \u0275dir=de({type:n,selectors:[["textarea","appAutoGrow",""]],hostBindings:function(e,i){e&1&&E("input",function(){return i.onInput()})}})};var ki=class n{constructor(t,e){this.viewContainer=t;this.templateRef=e}context={ngLet:null};viewRef=null;set ngLet(t){this.context.ngLet=t,this.viewRef||(this.viewRef=this.viewContainer.createEmbeddedView(this.templateRef,this.context))}static \u0275fac=function(e){return new(e||n)(Ce(Tt),Ce(It))};static \u0275dir=de({type:n,selectors:[["","ngLet",""]],inputs:{ngLet:"ngLet"}})};var Qo=(n,t)=>({"bg-blue-500 text-white dark:bg-blue-700":n,"bg-gray-300 text-gray-600 dark:bg-gray-600 dark:text-gray-300 line-through":t});function Jo(n,t){if(n&1){let e=D();m(0,"div")(1,"label",38)(2,"input",39),E("change",function(){let r=y(e).$implicit,o=d(2);return b(o.toggleMuscle("target",r))}),c(),h(3),_(4,"translate"),c()()}if(n&2){let e=t.$implicit,i=d(2);a(2),g("value",e.id)("checked",i.options.targetMuscles.includes(e.id))("disabled",i.options.avoidMuscles.includes(e.id)),a(),C(" ",f(4,4,e.name)," ")}}function Xo(n,t){if(n&1){let e=D();m(0,"div")(1,"label",38)(2,"input",39),E("change",function(){let r=y(e).$implicit,o=d(2);return b(o.toggleMuscle("avoid",r))}),c(),h(3),_(4,"translate"),c()()}if(n&2){let e=t.$implicit,i=d(2);a(2),g("value",e.id)("checked",i.options.avoidMuscles.includes(e.id))("disabled",i.options.targetMuscles.includes(e.id)),a(),C(" ",f(4,4,e.name)," ")}}function es(n,t){n&1&&(m(0,"p",44),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"generateWorkoutModal.noPersonalGym")))}function ts(n,t){if(n&1){let e=D();m(0,"button",45),E("click",function(){let r=y(e).$implicit,o=d(3);return b(o.toggleExcludePersonalGymEquipment(r))}),h(1),_(2,"titlecase"),c()}if(n&2){let e=t.$implicit,i=d(3);g("ngClass",Z(4,Qo,!i.options.excludeEquipment.includes(e.toLowerCase()),i.options.excludeEquipment.includes(e.toLowerCase()))),a(),C(" ",f(2,2,e)," ")}}function is(n,t){if(n&1&&(m(0,"div",40),w(1,es,3,3,"p",41),m(2,"div",42),w(3,ts,3,7,"button",43),c()()),n&2){let e=d(2);a(),g("ngIf",e.allPersonalGymEquipment().length===0),a(2),g("ngForOf",e.allPersonalGymEquipment())}}function rs(n,t){if(n&1){let e=D();m(0,"button",52),E("click",function(){let r=y(e).$implicit,o=d(4);return b(o.addExcludedEquipment(r))}),h(1),_(2,"titlecase"),c()}if(n&2){let e=t.$implicit;a(),C(" ",f(2,1,e)," ")}}function ns(n,t){if(n&1&&(m(0,"div",50),w(1,rs,3,3,"button",51),c()),n&2){let e=d(3);a(),g("ngForOf",e.filteredAvailableEquipmentToExclude())}}function os(n,t){if(n&1){let e=D();m(0,"span",57)(1,"span"),h(2),_(3,"titlecase"),c(),m(4,"button",58),E("click",function(){let r=y(e).$implicit,o=d(4);return b(o.removeExcludedEquipment(r))}),F(5,"app-icon",59),c()()}if(n&2){let e=t.$implicit;a(2),I(f(3,1,e))}}function ss(n,t){if(n&1&&(m(0,"div",53)(1,"label",54),h(2," Excluded equipment "),c(),m(3,"div",55),w(4,os,6,3,"span",56),c()()),n&2){let e=d(3);a(4),g("ngForOf",e.options.excludeEquipment)}}function as(n,t){if(n&1){let e=D();m(0,"div",31)(1,"label",46),h(2,"Exclude Equipment (Optional)"),c(),m(3,"input",47),ee("ngModelChange",function(r){y(e);let o=d(2);return X(o.excludeEquipmentSearchTerm,r)||(o.excludeEquipmentSearchTerm=r),b(r)}),c(),w(4,ns,2,1,"div",48)(5,ss,5,1,"div",49),c()}if(n&2){let e=d(2);a(3),J("ngModel",e.excludeEquipmentSearchTerm),a(),g("ngIf",e.filteredAvailableEquipmentToExclude().length>0&&e.excludeEquipmentSearchTerm().length>0),a(),g("ngIf",e.options.excludeEquipment.length>0)}}function ls(n,t){n&1&&(m(0,"p",44),h(1," No equipment excluded. "),c())}function cs(n,t){if(n&1){let e=D();m(0,"span",57)(1,"span"),h(2),_(3,"titlecase"),c(),m(4,"button",58),E("click",function(){let r=y(e).$implicit,o=d(4);return b(o.removeExcludedEquipment(r))}),F(5,"app-icon",59),c()()}if(n&2){let e=t.$implicit;a(2),I(f(3,1,e))}}function ds(n,t){if(n&1&&(m(0,"div",61),w(1,ls,2,0,"p",41)(2,cs,6,3,"span",56),c()),n&2){let e=d(3);a(),g("ngIf",e.options.excludeEquipment.length===0),a(),g("ngForOf",e.options.excludeEquipment)}}function us(n,t){if(n&1){let e=D();m(0,"button",52),E("click",function(){let r=y(e).$implicit,o=d(4);return b(o.addExcludedEquipment(r))}),h(1),_(2,"titlecase"),c()}if(n&2){let e=t.$implicit;a(),C(" ",f(2,1,e)," ")}}function ps(n,t){if(n&1&&(m(0,"div",50),w(1,us,3,3,"button",51),c()),n&2){let e=d(3);a(),g("ngForOf",e.filteredAvailableEquipmentToExclude())}}function ms(n,t){if(n&1){let e=D();m(0,"label",46),h(1,"Exclude personal gym equipment (Optional)"),c(),w(2,ds,3,2,"div",60),m(3,"input",47),ee("ngModelChange",function(r){y(e);let o=d(2);return X(o.excludeEquipmentSearchTerm,r)||(o.excludeEquipmentSearchTerm=r),b(r)}),c(),w(4,ps,2,1,"div",48)}if(n&2){let e=d(2);a(2),g("ngIf",e.options.excludeEquipment.length>0),a(),J("ngModel",e.excludeEquipmentSearchTerm),a(),g("ngIf",e.filteredAvailableEquipmentToExclude().length>0&&e.excludeEquipmentSearchTerm().length>0)}}function gs(n,t){if(n&1){let e=D();m(0,"div",2),E("click",function(){y(e);let r=d();return b(r.close.emit())}),m(1,"div",3),E("click",function(r){return y(e),b(r.stopPropagation())}),m(2,"header",4)(3,"div",5),F(4,"app-icon",6),m(5,"h3",7),h(6),_(7,"translate"),c()(),m(8,"button",8),E("click",function(){y(e);let r=d();return b(r.close.emit())}),F(9,"app-icon",9),c()(),m(10,"div",10)(11,"div",11)(12,"div")(13,"label",12),h(14),_(15,"translate"),m(16,"strong"),h(17),_(18,"translate"),c()(),m(19,"input",13),ee("ngModelChange",function(r){y(e);let o=d();return X(o.options.duration,r)||(o.options.duration=r),b(r)}),c()(),m(20,"div")(21,"label",12),h(22),_(23,"translate"),c(),m(24,"select",14),ee("ngModelChange",function(r){y(e);let o=d();return X(o.options.goal,r)||(o.options.goal=r),b(r)}),m(25,"option",15),h(26),_(27,"translate"),c(),m(28,"option",16),h(29),_(30,"translate"),c(),m(31,"option",17),h(32),_(33,"translate"),c()()(),m(34,"div",18)(35,"label",12),h(36),_(37,"translate"),c(),m(38,"select",14),ee("ngModelChange",function(r){y(e);let o=d();return X(o.options.split,r)||(o.options.split=r),b(r)}),m(39,"option",19),h(40),_(41,"translate"),c(),m(42,"option",20),h(43),_(44,"translate"),c(),m(45,"option",21),h(46),_(47,"translate"),c()()(),m(48,"div",22)(49,"label",23),h(50),_(51,"translate"),c(),m(52,"div",24),w(53,Jo,5,6,"div",25),c()(),m(54,"div",22)(55,"label",12),h(56),_(57,"translate"),c(),m(58,"div",24),w(59,Xo,5,6,"div",25),c()(),m(60,"div",26)(61,"label",12),h(62),_(63,"translate"),c(),m(64,"label",27)(65,"input",28),ee("ngModelChange",function(r){y(e);let o=d();return X(o.options.usePersonalGym,r)||(o.options.usePersonalGym=r),b(r)}),E("change",function(){y(e);let r=d();return b(r.onUsePersonalGymChange())}),c(),h(66),_(67,"translate"),c(),w(68,is,4,2,"div",29)(69,as,6,3,"div",30),c(),w(70,ms,5,3,"ng-template",31,0,xe),c()(),m(72,"footer",32)(73,"div",33)(74,"button",34),E("click",function(){y(e);let r=d();return b(r.generateQuick())}),F(75,"app-icon",35),h(76),_(77,"translate"),c(),m(78,"button",36),E("click",function(){y(e);let r=d();return b(r.generateDetailed())}),F(79,"app-icon",37),h(80),_(81,"translate"),c()()()()()}if(n&2){let e=Y(71),i=d();a(6),I(f(7,27,"generateWorkoutModal.title")),a(8),C("",f(15,29,"generateWorkoutModal.durationLabel"),": "),a(3),Q("",i.options.duration," ",f(18,31,"generateWorkoutModal.durationUnit")),a(2),J("ngModel",i.options.duration),a(3),I(f(23,33,"generateWorkoutModal.goalLabel")),a(2),J("ngModel",i.options.goal),a(2),I(f(27,35,"generateWorkoutModal.goals.hypertrophy")),a(3),I(f(30,37,"generateWorkoutModal.goals.strength")),a(3),C("",f(33,39,"generateWorkoutModal.goals.endurance")," "),a(4),I(f(37,41,"generateWorkoutModal.splitLabel")),a(2),J("ngModel",i.options.split),a(2),I(f(41,43,"generateWorkoutModal.splits.fullBody")),a(3),I(f(44,45,"generateWorkoutModal.splits.upperLower")),a(3),I(f(47,47,"generateWorkoutModal.splits.ppl")),a(4),I(f(51,49,"generateWorkoutModal.targetMusclesLabel")),a(3),g("ngForOf",i.allMuscleGroups()),a(3),I(f(57,51,"generateWorkoutModal.avoidMusclesLabel")),a(3),g("ngForOf",i.allMuscleGroups()),a(3),I(f(63,53,"generateWorkoutModal.equipmentLabel")),a(3),J("ngModel",i.options.usePersonalGym),a(),C(" ",f(67,55,"generateWorkoutModal.usePersonalGymLabel")," "),a(2),g("ngIf",i.options.usePersonalGym),a(),g("ngIf",!i.options.usePersonalGym)("ngIfElse",e),a(7),C(" ",f(77,57,"generateWorkoutModal.fab.quick")," "),a(4),C(" ",f(81,59,"generateWorkoutModal.fab.detailed")," ")}}var Ei=class n{constructor(t){this.document=t;Ie(()=>{this.isOpen?this.document.body.classList.add("overflow-hidden"):this.document.body.classList.remove("overflow-hidden")}),Ie(e=>{e(()=>{this.document.body.classList.remove("overflow-hidden")})})}isOpen=!1;close=new H;generate=new H;exerciseService=S(He);personalGymService=S(ui);muscleMapService=S(li);allMuscleGroups=R([]);allAvailableEquipment=R([]);allPersonalGymEquipment=R([]);equipmentSearchTerm=R("");excludeEquipmentSearchTerm=R("");filteredAvailableEquipment=ve(()=>{let t=this.equipmentSearchTerm().toLowerCase().trim();return t?this.allAvailableEquipment().filter(e=>e.toLowerCase().includes(t)&&!this.options.equipment.includes(e)):[]});options={duration:45,goal:"hypertrophy",split:"full-body",targetMuscles:[],avoidMuscles:[],usePersonalGym:!0,equipment:[],excludeEquipment:[]};ngOnInit(){return W(this,null,function*(){let t=this.exerciseService.getUniquePrimaryMuscleGroups(),e=this.muscleMapService.musclesMap$,i=ur([t,e]).pipe(le(([l,u])=>l.map(x=>u.get(typeof x=="string"?x:x.id)).filter(x=>x!==void 0).sort((x,v)=>x.name.localeCompare(v.name)))),r=yield he(i);this.allMuscleGroups.set(r);let o=yield he(this.exerciseService.getUniqueEquipment());this.allAvailableEquipment.set(o);let s=yield he(this.personalGymService.getAllEquipment());this.allPersonalGymEquipment.set(s.map(l=>l.category)),this.updateEquipmentFromPersonalGym()})}ngOnChanges(t){t.isOpen&&t.isOpen.currentValue===!0&&(this.resetOptions(),this.updateEquipmentFromPersonalGym())}toggleMuscle(t,e){let i=t==="target"?this.options.targetMuscles:this.options.avoidMuscles,r=i.indexOf(e.id);r>-1?i.splice(r,1):i.push(e.id)}generateQuick(){this.generate.emit("quick")}generateDetailed(){this.generate.emit(A({},this.options))}resetOptions(){this.options={duration:45,goal:"hypertrophy",split:"full-body",targetMuscles:[],avoidMuscles:[],usePersonalGym:!0,equipment:[],excludeEquipment:[]},this.equipmentSearchTerm.set(""),this.excludeEquipmentSearchTerm.set("")}selectEquipment(t){this.options.equipment.includes(t)||this.options.equipment.push(t),this.equipmentSearchTerm.set("")}removeEquipment(t){let e=this.options.equipment.indexOf(t);e>-1&&this.options.equipment.splice(e,1)}toggleExcludePersonalGymEquipment(t){let e=this.options.excludeEquipment.indexOf(t.toLowerCase());e>-1?this.options.excludeEquipment.splice(e,1):this.options.excludeEquipment.push(t.toLowerCase()),this.updateEquipmentFromPersonalGym()}filteredAvailableEquipmentToExclude=ve(()=>{let t=this.excludeEquipmentSearchTerm().toLowerCase().trim();if(!t)return[];let e=this.allAvailableEquipment(),i=this.allPersonalGymEquipment();return(this.options.usePersonalGym?i:e).filter(o=>o.toLowerCase().includes(t)&&!this.options.excludeEquipment.includes(o.toLowerCase()))});addExcludedEquipment(t){let e=t.toLowerCase();this.options.excludeEquipment.includes(e)||this.options.excludeEquipment.push(e),this.excludeEquipmentSearchTerm.set("")}removeExcludedEquipment(t){let e=this.options.excludeEquipment.indexOf(t);e>-1&&this.options.excludeEquipment.splice(e,1)}onUsePersonalGymChange(){this.options.excludeEquipment=[],this.equipmentSearchTerm.set(""),this.updateEquipmentFromPersonalGym()}updateEquipmentFromPersonalGym(){if(this.options.usePersonalGym){let t=this.allPersonalGymEquipment(),e=this.options.excludeEquipment;this.options.equipment=t.filter(i=>!e.includes(i.toLowerCase()))}else this.options.equipment=[]}static \u0275fac=function(e){return new(e||n)(Ce(_e))};static \u0275cmp=Be({type:n,selectors:[["app-generate-workout-modal"]],inputs:{isOpen:"isOpen"},outputs:{close:"close",generate:"generate"},features:[Ye],decls:1,vars:1,consts:[["usePersonalGymSection",""],["class","fixed inset-0 z-[100] flex flex-col bg-gray-100 dark:bg-gray-800 pb-32",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-[100]","flex","flex-col","bg-gray-100","dark:bg-gray-800","pb-32",3,"click"],[1,"w-full","h-full","flex","flex-col",3,"click"],[1,"px-5","py-2","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center","flex-shrink-0","bg-white/80","dark:bg-gray-800/80","backdrop-blur-sm"],[1,"flex","items-center","gap-3"],["name","magic-wand",1,"h-7","w-7","text-primary","dark:text-primary-light"],[1,"text-xl","font-semibold","text-gray-800","dark:text-gray-100"],[1,"p-1.5","rounded-full","text-gray-500","hover:text-gray-700",3,"click"],["name","cancel",1,"h-6","w-6"],[1,"overflow-y-auto","flex-grow","p-4","sm:p-6","pb-24"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-6","gap-y-6","max-w-4xl","mx-auto"],[1,"block","text-sm","font-medium","dark:text-gray-100"],["type","range","min","15","max","120","step","5",1,"w-full","h-2","rounded-md","appearance-none","cursor-pointer",3,"ngModelChange","ngModel"],[1,"block","w-full","p-2","border","rounded-md","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngModelChange","ngModel"],["value","hypertrophy"],["value","strength"],["value","muscular endurance"],[1,"md:col-span-2"],["value","full-body"],["value","upper-lower"],["value","push-pull-legs"],[1,"dark:text-gray-200"],[1,"block","text-sm","font-medium"],[1,"max-h-32","overflow-y-auto","p-2","border","rounded-md","dark:border-gray-600"],[4,"ngFor","ngForOf"],[1,"md:col-span-2","dark:text-gray-200"],[1,"flex","items-center","gap-2","my-2"],["type","checkbox",3,"ngModelChange","change","ngModel"],["class","p-2 border rounded-md bg-gray-100 dark:bg-gray-800",4,"ngIf"],["class","md:col-span-2 text-black dark:text-gray-200 relative",4,"ngIf","ngIfElse"],[1,"md:col-span-2","text-black","dark:text-gray-200","relative"],[1,"px-6","py-4","border-t","border-gray-200","dark:border-gray-700","flex-shrink-0","bg-white","dark:bg-gray-700","sticky","bottom-0"],[1,"flex","flex-col","sm:flex-row","sm:justify-end","sm:space-x-4","space-y-3","sm:space-y-0"],["type","button",1,"w-full","text-white","sm:w-auto","inline-flex","justify-center","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","dark:text-gray-200","bg-green-600","hover:bg-green-700",3,"click"],["name","random",1,"h-5","w-5","mr-2"],["type","button",1,"w-full","sm:w-auto","inline-flex","justify-center","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-purple-500","hover:bg-purple-700",3,"click"],["name","magic-wand",1,"h-5","w-5","mr-2"],[1,"flex","items-center","gap-2"],["type","checkbox",3,"change","value","checked","disabled"],[1,"p-2","border","rounded-md","bg-gray-100","dark:bg-gray-800"],["class","text-sm italic text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"flex","flex-wrap","gap-2"],["type","button","class","px-3 py-1.5 text-xs font-semibold rounded-full transition-colors",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"text-sm","italic","text-gray-500","dark:text-gray-400"],["type","button",1,"px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors",3,"click","ngClass"],[1,"block","text-sm","font-medium","dark:text-gray-100","my-1"],["type","text","placeholder","Search equipment to exclude...",1,"block","w-full","p-2","border","rounded-md","dark:bg-gray-800","dark:border-gray-600","focus:ring-primary","focus:border-primary",3,"ngModelChange","ngModel"],["class","absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-md shadow-lg max-h-40 overflow-y-auto",4,"ngIf"],["class","relative border rounded-md px-3 pt-5 pb-2 mt-4 dark:border-gray-600",4,"ngIf"],[1,"absolute","z-10","w-full","mt-1","bg-white","dark:bg-gray-800","border","dark:border-gray-600","rounded-md","shadow-lg","max-h-40","overflow-y-auto"],["type","button","class","w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-600",3,"click"],[1,"relative","border","rounded-md","px-3","pt-5","pb-2","mt-4","dark:border-gray-600"],[1,"absolute","top-0","left-3","-mt-2","px-2","text-xs","font-medium","text-gray-500","dark:text-gray-400","bg-white","dark:bg-gray-700","rounded-md"],[1,"flex","flex-wrap","gap-2","min-h-[40px]"],["class","flex items-center gap-x-2 px-3 py-1.5 text-xs font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-700 dark:text-white",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-x-2","px-3","py-1.5","text-xs","font-semibold","rounded-full","bg-red-100","text-red-800","dark:bg-red-700","dark:text-white"],["type","button",1,"text-red-800/70","hover:text-red-800","focus:outline-none","dark:text-white/70","dark:hover:text-white",3,"click"],["name","cancel",1,"h-4","w-4"],["class","p-2 border rounded-md mb-2 min-h-[40px] bg-white dark:bg-gray-800 flex flex-wrap gap-2",4,"ngIf"],[1,"p-2","border","rounded-md","mb-2","min-h-[40px]","bg-white","dark:bg-gray-800","flex","flex-wrap","gap-2"]],template:function(e,i){e&1&&w(0,gs,82,61,"div",1),e&2&&g("ngIf",i.isOpen)},dependencies:[dt,st,at,lt,ft,_t,gt,ht,ut,Vr,Rr,Xt,pt,mt,yt,ct,vt],encapsulation:2})};var Ii=class n{exerciseService=S(He);personalGymService=S(ui);workoutService=S(ci);toastService=S(xt);generateQuickWorkout(){return W(this,null,function*(){console.log("Starting QUICK workout generation...");let t={usePersonalGym:!0,avoidMuscles:[],split:"full-body",targetMuscles:[],duration:45,goal:"hypertrophy",equipment:[],excludeEquipment:[]},e=yield this.getSelectableExercises(t);if(e.length<5)return this.toastService.error("Not enough exercises available to generate a workout.",0,"Error"),null;let i=new Map;e.forEach(p=>{p.primaryMuscleGroup&&(i.has(p.primaryMuscleGroup)||i.set(p.primaryMuscleGroup,[]),i.get(p.primaryMuscleGroup).push(p))});let r={legs:["quadriceps","Hamstrings","Glutes","Calves"],push:["Chest","Shoulders","Triceps"],pull:["Lats","Traps","Biceps","Lower back","Back"],core:["Abs","Obliques","Core"]},o=[],s=new Set,l=p=>{let x=this.shuffleArray(p.filter(v=>i.has(v)));for(let v of x){let k=i.get(v),T=this.pickUniqueExercise(k,Array.from(s));if(T){o.push(this.createSimpleWorkoutExercise(T)),s.add(T.id);return}}};if(l(r.legs),l(r.push),l(r.pull),l(r.core),o.length<5){let p=Array.from(i.keys());l(p)}return o.length<3?(console.error("Quick generation failed: could not build a balanced workout."),null):{id:`generated-${K()}`,name:"Quick Surprise Workout",description:`A randomly generated full-body session created on ${new Date().toLocaleDateString()}.`,exercises:this.shuffleArray(o),goal:"hypertrophy",isFavourite:!1,isHidden:!0}})}tryGenerateWithCriteria(t){return W(this,null,function*(){let e=yield this.getSelectableExercises(t);return e.length<2?null:this.buildExerciseList(e,t)})}getSelectableExercises(t){return W(this,null,function*(){let i=(yield he(this.exerciseService.getExercises())).filter(s=>!s.isHidden&&s.category!=="stretching"),r=[];if(t.usePersonalGym?r=(yield he(this.personalGymService.getAllEquipment())).map(l=>l.category.toLowerCase()):t.equipment.length>0&&(r=t.equipment.map(s=>s.toLowerCase())),r.length>0&&(i=i.filter(s=>{if(s.category==="bodyweight-calisthenics"||!s.equipment&&(!s.equipmentNeeded||s.equipmentNeeded.length===0))return!0;let l=(s.equipment||"").toLowerCase(),u=(s.equipmentNeeded||[]).map(p=>p.toLowerCase());return r.some(p=>l&&l.includes(p)?!0:u.some(x=>x.includes(p)))})),t.avoidMuscles.length>0){let s=new Set(t.avoidMuscles);i=i.filter(l=>l&&l.primaryMuscleGroup&&!s.has(l.primaryMuscleGroup))}let o=this.determineTargetMuscles(t.split,t.targetMuscles);if(o.size>0&&(i=i.filter(s=>s.primaryMuscleGroup&&o.has(s.primaryMuscleGroup.toLowerCase()))),t.excludeEquipment&&t.excludeEquipment.length>0){let s=t.excludeEquipment.map(l=>l.toLowerCase());i=i.filter(l=>{let u=(l.equipment||"").toLowerCase(),p=(l.equipmentNeeded||[]).map(v=>v.toLowerCase());return!s.some(v=>u.includes(v)||p.some(k=>k.includes(v)))})}return i})}determineTargetMuscles(t,e){if(e.length>0)return new Set(e);switch(t){case"upper-lower":return new Set(["chest","lats","shoulders","biceps","triceps","traps","lower back","forearms","abs","obliques"]);case"push-pull-legs":return new Set(["chest","shoulders","triceps"]);case"full-body":default:return new Set(["quadriceps","hamstrings","glutes","calves","chest","lats","shoulders","biceps","triceps","lower back","traps","abs"])}}buildExerciseList(t,e){let i=[],r=0,o=e.duration*60,s=15,l=new Set;t.forEach(v=>{v.equipment&&v.category!=="bodyweight-calisthenics"&&l.add(v.equipment.toLowerCase()),(v.equipmentNeeded||[]).forEach(k=>l.add(k.toLowerCase()))});let u=this.shuffleArray(Array.from(l)),p=this.shuffleArray(t),x=new Map;for(;r<o&&i.length<s&&p.length>0;){let v=null,k=-1,T=u.find(q=>!i.some(V=>V.exercise.equipment?.toLowerCase()===q||V.exercise.equipmentNeeded?.map(te=>te.toLowerCase()).includes(q)));if(T){let q=this.shuffleArray(p.filter(V=>V.equipment?.toLowerCase()===T||V.equipmentNeeded?.map(te=>te.toLowerCase()).includes(T)));q.length>0&&(v=q[0],k=p.findIndex(V=>V.id===v.id))}if(!v&&p.length>0&&(v=p[0],k=0),!v)break;p.splice(k,1);let G=v.primaryMuscleGroup;if(!G)continue;let B=x.get(G)||0;if(B>=3)continue;let M=this.createWorkoutExercise(v,e.goal),N=this.workoutService.getEstimatedRoutineDuration({exercises:[M]})*60;r+N>o+120||(i.push(M),r+=N,G&&x.set(G?.toString(),B+1))}return this.shuffleArray(i)}pickUniqueExercise(t,e){let i=this.shuffleArray([...t]);for(let r of i)if(!e.includes(r.id))return r;return null}shuffleArray(t){for(let e=t.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}createWorkoutExercise(t,e){let i=3,r={min:8,max:12},o=60,s=300;switch(e){case"strength":i=4,r={min:4,max:6},o=90;break;case"muscular endurance":i=3,r={min:15,max:20},o=45,s=600;break;case"hypertrophy":default:i=3,r={min:8,max:12},o=60;break}let l={};t.category==="cardio"?l={fieldOrder:["duration","distance","rest"],targetDuration:Ne(s),targetDistance:ze(1)}:t.category==="bodyweight-calisthenics"?l={fieldOrder:["reps","rest"],targetReps:{type:"range",min:r.min,max:r.max}}:l={fieldOrder:["reps","weight","rest"],targetReps:{type:"range",min:r.min,max:r.max},targetWeight:be(10)};let u=Array.from({length:i},()=>A({id:K(),type:"standard",targetRest:ie(o)},l));return{id:K(),exerciseId:t.id,exerciseName:t.name,sets:u,supersetId:null,supersetOrder:null,type:"standard",exercise:t}}createSimpleWorkoutExercise(t){let e;return t.category==="cardio"?e=Array.from({length:3},()=>({id:K(),type:"standard",fieldOrder:["duration","distance","rest"],targetDuration:Ne(300),targetDistance:ze(1),targetRest:ie(90)})):t.category==="bodyweight-calisthenics"?e=Array.from({length:3},()=>({id:K(),type:"standard",fieldOrder:["reps","rest"],targetReps:qi(10),targetRest:ie(60)})):e=Array.from({length:3},()=>({id:K(),type:"standard",fieldOrder:["reps","weight","rest"],targetReps:qi(10),targetWeight:be(10),targetRest:ie(60)})),{id:K(),exerciseId:t.id,exerciseName:t.name,sets:e,supersetId:null,supersetOrder:null,type:"standard"}}generateWorkout(t){return W(this,null,function*(){console.log("Starting workout generation with options:",t);let e=yield this.tryGenerateWithCriteria(t);if(!e||e.length<2){console.warn("Generation failed with strict criteria. Fallback 1: Ignoring equipment constraints."),this.toastService.info("Not enough specific exercises found. Broadening search...",3e3,"Expanding Search");let o=z(A({},t),{usePersonalGym:!1,equipment:[]});e=yield this.tryGenerateWithCriteria(o)}if(!e||e.length<2){console.warn("Generation failed after relaxing equipment. Fallback 2: Ignoring target muscle constraints."),this.toastService.info("Still not enough. Ignoring specific muscle targets...",3e3,"Expanding Further");let o=z(A({},t),{targetMuscles:[]});e=yield this.tryGenerateWithCriteria(o)}if(!e||e.length===0)return console.error("CRITICAL: Workout generation failed even with all fallbacks."),null;let i=`Generated ${t.split.replace("-"," ")} Workout`;return{id:`generated-${K()}`,name:i,description:`Generated on ${new Date().toLocaleDateString()} for a ~${t.duration} minute, ${t.goal}-focused session.`,exercises:e,goal:t.goal,isFavourite:!1,isHidden:!0}})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ti=class n{audioCtx=null;constructor(){}playSound(t){if(this.initializeAudioContext(),!this.audioCtx)return;this.audioCtx.state==="suspended"&&this.audioCtx.resume();let e=this.audioCtx.currentTime,i=this.audioCtx.createOscillator(),r=this.audioCtx.createGain(),o=this.audioCtx.createGain(),s=this.audioCtx.createGain(),l=this.audioCtx.createOscillator(),u=this.audioCtx.createOscillator(),p=this.audioCtx.createOscillator(),x=this.audioCtx.createOscillator();switch(t){case"countdown":i.type="sine",i.frequency.setValueAtTime(880,e),r.gain.setValueAtTime(2,e),r.gain.exponentialRampToValueAtTime(1e-4,e+.15),i.connect(r),r.connect(this.audioCtx.destination),i.start(e),i.stop(e+.15);break;case"end":o.gain.setValueAtTime(.8,e),o.gain.exponentialRampToValueAtTime(1e-4,e+2),l.type="sine",l.frequency.setValueAtTime(110,e),u.type="sine",u.frequency.setValueAtTime(220,e),p.type="sine",p.frequency.setValueAtTime(330,e),l.connect(o),u.connect(o),p.connect(o),o.connect(this.audioCtx.destination),l.start(e),l.stop(e+2),u.start(e),u.stop(e+2),p.start(e),p.stop(e+2);break;case"error":i.type="sawtooth",i.frequency.setValueAtTime(600,e),i.frequency.linearRampToValueAtTime(300,e+.25),r.gain.setValueAtTime(.4,e),r.gain.exponentialRampToValueAtTime(1e-4,e+.25),i.connect(r),r.connect(this.audioCtx.destination),i.start(e),i.stop(e+.25);break;case"correct":r.gain.setValueAtTime(.5,e),r.gain.exponentialRampToValueAtTime(1e-4,e+.7),l.type="sine",l.frequency.setValueAtTime(784,e),u.type="sine",u.frequency.setValueAtTime(1568,e),s.gain.setValueAtTime(.5,e),l.connect(r),u.connect(s),s.connect(r),r.connect(this.audioCtx.destination),l.start(e),l.stop(e+.7),u.start(e),u.stop(e+.7);break;case"untoggle":r.gain.setValueAtTime(.3,e),r.gain.exponentialRampToValueAtTime(1e-4,e+1),i.type="triangle",i.frequency.setValueAtTime(120,e),i.connect(r),r.connect(this.audioCtx.destination),i.start(e),i.stop(e+.1);break;case"whoosh":let v=.3;r.gain.setValueAtTime(1,e),r.gain.exponentialRampToValueAtTime(1e-4,e+v);let k=this.audioCtx.createBiquadFilter();k.type="bandpass",k.Q.value=15,k.frequency.setValueAtTime(4e3,e),k.frequency.exponentialRampToValueAtTime(100,e+v);let T=this.audioCtx.sampleRate*v,G=this.audioCtx.createBuffer(1,T,this.audioCtx.sampleRate),B=G.getChannelData(0);for(let wt=0;wt<T;wt++)B[wt]=Math.random()*2-1;let M=this.audioCtx.createBufferSource();M.buffer=G,M.connect(k),k.connect(r),r.connect(this.audioCtx.destination),M.start(e),M.stop(e+v);break;case"tada":o.gain.setValueAtTime(.6,e),o.gain.exponentialRampToValueAtTime(1e-4,e+1.2),o.connect(this.audioCtx.destination),l.type="triangle",l.frequency.setValueAtTime(523.25,e),l.connect(o),l.start(e),l.stop(e+.15),u.type="triangle",u.frequency.setValueAtTime(783.99,e+.15),u.connect(o),u.start(e+.15),u.stop(e+.3),p.type="triangle",p.frequency.setValueAtTime(1046.5,e+.3),p.connect(o),p.start(e+.3),p.stop(e+5);break;case"tatatada":o.gain.setValueAtTime(.6,e),o.gain.exponentialRampToValueAtTime(1e-4,e+3.5),o.connect(this.audioCtx.destination);let N=261.63,q=392,V=523.25,te=783.99,$=.15,ae=.1,P=e,ge=(wt,lr,Xe)=>{if(!this.audioCtx)return;let St=this.audioCtx.createOscillator(),Ct=this.audioCtx.createGain();St.type="triangle",St.frequency.setValueAtTime(wt,Xe),Ct.gain.setValueAtTime(0,Xe),Ct.gain.linearRampToValueAtTime(1,Xe+.01),Ct.gain.exponentialRampToValueAtTime(1e-4,Xe+lr),St.connect(Ct),Ct.connect(o),St.start(Xe),St.stop(Xe+lr)};ge(N,$,P),P+=$+ae,ge(q,$,P),P+=$+ae,ge(V,$,P),P+=$+ae;let Nt=2,Te=this.audioCtx.createOscillator(),$e=this.audioCtx.createGain();Te.type="triangle",Te.frequency.setValueAtTime(te,P),$e.gain.setValueAtTime(0,P),$e.gain.linearRampToValueAtTime(1,P+.05),$e.gain.exponentialRampToValueAtTime(1e-4,P+Nt+.5),Te.connect($e),$e.connect(o),Te.start(P),Te.stop(P+Nt+.5);break;case"magic":{this.playMagicRestoreSound();break}case"pop":{this.playPopSound();break}}}initializeAudioContext(){if(!this.audioCtx)try{this.audioCtx=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}}playMagicRestoreSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx.currentTime,e=[622.25,783.99,932.33],i=this.audioCtx.createGain();i.gain.setValueAtTime(.3,t),i.connect(this.audioCtx.destination),e.forEach((r,o)=>{if(!this.audioCtx)return;let s=this.audioCtx.createOscillator(),l=this.audioCtx.createGain();s.type="sine",s.frequency.setValueAtTime(r,t),s.connect(l),l.connect(i);let u=t+o*.08;l.gain.setValueAtTime(0,u),l.gain.linearRampToValueAtTime(.4,u+.05),l.gain.exponentialRampToValueAtTime(1e-4,u+1.5),s.start(u),s.stop(u+1.5)})}playPopSound(){if(this.initializeAudioContext(),!this.audioCtx)return;let t=this.audioCtx,e=t.currentTime,i=t.createBuffer(1,t.sampleRate*.08,t.sampleRate),r=i.getChannelData(0);for(let x=0;x<i.length;x++)r[x]=(Math.random()*2-1)*Math.pow(1-x/i.length,2.5);let o=t.createBufferSource();o.buffer=i;let s=t.createGain();s.gain.setValueAtTime(.7,e),s.gain.exponentialRampToValueAtTime(.001,e+.08);let l=t.createBiquadFilter();l.type="bandpass",l.frequency.setValueAtTime(1800,e),l.Q.value=2,o.connect(l).connect(s).connect(t.destination);let u=t.createOscillator(),p=t.createGain();u.type="triangle",u.frequency.setValueAtTime(600,e),u.frequency.exponentialRampToValueAtTime(180,e+.09),p.gain.setValueAtTime(.18,e),p.gain.exponentialRampToValueAtTime(.001,e+.11),u.connect(p).connect(t.destination),o.start(e),o.stop(e+.08),u.start(e),u.stop(e+.11),u.onended=()=>{u.disconnect(),p.disconnect(),o.disconnect(),s.disconnect(),l.disconnect()}}static \u0275fac=function(e){return new(e||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Xn=[{id:"strengthTraining",name:"workout-categories.strengthTraining"},{id:"cardioEndurance",name:"workout-categories.cardioEndurance"},{id:"flexibilityMobility",name:"workout-categories.flexibilityMobility"},{id:"mindBodyRecovery",name:"workout-categories.mindBodyRecovery"},{id:"sportSpecific",name:"workout-categories.sportSpecific"},{id:"quickWorkouts",name:"workout-categories.quickWorkouts"},{id:"specialty",name:"workout-categories.specialty"},{id:"targetedWorkouts",name:"workout-categories.targetedWorkouts"},{id:"guidedPrograms",name:"workout-categories.guidedPrograms"},{id:"equipmentSpecific",name:"workout-categories.equipmentSpecific"},{id:"custom",name:"workout-categories.custom"}];var Mi=class n{translate=S(qe);allCategories$=oe(Xn);categoryMap$=this.allCategories$.pipe(le(t=>new Map(t.map(e=>[e.id,e]))),qt(1));translatedCategories$=this.translate.onLangChange.pipe(ce(null),De(()=>this.allCategories$.pipe(De(t=>{if(!t.length)return oe([]);let e=t.map(i=>`workout-categories.${i.id}`);return this.translate.get(e).pipe(le(i=>t.map(r=>z(A({},r),{name:i[`workout-categories.${r.id}`]||r.name}))))}))),qt(1));getTranslatedCategories(){return this.translatedCategories$}static \u0275fac=function(e){return new(e||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var hs=["exerciseSearchFied"],_s=["setRepsInput"],fs=["expandedSetElement"],xs=["expandedExerciseCard"],vs=n=>({"pb-32":n}),Fi=(n,t)=>({"border-red-500 dark:border-red-400":n,"border-gray-300 dark:border-gray-500":t}),ys=n=>({week:n}),bs=n=>({day:n}),ws=n=>({"top-3":n}),ar=n=>({count:n}),Ss=n=>({"rounded-b-none":n}),Cs=(n,t)=>({"w-8 h-8 ":n,"w-10 h-10 py-1":t}),ks=(n,t)=>({order:n,total:t}),Ot=()=>({standalone:!0}),Es=(n,t)=>({"bg-primary text-white border-primary-light":n,"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 border-gray-300 dark:border-gray-600":t}),Is=n=>[n],Ts=(n,t)=>({"bg-gray-50 dark:bg-gray-700/50":n,"bg-blue-50 dark:bg-blue-700/50":t}),Ms=()=>["warmup","dropset","failure","amrap","myorep","restpause"],Fs=(n,t)=>({"bg-gray-100 dark:bg-gray-800/50":n,"bg-blue-100 dark:bg-blue-800/50":t}),Ue=(n,t)=>({setControl:n,field:t}),Ds=(n,t,e)=>({setControl:n,exIndex:t,setIndex:e}),Rs=n=>({"animating-input-text":n});function Bs(n,t){if(n&1&&(m(0,"div",34),h(1),c()),n&2){let e=d();a(),C(" ",e.errorMessage(),`
`)}}function Ps(n,t){if(n&1){let e=D();m(0,"app-action-menu",40),E("itemClick",function(r){y(e);let o=d(3);return b(o.handleActionMenuItemClick(r))})("closeMenu",function(){y(e);let r=d(3);return b(r.onCloseActionMenu())}),c()}if(n&2){let e=d(2).ngIf,i=d();g("gridClass"," grid grid-cols-2 ")("items",i.getRoutineDropdownActionItems(e.id,"dropdown"))("isVisible",i.areActionsVisible(e.id))}}function As(n,t){if(n&1){let e=D();m(0,"div",36)(1,"button",37),E("click",function(r){y(e);let o=d().ngIf,s=d();return b(s.toggleActions(o.id,r))}),F(2,"app-icon",38),c(),w(3,Ps,1,3,"app-action-menu",39),c()}if(n&2){let e=d().ngIf,i=d();a(3),g("ngIf",i.areActionsVisible(e.id))}}function Vs(n,t){if(n&1&&(m(0,"div"),w(1,As,4,1,"div",35),c()),n&2){let e=t.ngIf,i=d();a(),g("ngIf",e.id&&!i.isNewMode&&i.mode!==i.BuilderMode.customProgramEntryBuilder)}}function Ls(n,t){if(n&1&&(m(0,"div")(1,"label",45),h(2),c()()),n&2){let e,i=d(2);a(2),I((e=i.builderForm.get("name"))==null?null:e.value)}}function Os(n,t){n&1&&(m(0,"span"),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.routineBuilder.nameRequired")))}function Ns(n,t){if(n&1&&(m(0,"div",50),w(1,Os,3,3,"span",22),c()),n&2){let e,i=d(3);a(),g("ngIf",(e=i.builderForm.get("name"))==null||e.errors==null?null:e.errors.required)}}function Ws(n,t){if(n&1&&(m(0,"div",46)(1,"label",47),h(2),_(3,"translate"),c(),F(4,"input",48),_(5,"translate"),w(6,Ns,2,1,"div",49),c()),n&2){let e,i,r=d(2);a(2),I(f(3,4,"workoutBuilder.routineBuilder.nameLabel")),a(2),g("placeholder",f(5,6,"workoutBuilder.routineBuilder.namePlaceholder"))("ngClass",Z(8,Fi,((e=r.builderForm.get("name"))==null?null:e.invalid)&&((e=r.builderForm.get("name"))==null?null:e.touched),!((e=r.builderForm.get("name"))!=null&&e.invalid&&((e=r.builderForm.get("name"))!=null&&e.touched)))),a(2),g("ngIf",((i=r.builderForm.get("name"))==null?null:i.invalid)&&(((i=r.builderForm.get("name"))==null?null:i.dirty)||((i=r.builderForm.get("name"))==null?null:i.touched)))}}function Gs(n,t){if(n&1&&(m(0,"div"),F(1,"p",51),c()),n&2){let e=d(2);a(),g("innerHTML",e.sanitizedDescription,_r)}}function qs(n,t){n&1&&(m(0,"div")(1,"label",52),h(2),_(3,"translate"),c(),F(4,"textarea",53),_(5,"translate"),c()),n&2&&(a(2),I(f(3,2,"workoutBuilder.routineBuilder.descriptionLabel")),a(2),g("placeholder",f(5,4,"workoutBuilder.routineBuilder.descriptionPlaceholder")))}function zs(n,t){if(n&1&&(m(0,"div")(1,"label",54)(2,"span",55),h(3),_(4,"translate"),c(),h(5),c()()),n&2){let e,i=d(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.goalLabel"),": "),a(2),C(" ",((e=i.builderForm.get("goal"))==null||e.value==null?null:e.value.toUpperCase())||"")}}function Hs(n,t){if(n&1&&(m(0,"option",60),h(1),_(2,"translate"),c()),n&2){let e=t.$implicit;g("value",e.value),a(),C(" ",f(2,2,e.label)," ")}}function Us(n,t){if(n&1&&(m(0,"div",46)(1,"label",56),h(2),_(3,"translate"),c(),m(4,"select",57)(5,"option",58),h(6),_(7,"translate"),c(),w(8,Hs,3,4,"option",59),c()()),n&2){let e=d(2);a(2),I(f(3,3,"workoutBuilder.routineBuilder.goalLabel")),a(4),I(f(7,5,"workoutBuilder.routineBuilder.goalPlaceholder")),a(2),g("ngForOf",e.routineGoals)}}function $s(n,t){if(n&1&&(m(0,"div")(1,"label",54)(2,"span",55),h(3),_(4,"translate"),c(),h(5),c()()),n&2){let e,i=d(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.primaryCategoryLabel"),": "),a(2),C(" ",(e=i.builderForm.get("primaryCategory"))==null?null:e.value," ")}}function js(n,t){if(n&1&&(m(0,"option",60),h(1),c()),n&2){let e=t.$implicit;g("value",e.id),a(),C(" ",e.name," ")}}function Ks(n,t){if(n&1&&(m(0,"div")(1,"label",61),h(2),_(3,"translate"),c(),m(4,"select",62)(5,"option",58),h(6),_(7,"translate"),c(),w(8,js,2,2,"option",59),c()()),n&2){let e=d(2);a(2),C(" ",f(3,3,"workoutBuilder.routineBuilder.primaryCategoryLabel")," "),a(4),C("",f(7,5,"workoutBuilder.routineBuilder.primaryCategoryPlaceholder")," "),a(2),g("ngForOf",e.categories())}}function Zs(n,t){if(n&1&&(m(0,"div")(1,"label",54)(2,"span",55),h(3),_(4,"translate"),c(),h(5),c()()),n&2){let e,i=d(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.secondaryCategoryLabel"),": "),a(2),C(" ",(e=i.builderForm.get("secondaryCategory"))==null?null:e.value," ")}}function Ys(n,t){n&1&&(m(0,"div")(1,"label",63),h(2),_(3,"translate"),c(),F(4,"input",64),_(5,"translate"),c()),n&2&&(a(2),C(" ",f(3,2,"workoutBuilder.routineBuilder.secondaryCategoryLabel")," "),a(2),g("placeholder",f(5,4,"workoutBuilder.routineBuilder.secondaryCategoryPlaceholder")))}function Qs(n,t){if(n&1&&(m(0,"span",69),h(1),c()),n&2){let e=t.$implicit;a(),C(" ",e.trim()," ")}}function Js(n,t){if(n&1&&(m(0,"div",65)(1,"div",66)(2,"label",67),h(3),_(4,"translate"),c(),w(5,Qs,2,1,"span",68),c()()),n&2){let e,i=d(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.tagsLabel"),": "),a(2),g("ngForOf",(e=i.builderForm.get("tags"))==null?null:e.value.split(","))}}function Xs(n,t){n&1&&(m(0,"div")(1,"label",70),h(2),_(3,"translate"),c(),F(4,"input",71),_(5,"translate"),c()),n&2&&(a(2),C(" ",f(3,2,"workoutBuilder.routineBuilder.tagsLabel")," "),a(2),g("placeholder",f(5,4,"workoutBuilder.routineBuilder.tagsPlaceholder")))}function ea(n,t){if(n&1&&(m(0,"div",74)(1,"span",55),h(2),_(3,"translate"),c(),h(4),c()),n&2){let e=d().ngIf;a(2),I(f(3,2,"workoutBuilder.routineBuilder.lastDuration")),a(2),C(" ",e.duration," min ")}}function ta(n,t){if(n&1&&(L(0),m(1,"div",72)(2,"span",55),h(3),_(4,"translate"),c(),h(5),_(6,"millisecondsDate"),c(),w(7,ea,5,4,"div",73),O()),n&2){let e=t.ngIf;a(3),I(f(4,3,"workoutBuilder.routineBuilder.lastPerformed")),a(2),C(" ",f(6,5,e.startTime)," "),a(2),g("ngIf",e.duration)}}function ia(n,t){n&1&&(m(0,"div",75),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.routineBuilder.notPerformed")," "))}function ra(n,t){if(n&1&&(m(0,"div",72)(1,"span",55),h(2),_(3,"translate"),c(),h(4),c()),n&2){let e=d(2);a(2),I(f(3,2,"workoutBuilder.routineBuilder.estimatedDuration")),a(2),C(" ~",e.getRoutineDuration()," min ")}}function na(n,t){if(n&1&&(m(0,"div",72)(1,"span",55),h(2),_(3,"translate"),c(),h(4),c()),n&2){let e=d(2);a(2),I(f(3,2,"workoutBuilder.routineBuilder.totExercises")),a(2),C(" ",e.getTotalExerciseCount()," ")}}function oa(n,t){if(n&1&&(L(0),w(1,Ls,3,1,"div",22)(2,Ws,7,11,"div",41)(3,Gs,2,1,"div",22)(4,qs,6,6,"div",22)(5,zs,6,4,"div",22)(6,Us,9,7,"div",41)(7,$s,6,4,"div",22)(8,Ks,9,7,"div",22)(9,Zs,6,4,"div",22)(10,Ys,6,6,"div",22)(11,Js,6,4,"div",42)(12,Xs,6,6,"div",22)(13,ta,8,7,"ng-container",43)(14,ia,3,3,"ng-template",null,3,xe),m(16,"div"),w(17,ra,5,4,"div",44),c(),m(18,"div"),w(19,na,5,4,"div",44),c(),O()),n&2){let e,i,r,o,s=Y(15),l=d();a(),g("ngIf",l.isViewMode),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.isViewMode),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.isViewMode),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.isViewMode&&((e=l.builderForm.get("primaryCategory"))==null?null:e.value)),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.isViewMode&&((i=l.builderForm.get("secondaryCategory"))==null?null:i.value)),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.isViewMode&&((r=l.builderForm.get("tags"))==null?null:r.value)),a(),g("ngIf",l.isEditableMode()),a(),g("ngIf",l.lastLogForCurrentRoutine())("ngIfElse",s),a(4),g("ngIf",l.liveFormAsRoutine()&&l.getRoutineDuration()>0),a(2),g("ngIf",(l.liveFormAsRoutine()&&((o=l.liveFormAsRoutine())==null?null:o.exercises)&&((o=l.liveFormAsRoutine())==null||o.exercises==null?null:o.exercises.length))??0)}}function sa(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(3);a(),I(e.getLogTitleForProgramEntry())}}function aa(n,t){if(n&1&&(m(0,"header",92)(1,"h1",93),w(2,sa,2,1,"span",22),c()()),n&2){let e=d(2);a(2),g("ngIf",e.isEditableMode)}}function la(n,t){n&1&&(m(0,"span"),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.logEntry.dateRequired")))}function ca(n,t){if(n&1&&(m(0,"div",50),w(1,la,3,3,"span",22),c()),n&2){let e,i=d(2);a(),g("ngIf",(e=i.builderForm.get("workoutDate"))==null||e.errors==null?null:e.errors.required)}}function da(n,t){n&1&&(m(0,"span"),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.logEntry.startTimeRequired")))}function ua(n,t){if(n&1&&(m(0,"div",50),w(1,da,3,3,"span",22),c()),n&2){let e,i=d(2);a(),g("ngIf",(e=i.builderForm.get("startTime"))==null||e.errors==null?null:e.errors.required)}}function pa(n,t){n&1&&(m(0,"span"),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.logEntry.endTimeRequired")))}function ma(n,t){if(n&1&&(m(0,"div",50),w(1,pa,3,3,"span",22),c()),n&2){let e,i=d(2);a(),g("ngIf",(e=i.builderForm.get("endTime"))==null||e.errors==null?null:e.errors.required)}}function ga(n,t){if(n&1&&(m(0,"option",60),h(1),c()),n&2){let e=t.$implicit;g("value",e.id),a(),I(e.name)}}function ha(n,t){if(n&1&&(m(0,"option",60),h(1),c()),n&2){let e=t.$implicit;g("value",e.id),a(),C("",e.name," ")}}function _a(n,t){n&1&&(m(0,"span",97),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.logEntry.iterationWarning")))}function fa(n,t){if(n&1&&(m(0,"option",60),h(1),c()),n&2){let e=t.$implicit;g("value",e),a(),I(e)}}function xa(n,t){if(n&1&&(m(0,"div")(1,"label",94),h(2),_(3,"translate"),c(),w(4,_a,3,3,"span",95),m(5,"select",96)(6,"option",58),h(7),_(8,"translate"),c(),w(9,fa,2,2,"option",59),c()()),n&2){let e,i=d(2);a(2),I(f(3,5,"workoutBuilder.logEntry.iterationLabel")),a(2),g("ngIf",i.isEditableMode),a(),g("disabled",!((e=i.builderForm.get("programIdForLog"))!=null&&e.value)||i.availableIterationIds.length===0),a(2),I(f(8,7,"workoutBuilder.logEntry.iterationPlaceholder")),a(2),g("ngForOf",i.availableIterationIds)}}function va(n,t){n&1&&(m(0,"span",97),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.logEntry.scheduledDayWarning")))}function ya(n,t){if(n&1&&(m(0,"option",60),h(1),_(2,"translate"),_(3,"translate"),c()),n&2){let e=t.$implicit;g("value",e.id),a(),Q("",e.weekNumber?Ee(2,3,"workoutBuilder.logEntry.weekLabel",se(9,ys,e.weekNumber)):""," - ",e.dayName?Ee(3,6,"workoutBuilder.logEntry.dayLabel",se(11,bs,e.dayName)):""," ")}}function ba(n,t){if(n&1&&(m(0,"div")(1,"label",98),h(2),_(3,"translate"),c(),w(4,va,3,3,"span",95),m(5,"select",99)(6,"option",58),h(7),_(8,"translate"),c(),w(9,ya,4,13,"option",59),c()()),n&2){let e,i=d(2);a(2),C("",f(3,5,"workoutBuilder.logEntry.scheduledDayLabel")," "),a(2),g("ngIf",i.isEditableMode),a(),g("disabled",!((e=i.builderForm.get("programIdForLog"))!=null&&e.value)||i.availableScheduledDayIds.length===0),a(2),I(f(8,7,"workoutBuilder.logEntry.scheduledDayPlaceholder")),a(2),g("ngForOf",i.availableScheduledDayInfos)}}function wa(n,t){if(n&1){let e=D();L(0),w(1,aa,3,1,"header",76),m(2,"div",77)(3,"div")(4,"label",78),h(5),_(6,"translate"),c(),F(7,"input",79),w(8,ca,2,1,"div",49),c(),m(9,"div")(10,"label",80),h(11),_(12,"translate"),c(),F(13,"input",81),w(14,ua,2,1,"div",49),c(),m(15,"div")(16,"label",82),h(17),_(18,"translate"),c(),m(19,"input",83),E("change",function(){y(e);let r=d();return b(r.handleEndTimeChange())}),c(),w(20,ma,2,1,"div",49),c()(),m(21,"div")(22,"label",84),h(23),_(24,"translate"),c(),F(25,"input",85),_(26,"translate"),c(),m(27,"div")(28,"label",86),h(29),_(30,"translate"),c(),m(31,"select",87)(32,"option",58),h(33),_(34,"translate"),c(),w(35,ga,2,2,"option",59),c()(),m(36,"div")(37,"label",88),h(38),_(39,"translate"),c(),m(40,"select",89)(41,"option",58),h(42),_(43,"translate"),c(),w(44,ha,2,2,"option",59),c()(),w(45,xa,10,9,"div",22)(46,ba,10,9,"div",22),m(47,"div")(48,"label",90),h(49),_(50,"translate"),c(),F(51,"textarea",91),c(),O()}if(n&2){let e,i,r,o,s,l,u,p=d();a(),g("ngIf",p.checkIfLogForProgram()),a(4),I(f(6,22,"workoutBuilder.logEntry.dateLabel")),a(2),g("ngClass",Z(42,Fi,((e=p.builderForm.get("workoutDate"))==null?null:e.invalid)&&((e=p.builderForm.get("workoutDate"))==null?null:e.touched),!((e=p.builderForm.get("workoutDate"))!=null&&e.invalid&&((e=p.builderForm.get("workoutDate"))!=null&&e.touched)))),a(),g("ngIf",((i=p.builderForm.get("workoutDate"))==null?null:i.invalid)&&(((i=p.builderForm.get("workoutDate"))==null?null:i.dirty)||((i=p.builderForm.get("workoutDate"))==null?null:i.touched))),a(3),I(f(12,24,"workoutBuilder.logEntry.startTimeLabel")),a(2),g("ngClass",Z(45,Fi,((r=p.builderForm.get("startTime"))==null?null:r.invalid)&&((r=p.builderForm.get("startTime"))==null?null:r.touched),!((r=p.builderForm.get("startTime"))!=null&&r.invalid&&((r=p.builderForm.get("startTime"))!=null&&r.touched)))),a(),g("ngIf",((o=p.builderForm.get("startTime"))==null?null:o.invalid)&&(((o=p.builderForm.get("startTime"))==null?null:o.dirty)||((o=p.builderForm.get("startTime"))==null?null:o.touched))),a(3),I(f(18,26,"workoutBuilder.logEntry.endTimeLabel")),a(2),g("ngClass",Z(48,Fi,((s=p.builderForm.get("endTime"))==null?null:s.invalid)&&((s=p.builderForm.get("endTime"))==null?null:s.touched),!((s=p.builderForm.get("endTime"))!=null&&s.invalid&&((s=p.builderForm.get("endTime"))!=null&&s.touched)))),a(),g("ngIf",((l=p.builderForm.get("endTime"))==null?null:l.invalid)&&(((l=p.builderForm.get("endTime"))==null?null:l.dirty)||((l=p.builderForm.get("endTime"))==null?null:l.touched))),a(3),I(f(24,28,"workoutBuilder.logEntry.titleLabel")),a(2),g("placeholder",f(26,30,"workoutBuilder.logEntry.titlePlaceholder")),a(4),I(f(30,32,"workoutBuilder.logEntry.basedOnRoutineLabel")),a(2),g("disabled",(u=p.builderForm.get("programIdForLog"))==null?null:u.value),a(2),I(f(34,34,"workoutBuilder.logEntry.adHocOption")),a(2),g("ngForOf",p.availableRoutines),a(3),I(f(39,36,"workoutBuilder.logEntry.basedOnProgramLabel")),a(4),I(f(43,38,"workoutBuilder.logEntry.adHocProgramOption")),a(2),g("ngForOf",p.availablePrograms),a(),g("ngIf",p.initialProgramIdForLogEdit),a(),g("ngIf",p.initialProgramIdForLogEdit),a(3),I(f(50,40,"workoutBuilder.logEntry.notesLabel"))}}function Sa(n,t){if(n&1){let e=D();m(0,"button",123),E("click",function(){y(e);let r=d(5);return b(r.removeSelectedExercises())}),h(1),_(2,"translate"),c()}if(n&2){let e=d(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.removeExercisesButton",se(4,ar,e.selectedExerciseIndicesForMultipleRemoval().length))," ")}}function Ca(n,t){if(n&1){let e=D();m(0,"button",124),E("click",function(){y(e);let r=d(5);return b(r.groupSelectedAsSuperset())}),h(1),_(2,"translate"),c()}if(n&2){let e=d(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.groupButton",se(4,ar,e.selectedExerciseIndicesForSuperset().length))," ")}}function ka(n,t){if(n&1){let e=D();m(0,"button",125),E("click",function(){y(e);let r=d(2).index,o=d(3);return b(o.ungroupSuperset(r))}),h(1),_(2,"translate"),c()}if(n&2){let e=d(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.ungroupButton",se(4,ar,e.selectedExerciseIndicesForSuperset().length))," ")}}function Ea(n,t){if(n&1&&(m(0,"div",119),w(1,Sa,3,6,"button",120)(2,Ca,3,6,"button",121)(3,ka,3,6,"button",122),c()),n&2){let e=d(4);a(),g("ngIf",e.canRemoveSelectedExercises()),a(),g("ngIf",!e.canUngroupSelectedExercises()),a(),g("ngIf",e.canUngroupSelectedExercises())}}function Ia(n,t){if(n&1&&(m(0,"div",136)(1,"label",137),h(2),_(3,"translate"),c(),F(4,"input",138),c()),n&2){let e=d(2).index;a(),g("for","emomTime-"+e),a(),C("",f(3,3,"workoutBuilder.set.time")," (s):"),a(2),g("id","emomTime-"+e)}}function Ta(n,t){if(n&1){let e=D();m(0,"div",126,5)(2,"div",127)(3,"div",128)(4,"span",129),h(5),_(6,"translate"),c(),m(7,"strong",130),h(8),c()(),m(9,"div",131)(10,"span",129),h(11),_(12,"translate"),c(),m(13,"strong",132),h(14),_(15,"titlecase"),c(),m(16,"button",133),E("click",function(){y(e);let r=d().$implicit,o=d(3);return b(o.changeSupersetType(r))}),F(17,"app-icon",134),h(18),_(19,"translate"),c()(),w(20,Ia,5,5,"div",135),c()()}if(n&2){let e,i,r=d().$implicit,o=d(3);a(5),C(" ",f(6,7,"workoutBuilder.superset.rounds"),": "),a(3),I(o.workoutFormService.getSetsFormArray(r).length),a(3),C("",f(12,9,"workoutBuilder.set.type"),": "),a(2),g("ngClass",o.standarSuperSetOrEmomClass(r,!0)),a(),C(" ",f(15,11,((e=r.get("supersetType"))==null?null:e.value)||"standard")," "),a(4),C(" ",f(19,13,"workoutBuilder.changeType")," "),a(2),g("ngIf",((i=r.get("supersetType"))==null?null:i.value)==="emom")}}function Ma(n,t){if(n&1&&(m(0,"div",139),h(1),c()),n&2){let e=d().$implicit,i=d(3);g("ngClass",i.standarSuperSetOrEmomClass(e,!1)),a(),C(" ",i.standarSuperSetOrEmomLabel(e)," ")}}function Fa(n,t){n&1&&(m(0,"div",140),_(1,"translate"),F(2,"app-icon",141),c()),n&2&&g("title",f(1,1,"workoutBuilder.exercise.dragToReorder"))}function Da(n,t){if(n&1){let e=D();m(0,"input",142),_(1,"translate"),E("change",function(r){y(e);let o=d().index,s=d(3);return b(s.toggleExerciseSelection(o,r))}),c()}if(n&2){let e=d().index,i=d(3);g("title",f(1,3,"workoutBuilder.exercise.selectForSuperset"))("id","superset-select-"+e)("checked",i.selectedExerciseIndicesForSuperset().includes(e))}}function Ra(n,t){if(n&1){let e=D();m(0,"app-icon",151),E("click",function(r){y(e);let o=d(3).$implicit,s=d(3);return b(s.openModal(o.value,r))}),c()}}function Ba(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(2).ngIf,i=d(6);a(),Kt("",e.reps," x ",e.weight," ",i.unitService.getWeightUnitSuffix())}}function Pa(n,t){if(n&1&&(m(0,"span"),h(1),_(2,"translate"),c()),n&2){let e=d(2).ngIf;a(),Q("",f(2,2,"workoutBuilder.set.reps"),": ",e.reps)}}function Aa(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(2).ngIf,i=d(6);a(),Q("",e.weight," ",i.unitService.getWeightUnitSuffix())}}function Va(n,t){if(n&1&&(L(0),w(1,Ba,2,3,"span",22)(2,Pa,3,4,"span",22)(3,Aa,2,2,"span",22),O()),n&2){let e=d().ngIf;a(),g("ngIf",e.reps&&e.weight),a(),g("ngIf",e.reps&&!e.weight),a(),g("ngIf",!e.reps&&e.weight)}}function La(n,t){n&1&&(m(0,"span",155),h(1,"|"),c())}function Oa(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(2).ngIf,i=d(6);a(),Q("",e.distance," ",i.unitService.getDistanceMeasureUnitSuffix())}}function Na(n,t){n&1&&(m(0,"span",158),h(1,"/"),c())}function Wa(n,t){if(n&1&&(m(0,"span",159),F(1,"app-icon",160),h(2),c()),n&2){let e=d(2).ngIf,i=d(6);a(2),C(" ",i.workoutUtilsService.formatSecondsToTime(e.duration)," ")}}function Ga(n,t){if(n&1&&(L(0),w(1,Oa,2,2,"span",22)(2,Na,2,0,"span",156)(3,Wa,3,1,"span",157),O()),n&2){let e=d().ngIf;a(),g("ngIf",e.distance),a(),g("ngIf",e.distance&&e.duration),a(),g("ngIf",e.duration)}}function qa(n,t){n&1&&(m(0,"span",155),h(1,"|"),c())}function za(n,t){if(n&1&&(L(0),m(1,"span",159),F(2,"app-icon",161),h(3),c(),O()),n&2){let e=d().ngIf,i=d(6);a(3),C(" ",i.workoutUtilsService.formatSecondsToTime(e.rest)," ")}}function Ha(n,t){if(n&1&&(L(0),m(1,"p",152)(2,"span"),h(3),_(4,"translate"),_(5,"translate"),c(),m(6,"span",153),h(7," ( "),w(8,Va,4,3,"ng-container",22)(9,La,2,0,"span",154)(10,Ga,4,3,"ng-container",22)(11,qa,2,0,"span",154)(12,za,4,1,"ng-container",22),h(13," ) "),c()(),O()),n&2){let e,i=t.ngIf,r=d(3),o=r.$implicit,s=r.index,l=d(3);a(3),C(" ",(l.isSuperSet(s)?f(5,8,"workoutBuilder.superset.rounds")+": ":f(4,6,"workoutBuilder.set.totalSets")+": ")+((e=o.get("sets"))==null||e.value==null?null:e.value.length)," "),a(5),g("ngIf",i.reps||i.weight),a(),g("ngIf",(i.reps||i.weight)&&(i.distance||i.duration)),a(),g("ngIf",i.distance||i.duration),a(),g("ngIf",(i.reps||i.weight||i.distance||i.duration)&&i.rest),a(),g("ngIf",i.rest)}}function Ua(n,t){if(n&1&&(m(0,"p"),h(1),_(2,"translate"),_(3,"translate"),c()),n&2){let e,i=d(4).$implicit,r=d(3);a(),Q(" ",r.isEmomExercise(i)?"":f(2,2,"workoutBuilder.set.set")+": "+(i==null||(e=i.get("sets"))==null?null:e.value.length)," ",!r.isExerciseCardioOnlyCtrl(i)&&r.getSetReps(i)?"( "+f(3,4,"workoutBuilder.set.reps")+": "+r.getSetReps(i)+" )":""," ")}}function $a(n,t){if(n&1&&(m(0,"p"),h(1),_(2,"translate"),c()),n&2){let e=d(4).$implicit,i=d(3);a(),Kt(" ",f(2,3,"workoutBuilder.set.weight")," (",i.unitService.getWeightUnitSuffix(),"): ",i.getSetWeightsUsed(e)," ")}}function ja(n,t){if(n&1&&(m(0,"p"),h(1),_(2,"translate"),c()),n&2){let e=d(4).$implicit,i=d(3);a(),Kt(" ",f(2,3,"workoutBuilder.set.distance")," (",i.unitService.getDistanceMeasureUnitSuffix(),"): ",i.getSetDistanceDisplay(e)," ")}}function Ka(n,t){if(n&1&&w(0,Ua,4,6,"p",22)(1,$a,3,5,"p",22)(2,ja,3,5,"p",22),n&2){let e,i,r=d(3).$implicit,o=d(3);g("ngIf",(r==null||(e=r.get("sets"))==null||e.value==null?null:e.value.length)>=1),a(),g("ngIf",(r==null||(i=r.get("sets"))==null?null:i.value)&&(r==null||(i=r.get("sets"))==null?null:i.value.length)>=1&&o.checkIfWeightedExercise(r)),a(),g("ngIf",o.isExerciseCardioOnlyCtrl(r)&&o.getSetDistanceDisplay(r))}}function Za(n,t){if(n&1&&(m(0,"div",145)(1,"div",146)(2,"div",147)(3,"h3",148),h(4),c(),w(5,Ra,1,0,"app-icon",149),c(),m(6,"div",150),w(7,Ha,14,10,"ng-container",43)(8,Ka,3,3,"ng-template",null,6,xe),c()()()),n&2){let e,i,r,o=Y(9),s=d(2).$implicit,l=d(3);a(3),g("title",(e=s.get("exerciseName"))==null?null:e.value),a(),C(" ",(i=s.get("exerciseName"))==null?null:i.value," "),a(),g("ngIf",(r=s.get("exerciseId"))==null?null:r.value),a(2),g("ngIf",l.getUniformSetValues(s))("ngIfElse",o)}}function Ya(n,t){if(n&1&&(m(0,"div",143),w(1,Za,10,5,"div",144),c()),n&2){let e=d().$implicit,i=d(3);a(),g("ngIf",i.workoutFormService.getSetsFormArray(e).controls.length>0)}}function Qa(n,t){if(n&1&&(m(0,"span",171),h(1),_(2,"translate"),c()),n&2){let e,i=d(2),r=i.$implicit,o=i.index,s=d(3);g("ngClass",s.standarSuperSetOrEmomClass(r,!0)),a(),C(" ",Ee(2,2,"workoutBuilder.superset.exerciseLabel",Z(5,ks,(((e=r.get("supersetOrder"))==null?null:e.value)??0)+1,s.getSupersetSize(o)))," ")}}function Ja(n,t){if(n&1){let e=D();m(0,"app-icon",151),E("click",function(r){y(e);let o=d(2).$implicit,s=d(3);return b(s.openModal(o.value,r))}),c()}}function Xa(n,t){if(n&1&&(m(0,"div")(1,"label",172),h(2),_(3,"translate"),c(),F(4,"textarea",173),c()),n&2){let e=d(2).index,i=d(3);a(),g("for","exerciseNotes-"+e),a(),C(" ",f(3,4,i.isRoutineMode?"workoutBuilder.exercise.notesLabel":"workoutBuilder.exercise.loggedNotesLabel")," "),a(2),g("id","exerciseNotes-"+e)("readonly",i.isViewMode)}}function el(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.reps")))}function tl(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.weight")))}function il(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.distance")))}function rl(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.time")," (s)"))}function nl(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.rest")," (s)"))}function ol(n,t){n&1&&(m(0,"div",175),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.notes")))}function sl(n,t){if(n&1&&(m(0,"div",180)(1,"strong"),h(2),c()()),n&2){let e=d().$implicit,i=d(6);a(2),I(i.workoutUtilsService.formatMetricTarget(e.targetReps,i.metricEnum.reps)||"-")}}function al(n,t){if(n&1&&(m(0,"div",180)(1,"strong"),h(2),c()()),n&2){let e=d().$implicit,i=d(6);a(2),Q("",i.getSetTargetDisplay(e,i.metricEnum.weight)||"-","",i.getSetTargetDisplay(e,i.metricEnum.weight)!=="-"?" "+i.unitService.getWeightUnitSuffix():"")}}function ll(n,t){if(n&1&&(m(0,"div",180)(1,"strong"),h(2),c()()),n&2){let e=d().$implicit,i=d(6);a(2),Q("",i.getSetTargetDisplay(e,i.metricEnum.distance)||"-","",i.getSetTargetDisplay(e,i.metricEnum.distance)!=="-"?" "+i.unitService.getDistanceMeasureUnitSuffix():"")}}function cl(n,t){if(n&1&&(m(0,"div",180)(1,"strong"),h(2),c()()),n&2){let e=d().$implicit,i=d(6);a(2),I(i.getSetTargetDisplay(e,i.metricEnum.duration)||"-")}}function dl(n,t){if(n&1&&(m(0,"div",180)(1,"strong"),h(2),c()()),n&2){let e=d().$implicit,i=d(6);a(2),I(i.getSetTargetDisplay(e,i.metricEnum.rest)||"-")}}function ul(n,t){if(n&1){let e=D();L(0),m(1,"div",181),E("click",function(){y(e);let r=d(2).$implicit,o=d(6);return b(o.showNotesModal(r.notes))}),F(2,"app-icon",182),c(),O()}}function pl(n,t){n&1&&(m(0,"span"),h(1,"-"),c())}function ml(n,t){if(n&1&&(m(0,"div",180),w(1,ul,3,0,"ng-container",43)(2,pl,2,0,"ng-template",null,7,xe),c()),n&2){let e=Y(3),i=d().$implicit;a(),g("ngIf",i.notes)("ngIfElse",e)}}function gl(n,t){n&1&&F(0,"div",183)}function hl(n,t){if(n&1&&(L(0),m(1,"div",177),h(2),c(),w(3,sl,3,1,"div",178)(4,al,3,2,"div",178)(5,ll,3,2,"div",178)(6,cl,3,1,"div",178)(7,dl,3,1,"div",178)(8,ml,4,2,"div",178)(9,gl,1,0,"div",179),O()),n&2){let e=t.$implicit,i=t.index,r=t.last,o=d(3).$implicit,s=d(3);a(2),I(i+1),a(),g("ngIf",s.checkIfRepsIsVisible(e)),a(),g("ngIf",s.checkIfWeightIsVisible(e)),a(),g("ngIf",s.checkIfDistanceIsVisible(e)),a(),g("ngIf",s.checkIfDurationIsVisible(e)&&!s.isEmom(o)),a(),g("ngIf",s.checkIfRestIsVisible(e)&&!s.isEmom(o)),a(),g("ngIf",s.checkIfNotesIsVisible(e)),a(),g("ngIf",!r)}}function _l(n,t){if(n&1&&(m(0,"div",174)(1,"div",175),h(2),_(3,"translate"),c(),w(4,el,3,3,"div",176)(5,tl,3,3,"div",176)(6,il,3,3,"div",176)(7,rl,3,3,"div",176)(8,nl,3,3,"div",176)(9,ol,3,3,"div",176)(10,hl,10,8,"ng-container",104),c()),n&2){let e,i=d(2).$implicit,r=d(3);g("ngClass",r.getGridColsForViewExercise(i)),a(2),C(" ",f(3,9,"workoutBuilder.set.header")),a(2),g("ngIf",r.checkIfRepsIsVisible(i)),a(),g("ngIf",r.checkIfWeightIsVisible(i)),a(),g("ngIf",r.checkIfDistanceIsVisible(i)),a(),g("ngIf",r.checkIfDurationIsVisible(i)&&!r.isEmom(i)),a(),g("ngIf",r.checkIfRestIsVisible(i)&&!r.isEmom(i)),a(),g("ngIf",r.checkIfNotesIsVisible(i)),a(),g("ngForOf",(e=i.get("sets"))==null?null:e.value)}}function fl(n,t){if(n&1){let e=D();L(0),m(1,"button",203),E("click",function(){let r=y(e).$implicit,o=d(4).index,s=d(3);return b(s.toggleMetricForAllSets(o,r))}),h(2),_(3,"translate"),c(),O()}if(n&2){let e=t.$implicit,i=d(4).index,r=d(3);a(),g("ngClass",Z(4,Es,r.isMetricActiveForAllSets(i,e),!r.isMetricActiveForAllSets(i,e))),a(),C(" ",f(3,2,"metrics."+e)," ")}}function xl(n,t){if(n&1){let e=D();m(0,"div",190)(1,"button",191),E("click",function(r){y(e);let o=d(3).index,s=d(3);return b(s.toggleSetAllPanel(o,r))}),m(2,"span"),h(3),_(4,"translate"),c(),F(5,"app-icon",192),c(),m(6,"div",193,8)(8,"div",194),w(9,fl,4,7,"ng-container",104),c(),m(10,"div",195)(11,"div",196)(12,"div")(13,"label",197),h(14),_(15,"translate"),c(),m(16,"input",198),ee("ngModelChange",function(r){y(e);let o=d(6);return X(o.repsToSetForAll,r)||(o.repsToSetForAll=r),b(r)}),c()(),m(17,"div")(18,"label",197),h(19),_(20,"translate"),c(),m(21,"input",199),ee("ngModelChange",function(r){y(e);let o=d(6);return X(o.weightToSetForAll,r)||(o.weightToSetForAll=r),b(r)}),c()(),m(22,"div")(23,"label",197),h(24),_(25,"translate"),c(),m(26,"input",198),ee("ngModelChange",function(r){y(e);let o=d(6);return X(o.durationToSetForAll,r)||(o.durationToSetForAll=r),b(r)}),c()(),m(27,"div")(28,"label",197),h(29),_(30,"translate"),c(),m(31,"input",200),ee("ngModelChange",function(r){y(e);let o=d(6);return X(o.distanceToSetForAll,r)||(o.distanceToSetForAll=r),b(r)}),c()(),m(32,"div")(33,"label",197),h(34),_(35,"translate"),c(),m(36,"input",198),ee("ngModelChange",function(r){y(e);let o=d(6);return X(o.restToSetForAll,r)||(o.restToSetForAll=r),b(r)}),c()()(),m(37,"div",201)(38,"button",202),E("click",function(){y(e);let r=d(3).index,o=d(3);return b(o.applyToAllSets(r))}),h(39),_(40,"translate"),c()()()()()}if(n&2){let e=d(3).index,i=d(3);a(3),I(f(4,30,"setValueForAllSets")),a(2),Le("rotate-180",i.expandedSetAllPanel()===e),a(),nt("max-height",i.expandedSetAllPanel()===e?"500px":"0px"),a(3),g("ngForOf",i.allAvailableMetrics),a(5),I(f(15,32,"metrics.reps")),a(2),J("ngModel",i.repsToSetForAll),g("ngModelOptions",Qe(44,Ot))("step",i.repsStep),a(3),Q("",f(20,34,"metrics.weight")," (",i.unitService.getWeightUnitSuffix(),")"),a(2),J("ngModel",i.weightToSetForAll),g("ngModelOptions",Qe(45,Ot))("step",i.weightStep),a(3),C("",f(25,36,"metrics.duration")," (s)"),a(2),J("ngModel",i.durationToSetForAll),g("ngModelOptions",Qe(46,Ot))("step",i.durationStep),a(3),Q("",f(30,38,"metrics.distance")," (",i.unitService.getDistanceMeasureUnitSuffix(),")"),a(2),J("ngModel",i.distanceToSetForAll),g("ngModelOptions",Qe(47,Ot))("step",i.distanceStep),a(3),C("",f(35,40,"metrics.rest")," (s)"),a(2),J("ngModel",i.restToSetForAll),g("ngModelOptions",Qe(48,Ot))("step",i.restStep),a(2),g("disabled",i.repsToSetForAll()===null&&i.weightToSetForAll()===null&&i.durationToSetForAll()===null&&i.distanceToSetForAll()===null&&i.restToSetForAll()===null),a(),C(" ",f(40,42,"applyToAllSets")," ")}}function vl(n,t){n&1&&(m(0,"div",212),h(1),_(2,"translate"),c()),n&2&&(a(),I(f(2,1,"workoutBuilder.set.reps")))}function yl(n,t){if(n&1&&(m(0,"div",213),h(1),_(2,"translate"),c()),n&2){let e=d(7);a(),Q("",f(2,2,"workoutBuilder.set.weight")," (",e.unitService.getWeightUnitSuffix(),")")}}function bl(n,t){if(n&1&&(m(0,"div",213),h(1),_(2,"translate"),c()),n&2){let e=d(7);a(),Q("",f(2,2,"workoutBuilder.set.distance")," (",e.unitService.getDistanceMeasureUnitSuffix(),")")}}function wl(n,t){n&1&&(m(0,"div",212),h(1),_(2,"translate"),c()),n&2&&(a(),C("",f(2,1,"workoutBuilder.set.time")," (s)"))}function Sl(n,t){n&1&&(m(0,"div",214),h(1),_(2,"translate"),c()),n&2&&(a(),C("",f(2,1,"workoutBuilder.set.rest")," (s)"))}function Cl(n,t){if(n&1&&(L(0),m(1,"div",204)(2,"div",205),h(3),_(4,"translate"),c(),m(5,"div",206)(6,"div",207),w(7,vl,3,3,"div",208)(8,yl,3,4,"div",209)(9,bl,3,4,"div",209)(10,wl,3,3,"div",208)(11,Sl,3,3,"div",210),c()(),F(12,"div",211),c(),O()),n&2){let e=t.ngLet,i=d(3).index,r=d(3);a(),g("ngClass",r.getGridClassForExercise(i)),a(2),I(f(4,7,"workoutBuilder.set.header")),a(4),g("ngIf",e[r.metricEnum.reps]),a(),g("ngIf",e[r.metricEnum.weight]),a(),g("ngIf",e[r.metricEnum.distance]),a(),g("ngIf",e[r.metricEnum.duration]),a(),g("ngIf",e[r.metricEnum.rest])}}function kl(n,t){if(n&1&&(m(0,"div",225),h(1),c()),n&2){let e=d(3).$implicit,i=d(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.reps)," ")}}function El(n,t){if(n&1&&(m(0,"div",226),h(1),c()),n&2){let e=d(3).$implicit,i=d(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.weight)," ")}}function Il(n,t){if(n&1&&(m(0,"div",226),h(1),c()),n&2){let e=d(3).$implicit,i=d(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.distance)," ")}}function Tl(n,t){if(n&1&&(m(0,"div",225),h(1),c()),n&2){let e=d(3).$implicit,i=d(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.duration)," ")}}function Ml(n,t){if(n&1&&(m(0,"div",227),h(1),c()),n&2){let e=d(3).$implicit,i=d(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.rest)," ")}}function Fl(n,t){if(n&1){let e=D();L(0),m(1,"div",217),E("click",function(r){y(e);let o=d(2).index,s=d(3).index,l=d(3);return b(l.toggleSetExpansion(s,o,r))}),m(2,"div",218),h(3),c(),m(4,"div",206)(5,"div",207),w(6,kl,2,1,"div",219)(7,El,2,1,"div",220)(8,Il,2,1,"div",220)(9,Tl,2,1,"div",219)(10,Ml,2,1,"div",221),c()(),m(11,"div",222)(12,"button",223),_(13,"translate"),E("click",function(r){y(e);let o=d(2).index,s=d(3),l=s.$implicit,u=s.index,p=d(3);return b(p.removeSet(l,u,o,r))}),F(14,"app-icon",224),c()()(),O()}if(n&2){let e,i=t.ngLet,r=d(2),o=r.$implicit,s=r.index,l=d(3).index,u=d(3);a(),g("ngClass",se(11,Is,u.getGridClassForExercise(l)))("ngClass",Z(13,Ts,((e=o.get("type"))==null?null:e.value)==="standard",((e=o.get("type"))==null?null:e.value)==="warmup")),a(2),C(" #",s+1),a(3),g("ngIf",i[u.metricEnum.reps]),a(),g("ngIf",i[u.metricEnum.weight]),a(),g("ngIf",i[u.metricEnum.distance]),a(),g("ngIf",i[u.metricEnum.duration]),a(),g("ngIf",i[u.metricEnum.rest]),a(2),g("title",f(13,9,"workoutBuilder.set.removeSet"))}}function Dl(n,t){if(n&1&&(m(0,"div"),w(1,Fl,15,16,"ng-container",188),c()),n&2){let e=d(4).index,i=d(3);a(),g("ngLet",i.getVisibleColumnsForExercise(e))}}function Rl(n,t){if(n&1){let e=D();m(0,"div",237)(1,"button",223),_(2,"translate"),E("click",function(r){y(e);let o=d(2).index,s=d(3),l=s.$implicit,u=s.index,p=d(3);return b(p.removeSet(l,u,o,r))}),F(3,"app-icon",224),c()()}n&2&&(a(),g("title",f(2,1,"workoutBuilder.set.removeSet")))}function Bl(n,t){if(n&1){let e=D();m(0,"button",243),E("click",function(r){y(e);let o=d(3).index,s=d(3).index;return d(3).promptAddField(s,o),b(r.stopPropagation())}),F(1,"app-icon",244),c()}}function Pl(n,t){if(n&1){let e=D();m(0,"div",238)(1,"label",239),h(2),_(3,"translate"),c(),m(4,"button",240),E("click",function(r){y(e);let o=d(2).index,s=d(3).index;return d(3).promptRemoveField(s,o),b(r.stopPropagation())}),F(5,"app-icon",241),c(),w(6,Bl,2,0,"button",242),c()}if(n&2){let e=d(2).index,i=d(3).index,r=d(3);a(2),C("",f(3,2,"workoutBuilder.set.metrics"),":"),a(4),g("ngIf",r.getFieldsForSet(i,e).hidden.length>0)}}function Al(n,t){if(n&1&&(m(0,"option",60),h(1),c()),n&2){let e=t.$implicit;g("value",e.value),a(),I(e.label)}}function Vl(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4).$implicit,i=d(6),r=Y(21);a(),g("ngTemplateOutlet",r)("ngTemplateOutletContext",Z(2,Ue,e,i.metricEnum.reps))}}function Ll(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4).$implicit,i=d(6),r=Y(21);a(),g("ngTemplateOutlet",r)("ngTemplateOutletContext",Z(2,Ue,e,i.metricEnum.weight))}}function Ol(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4).$implicit,i=d(6),r=Y(21);a(),g("ngTemplateOutlet",r)("ngTemplateOutletContext",Z(2,Ue,e,i.metricEnum.distance))}}function Nl(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4).$implicit,i=d(6),r=Y(21);a(),g("ngTemplateOutlet",r)("ngTemplateOutletContext",Z(2,Ue,e,i.metricEnum.duration))}}function Wl(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4),i=e.$implicit,r=e.index,o=d(3).index;d(3);let s=Y(17);a(),g("ngTemplateOutlet",s)("ngTemplateOutletContext",Zt(2,Ds,i,o,r))}}function Gl(n,t){if(n&1&&(m(0,"div"),ke(1,248),c()),n&2){let e=d(4).$implicit,i=d(6),r=Y(21);a(),g("ngTemplateOutlet",r)("ngTemplateOutletContext",Z(2,Ue,e,i.metricEnum.rest))}}function ql(n,t){if(n&1&&(L(0)(1,246),w(2,Vl,2,5,"div",247)(3,Ll,2,5,"div",247)(4,Ol,2,5,"div",247)(5,Nl,2,5,"div",247)(6,Wl,2,6,"div",247)(7,Gl,2,5,"div",247),O()()),n&2){let e=t.$implicit,i=d(9);a(),g("ngSwitch",e),a(),g("ngSwitchCase",i.metricEnum.reps),a(),g("ngSwitchCase",i.metricEnum.weight),a(),g("ngSwitchCase",i.metricEnum.distance),a(),g("ngSwitchCase",i.metricEnum.duration),a(),g("ngSwitchCase",i.metricEnum.tempo),a(),g("ngSwitchCase",i.metricEnum.rest)}}function zl(n,t){if(n&1){let e=D();m(0,"div",249)(1,"button",250),E("click",function(r){y(e);let o=d(3).index,s=d(3).index;return d(3).promptAddField(s,o),b(r.stopPropagation())}),F(2,"app-icon",251),c()()}}function Hl(n,t){if(n&1&&(L(0),w(1,ql,8,7,"ng-container",104)(2,zl,3,0,"div",245),O()),n&2){let e=t.ngIf,i=d(5).index,r=d(3);a(),g("ngForOf",e),a(),g("ngIf",r.isGhostFieldVisible(e,i))}}function Ul(n,t){if(n&1&&(m(0,"div")(1,"label",172),h(2),_(3,"translate"),c(),F(4,"textarea",173),c()),n&2){let e=d(2).index,i=d(3).index,r=d(3);a(),g("for","setNotes-"+i+e),a(),C(" ",f(3,4,(r.isRoutineMode,"workoutBuilder.set.notes"))," "),a(2),g("id","setNotes-"+i+e)("readonly",r.isViewMode)}}function $l(n,t){if(n&1){let e=D();m(0,"div",228,10)(2,"div",229),E("click",function(r){y(e);let o=d().index,s=d(3).index,l=d(3);return b(l.toggleSetExpansion(s,o,r))}),h(3),_(4,"translate"),_(5,"translate"),m(6,"div",230),w(7,Rl,4,3,"div",231),c()(),m(8,"div",180),w(9,Pl,7,4,"div",232),c(),m(10,"div",233)(11,"div",234)(12,"label",235),h(13),_(14,"translate"),c(),m(15,"select",236),w(16,Al,2,2,"option",59),c()(),w(17,Hl,3,2,"ng-container",22),c(),w(18,Ul,5,6,"div",22),c()}if(n&2){let e,i,r,o=d(),s=o.$implicit,l=o.index,u=d(3),p=u.$implicit,x=u.index,v=d(3);g("ngClass",Z(20,Fs,!Qe(19,Ms).includes(((e=s.get("type"))==null?null:e.value)??""),((e=s.get("type"))==null?null:e.value)==="warmup")),a(2),g("ngClass",v.setLabelClass(p)),a(),Q(" #",l+1," ",v.isSuperSet(x)?f(4,13,"workoutBuilder.set.round"):f(5,15,"workoutBuilder.set.set")," "),a(4),g("ngIf",v.isEditableMode()),a(2),g("ngIf",v.isEditableMode()&&!v.isSuperSet(x)),a(3),g("for","setType-exp-"+x+"-"+l),a(),I(f(14,17,"workoutBuilder.set.type")),a(2),g("id","setType-exp-"+x+"-"+l)("disabled",v.isViewMode),a(),g("ngForOf",v.availableSetTypes),a(),g("ngIf",(i=s.get("fieldOrder"))==null?null:i.value),a(),g("ngIf",(r=s.get("notes"))==null?null:r.value)}}function jl(n,t){if(n&1&&(m(0,"div",215,9),w(2,Dl,2,1,"div",22)(3,$l,19,23,"div",216),c()),n&2){let e=t.index,i=d(3).index,r=d(3);Le("add-set-animated",r.isNewlyAdded(i,e)),g("formGroupName",e),a(2),g("ngIf",!r.isSetExpanded(i,e)),a(),g("ngIf",r.isSetExpanded(i,e))}}function Kl(n,t){if(n&1){let e=D();m(0,"div",252)(1,"div",253)(2,"label",239),h(3),_(4,"translate"),c(),m(5,"button",254),_(6,"translate"),E("click",function(r){y(e);let o=d(3).$implicit,s=d(3);return b(s.removeLastSet(o,r))}),F(7,"app-icon",241),c(),m(8,"button",255),_(9,"translate"),E("click",function(r){y(e);let o=d(3),s=o.$implicit,l=o.index;return d(3).addSet(s,l),b(r.stopPropagation())}),F(10,"app-icon",244),c()()()}n&2&&(a(3),C("",f(4,3,"workoutBuilder.set.set"),":"),a(2),Mt("aria-label",f(6,5,"workoutBuilder.set.removeLastSet")),a(3),Mt("aria-label",f(9,7,"workoutBuilder.set.addSet")))}function Zl(n,t){if(n&1&&(m(0,"div",184)(1,"div",185)(2,"div",128)(3,"span",129),h(4),_(5,"translate"),c(),m(6,"strong",130),h(7),c()(),w(8,xl,41,49,"div",186),c(),m(9,"div",187),w(10,Cl,13,9,"ng-container",188)(11,jl,4,5,"div",189),c(),w(12,Kl,11,9,"div",116),c()),n&2){let e=d(2),i=e.$implicit,r=e.index,o=d(3);a(4),C(" ",f(5,6,"workoutBuilder.set.totalSets"),": "),a(3),I(o.workoutFormService.getSetsFormArray(i).length),a(),g("ngIf",o.isEditableMode()&&o.getExerciseSetsLength(r)>1),a(2),g("ngLet",o.getVisibleColumnsForExercise(r)),a(),g("ngForOf",o.workoutFormService.getSetsFormArray(i).controls),a(),g("ngIf",!o.isSuperSet(r))}}function Yl(n,t){if(n&1){let e=D();m(0,"div",162)(1,"div",163),E("click",function(r){y(e);let o=d().index,s=d(3);return b(s.expandExerciseCard(o,r))}),m(2,"div",164),w(3,Qa,3,8,"span",165),m(4,"div",166),F(5,"img",167),_(6,"async"),m(7,"h3",168),h(8),_(9,"translate"),c(),w(10,Ja,1,0,"app-icon",149),c()()(),w(11,Xa,5,6,"div",22)(12,_l,11,11,"div",169)(13,Zl,13,8,"div",170),c()}if(n&2){let e,i,r,o,s=d(),l=s.$implicit,u=s.index,p=d(3);a(),g("ngClass",se(13,Ss,!p.isEditableMode())),a(2),g("ngIf",(e=l.get("supersetId"))==null?null:e.value),a(2),g("src",f(6,9,p.getIconPath((i=l.get("exerciseId"))==null?null:i.value)),fr)("ngClass",Z(15,Cs,!p.isSetExpanded(u,0),p.isSetExpanded(u,0))),a(3),C(" ",((r=l.get("exerciseName"))==null?null:r.value)||f(9,11,"workoutBuilder.exercise.selectPlaceholder")," "),a(2),g("ngIf",(o=l.get("exerciseId"))==null?null:o.value),a(),g("ngIf",p.expandedExerciseNotes()===u),a(),g("ngIf",p.shouldShowExpandedExercise(u)&&p.isViewMode),a(),g("ngIf",p.shouldShowExpandedExercise(u)&&p.isEditableMode())}}function Ql(n,t){if(n&1){let e=D();m(0,"div",252,11)(2,"div",238)(3,"span",129),h(4),_(5,"translate"),c(),m(6,"button",256),_(7,"translate"),E("click",function(r){y(e);let o=d().$implicit,s=d(3);return b(s.removeRoundFromSuperset(o,r))}),F(8,"app-icon",257),c(),m(9,"button",258),_(10,"translate"),E("click",function(r){y(e);let o=d().$implicit,s=d(3);return b(s.addRoundToSuperset(o,r))}),F(11,"app-icon",259),c()()()}if(n&2){let e=d().$implicit,i=d(3);a(4),C(" ",f(5,4,"workoutBuilder.superset.rounds"),": "),a(2),g("disabled",i.workoutFormService.getSetsFormArray(e).length<=1),Mt("aria-label",f(7,6,"workoutBuilder.set.removeLastSet")),a(3),Mt("aria-label",f(10,8,"workoutBuilder.set.addSet"))}}function Jl(n,t){if(n&1){let e=D();m(0,"app-action-menu",262),E("itemClick",function(r){y(e);let o=d(2),s=o.$implicit,l=o.index,u=d(3);return b(u.handleExerciseActionMenuItemClick(r,l,s))})("closeMenu",function(){y(e);let r=d(5);return b(r.closeExerciseActionMenu())}),c()}if(n&2){let e=d(2),i=e.$implicit,r=e.index,o=d(3);g("items",o.getExerciseActionMenuItems(i))("isVisible",o.isExerciseActionMenuVisible(r))}}function Xl(n,t){if(n&1){let e=D();m(0,"div",260)(1,"div",36,12)(3,"button",37),E("click",function(r){y(e);let o=d().index,s=d(3);return b(s.toggleExerciseActionMenu(o,r))}),F(4,"app-icon",38),c(),w(5,Jl,1,2,"app-action-menu",261),c()()}if(n&2){let e=d().index,i=d(3);a(5),g("ngIf",i.isExerciseActionMenuVisible(e))}}function ec(n,t){if(n&1){let e=D();L(0),m(1,"div",105,4),E("clickOutside",function(){y(e);let r=d(3);return b(r.closeExerciseActionMenu())}),w(3,Ea,4,3,"div",106),m(4,"div",107),_(5,"translate"),E("click",function(r){let o=y(e).index,s=d(3);return b(s.expandExerciseCard(o,r))}),w(6,Ta,21,15,"div",108),m(7,"div",109),w(8,Ma,2,2,"div",110),m(9,"div",111),w(10,Fa,3,3,"div",112)(11,Da,2,5,"input",113)(12,Ya,2,1,"div",114),c(),w(13,Yl,14,18,"div",115),c(),w(14,Ql,12,10,"div",116),c(),m(15,"div",117),w(16,Xl,6,1,"div",118),c()(),O()}if(n&2){let e=t.$implicit,i=t.index,r=d(3);a(),nt("z-index",r.isExerciseActionMenuVisible(i)?50:"auto"),g("@exerciseExit",void 0)("ngClass",r.getExerciseCardClass(e,i)),a(2),g("ngIf",r.isEditableMode()&&r.selectedExerciseIndicesForSuperset().length>=2&&i===r.firstSelectedExerciseIndexForSuperset),a(),g("cdkDragDisabled",!r.isDraggingEnabled(i))("dragHandleSelector",r.shouldShowExpandedExercise(i)?"[data-drag-handle]":void 0)("longPressEnabled",r.isEditableMode()&&!r.shouldShowExpandedExercise(i))("longPressDelay",150)("cdkDragData",e)("cdkDragStartDelay",110)("formGroupName",i)("title",r.isEditableMode()&&!r.shouldShowExpandedExercise(i)?f(5,22,"workoutBuilder.exercise.dragToReorder"):""),a(2),g("ngIf",r.isEditableMode()&&r.isSuperSet(i)&&r.isFirstInSuperset(i)),a(2),g("ngIf",r.isFirstInSuperset(i)),a(2),g("ngIf",r.isDraggingEnabled(i)),a(),g("ngIf",(r.isEditableMode()||r.isNewMode)&&!r.isViewMode&&!r.shouldShowExpandedExercise(i)),a(),g("ngIf",!r.shouldShowExpandedExercise(i)),a(),g("ngIf",r.shouldShowExpandedExercise(i)),a(),g("ngIf",r.isEditableMode()&&r.isSuperSet(i)&&r.isLastInSuperset(i)),a(),g("ngClass",se(24,ws,r.isSuperSet(i))),a(),g("ngIf",r.isEditableMode()&&(!r.isSuperSet(i)||r.isSuperSet(i)&&r.isFirstInSuperset(i)))}}function tc(n,t){if(n&1){let e=D();m(0,"div",103),E("cdkDropListDropped",function(r){y(e);let o=d(2);return b(o.onExerciseDrop(r))}),w(1,ec,17,26,"ng-container",104),c()}if(n&2){let e=d(2);g("cdkDropListData",e.exercisesFormArray.controls)("cdkDropListDisabled",!e.isEditableMode()),a(),g("ngForOf",e.exercisesFormArray.controls)}}function ic(n,t){if(n&1){let e=D();m(0,"div",263)(1,"p",264),h(2,"Select a routine or ADD EXERCISEs manually to log"),c(),m(3,"button",265),E("click",function(){y(e);let r=d(2);return b(r.openExerciseSelectionModal())}),h(4),_(5,"translate"),c()()}n&2&&(a(4),C(" + ",f(5,1,"workoutBuilder.logEntry.addFirstExercise")," "))}function rc(n,t){n&1&&(m(0,"div",266),h(1),_(2,"translate"),c()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.logEntry.noExercisesInRoutine")," "))}function nc(n,t){if(n&1&&(m(0,"section"),w(1,tc,2,3,"div",100)(2,ic,6,3,"div",101)(3,rc,3,3,"div",102),c()),n&2){let e,i,r=d();a(),g("ngIf",r.exercisesFormArray.length>0),a(),g("ngIf",r.mode===r.BuilderMode.manualLogEntry&&r.exercisesFormArray.length===0&&!((e=r.builderForm.get("routineIdForLog"))!=null&&e.value)),a(),g("ngIf",r.mode===r.BuilderMode.manualLogEntry&&r.exercisesFormArray.length===0&&((i=r.builderForm.get("routineIdForLog"))==null?null:i.value))}}function oc(n,t){n&1&&(m(0,"section",267)(1,"p",268),h(2),_(3,"translate"),c()()),n&2&&(a(2),I(f(3,1,"workoutBuilder.restDayMessage")))}function sc(n,t){if(n&1){let e=D();m(0,"div",263)(1,"button",272),E("click",function(){y(e);let r=d(2);return b(r.openExerciseSelectionModal())}),F(2,"app-icon",273),h(3),_(4,"translate"),c()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.addExerciseButton")," "))}function ac(n,t){if(n&1){let e=D();m(0,"div")(1,"button",274),E("click",function(){y(e);let r=d(2);return b(r.resetTemplateAndStardWizard())}),F(2,"app-icon",275),h(3),_(4,"translate"),c()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.buttons.resetTemplateButton")," "))}function lc(n,t){if(n&1){let e=D();m(0,"div")(1,"button",276),E("click",function(){y(e);let r=d(2);return b(r.regenerateWorkout())}),F(2,"app-icon",277),h(3),_(4,"translate"),c()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.buttons.regenButton")," "))}function cc(n,t){if(n&1){let e=D();m(0,"div",269),w(1,sc,5,3,"div",101),m(2,"button",270),E("click",function(){y(e);let r=d();return b(r.onSubmit())}),F(3,"app-icon",271),h(4),_(5,"translate"),c(),w(6,ac,5,3,"div",22)(7,lc,5,3,"div",22),c()}if(n&2){let e,i=d();a(),g("ngIf",i.mode!==i.BuilderMode.manualLogEntry&&((e=i.builderForm.get("goal"))==null?null:e.value)!==i.metricEnum.rest),a(),g("disabled",i.isFormInvalid()),a(2),C(" ",f(5,5,i.getSubmitButtonLabel())," "),a(2),g("ngIf",i.isNewMode&&i.isEditableMode()&&i.mode!==i.BuilderMode.manualLogEntry),a(),g("ngIf",i.isGeneratedRoutine())}}function dc(n,t){if(n&1&&(L(0),F(1,"input",281),_(2,"translate"),O()),n&2){let e=d(2);a(),g("placeholder",f(2,2,"workoutBuilder.set.tempoPlaceholder"))("readonly",e.isViewMode)}}function uc(n,t){if(n&1&&(F(0,"input",282),_(1,"translate")),n&2){let e=d(),i=e.exIndex,r=e.setIndex,o=d();g("id","tempo-exp-"+i+"-"+r)("placeholder",f(1,3,"workoutBuilder.set.tempoPlaceholder"))("readonly",o.isViewMode)}}function pc(n,t){if(n&1&&(m(0,"div",278)(1,"label",279)(2,"span"),h(3),_(4,"translate"),c()(),w(5,dc,3,4,"ng-container",22)(6,uc,2,5,"input",280),c()),n&2){let e=t.setControl,i=t.exIndex,r=t.setIndex,o=d();g("formGroup",e),a(),g("for","tempo-exp-"+i+"-"+r),a(2),I(f(4,5,"workoutBuilder.set.tempo")),a(2),g("ngIf",o.mode===o.BuilderMode.routineBuilder),a(),g("ngIf",o.mode===o.BuilderMode.manualLogEntry)}}function mc(n,t){if(n&1){let e=D();m(0,"div",278)(1,"div",283)(2,"button",284),E("shortPress",function(){let r=y(e),o=r.setControl,s=r.field,l=d();return b(l.onShortPressDecrement(o,s))})("longPress",function(){let r=y(e),o=r.setControl,s=r.field,l=d();return b(l.onLongPressDecrement(o,s))})("pressRelease",function(){y(e);let r=d();return b(r.onPressRelease())}),F(3,"app-icon",285),c(),m(4,"div",286)(5,"span",287),E("click",function(){let r,o=y(e),s=o.setControl,l=o.field,u=d();return b(u.focusInput((r=s.get("id"))==null?null:r.value,l))}),h(6),c(),m(7,"input",288,13),E("input",function(r){let o=y(e),s=o.setControl,l=o.field,u=d();return b(u.onExactInputChange(s,l,r))})("focus",function(){let r,o=y(e),s=o.setControl,l=o.field,u=Y(8),p=d();return p.onInputFocus((r=s.get("id"))==null?null:r.value,l),b(p.selectInputText(u))})("blur",function(){let r,o=y(e),s=o.setControl,l=o.field,u=d();return b(u.onInputBlur((r=s.get("id"))==null?null:r.value,l))})("wheel",function(r){let o=y(e),s=o.setControl,l=o.field,u=d();return b(u.onInputWheel(s,l,r))})("touchstart",function(r){y(e);let o=d();return b(o.onInputTouchStart(r))})("touchmove",function(r){let o=y(e),s=o.setControl,l=o.field,u=d();return b(u.onInputTouchMove(s,l,r))}),c()(),m(9,"button",289),E("shortPress",function(){let r=y(e),o=r.setControl,s=r.field,l=d();return b(l.onShortPressIncrement(o,s))})("longPress",function(){let r=y(e),o=r.setControl,s=r.field,l=d();return b(l.onLongPressIncrement(o,s))})("pressRelease",function(){y(e);let r=d();return b(r.onPressRelease())}),F(10,"app-icon",290),c()()()}if(n&2){let e,i,r=t.setControl,o=t.field,s=d();g("formGroup",r),a(5),g("@valueAnimation",s.getExactInputValue(r,o)),a(),C(" ",s.getSetMetricDisplayValue(r,o)||0," "),a(),g("value",s.getExactInputValue(r,o))("readonly",s.isViewMode)("ngClass",se(8,Rs,s.isAnimatingSet()===((e=r.get("id"))==null?null:e.value))),jt("data-set-id",(i=r.get("id"))==null?null:i.value)("data-field",o)}}function gc(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(2);a(),C("(",e.unitService.currentWeightUnit(),")")}}function hc(n,t){n&1&&(m(0,"span"),h(1,"(s)"),c())}function _c(n,t){if(n&1&&(m(0,"span"),h(1),c()),n&2){let e=d(2);a(),C("(",e.unitService.currentDistanceMeasureUnit(),")")}}function fc(n,t){n&1&&(m(0,"span"),h(1,"(s)"),c())}function xc(n,t){if(n&1){let e=D();L(0),m(1,"div",294)(2,"input",295),E("input",function(r){y(e);let o=d(),s=o.setControl,l=o.field,u=d();return b(u.updateTargetField(s,u.getFormControlName(l),"min",r))}),c(),m(3,"span",296),h(4,"-"),c(),m(5,"input",297),E("input",function(r){y(e);let o=d(),s=o.setControl,l=o.field,u=d();return b(u.updateTargetField(s,u.getFormControlName(l),"max",r))}),c()(),O()}if(n&2){let e,i,r=d(),o=r.setControl,s=r.field,l=d();a(2),g("readonly",l.isViewMode)("value",((e=o.get(l.getFormControlName(s)))==null||e.value==null?null:e.value.min)??((e=o.get(l.getFormControlName(s)))==null||e.value==null?null:e.value.minSeconds)),a(3),g("readonly",l.isViewMode)("value",((i=o.get(l.getFormControlName(s)))==null||i.value==null?null:i.value.max)??((i=o.get(l.getFormControlName(s)))==null||i.value==null?null:i.value.maxSeconds))}}function vc(n,t){if(n&1&&(L(0),ke(1,248),O()),n&2){let e=d(),i=e.setControl,r=e.field;d();let o=Y(19);a(),g("ngTemplateOutlet",o)("ngTemplateOutletContext",Z(2,Ue,i,r))}}function yc(n,t){if(n&1&&(L(0),ke(1,248),O()),n&2){let e=d(),i=e.setControl,r=e.field;d();let o=Y(19);a(),g("ngTemplateOutlet",o)("ngTemplateOutletContext",Z(2,Ue,i,r))}}function bc(n,t){if(n&1&&(L(0),ke(1,248),O()),n&2){let e=d(),i=e.setControl,r=e.field;d();let o=Y(19);a(),g("ngTemplateOutlet",o)("ngTemplateOutletContext",Z(2,Ue,i,r))}}function wc(n,t){if(n&1&&(m(0,"div",298)(1,"span"),h(2),c()()),n&2){let e,i=d(),r=i.setControl,o=i.field,s=d();a(2),I(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Sc(n,t){if(n&1&&(m(0,"div",298)(1,"span"),h(2),c()()),n&2){let e,i=d(),r=i.setControl,o=i.field,s=d();a(2),I(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Cc(n,t){if(n&1&&(m(0,"div",298)(1,"span"),h(2),c()()),n&2){let e,i=d(),r=i.setControl,o=i.field,s=d();a(2),I(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function kc(n,t){if(n&1&&(m(0,"div",298)(1,"span"),h(2),c()()),n&2){let e,i=d(),r=i.setControl,o=i.field,s=d();a(2),I(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Ec(n,t){if(n&1&&(L(0),F(1,"input",299),O()),n&2){let e=d().field,i=d();a(),g("formControlName",i.getFormControlName(e))("readonly",i.isViewMode)}}function Ic(n,t){if(n&1){let e=D();m(0,"div",278)(1,"label",239)(2,"span"),h(3),_(4,"translate"),w(5,gc,2,1,"span",22)(6,hc,2,0,"span",22)(7,_c,2,1,"span",22)(8,fc,2,0,"span",22),c(),m(9,"button",291),E("click",function(r){let o=y(e),s=o.setControl,l=o.field,u=d();return b(u.openMetricSchemeModal(s,l,r))}),h(10),_(11,"translate"),c()(),L(12,246),w(13,xc,6,4,"ng-container",247)(14,vc,2,5,"ng-container",247)(15,yc,2,5,"ng-container",247)(16,bc,2,5,"ng-container",247)(17,wc,3,1,"div",292)(18,Sc,3,1,"div",292)(19,Cc,3,1,"div",292)(20,kc,3,1,"div",292)(21,Ec,2,2,"ng-container",293),O(),c()}if(n&2){let e,i=t.setControl,r=t.field,o=d();g("formGroup",i),a(3),C("",f(4,16,"metrics."+r)," "),a(2),g("ngIf",r===o.metricEnum.weight),a(),g("ngIf",r===o.metricEnum.duration),a(),g("ngIf",r===o.metricEnum.distance),a(),g("ngIf",r===o.metricEnum.rest),a(2),C(" ",f(11,18,"common.edit")," "),a(2),g("ngSwitch",(e=i.get(o.getFormControlName(r)))==null||e.value==null?null:e.value.type),a(),g("ngSwitchCase","range"),a(),g("ngSwitchCase","exact"),a(),g("ngSwitchCase","min_plus"),a(),g("ngSwitchCase","percentage_1rm"),a(),g("ngSwitchCase","bodyweight"),a(),g("ngSwitchCase","max"),a(),g("ngSwitchCase","amrap"),a(),g("ngSwitchCase","max_fraction")}}function Tc(n,t){if(n&1){let e=D();m(0,"app-modal",300),_(1,"translate"),E("isOpenChange",function(){y(e);let r=d();return b(r.notesModalsData.set(null))}),m(2,"div",301)(3,"textarea",302),h(4),c(),m(5,"div",303)(6,"button",304),E("click",function(){y(e);let r=d();return b(r.notesModalsData.set(null))}),F(7,"app-icon",305),h(8),_(9,"translate"),c()()()()}if(n&2){let e=t.ngIf;g("isOpen",!!e)("modalTitle",f(1,5,"workoutBuilder.modal.notesTitle")),a(3),g("disabled",!0),a(),I(e),a(4),C(" ",f(9,7,"workoutBuilder.modal.close")," ")}}function Mc(n,t){if(n&1){let e=D();m(0,"app-modal",306),ee("isOpenChange",function(r){y(e);let o=d();return X(o.isSimpleModalOpen,r)||(o.isSimpleModalOpen=r),b(r)}),F(1,"app-exercise-detail",307),c()}if(n&2){let e=d();g("forceFullScreen",!0),J("isOpen",e.isSimpleModalOpen),g("modalTitle",e.exerciseDetailsName),a(),g("id",e.exerciseDetailsId)("isModal",!0)}}var to=(i=>(i.routineBuilder="routineBuilder",i.customProgramEntryBuilder="customProgramEntryBuilder",i.manualLogEntry="manualLogEntry",i))(to||{});var eo=class n{context="route";initialRoutine=null;mode="routineBuilder";routineConfirmed=new H;modalClose=new H;fb=S(ei);router=S(Dr);route=S(Fr);workoutService=S(ci);trainingService=S(ln);exerciseService=S(He);unitService=S(oi);spinnerService=S(dn);alertService=S(Ur);toastService=S(xt);trackingService=S(ai);cdr=S(ot);ngZone=S(Re);platformId=S(Ut);appSettingsService=S(ni);translate=S(qe);workoutGeneratorService=S(Ii);subscriptionService=S(an);audioService=S(Ti);workoutUtilsService=S(pi);workoutCategoryService=S(Mi);workoutFormService=S(wi);isRoutineMode=!1;availableRepSchemes=[];availableExerciseCategories=[];setRepsInputs;expandedSetElements;expandedExerciseCard;myExerciseInput;isAllExpandedInViewMode=R(!1);expandedExerciseNotes=R(null);exerciseInfoTooltipString=this.translate.instant("workoutBuilder.exerciseInfoTooltip");lastRoutineDuration=0;liveFormAsRoutine;loadedRoutine=R(void 0);lastLoggedRoutineInfo=R({});builderForm;isEditableMode=R(!1);isEditMode=!1;isNewMode=!0;isViewMode=!1;pastSession=!1;currentRoutineId=null;currentProgramId=null;dateParam=null;currentLogId=null;routeSub;initialRoutineIdForLogEdit=void 0;initialProgramIdForLogEdit=void 0;initialProgramIterationIdForLogEdit=void 0;initialProgramScheduledIdForLogEdit=void 0;subscriptions=new Me;expandedSetPath=R(null);expandedExercisePath=R(null);lastLogForCurrentRoutine=ve(()=>{let t=this.liveFormAsRoutine(),e=this.lastLoggedRoutineInfo();return!t||!e?null:e[t.id]||null});availableSetTypes=[{value:"standard",label:this.translate.instant("workoutBuilder.setTypes.standard")},{value:"warmup",label:this.translate.instant("workoutBuilder.setTypes.warmup")},{value:"superset",label:this.translate.instant("workoutBuilder.setTypes.superset")},{value:"amrap",label:this.translate.instant("workoutBuilder.setTypes.amrap")},{value:"dropset",label:this.translate.instant("workoutBuilder.setTypes.dropset")},{value:"failure",label:this.translate.instant("workoutBuilder.setTypes.failure")},{value:"myorep",label:this.translate.instant("workoutBuilder.setTypes.myorep")},{value:"restpause",label:this.translate.instant("workoutBuilder.setTypes.restpause")},{value:"custom",label:this.translate.instant("workoutBuilder.setTypes.custom")}];routineGoals=[{value:"hypertrophy",label:"workoutBuilder.goals.hypertrophy"},{value:"strength",label:"workoutBuilder.goals.strength"},{value:"tabata",label:"workoutBuilder.goals.tabata"},{value:"muscular endurance",label:"workoutBuilder.goals.muscularEndurance"},{value:"cardiovascular endurance",label:"workoutBuilder.goals.cardiovascularEndurance"},{value:"fat loss / body composition",label:"workoutBuilder.goals.fatLoss"},{value:"mobility & flexibility",label:"workoutBuilder.goals.mobility"},{value:"power / explosiveness",label:"workoutBuilder.goals.power"},{value:"speed & agility",label:"workoutBuilder.goals.speed"},{value:"balance & coordination",label:"workoutBuilder.goals.balance"},{value:"skill acquisition",label:"workoutBuilder.goals.skill"},{value:"rehabilitation / injury prevention",label:"workoutBuilder.goals.rehabilitation"},{value:"mental health / stress relief",label:"workoutBuilder.goals.mentalHealth"},{value:"general health & longevity",label:"workoutBuilder.goals.generalHealth"},{value:"sport-specific performance",label:"workoutBuilder.goals.sportSpecific"},{value:"maintenance",label:"workoutBuilder.goals.maintenance"},{value:"rest",label:"workoutBuilder.goals.rest"},{value:"custom",label:"workoutBuilder.goals.custom"}];isExerciseModalOpen=!1;availableExercises=[];availableRoutines=[];availablePrograms=[];availableIterationIds=[];availableScheduledDayIds=[];availableScheduledDayInfos=[];modalSearchTerm=R("");filteredAvailableExercises=ve(()=>{let t=this.modalSearchTerm().toLowerCase();return t?(t=this.exerciseService.normalizeExerciseNameForSearch(t),this.availableExercises.filter(e=>e.name.toLowerCase().includes(t)||e.category&&e.category.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.primaryMuscleGroup&&e.primaryMuscleGroup.toLowerCase().includes(t))):this.availableExercises});selectedExerciseIndicesForSuperset=R([]);selectedExerciseIndicesForMultipleRemoval=R([]);sanitizer=S(Mr);sanitizedDescription="";previousFormState=null;defaultMetricFieldOrder=["reps","weight","distance","duration","rest"];isGeneratorModalOpen=R(!1);isGeneratedRoutine=R(!1);lastGenerationOptions=R(null);constructor(){this.builderForm=this.fb.group({name:[""],description:[""],goal:[""],primaryCategory:[""],secondaryCategory:[""],tags:[""],workoutDate:[""],startTime:[""],endTime:[""],overallNotesLog:[""],routineIdForLog:[""],programIdForLog:[""],iterationIdForLog:[""],scheduledDayIdForLog:[""],exercises:this.fb.array([])});let t=this.builderForm.valueChanges.pipe(ce(this.builderForm.getRawValue()),le(e=>{let i=this.mapFormToRoutine(e);return this.mode==="manualLogEntry"&&this.currentLogId?z(A({},i),{workoutLogId:this.currentLogId}):i}));this.liveFormAsRoutine=Ft(t,{initialValue:void 0}),this.builderForm.valueChanges.pipe(Et(500),ce(this.builderForm.getRawValue()),Bi()).subscribe(([e,i])=>{if(this.originalStateSnapshot||(this.originalStateSnapshot=JSON.parse(JSON.stringify(e))),this.history.length>0&&JSON.stringify(e)!==JSON.stringify(i)&&this.canRestore.set(!0),this.isUndoingOrRedoing){this.isUndoingOrRedoing=!1;return}this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1));let r=this.getActionDescription(e,i);this.history.push({state:JSON.parse(JSON.stringify(i)),action:r}),this.historyIndex++,this.history.length>this.MAX_HISTORY_SIZE&&(this.history.shift(),this.historyIndex--),this.updateHistorySignals(),this.refreshFabMenuItems()})}categories=Ft(this.workoutCategoryService.getTranslatedCategories(),{initialValue:[]});ngOnInit(){console.log("WorkoutBuilderComponent mode:",this.mode,"context:",this.context),window.scrollTo(0,0),this.isRoutineMode=this.mode==="routineBuilder"||this.mode==="customProgramEntryBuilder",this.availableRepSchemes=this.workoutUtilsService.getAvailableRepsSchemes("builder"),this.spinnerService.hide(),this.loadAvailableExercises(),this.subscriptions.add(this.workoutService.routines$.pipe(Fe(1)).subscribe(o=>{this.availableRoutines=o})),this.subscriptions.add(this.trainingService.programs$.pipe(Fe(1)).subscribe(o=>{this.availablePrograms=o})),this.routeSub=this.route.data.pipe(De(o=>{this.isGeneratedRoutine.set(!1),this.context||(this.context="route"),this.context==="route"&&(this.mode=o.mode||"routineBuilder",this.isNewMode=o.isNew===!0),this.context==="modal"&&window.scrollTo(0,0),console.log(`Builder ngOnInit: Mode=${this.mode}, isNewMode=${this.isNewMode}`),console.log(`isNewMode: ${this.isNewMode}`),this.route.snapshot.queryParamMap.get("openGenerator")==="true"&&this.isNewMode&&this.mode==="routineBuilder"&&setTimeout(()=>{this.openWorkoutGenerator()},150),this.isRoutineMode&&this.isNewMode&&this.showCreationWizard(),this.currentRoutineId=this.route.snapshot.paramMap.get("routineId"),this.currentLogId=this.route.snapshot.paramMap.get("logId"),this.currentProgramId=this.route.snapshot.queryParamMap.get("programId"),this.pastSession=this.route.snapshot.queryParamMap.get("pastSession")?!!this.route.snapshot.queryParamMap.get("pastSession"):!1,this.initialProgramIdForLogEdit=this.currentProgramId,this.initialProgramIterationIdForLogEdit=this.route.snapshot.queryParamMap.get("iterationId"),this.initialProgramScheduledIdForLogEdit=this.route.snapshot.queryParamMap.get("scheduledDayId");let l=this.route.snapshot.queryParamMap.get("date");if(this.dateParam=l?new Date(l):null,this.isViewMode=this.isRoutineMode&&!!this.currentRoutineId&&!this.isNewMode&&this.route.snapshot.routeConfig?.path?.includes("view")||!1,this.isEditMode=!this.isNewMode&&!this.isViewMode||this.mode==="customProgramEntryBuilder",this.isEditableMode.set(this.isEditMode||this.isNewMode),console.log(`Builder isEditableMode: Mode=${this.isEditableMode()}`),this.configureFormValidatorsAndFieldsForMode(),this.expandedSetPath.set(null),this.exercisesFormArray.clear({emitEvent:!1}),this.builderForm.reset(this.getDefaultFormValuesForMode(),{emitEvent:!1}),this.isRoutineMode){if(this.mode==="customProgramEntryBuilder"&&this.initialRoutine)return this.loadedRoutine.set(this.initialRoutine),this.patchFormWithRoutineData(this.initialRoutine),oe(null);if(this.currentLogId&&this.isNewMode)return this.trackingService.getWorkoutLogById(this.currentLogId);if(this.currentRoutineId&&(this.isEditMode||this.isViewMode))return this.workoutService.getRoutineById(this.currentRoutineId)}else if(this.mode==="manualLogEntry"){if(this.currentLogId&&this.isEditMode)return this.trackingService.getWorkoutLogById(this.currentLogId);if(this.currentRoutineId&&this.isNewMode)return this.workoutService.getRoutineById(this.currentRoutineId)}return oe(null)}),zt(o=>{o?(this.isEditMode&&(this.originalStateSnapshot=JSON.parse(JSON.stringify(o))),this.mode==="routineBuilder"&&this.currentLogId&&this.isNewMode?this.prefillRoutineFormFromLog(o):this.mode==="routineBuilder"?(this.loadedRoutine.set(o),this.patchFormWithRoutineData(o)):this.mode==="manualLogEntry"&&this.isEditMode&&this.currentLogId?(this.patchFormWithLogData(o),this.loadedRoutine.set(this.mapFormToRoutine(this.builderForm.getRawValue()))):this.mode==="manualLogEntry"&&this.isNewMode&&this.currentRoutineId&&this.prefillLogFormFromRoutine(o)):!this.isNewMode&&(this.currentRoutineId||this.currentLogId)&&(this.toastService.error("Data not found.",0,this.translate.instant("common.error")),this.router.navigate([this.mode==="routineBuilder"?"/workout":"/history/list"])),this.isViewMode?this.expandAllSets():this.toggleFormState(!1),this.refreshFabMenuItems()})).subscribe(),this.subscriptions.add(this.routeSub),this.mode==="manualLogEntry"&&(this.builderForm.get("routineIdForLog")?.valueChanges.subscribe(o=>{if(this.isEditMode&&o===this.initialRoutineIdForLogEdit&&!this.builderForm.get("routineIdForLog")?.dirty||this.isEditMode&&o===this.initialProgramIdForLogEdit&&!this.builderForm.get("programIdForLog")?.dirty)return;let s=this.availableRoutines.find(l=>l.id===o);s?this.prefillLogFormFromRoutine(s,!1):(this.exercisesFormArray.clear(),this.isEditMode||this.builderForm.get("name")?.setValue("Ad-hoc Workout"))}),this.builderForm.get("programIdForLog")?.valueChanges.subscribe(o=>{o?(this.builderForm.get("routineIdForLog")?.disable(),this.initialProgramIdForLogEdit=o,this.retrieveProgramInfo(o),this.builderForm.get("iterationIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("routineIdForLog")?.setValue("",{emitEvent:!1}),this.exercisesFormArray.clear()):(this.builderForm.get("routineIdForLog")?.enable(),this.initialProgramIdForLogEdit=void 0,this.availableIterationIds=[],this.availableScheduledDayIds=[],this.availableScheduledDayInfos=[],this.builderForm.get("iterationIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.setValue("",{emitEvent:!1}))}),this.builderForm.get("scheduledDayIdForLog")?.valueChanges.subscribe(o=>{let s=this.availableScheduledDayInfos.find(l=>l.id===o);if(!s){this.exercisesFormArray.clear(),this.builderForm.get("routineIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("name")?.setValue("Ad-hoc Workout",{emitEvent:!1});return}he(this.workoutService.getRoutineById(s.routineId)).then(l=>{l?(this.builderForm.get("name")?.setValue(`Log: ${l.name}`,{emitEvent:!1}),this.builderForm.get("routineIdForLog")?.setValue(l.id,{emitEvent:!1}),this.exercisesFormArray.clear({emitEvent:!1}),l.exercises.forEach(u=>{this.exercisesFormArray.push(this.workoutFormService.createExerciseFormGroup(u,!1,!0),{emitEvent:!1})}),s.iterationId&&this.builderForm.get("iterationIdForLog")?.setValue(s.iterationId,{emitEvent:!1})):(this.toastService.error(`Routine with ID ${s.routineId} not found.`,0,this.translate.instant("common.error")),this.exercisesFormArray.clear())}).catch(l=>{console.error("Failed to fetch routine for scheduled day:",l),this.toastService.error("Could not load routine details.",0,this.translate.instant("common.error")),this.exercisesFormArray.clear()})}));let t=this.builderForm.get("goal")?.valueChanges.pipe(tt()).subscribe(o=>W(this,null,function*(){if(this.previousGoalValue&&this.previousGoalValue==="tabata")return;if(this.previousGoalValue!==o&&o!=="tabata"&&(this.previousGoalValue=o),this.isRoutineMode&&o==="rest"){for(;this.exercisesFormArray.length;)this.exercisesFormArray.removeAt(0);this.exercisesFormArray.clearValidators()}let s=this.exercisesFormArray.controls;if(this.isRoutineMode&&o==="tabata"){let l=this.exercisesFormArray.controls;if(l.length<2){this.toastService.warning("Tabata routines require at least 2 exercises. Please add more exercises first.",5e3),this.builderForm.get("goal")?.setValue(this.previousGoalValue,{emitEvent:!1});return}let u=yield this.alertService.showConfirm("Convert to Tabata?","This will convert all exercises into a single superset. Each round will be set to 20 seconds of work and 10 seconds of rest. Are you sure?","Convert","Cancel");if(!u||!u.data){this.builderForm.get("goal")?.setValue(this.previousGoalValue,{emitEvent:!1});return}let p=K();l.forEach((x,v)=>{let k=x.get("sets");for(;k.length>1;)k.removeAt(1);if(k.length===0){let T={id:K(),type:"standard",targetRest:ie(10),targetDuration:Ne(20),fieldOrder:["weight","reps"]};k.push(this.workoutFormService.createSetFormGroup(T,!1))}k.at(0).patchValue({targetDuration:20,targetRest:10,targetReps:null,targetWeight:null,targetDistance:null,targetTempo:null},{emitEvent:!1}),x.patchValue({supersetId:p,supersetOrder:v,supersetType:"standard",type:"superset"},{emitEvent:!1})}),this.toastService.info("Routine converted to Tabata format.")}else if(this.isRoutineMode&&this.builderForm.get("goal")?.value!=="tabata"){let l=this.exercisesFormArray.at(0);l&&l.get("supersetId")?.value&&l.get("sets")?.value?.length===this.exercisesFormArray.length&&(this.exercisesFormArray.controls.forEach(u=>{u.patchValue({supersetId:null,supersetOrder:null,type:"standard"},{emitEvent:!1})}),this.toastService.info("Tabata grouping removed.",3e3))}this.exercisesFormArray.updateValueAndValidity()}));this.subscriptions.add(t);let e=this.builderForm.get("description")?.valueChanges.subscribe(o=>{this.updateSanitizedDescription(o||"")});this.subscriptions.add(e);let i=this.builderForm.get("sets")?.valueChanges.subscribe(o=>{this.getRoutineDuration()});this.subscriptions.add(i);let r=this.builderForm.get("supersetRounds")?.valueChanges.subscribe(o=>{this.getRoutineDuration()});this.subscriptions.add(r)}retrieveProgramRoutines(t){let e=this.availablePrograms.find(i=>i.id===t);return e?e.schedule&&e.schedule.length>0?e.schedule:[]:[]}retrieveProgramIterationIds(t){let e=this.availablePrograms.find(i=>i.id===t);return e?e.history&&e.history.length>0?e.history.map(i=>i.id).filter(i=>!!i):e.iterationId?[e.iterationId]:[]:[]}retrieveProgramScheduledDayInfo(t){let e=this.availablePrograms.find(r=>r.id===t);if(!e)return[];let i=[];if(e.schedule&&e.schedule.length>0){let r=e.schedule;i.push(...r)}if(e.weeks&&e.weeks.length>0){let r=e.weeks.flatMap(o=>o.schedule?o.schedule:[]);i.push(...r)}return[...new Set(i)]}retrieveProgramScheduledDayIds(t){let e=this.availablePrograms.find(r=>r.id===t);if(!e)return[];let i=[];if(e.schedule&&e.schedule.length>0){let r=e.schedule.map(o=>o.id).filter(o=>!!o);i.push(...r)}if(e.weeks&&e.weeks.length>0){let r=e.weeks.flatMap(o=>o.schedule?o.schedule.map(s=>s.id).filter(s=>!!s):[]);i.push(...r)}return[...new Set(i)]}onSearchEnter(){let t=this.filteredAvailableExercises();if(t.length===1){let e=t[0];this.selectExercisesFromLibrary([e])}}updateSanitizedDescription(t){this.sanitizedDescription=this.sanitizer.bypassSecurityTrustHtml(t)}getDefaultFormValuesForMode(){let t={name:"",description:"",goal:"",primaryCategory:"",secondaryCategory:"",tags:"",workoutDate:"",startTime:"",endTime:"",overallNotesLog:"",routineIdForLog:"",programIdForLog:"",iterationIdForLog:"",scheduledDayIdForLog:"",exercises:[]};if(this.mode==="manualLogEntry"){let e=new Date;return z(A({},t),{goal:"custom",workoutDate:pe(e,"yyyy-MM-dd"),startTime:pe(e,"HH:mm"),endTime:pe(e,"HH:mm")})}return A({},t)}configureFormValidatorsAndFieldsForMode(){let t=this.builderForm.get("name"),e=this.builderForm.get("goal"),i=this.builderForm.get("workoutDate"),r=this.builderForm.get("startTime"),o=this.builderForm.get("endTime");t?.clearValidators(),e?.clearValidators(),i?.clearValidators(),r?.clearValidators(),o?.clearValidators(),this.isRoutineMode?(t?.setValidators(Oe.required),e?.setValidators(Oe.required),this.builderForm.get("exercises")?.setValidators(Oe.nullValidator)):(i?.setValidators(Oe.required),r?.setValidators(Oe.required),o?.setValidators(Oe.required),this.builderForm.get("exercises")?.setValidators(Oe.required)),this.builderForm.updateValueAndValidity({emitEvent:!1})}toggleFormState(t){t?this.builderForm.disable({emitEvent:!1}):(this.builderForm.enable({emitEvent:!1}),this.isRoutineMode?(this.builderForm.get("workoutDate")?.disable({emitEvent:!1}),this.builderForm.get("startTime")?.disable({emitEvent:!1}),this.builderForm.get("endTime")?.disable({emitEvent:!1}),this.builderForm.get("overallNotesLog")?.disable({emitEvent:!1}),this.builderForm.get("routineIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("programIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("iterationIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.disable({emitEvent:!1})):(this.builderForm.get("description")?.disable({emitEvent:!1}),this.builderForm.get("goal")?.disable({emitEvent:!1}),this.checkIfLogForProgram()&&(this.builderForm.get("programIdForLog")?.disable(),this.builderForm.get("routineIdForLog")?.disable(),this.pastSession?(this.builderForm.get("iterationIdForLog")?.disable(),this.builderForm.get("scheduledDayIdForLog")?.disable()):(this.builderForm.get("iterationIdForLog")?.enable(),this.builderForm.get("scheduledDayIdForLog")?.enable()),this.builderForm.get("workoutDate")?.disable())))}checkIfLogForProgram(){return!!(this.currentProgramId&&this.mode==="manualLogEntry"&&this.dateParam&&this.currentRoutineId)}getLogTitleForProgramEntry(){if(this.checkIfLogForProgram()){let t=this.availablePrograms.find(i=>i.id===this.currentProgramId),e=this.availableRoutines.find(i=>i.id===this.currentRoutineId);if(t)return`Log for Program: ${t.name} - Routine: ${e?.name||"Ad-hoc"}`}return"Ad-hoc Workout"}get exercisesFormArray(){return this.builderForm.get("exercises")}addRepsListener(t){let e=this.setupRepsListener(t);this.subscriptions.add(e)}setupRepsListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(Et(300),ce(null),Ke(r=>{let o=e.controls;return je(o).pipe(Ke((s,l)=>{let p=[s.get("targetReps")?.valueChanges].filter(x=>!!x);return p.length===0?oe(null):je(p).pipe(Wt(),le(()=>({setIndex:l,exerciseId:t.get("id")?.value})),tt((x,v)=>JSON.stringify(x)===JSON.stringify(v)))}))}),et(r=>r!==null)).subscribe(r=>{console.log(`Reps Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}setupDurationListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(Et(300),ce(null),Ke(r=>{let o=e.controls;return je(o).pipe(Ke((s,l)=>{let u=s.get("targetDurationMin"),p=s.get("targetDurationMax"),x=[u?.valueChanges,p?.valueChanges].filter(v=>!!v);return x.length===0?oe(null):je(x).pipe(Wt(),le(()=>({setIndex:l,exerciseId:t.get("id")?.value})),tt((v,k)=>JSON.stringify(v)===JSON.stringify(k)))}))}),et(r=>r!==null)).subscribe(r=>{console.log(`Duration Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}addDurationListener(t){this.setupDurationListener(t)}addDistanceListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(Et(300),ce(null),Ke(r=>{let o=e.controls;return je(o).pipe(Ke((s,l)=>{let p=[s.get("targetDistance")?.valueChanges].filter(x=>!!x);return p.length===0?oe(null):je(p).pipe(Wt(),le(()=>({setIndex:l,exerciseId:t.get("id")?.value})),tt((x,v)=>JSON.stringify(x)===JSON.stringify(v)))}))}),et(r=>r!==null)).subscribe(r=>{console.log(`Distance Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}loadAvailableExercises(){this.exerciseService.getExercises().pipe(Fe(1),De(t=>!t||t.length===0?oe([]):this.exerciseService.getTranslatedExerciseList(t))).subscribe(t=>{this.availableExercises=t})}updateExerciseNamesInForm(){let t=new Map(this.availableExercises.map(e=>[e.id,e.name]));this.exercisesFormArray.controls.forEach(e=>{let i=e,r=i.get("exerciseId")?.value,o=i.get("exerciseName")?.value;if(r){let s=t.get(r);s&&s!==o&&i.get("exerciseName")?.patchValue(s,{emitEvent:!1})}})}patchFormWithRoutineData(t){this.builderForm.patchValue({name:t.name,description:t.description,goal:t.goal??"",primaryCategory:t.primaryCategory??"",secondaryCategory:t.secondaryCategory??"",tags:t.tags?.join(", ")||""}),this.updateSanitizedDescription(t.description||""),this.exercisesFormArray.clear(),t.exercises.forEach(e=>{let i=this.workoutFormService.createExerciseFormGroup(e,!0,!1);this.exercisesFormArray.push(i),this.addRepsListener(i),this.addDurationListener(i)}),this.updateExerciseNamesInForm(),this.builderForm.markAsPristine()}patchFormWithLogData(t){this.initialRoutineIdForLogEdit=t.routineId,this.initialProgramIdForLogEdit=t.programId,this.initialProgramIterationIdForLogEdit=t.iterationId,this.initialProgramScheduledIdForLogEdit=t.scheduledDayId,this.builderForm.patchValue({name:t.routineName||"Logged Workout",workoutDate:pe(si(t.date),"yyyy-MM-dd"),startTime:pe(new Date(t.startTime),"HH:mm"),endTime:t.endTime?pe(new Date(t.endTime),"HH:mm"):t.startTime&&t.durationMinutes?pe(new Date(new Date(t.startTime).getTime()+t.durationMinutes*6e4),"HH:mm"):"",overallNotesLog:t.notes||"",routineIdForLog:t.routineId||"",programIdForLog:t.programId||"",iterationIdForLog:t.iterationId||"",scheduledDayIdForLog:t.scheduledDayId||""}),t.programId&&(this.availableIterationIds=this.retrieveProgramIterationIds(t.programId),this.availableScheduledDayIds=this.retrieveProgramScheduledDayIds(t.programId),this.availableScheduledDayInfos=this.retrieveProgramScheduledDayInfo(t.programId)),this.exercisesFormArray.clear(),t.exercises.forEach(e=>{let i=this.workoutFormService.createExerciseFormGroupFromLoggedExercise(e);this.exercisesFormArray.push(i)}),this.toggleFormState(!1),this.expandedSetPath.set(null),this.builderForm.markAsPristine()}prefillLogFormFromRoutine(t,e=!0){this.currentProgramId&&this.retrieveProgramInfo(this.currentProgramId);let i={name:`${this.translate.instant("workoutBuilder.logEntry.logForProgramTitle",{programName:"",routineName:""})}${t.name}`,routineIdForLog:t.id,iterationIdForLog:this.initialProgramIterationIdForLogEdit,scheduledDayIdForLog:this.initialProgramScheduledIdForLogEdit};if(e){let r=new Date,o=this.dateParam?this.dateParam:r;i.programIdForLog=this.currentProgramId||null,i.workoutDate=pe(o,"yyyy-MM-dd"),i.startTime=pe(o,"HH:mm")}this.builderForm.patchValue(i,{emitEvent:!1}),this.exercisesFormArray.clear({emitEvent:!1}),t.exercises.forEach(r=>{let o=this.workoutFormService.createExerciseFormGroup(r,!0,!0);this.exercisesFormArray.push(o,{emitEvent:!1})}),this.builderForm.markAsDirty()}prefillRoutineFormFromLog(t){this.builderForm.patchValue({name:`${t.routineName||this.translate.instant("workoutBuilder.logEntry.adHocTitle")} - As Routine`,description:t.notes||"",goal:this.availableRoutines.find(e=>e.id===t.routineId)?.goal||"custom"},{emitEvent:!1}),this.updateSanitizedDescription(t.notes||""),this.exercisesFormArray.clear({emitEvent:!1}),t.exercises.forEach(e=>{let i=this.createRoutineExerciseFromLoggedExercise(e);this.exercisesFormArray.push(i,{emitEvent:!1})}),this.toggleFormState(!1),this.builderForm.markAsDirty()}createRoutineExerciseFromLoggedExercise(t){let e=this.availableExercises.find(o=>o.id===t.exerciseId),i=t.sets.map(o=>{let s={id:this.workoutService.generateExerciseSetId(),targetReps:o.repsLogged,targetWeight:o.weightLogged??void 0,targetDuration:o.durationLogged,targetDistance:o.distanceLogged,targetTempo:o.targetTempo,targetRest:o.restLogged??ie(60),type:o.type,notes:o.notes,fieldOrder:o.fieldOrder};return this.workoutFormService.createSetFormGroup(s,!1)}),r=this.fb.group({id:this.workoutService.generateWorkoutExerciseId(),exerciseId:[t.exerciseId,Oe.required],exerciseName:[e?.name||t.exerciseName],notes:[t.notes||""],sets:this.fb.array(i),supersetId:[t.supersetId||null],supersetOrder:[t.supersetOrder??null]});return this.addRepsListener(r),this.addDurationListener(r),r}createRangeValidator(){return t=>(t instanceof ue&&["targetReps","targetDuration","targetRest","targetWeight","targetDistance"].forEach(i=>{let r=t.get(i),o=r?.value;if(o&&typeof o=="object"&&o.type==="range"){let l=o.min??o.minSeconds,u=o.max??o.maxSeconds;if(l!=null&&u!=null&&u<l)r.setErrors({min:!0});else if(r?.hasError("min")){let s=r.errors||{},{min:p}=s,x=cr(s,["min"]);r.setErrors(Object.keys(x).length>0?x:null)}}}),null)}scrollExpandedExerciseIntoView(){let t=this.expandedExercisePath();if(t){let e=this.expandedExerciseCard.get(t.exerciseIndex)?.nativeElement;e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}}scrollExpandedSetIntoView(){let t=this.expandedSetPath();if(t){let e=this.expandedSetElements.get(t.exerciseIndex)?.nativeElement;if(e){let r=e.querySelectorAll(".set-item")[t.setIndex];if(r){let l=r.getBoundingClientRect().top+window.pageYOffset-120;window.scrollTo({top:l,behavior:"smooth"})}}}}scrollIntoView(){setTimeout(()=>{let t=this.exercisesFormArray.length-1,e=this.expandedSetElements.get(t)?.nativeElement;e&&e.scrollIntoView({behavior:"smooth",block:"start"})},2e3)}openExerciseSelectionModal(){this.isViewMode||(this.modalSearchTerm.set(""),this.isExerciseModalOpen=!0,setTimeout(()=>{this.myExerciseInput&&this.myExerciseInput.nativeElement&&this.myExerciseInput?.nativeElement?.focus()}))}closeExerciseSelectionModal(){this.isExerciseModalOpen=!1}onModalSearchTermChange(t){let e=t.target;this.modalSearchTerm.set(e.value)}selectExercisesFromLibrary(t){t.forEach(e=>{let i=this.isExerciseCardioOnly(e.id),r=[];i?r=["duration","distance","rest"]:r=["reps","weight","rest"];let o={id:this.workoutService.generateExerciseSetId(),type:"standard",fieldOrder:r,targetReps:i?void 0:Rt(8),targetWeight:i?void 0:be(10),targetRest:ie(60),targetDuration:i?Ne(60):void 0,targetDistance:i?ze(1):void 0,targetTempo:void 0,notes:void 0},s={id:this.workoutService.generateWorkoutExerciseId(),exerciseId:e.id,exerciseName:e.name,sets:[o],type:"standard",supersetId:null,supersetOrder:null},l;this.isRoutineMode?(l=this.workoutFormService.createExerciseFormGroup(s,!0,!1),this.addRepsListener(l),this.addDurationListener(l),this.addDistanceListener(l),this.exercisesFormArray.push(l)):(l=this.workoutFormService.createExerciseFormGroup(s,!1,!0),this.exercisesFormArray.push(l)),t.indexOf(e)===t.length-1&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.ngZone.run(()=>{this.toggleSetExpansion(this.exercisesFormArray.length-1,0)})},0)})}),this.closeExerciseSelectionModal()}ngAfterViewInit(){this.expandedSetElements.changes.subscribe(t=>{let e=t.first;e&&this.expandedSetPath()&&setTimeout(()=>{e.nativeElement.scrollIntoView({behavior:"smooth",block:"center"})},100)}),this.previousGoalValue=this.builderForm.get("goal")?.value}addSet(t,e){if(this.isViewMode)return;let i=t.get("supersetId")?.value;if(i){this.exercisesFormArray.controls.forEach((s,l)=>{let u=s;if(u.get("supersetId")?.value===i){let p=this.workoutFormService.getSetsFormArray(u),x=this.createSyncedSet(p,s);p.push(x)}});let o=this.workoutFormService.getSetsFormArray(t).length-1}else{let r=this.workoutFormService.getSetsFormArray(t),o=this.createSyncedSet(r,t);r.push(o),this.cdr.detectChanges();let s=r.length-1}this.audioService.playSound("correct"),this.handleAnimationForNewSet(e)}isNewlyAdded(t,e){return this.newlyAddedSets.get(t)===e}handleAnimationForNewSet(t){if(t<0)return;let e=this.exercisesFormArray.controls.at(t);if(!e)return;let i=this.workoutFormService.getSetsFormArray(e).controls.length-1;this.newlyAddedSets.set(t,i),setTimeout(()=>{this.newlyAddedSets.delete(t)},500)}createSyncedSet(t,e){if(t.length>0){let i=t.at(t.length-1).value,r=A({},i);return delete r.id,this.workoutFormService.createSetFormGroup(r,this.mode==="manualLogEntry")}else return this.workoutFormService.createSetFormGroup(void 0,this.mode==="manualLogEntry")}removeSet(t,e,i,r){return W(this,null,function*(){if(r?.stopPropagation(),this.isViewMode)return;let o=t.get("supersetId")?.value,s=this.workoutFormService.getSetsFormArray(t),l=!1;if(o)if(s.length===1){let u=yield this.alertService.showConfirm("Remove Last Round?","This will remove the exercise from the superset. Are you sure?","Remove Exercise","Cancel");if(u&&u.data){this.exercisesFormArray.removeAt(e),l=!0;let p=this.exercisesFormArray.controls.filter(v=>v.get("supersetId")?.value===o),x=p[0]?.get("supersetType")?.value==="emom";p.length<2&&!x?p.length===1&&(p[0].patchValue({supersetId:null,supersetOrder:null,type:"standard"}),this.toastService.info("Superset ungrouped.",2e3)):p.length>0&&this.recalculateSupersetOrders(),this.showUndoWithToast("Exercise removed from superset"),this.audioService.playSound("whoosh")}else return}else this.exercisesFormArray.controls.forEach(u=>{if(u.get("supersetId")?.value===o){let p=this.workoutFormService.getSetsFormArray(u);i<p.length&&p.removeAt(i)}}),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.toasts.roundRemoved")),this.audioService.playSound("whoosh");else if(s.length===1){let u=yield this.alertService.showConfirm(this.translate.instant("compactPlayer.removeLastSet"),this.translate.instant("workoutBuilder.exercise.removeLastSet"),this.translate.instant("workoutBuilder.exercise.remove"),this.translate.instant("common.cancel"));if(u&&u.data)this.exercisesFormArray.removeAt(e),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.toasts.exerciseRemoved")),this.audioService.playSound("whoosh");else return}else s.removeAt(i),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.set.setRemoved")),this.audioService.playSound("whoosh");if(l){let u=this.expandedSetPath();u&&u.exerciseIndex===e&&u.setIndex===i?this.expandedSetPath.set(null):u&&u.exerciseIndex===e&&u.setIndex>i?this.expandedSetPath.set({exerciseIndex:e,setIndex:u.setIndex-1}):u&&u.exerciseIndex>e&&this.expandedSetPath.set({exerciseIndex:u.exerciseIndex-1,setIndex:u.setIndex})}})}showUndoWithToast(t){this.toastService.clearAll(),this.toastService.showWithAction(t,this.translate.instant("common.undo"),()=>this.undoLastChange(),this.translate.instant("common.info"),this.translate.instant("common.actionCompleted"))}toggleSetExpansion(t,e,i){if(this.closeExerciseActionMenu(),i?.stopPropagation(),navigator.vibrate&&navigator.vibrate(50),i&&(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLSelectElement))return;let r=this.expandedSetPath();r?.exerciseIndex===t&&r?.setIndex===e?this.expandedSetPath.set(null):(this.expandedSetPath.set({exerciseIndex:t,setIndex:e}),this.cdr.detectChanges(),setTimeout(()=>{this.scrollExpandedSetIntoView();let s=this.expandedSetElements.find((l,u)=>u===e)?.nativeElement},50))}isSetExpanded(t,e){let i=this.expandedSetPath();return i?.exerciseIndex===t&&i?.setIndex===e}collapseExpandedSet(t=!1,e){e&&e.target.closest(".view-mode-controls")||(this.isAllExpandedInViewMode.set(!1),this.expandedSetPath.set(null),e?.stopPropagation())}getFormErrors(t){let e={};return Object.keys(t.controls).forEach(i=>{let r=t.get(i).errors;if(r&&(e[i]=r),t.get(i)instanceof ue||t.get(i)instanceof qr){let o=this.getFormErrors(t.get(i));Object.keys(o).length>0&&(e[i]=o)}}),e}get f(){return this.builderForm.controls}toggleExerciseSelection(t,e){this.isViewMode||(e?.stopPropagation(),this.toggleExerciseSelectionForMultipleRemoval(t,e),this.toggleExerciseSelectionForSuperset(t,e))}toggleExerciseSelectionForMultipleRemoval(t,e){if(this.isViewMode)return;e?.stopPropagation();let i=e.target;this.selectedExerciseIndicesForMultipleRemoval.update(r=>{let o;return i.checked?o=r.includes(t)?r:[...r,t]:o=r.filter(s=>s!==t),o.sort((s,l)=>s-l)})}removeSelectedExercises(){if(this.isViewMode)return;this.selectedExerciseIndicesForMultipleRemoval().sort((e,i)=>i-e).forEach(e=>{this.exercisesFormArray.removeAt(e)}),this.selectedExerciseIndicesForMultipleRemoval.set([]),this.selectedExerciseIndicesForSuperset.set([]),this.recalculateSupersetOrders(),this.expandedSetPath.set(null),this.audioService.playSound("whoosh")}toggleExerciseSelectionForSuperset(t,e){if(this.isViewMode)return;e?.stopPropagation();let i=e.target;this.selectedExerciseIndicesForSuperset.update(r=>{let o;return i.checked?o=r.includes(t)?r:[...r,t]:o=r.filter(s=>s!==t),o.sort((s,l)=>s-l)})}canRemoveSelectedExercises(){return this.selectedExerciseIndicesForMultipleRemoval().length>0&&!this.isViewMode}canUngroupSelectedExercises(){let t=this.selectedExerciseIndicesForSuperset();if(t.length===0)return!1;let e=Array.from(new Set(t.map(r=>this.exercisesFormArray.at(r).get("supersetId")?.value).filter(r=>!!r)));return Array.from(new Set(e)).length===1}onExerciseDrop(t){if(!this.isViewMode&&t.previousContainer===t.container){let e=this.exercisesFormArray;yi(e.controls,t.previousIndex,t.currentIndex),e.updateValueAndValidity(),this.selectedExerciseIndicesForSuperset.set([]),this.handleSupersetIntegrityAfterDrag(t.previousIndex,t.currentIndex),this.recalculateSupersetOrders(),this.expandedSetPath.set(null)}}handleSupersetIntegrityAfterDrag(t,e){let i=new Set;if(i.add(t),i.add(e),t<e)for(let o=t;o<=e;o++)i.add(o);else for(let o=e;o<=t;o++)i.add(o);let r=new Set;i.forEach(o=>{if(o<this.exercisesFormArray.length){let l=this.exercisesFormArray.at(o).get("supersetId")?.value;l&&r.add(l)}}),r.forEach(o=>{this.exercisesFormArray.controls.forEach(s=>{let l=s;l.get("supersetId")?.value===o&&l.patchValue({supersetId:null,supersetOrder:null})})}),this.recalculateSupersetOrders()}recalculateSupersetOrders(){let t=new Map;this.exercisesFormArray.controls.forEach(e=>{let i=e,r=i.get("supersetId")?.value;r?(t.has(r)||t.set(r,[]),t.get(r).push(i)):i.patchValue({supersetOrder:null},{emitEvent:!1})}),t.forEach((e,i)=>{(e[0].get("supersetType")?.value||"standard")==="standard"&&e.length<2?e.forEach(o=>{o.patchValue({supersetId:null,supersetOrder:null})}):(e.sort((o,s)=>this.exercisesFormArray.controls.indexOf(o)-this.exercisesFormArray.controls.indexOf(s)),e.forEach((o,s)=>{o.patchValue({supersetOrder:s},{emitEvent:!1})}))}),this.exercisesFormArray.updateValueAndValidity({emitEvent:!1})}groupSelectedAsSuperset(){return W(this,null,function*(){if(this.isViewMode)return;let t=this.selectedExerciseIndicesForSuperset().sort((M,N)=>M-N);if(t.length<2){this.toastService.warning("Select at least two exercises",3e3,"Superset Error");return}for(let M=1;M<t.length;M++)if(t[M]!==t[M-1]+1){this.toastService.warning(this.translate.instant("workoutBuilder.toasts.supersetOrderError"),5e3,"Superset Error");return}let e=!1,i=[{text:"STANDARD",role:"confirm",data:"standard",cssClass:"bg-orange-500 text-white"},{text:"EMOM",role:"confirm",data:"emom",cssClass:"bg-teal-500 text-white"}],r=yield this.alertService.showConfirmationDialog("Select Group Type","How would you like to group these exercises?",i);if(!r||!r.data){this.toastService.info("Grouping cancelled.",2e3);return}let o=r.data,s,l=null;if(o==="emom"){e=!0;let M=[{name:"emomTime",type:"number",label:"Time per Round (s)",value:"60",attributes:{min:"10",required:!0}},{name:"numSets",type:"number",label:"Number of Rounds (Sets)",value:"5",attributes:{min:"1",required:!0}}],N=yield this.alertService.showPromptDialog("Set EMOM Details","Configure the EMOM parameters.",M);if(!N||!N.emomTime||!N.numSets)return;l=Number(N.emomTime),s=Number(N.numSets)}else{let M=yield this.alertService.showPromptDialog("Set Superset Rounds","How many rounds (sets) should this superset have?",[{name:"numSets",type:"number",label:"Number of Rounds (Sets)",value:"3",attributes:{min:"1",required:!0}}]);if(!M||!M.numSets){this.toastService.info("Superset creation cancelled.",2e3);return}s=Number(M.numSets)}let u=[],p=t.map(M=>this.exercisesFormArray.at(M)),v=this.unitService.convertWeight(15,this.unitService.currentWeightUnit(),"kg");p.forEach((M,N)=>{let q=M.get("exerciseName")?.value,V=M.get("exerciseId")?.value,te=this.availableExercises.find(ae=>ae.id===V),$=te?te.category!=="cardio":!1;u.push({name:`reps_${N}`,type:"number",label:`${q} - Reps`,value:"8",attributes:{min:"0",required:!0}}),$&&u.push({name:`weight_${N}`,type:"number",label:`${q} - Weight (${this.unitService.getWeightUnitSuffix()})`,value:String(Math.round(v)),attributes:{min:"0"}})});let k=yield this.alertService.showPromptDialog("Set Exercise Targets","Enter the target reps and weight for each set in the group.",u);if(!k){this.toastService.info("Grouping cancelled.",2e3);return}let T=K(),G=t.length;t.forEach((M,N)=>{let q=this.exercisesFormArray.at(M);q.patchValue({supersetId:T,supersetOrder:N,supersetType:o,emomTimeSeconds:l,type:"superset"});let V=q.get("sets"),te={type:"exact",value:Number(k[`reps_${N}`]??8)},$=k[`weight_${N}`]!==void 0?Number(k[`weight_${N}`]):null,ae=$!==null?be(this.unitService.convertWeight($,"kg",this.unitService.currentWeightUnit())):void 0,P=ie(0);o==="standard"&&N===G-1&&(P=ie(60));let ge=[];te&&ge.push("weight"),ae&&ge.push("reps"),P&&ge.push("rest");let Nt={id:K(),type:"superset",targetReps:te,targetWeight:ae,fieldOrder:ge,targetRest:P};V.clear();for(let Te=0;Te<s;Te++){let $e=this.workoutFormService.createSetFormGroup(Nt,!1);V.push($e)}}),this.selectedExerciseIndicesForSuperset.set([]);let B=o==="emom"?`EMOM created for ${s} rounds!`:`Superset created with ${s} rounds!`;this.toastService.success(B,4e3,"Success"),this.expandedSetPath.set(null),this.toggleSetExpansion(t[0],0)})}ungroupSuperset(t){if(this.isViewMode)return;let i=this.exercisesFormArray.at(t).get("supersetId")?.value;i&&(this.exercisesFormArray.controls.forEach(r=>{let o=r;o.get("supersetId")?.value===i&&o.patchValue({supersetId:null,supersetOrder:null,supersetType:"standard",emomTimeSeconds:null})}),this.selectedExerciseIndicesForSuperset.set([]),this.toastService.info("Superset ungrouped",3e3,"Ungrouped"))}removeExercise(t,e){if(this.isViewMode)return;e?.stopPropagation();let r=this.exercisesFormArray.at(t).get("supersetId")?.value;this.exercisesFormArray.removeAt(t),this.selectedExerciseIndicesForSuperset.set([]),r&&this.recalculateSupersetOrders(),this.expandedSetPath.set(null),this.showUndoWithToast("Exercise removed"),this.audioService.playSound("whoosh")}errorMessage=R(null);onSubmit(){return W(this,null,function*(){if(this.isViewMode){this.toastService.info(this.translate.instant("workoutBuilder.toasts.viewMode"),3e3,this.translate.instant("workoutBuilder.toasts.viewMode"));return}this.recalculateSupersetOrders();let t=this.builderForm.getRawValue();if(this.isRoutineMode&&t.goal==="tabata"){let r=this.exercisesFormArray.controls;if(r.length>=2){let o=r[0].get("supersetId")?.value,s=r[0].get("sets").length;if(!o||!r.every(l=>l.get("supersetId")?.value===o)){this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataValidationError1"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}if(!r.every(l=>l.get("sets").length===s)){this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataValidationError2"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}this.exercisesFormArray.controls.forEach(l=>{l.get("sets").controls.forEach(p=>{p.patchValue({targetDuration:20,targetRest:10,targetReps:null,targetWeight:null,targetDistance:null},{emitEvent:!1})})})}else{this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataSizeError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}}let e=this.isRoutineMode&&this.builderForm.get("goal")?.value==="rest";if(this.isRoutineMode&&(this.builderForm.get("name")?.invalid||this.builderForm.get("goal")?.invalid)||this.mode==="manualLogEntry"&&(this.builderForm.get("workoutDate")?.invalid||this.builderForm.get("startTime")?.invalid||this.builderForm.get("endTime")?.invalid)){this.builderForm.markAllAsTouched();let r=[];this.builderForm.get("name")?.invalid&&r.push(this.translate.instant("workoutBuilder.routineBuilder.nameLabel")),this.builderForm.get("goal")?.invalid&&r.push(this.translate.instant("workoutBuilder.routineBuilder.goalLabel")),this.builderForm.get("workoutDate")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.dateLabel")),this.builderForm.get("startTime")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.startTimeLabel")),this.builderForm.get("endTime")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.endTimeLabel")),this.toastService.error(`${this.translate.instant("workoutBuilder.toasts.validationError",{errors:r.join(", ")})}`,0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(!e&&this.exercisesFormArray.length===0){this.toastService.error(this.mode==="manualLogEntry"?this.translate.instant("workoutBuilder.toasts.noExercisesLogError"):this.translate.instant("workoutBuilder.toasts.noExercisesRoutineError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(!e&&!this.validateSupersetIntegrity()){this.toastService.error(this.translate.instant("workoutBuilder.toasts.invalidSupersetError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(this.builderForm.invalid){this.toastService.error(this.translate.instant("workoutBuilder.toasts.formError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.builderForm.markAllAsTouched();return}let i=this.builderForm.getRawValue();this.spinnerService.show(this.isNewMode?"Saving...":"Updating...");try{if(this.isRoutineMode){let r=this.mapFormToRoutine(i),o;if(this.context==="modal"){this.routineConfirmed.emit(r),this.toastService.success("Routine created!",2e3,"Success"),this.modalClose.emit();return}if(this.isNewMode)o=yield this.workoutService.addRoutine(r);else{let s=this.liveFormAsRoutine()?this.liveFormAsRoutine()?.cardColor:"";r.cardColor=s;let l=yield this.workoutService.updateRoutine(r);if(l)o=l;else return}this.toastService.success(`Routine ${this.isNewMode?"created":"updated"}!`,4e3,"Success"),this.isNewMode&&o&&(this.isEditMode=!0,this.isNewMode=!1,this.currentRoutineId=o.id,this.router.navigate(["/workout/routine/edit",o.id],{replaceUrl:!0}))}else{let r=i.workoutDate,o=i.startTime,s=i.endTime,l=`${r}T${o}:00`,u=`${r}T${s}:00`,p=si(l).getTime(),x=si(u).getTime();x<p&&(x+=1440*60*1e3);let v=i.exercises.map(T=>{let G=T.sets.map(B=>({id:B.id||K(),exerciseName:T.exerciseName,plannedSetId:B.plannedSetId,exerciseId:T.exerciseId,type:B.type,repsLogged:B.repsLogged,weightLogged:B.weightLogged?be(this.unitService.convertWeight(this.workoutUtilsService.getWeightValue(B.weightLogged),"kg",this.unitService.currentWeightUnit())):void 0,distanceLogged:B.distanceLogged,durationLogged:B.durationLogged,restLogged:B.restLogged,notes:B.notes,targetReps:B.targetReps,targetWeight:B.targetWeight,targetDuration:B.targetDuration,targetTempo:B.targetTempo,targetRest:B.targetRest,rpe:void 0,timestamp:B.timestamp||new Date().toISOString(),fieldOrder:B.fieldOrder}));return{id:T.id,exerciseId:T.exerciseId,exerciseName:T.exerciseName,notes:T.notes,sets:G,supersetId:T.supersetId,supersetOrder:T.supersetOrder,supersetType:T.supersetType||"standard",emomTimeSeconds:T.emomTimeSeconds||null,type:T.type||"standard"}}),k={date:pe(new Date(p),"yyyy-MM-dd"),startTime:p,endTime:x,durationMinutes:Math.round(x?(x-p)/6e4:(Date.now()-p)/6e4),routineId:i.routineIdForLog||void 0,routineName:i.routineIdForLog?this.availableRoutines.find(T=>T.id===i.routineIdForLog)?.name||i.name||"Workout from Routine":i.name||this.translate.instant("workoutBuilder.logEntry.adHocTitle"),programId:i.programIdForLog||void 0,notes:i.overallNotesLog,exercises:v,iterationId:i.iterationIdForLog||void 0,scheduledDayId:i.scheduledDayIdForLog||void 0,dayName:"AAAA"};if(this.isEditMode&&this.currentLogId){let T=z(A({},k),{id:this.currentLogId});yield this.trackingService.updateWorkoutLog(T),this.toastService.success(this.translate.instant("workoutBuilder.toasts.logUpdated"),4e3,"Success"),this.router.navigate(["/history/log",this.currentLogId])}else{let T=k,G=yield this.trackingService.addWorkoutLog(T);this.toastService.success(this.translate.instant("workoutBuilder.toasts.logSaved"),4e3,"Success"),this.router.navigate(["/history/log",G.id])}}this.builderForm.markAsPristine()}catch(r){console.error("Error saving:",r),this.toastService.error(`Failed to save: ${r.message||"Unknown error"}`,0,"Save Error")}finally{this.spinnerService.hide()}})}handleCancel(){this.context==="modal"?this.modalClose.emit():this.router.navigate([this.mode==="routineBuilder"?"/workout":"/history/list"])}validateSupersetIntegrity(){let t=this.exercisesFormArray.value,e=new Map;for(let i of t)i.supersetId&&(e.has(i.supersetId)||e.set(i.supersetId,[]),e.get(i.supersetId).push(i));for(let[i,r]of e.entries()){let o=r.length>0&&r[0].supersetType==="emom";if(r.length<2&&!o)return!1;if(r.length>1){let s=r.sort((u,p)=>(u.supersetOrder??1/0)-(p.supersetOrder??1/0));for(let u=0;u<s.length;u++)if(s[u].supersetOrder!==u)return!1;let l=s.map(u=>this.exercisesFormArray.controls.findIndex(p=>p.get("id")?.value===u.id));for(let u=1;u<l.length;u++)if(l[u]!==l[u-1]+1)return!1}}return!0}get firstSelectedExerciseIndexForSuperset(){let t=this.selectedExerciseIndicesForSuperset();return t.length>0?t[0]:null}startCurrentWorkout(){if(this.currentRoutineId){let t=this.workoutService.checkPlayerMode(this.currentRoutineId);this.router.navigate([t,this.currentRoutineId])}else this.toastService.error("Cannot start workout: Routine ID is missing",0,this.translate.instant("common.error"))}enableEditMode(){this.isViewMode&&this.currentRoutineId&&(this.isViewMode=!1,this.isEditMode=!0,this.toggleFormState(!1),this.toastService.info("Edit mode enabled",3e3,"Mode Changed"))}ngOnDestroy(){this.subscriptions.unsubscribe()}getSupersetSize(t){return this.workoutService.getSupersetSize(this.liveFormAsRoutine(),t)}getExerciseCardClass(t,e){let i=t.get("supersetId")?.value,r=t.get("supersetType")?.value==="emom",o=!!i&&!r,s=!!i,l=this.selectedExerciseIndicesForSuperset().includes(e),u=t.get("sets")?.value||[],p=u.length>0&&u.every(N=>N.type==="warmup"),x=t.get("supersetOrder")?.value??0,v=this.getSupersetSize(e),k=x===0,T=x===v-1,G=!k&&!T,B=v===1,M={};return r?M={"border-teal-500 dark:border-teal-400 border-r-2 border-l-2":!0,"bg-teal-50 dark:bg-teal-900/10":!l,"bg-teal-100 dark:bg-teal-800/50":l,"rounded-xl border-4":B,"mb-2":B||T,"mt-4":B||k,"rounded-t-xl border-x-2 border-t-2":k&&!B,"border-x-2":!k,"rounded-b-xl border-b-2":T||B}:o?M={"border-primary border-r-2 border-l-2":!0,"bg-orange-100 dark:bg-orange-900/10":!l,"bg-orange-200 dark:bg-orange-800/50":l,"rounded-t-xl border-x-2 border-t-2 mt-2":k,"border-x-2":!k,"rounded-b-xl border-b-2 mb-2":T}:M={"border rounded-xl mb-2":!0,"bg-blue-50 dark:bg-blue-900/40 border-blue-400":p&&!l,"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600":!p&&!l,"mt-5":this.isEditableMode()&&this.selectedExerciseIndicesForSuperset().length>=2&&e===this.firstSelectedExerciseIndexForSuperset},l&&(M["ring-2 ring-yellow-400 dark:ring-yellow-300"]=!0),M["shadow-sm"]=!0,M["cursor-grab"]=this.isEditableMode(),M["cursor-pointer"]=!this.isEditableMode(),M}hasAdjacentSupersets(t){let e=this.exercisesFormArray;if(t<0||t>=e.length)return!1;let i=e.at(t).get("supersetId")?.value;if(!i)return!1;if(t>0){let r=e.at(t-1).get("supersetId")?.value;if(r&&r===i)return!0}if(t<e.length-1){let r=e.at(t+1).get("supersetId")?.value;if(r&&r===i)return!0}return!1}isSupersetSpacing(t){if(t<=0)return!1;let e=this.exercisesFormArray.at(t).get("id")?.value,i=this.exercisesFormArray.at(t-1).get("id")?.value;return t>0&&e&&e!==i}handleTrulyCustomExerciseEntry(t=!1){return W(this,null,function*(){let e=[{name:"exerciseName",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName"),value:"",attributes:{required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName")},{name:"numSets",type:"number",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets"),value:"3",attributes:{min:"1",required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets")},{name:"equipmentNeeded",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment")},{name:"description",type:"textarea",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription")}];t&&this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));let i=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.exercise.newCustomExerciseTitle"),this.translate.instant("workoutBuilder.exercise.newCustomExerciseMsg"),e,this.translate.instant("workoutBuilder.exercise.newCustomExerciseBtn"));if(i&&i.exerciseName){let r=String(i.exerciseName).trim(),o=String(i.description).trim(),s=i.numSets?parseInt(String(i.numSets),10):3;if(!r||s<=0){this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));return}let l=Array.from({length:s},()=>({id:`custom-adhoc-set-${K()}`,fieldOrder:["reps","weight","rest"],targetReps:Wi(8),targetWeight:be(10),targetDuration:void 0,targetRest:ie(60),type:"standard",notes:""})),p={id:`custom-adhoc-ex-${r.trim().toLowerCase().replace(/\s+/g,"-")}-${K()}`,name:r,description:o,category:"custom",muscleGroups:[],primaryMuscleGroup:void 0,imageUrls:[]};this.closeExerciseSelectionModal(),this.exerciseService.addExercise(p);let x={id:this.workoutService.generateWorkoutExerciseId(),exerciseId:p.id,exerciseName:p.name,sets:l,type:"standard",supersetId:null,supersetOrder:null},v=this.workoutFormService.createExerciseFormGroup(x,!0,!1);this.exercisesFormArray.push(v),this.toggleSetExpansion(this.exercisesFormArray.length-1,0),this.addRepsListener(v),this.addDurationListener(v)}else{if(!i)return;this.handleTrulyCustomExerciseEntry(!0);return}})}getRoutineDuration(){return this.liveFormAsRoutine()?this.workoutService.getEstimatedRoutineDuration(this.mapFormToRoutine(this.builderForm.getRawValue())):0}getTotalExerciseCount(){return this.exercisesFormArray.length}mapFormToRoutine(t){let e=this.loadedRoutine(),i=t.tags,r=[];return typeof i=="string"?r=i.split(",").map(s=>s.trim()).filter(s=>s.length>0):Array.isArray(i)&&(r=i),{id:this.currentRoutineId||K(),name:t.name,description:t.description,goal:t.goal,primaryCategory:t.primaryCategory||void 0,secondaryCategory:t.secondaryCategory||void 0,tags:r,exercises:t.goal==="rest"?[]:t.exercises.map(s=>{let l=!!s.supersetId;return{id:s.id||K(),exerciseId:s.exerciseId,exerciseName:s.exerciseName,notes:s.notes,sets:s.sets.map(u=>z(A({},u),{targetWeight:this.unitService.convertWeight(u.targetWeight,"kg",this.unitService.currentWeightUnit())??null,targetDuration:u.targetDuration??null,targetDistance:u.targetDistance??null,targetTempo:u.targetTempo??null})),supersetId:s.supersetId||null,supersetOrder:l?s.supersetOrder:null,supersetType:l?s.supersetType||"standard":null,emomTimeSeconds:l&&s.supersetType==="emom"?s.emomTimeSeconds:null,type:s.type}}),isFavourite:e?.isFavourite,isHidden:e?.isHidden,lastPerformed:e?.lastPerformed,isDisabled:!1,cardColor:e?.cardColor||void 0,createdAt:e?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}isSuperSet(t){let e=this.liveFormAsRoutine()?.exercises;return!(!e||!e[t]?.supersetId)}getRoutineDropdownActionItems(t,e){let i="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-primary flex items-center text-sm hover:text-white dark:hover:text-gray-100 dark:hover:text-white",r="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-red-600 flex items-center text-sm hover:text-gray-100 hover:animate-pulse",o=z(A({},pn),{buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}}),s={label:"actionButtons.edit",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},l={label:"actionButtons.expand",actionKey:"expand",iconName:"ungroup",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},u={label:"actionButtons.collapse",actionKey:"collapse",iconName:"collapse",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},p={label:"actionButtons.delete",actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+r,data:{routineId:t}},x={label:"actionButtons.logs",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},v=[{label:"actionButtons.start",actionKey:"start",iconName:"play",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},{label:"actionButtons.copy",actionKey:"clone",iconName:"copy",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},x];return this.isViewMode&&(v.push(s),this.exercisesFormArray?.length>0&&(v.push(l),v.push(u))),v.push(o),v.push({isDivider:!0}),v.push(p),v}checkEditRoutine(t){return W(this,null,function*(){let e=this.workoutService.getPausedSession();if(this.workoutService.isPausedSession()&&e&&e?.routineId===t){yield this.alertService.showAlert(this.translate.instant("workoutService.alerts.editRunningTitle"),this.translate.instant("workoutService.alerts.editRunningMessage")).then(()=>{});return}this.router.navigate(["/workout/routine/edit",t])})}handleActionMenuItemClick(t,e){let i=this.liveFormAsRoutine()?.id;if(i){switch(t.actionKey){case"start":this.startCurrentWorkout();break;case"edit":this.checkEditRoutine(i);break;case"clone":this.cloneAndEditRoutine(i);break;case"color":this.openColorPicker();break;case"delete":this.deleteRoutine(i);break;case"history":this.goToRoutineHistory(i);break;case"collapse":this.collapseAllSets();break;case"expand":this.expandAllSets();break}this.activeRoutineIdActions.set(null)}}goToRoutineHistory(t){this.router.navigate(["/history/list"],t?{queryParams:{routineId:t}}:{})}activeRoutineIdActions=R(null);toggleActions(t,e){e.stopPropagation(),this.activeRoutineIdActions.update(i=>i===t?null:t)}areActionsVisible(t){return this.activeRoutineIdActions()===t}onCloseActionMenu(){this.activeRoutineIdActions.set(null)}deleteRoutine(t,e){return W(this,null,function*(){let i=yield this.alertService.showConfirm("Delete Routine","Are you sure you want to delete this workout? This action cannot be undone","Delete");if(i&&i.data)try{this.spinnerService.show(),yield this.workoutService.deleteRoutine(t),this.toastService.success("Workout deleted successfully"),this.router.navigate(["/workout"])}catch{this.toastService.error("Failed to delete workout")}finally{this.spinnerService.hide()}})}cloneAndEditRoutine(t,e){return W(this,null,function*(){let i=this.liveFormAsRoutine();if(!i){this.toastService.error("Routine not found for cloning",0,this.translate.instant("common.error"));return}let r=z(A({},structuredClone(i)),{name:i.name+" (Copy)",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});try{this.spinnerService.show(),r=yield this.workoutService.addRoutine(r),this.toastService.success(`Routine "${r.name}" cloned successfully.`,3e3,"Routine Cloned"),this.router.navigate(["/workout/routine/edit",r.id])}catch(o){console.error("Error during routine cloning:",o),this.toastService.error("Failed to clone routine",0,"Clone Failed")}finally{this.spinnerService.hide()}})}checkIfTimedExercise(t){let e=t?.getRawValue();return!e||!e.sets?!1:e.sets.some(i=>i.duration!=null||i.durationMin!=null||i.durationMax!=null||i.durationLogged!=null)}checkIfWeightedExercise(t){return t?.getRawValue()?.sets.some(i=>i.weightLogged||i.targetWeight)}getSetReps(t){let e=t?.getRawValue()?.sets;if(!e||e.length===0)return"";let i=e.map(o=>this.getSetDisplayValue(new ue({targetReps:new Dt(o.targetReps||o.repsLogged),repsLogged:new Dt(o.weightLogged)}),"reps")),r=i.join(", ");return i.every(o=>o===i[0])?"x "+i[0]:(r.length>15&&(r=r.substring(0,15)+"..."),r)}openMetricSchemeModal(t,e,i){return W(this,null,function*(){if(i?.stopPropagation(),this.isViewMode||!(t instanceof ue))return;let r,o=this.getFormControlNameForBuilder(e);if(!o)return;let s=this.mode==="manualLogEntry";switch(e){case"reps":r=$r.filter(p=>p.availableInBuilder&&!s||p.availableInLogs);break;case"weight":r=Kr.filter(p=>p.availableInBuilder&&!s||p.availableInLogs);break;case"duration":r=Yr.filter(p=>p.availableInBuilder&&!s||p.availableInLogs);break;case"distance":r=Jr.filter(p=>p.availableInBuilder&&!s||p.availableInLogs);break;case"rest":r=en.filter(p=>p.availableInBuilder&&!s||p.availableInLogs);break;default:this.toastService.error(`Scheme editing is not supported for metric: ${e}`);return}let l=t.get(o)?.value;if(r=r.filter(p=>p.type!==l?.type),r.length===0){this.toastService.error(`No further available schemes found for metric: ${e}. Consider that while logging metric types different from 'exact' are not allowed`,6e3,this.translate.instant("common.error"));return}let u=yield this.workoutUtilsService.showSchemeModal(e,l??null,r);u&&u.data&&(t.get(o)?.patchValue(u.data),t.markAsDirty())})}getFormControlNameForBuilder(t){let e=this.mode==="manualLogEntry";switch(t){case"reps":return e?this.getLoggedControlName("reps"):this.getTargetControlName("reps");case"weight":return e?this.getLoggedControlName("weight"):this.getTargetControlName("weight");case"duration":return e?this.getLoggedControlName("duration"):this.getTargetControlName("duration");case"distance":return e?this.getLoggedControlName("distance"):this.getTargetControlName("distance");case"rest":return e?this.getLoggedControlName("rest"):this.getTargetControlName("rest");default:return""}}isRangeMode(t,e,i){if(i?.stopPropagation(),!(t instanceof ue))return!1;let r=e?String(e).charAt(0).toUpperCase()+String(e).slice(1):"",o=t.get(`target${r}Min`),s=t.get(`target${r}Max`);return o?.value!=null||s?.value!=null}getSetDurationDisplay(t){if(!t||!t.value||!t.value.sets||t.value.sets.length===0)return"";if(this.mode==="manualLogEntry"){let i=t.getRawValue().sets.map(r=>r.durationLogged).filter(r=>r!=null&&ri(r)>0);return i.length>0?i.join("-"):""}else return this.workoutFormService.getSetsFormArray(t).controls.map(o=>this.getSetDisplayValue(o,this.metricEnum.duration)).filter(o=>o&&o!=="-").join(", ")}getSetDisplayValue(t,e){if(!t)return"-";let i={reps:tn,rest:sn,weight:rn,duration:nn,distance:on,tempo:u=>u?String(u):"-"};if(i[e]){let u=t.get(this.getFormControlName(e))?.value;return i[e](u)||"-"}let r=e?String(e).charAt(0).toUpperCase()+String(e).slice(1):"",o=t.get(`target${r}Min`)?.value,s=t.get(`target${r}Max`)?.value,l=t.get(`target${r}`)?.value;if(o!=null||s!=null){if(o!=null&&s!=null)return o===s?`${o}`:`${o}-${s}`;if(o!=null)return`${o}+`;if(s!=null)return`Up to ${s}`}return l!=null?String(l):"-"}getSetWeightsUsed(t){let e=t?.getRawValue()?.sets;if(!e||e.length===0)return"";let r=e.map(o=>this.getSetDisplayValue(new ue({targetWeight:new Dt(o.targetWeight||o.weightLogged),weightLogged:new Dt(o.weightLogged)}),this.metricEnum.weight)).join(", ");return r.length>15&&(r=r.substring(0,15)+"..."),r}getSetdurationLogged(t){return this.currentLogId?t?.getRawValue()?.sets.map(i=>i.durationLogged?this.workoutUtilsService.getDurationValue(i.durationLogged):"").join(" - "):t?.getRawValue()?.sets.map(i=>i.targetDuration?this.workoutUtilsService.getDurationValue(i.targetDuration):"").join(" - ")}getIconPath(t){if(!t)return oe(this.exerciseService.getIconPath("default-exercise"));let e=this.liveFormAsRoutine()?.exercises.find(i=>i.exerciseId===t);return e?this.exerciseService.getExerciseById(e.exerciseId).pipe(le(i=>{if(i){let r=this.exerciseService.determineExerciseIcon(i,i.name);return this.exerciseService.getIconPath(r)}else return this.exerciseService.getIconPath("default-exercise")})):oe(this.exerciseService.getIconPath("default-exercise"))}checkTextClass(t,e){if(!t)return"text-gray-700 dark:text-gray-300";let i={type:"exact",value:0},r=0,o=0;if(e==="reps"?(i=t.repsLogged??i,o=Gi(t.targetReps)??Gi(Wi(0))):e==="duration"?(r=ri(t.durationLogged)??0,o=ri(t.targetDuration)??0):e==="weight"&&(r=ii(t.weightLogged)??0,o=ii(t.targetWeight)??0),e==="reps"){let s=i.type==="exact"?i.value:i.type==="range"?i.min:void 0;return s&&s>o?"text-green-500 dark:text-green-400":s&&s<o?"text-red-500 dark:text-red-400":"text-gray-800 dark:text-white"}else return r>o?"text-green-500 dark:text-green-400":r<o?"text-red-500 dark:text-red-400":"text-gray-800 dark:text-white"}notesModalsData=R(null);showNotesModal(t){this.notesModalsData.set(t)}expandExerciseCard(t,e){if(this.closeExerciseActionMenu(),e){let l=e.target;if(l.closest("button")||["INPUT","TEXTAREA","SELECT"].includes(l.tagName)||l.closest("#expandedExerciseSetsContainer"))return}if(e?.stopPropagation(),t<0||t>=this.exercisesFormArray.length){this.expandedExercisePath.set(null),this.expandedSetPath.set(null);return}let r=this.exercisesFormArray.at(t).get("supersetId")?.value,o=t;this.expandedExercisePath()?.exerciseIndex===o?(this.expandedExercisePath.set(null),this.expandedSetPath.set(null),this.expandedExerciseNotes.set(null)):(this.expandedExercisePath.set({exerciseIndex:o}),this.scrollExpandedExerciseIntoView())}getSetControl(t,e){return t.get("sets").at(e)}shouldShowExpandedExercise(t){return this.expandedExercisePath()?.exerciseIndex===t}isExerciseDetailModalOpen=R(!1);isSimpleModalOpen=R(!1);exerciseDetailsId="";exerciseDetailsName="";openModal(t,e){e?.stopPropagation(),this.exerciseDetailsId=t.exerciseId,this.exerciseDetailsName=t.exerciseName||"Exercise details",this.isSimpleModalOpen.set(!0)}isExerciseCardioOnlyCtrl(t){let e=t.value?.exerciseId;return this.isExerciseCardioOnly(e)}isExerciseCardioOnly(t){if(!t)return!1;let e=this.availableExercises.find(i=>i.id===t);return e&&e.category?e.category==="cardio":!1}handleEndTimeChange(){let t=this.builderForm.get("workoutDate"),e=this.builderForm.get("startTime"),i=this.builderForm.get("endTime");if(!t||!e||!i)return;let r=t.value,o=e.value,s=i.value;if(!r||!o||!s)return;let l=new Date(`${r}T${o}:00`),u=new Date(`${r}T${s}:00`);if(u.getTime()<l.getTime()){u.setDate(u.getDate()+1);let p=pe(u,"yyyy-MM-dd");t.setValue(p,{emitEvent:!1}),this.toastService.info("End time was before start time, assuming next day")}}retrieveProgramInfo(t){this.availableIterationIds=this.retrieveProgramIterationIds(t),this.availableScheduledDayIds=this.retrieveProgramScheduledDayIds(t),this.availableScheduledDayInfos=this.retrieveProgramScheduledDayInfo(t)}isFormInvalid(){return this.builderForm.invalid||this.exercisesFormArray.length===0&&!(this.isRoutineMode&&this.builderForm.get("goal")?.value==="rest")}getSetTargetDisplay(t,e){let i=this.workoutUtilsService.getSetTargetDisplay(t,e);return i.length>15&&(i=i.substring(0,15)+"..."),i}changeSupersetType(t){return W(this,null,function*(){if(this.isViewMode||!(t instanceof ue))return;let e=t.get("supersetId")?.value;if(!e)return;let r=(t.get("supersetType")?.value||"standard")==="standard"?"emom":"standard",o=60;if(r==="emom"){let s=yield this.alertService.showPromptDialog("Set EMOM Time","Enter the time for each round in seconds (e.g., 60 for EMOM, 120 for E2MOM).",[{name:"emomTime",type:"number",value:"60",attributes:{min:"10",required:!0}}]);if(s&&s.emomTime)o=Number(s.emomTime);else return}else o=null;this.ngZone.run(()=>{this.syncSupersetProperties(e,r,o),this.toastService.success(`Superset converted to ${r.toUpperCase()}`,3e3,"Type Changed"),this.expandedSetPath.set(null),this.toggleSetExpansion(this.getExerciseIndexByControl(t),0),this.cdr.detectChanges()})})}getExerciseIndexByControl(t){return this.exercisesFormArray.controls.findIndex(e=>e===t)}getSetIndexByControl(t){let e=t.parent;return e&&e.controls?e.controls.indexOf(t):-1}getSetPathByControl(t){let e=t.parent;if(!e||!e.controls)return null;let i=e.controls.indexOf(t);if(i===-1)return null;let r=e.parent;if(!r||!r.parent)return null;let o=r.parent.controls.indexOf(r);return o===-1?null:{exerciseIndex:o,setIndex:i}}syncSupersetProperties(t,e,i){this.exercisesFormArray.controls.filter(o=>o.get("supersetId")?.value===t).forEach(o=>{let s=o,l=this.getExerciseIndexByControl(s);s.patchValue({supersetType:e,emomTimeSeconds:i},{emitEvent:!1});let u=0;e==="standard"&&this.isLastInSuperset(l)&&(u=60),this.workoutFormService.getSetsFormArray(s).controls.forEach(x=>{x.patchValue({targetRest:u},{emitEvent:!1})})}),this.cdr.detectChanges()}isFirstInSuperset(t){let e=this.exercisesFormArray.at(t);return e?.get("supersetId")?.value?e.get("supersetOrder")?.value===0:!1}getNumberOfRoundsAsArray(t){let i=this.exercisesFormArray.at(t).get("sets")?.length||0;return Array.from({length:i},(r,o)=>o)}isLastInSuperset(t){let e=this.exercisesFormArray.at(t),i=e?.get("supersetId")?.value,r=this.exercisesFormArray.controls.filter(s=>s.get("supersetId")?.value===i).length,o=e?.get("supersetOrder")?.value;return!i||r==null||o==null?!1:o===r-1}isMiddleInSuperset(t){return this.exercisesFormArray.at(t)?.get("supersetId")?.value?!this.isFirstInSuperset(t)&&!this.isLastInSuperset(t):!1}getIndexOfExercise(t){return this.exercisesFormArray.controls.indexOf(t)}getSupersetGroupExercises(t){let i=this.exercisesFormArray.at(t)?.get("supersetId")?.value;return i?this.exercisesFormArray.controls.filter(r=>r.get("supersetId")?.value===i).sort((r,o)=>(r.get("supersetOrder")?.value??0)-(o.get("supersetOrder")?.value??0)):[]}standarSuperSetOrEmomClass(t,e=!1){let i=" absolute -left-2 top-2 text-white text-xs font-bold rounded-xl shadow-lg z-10 transform translate-x-3 -translate-y-6 p-1";return t.get("supersetType")?.value=="emom"?e?"font-bold text-teal-600 dark:text-teal-400":i+" bg-teal-400 text-white":t.get("supersetType")?.value!=="emom"?e?"font-bold text-primary":i+" bg-primary text-white":""}setLabelClass(t){let e="flex text-white text-xl font-bold rounded-xl shadow-lg z-10 p-1 w-full bg-primary justify-between items-center";return t.get("supersetType")?.value=="emom"?e+" bg-teal-400 text-white":t.get("supersetType")?.value!=="emom"?e+" bg-primary text-white":""}standarSuperSetOrEmomLabel(t){let e=t.get("sets")?.value?.length||1,i=e>1?` (${e} ROUNDS)`:` (${e} ROUND)`;return t.get("supersetType")?.value=="emom"?`EMOM${i} - Every ${t.get("emomTimeSeconds")?.value||60}s`:t.get("supersetType")?.value!=="emom"?`SUPERSET${i}`:""}convertToSingleExerciseEmom(t,e){return W(this,null,function*(){if(this.isViewMode||!(t instanceof ue))return;e?.stopPropagation();let i=this.getExerciseIndexByControl(t);this.expandExerciseCardIfNeeded(i);let r=[{name:"emomTime",type:"number",label:"Time per Round (s)",value:"60",attributes:{min:"10",required:!0}},{name:"numSets",type:"number",label:"Number of Rounds (Sets)",value:"10",attributes:{min:"1",required:!0}}],o=yield this.alertService.showPromptDialog("Create Single-Exercise EMOM","Configure EMOM parameters.",r);if(!o||!o.emomTime||!o.numSets)return;let s=Number(o.emomTime),l=Number(o.numSets),u=t.get("sets"),p=u.length>0?A({},u.at(0).value):{id:K(),type:"standard",targetReps:8,targetRest:60};delete p.id,u.clear();for(let x=0;x<l;x++)u.push(this.workoutFormService.createSetFormGroup(p,!1));t.patchValue({supersetId:K(),supersetOrder:0,supersetType:"emom",emomTimeSeconds:s,type:"superset"})})}isEmomExerciseByIndex(t){let e=this.exercisesFormArray.at(t);return this.isEmom(e)}isEmomExercise(t){let e=this.getExerciseIndexByControl(t),i=this.exercisesFormArray.at(e),r=this.isEmom(i);return t.get("supersetType")?.value==="emom"||r}isStandardSupersetExercise(t){return t.get("supersetType")?.value==="standard"}addRoundToSuperset(t,e){if(e.stopPropagation(),this.isViewMode)return;let i=t.get("supersetId")?.value;if(!i)return;this.exercisesFormArray.controls.forEach(o=>{let s=o;if(s.get("supersetId")?.value===i){let l=this.workoutFormService.getSetsFormArray(s),u=this.createSyncedSet(l,o),p=this._getCorrectRestForSupersetExercise(s);u.get("targetRest")?.setValue(p,{emitEvent:!1}),l.push(u)}}),this.toastService.success("Round added to superset.",2e3);let r=this.getExerciseIndexByControl(t);this.handleAnimationForNewSet(r)}removeRoundFromSuperset(t,e){if(e.stopPropagation(),this.isViewMode)return;let i=t.get("supersetId")?.value;i&&(this.exercisesFormArray.controls.forEach(r=>{let o=r;if(o.get("supersetId")?.value===i){let s=this.workoutFormService.getSetsFormArray(o);s.length>1&&s.removeAt(s.length-1)}}),this.toastService.info("Round removed from superset.",2e3))}isEmom(t){return t.get("supersetType")?.value==="emom"}checkIfWeightIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetWeight,"weight");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfRepsIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetReps,"reps");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfDistanceIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetDistance,"distance");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfDurationIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetDuration,"duration");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfRestIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetRest,"rest");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfNotesIsVisible(t){return t?typeof t.get=="function"?typeof t.getRawValue=="function"&&t.getRawValue()&&t.getRawValue().sets?t.getRawValue().sets.some(e=>!!e.notes):!!t.get("notes")?.value:!!t.notes:!1}getGridColsForViewExercise(t){let e=this.isEmom(t),i=1,r=t.get("sets");if(r&&r.length>0){let l=this.getIndexOfExercise(t),u=this.getVisibleColumnsForExercise(l);u.reps&&i++,u.weight&&i++,u.distance&&i++,u.duration&&i++,u.rest&&i++,this.checkIfNotesIsVisible(t)&&i++}let o;switch(i){case 1:o="grid-cols-1";break;case 2:o="grid-cols-2";break;case 3:o="grid-cols-3";break;case 4:o="grid-cols-4";break;case 5:o="grid-cols-5";break;case 6:o="grid-cols-6";break;case 7:o="grid-cols-7";break;default:o="grid-cols-2"}return`grid ${o}`}activeExerciseActionMenu=R(null);isExerciseActionMenuVisible(t){return this.activeExerciseActionMenu()===t}toggleExerciseActionMenu(t,e){e.stopPropagation(),this.activeExerciseActionMenu.update(i=>i===t?null:t)}closeExerciseActionMenu(){this.activeExerciseActionMenu.set(null)}fabMenuItems=[];refreshFabMenuItems(){let t=this.isRoutineMode?!!this.currentRoutineId:!!this.isNewMode;if(this.isEditableMode()){if(this.fabMenuItems=[{label:"fab.add_exercise",actionKey:"add_exercise",iconName:"plus-circle",cssClass:"bg-green-500 focus:ring-green-400",isPremium:!1},{label:this.mode==="routineBuilder"?"fab.save_routine":this.isNewMode?"fab.save_log":"fab.save_log_changes",actionKey:"save_routine",iconName:"save",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1},{label:"fab.start",actionKey:"start",iconName:"play",cssClass:"bg-blue-400 focus:ring-blue-600",isPremium:!1}],this.canRestore()&&this.fabMenuItems.unshift({label:"fab.restore",actionKey:"restore",iconName:"restore",cssClass:"bg-red-500 focus:ring-red-400"}),this.canRedo()){let e=this.nextRedoAction;this.fabMenuItems.unshift({label:this.translate.instant("fab.redo")+(e?` (${e})`:""),actionKey:"redo",iconName:"redo",cssClass:"bg-blue-500 focus:ring-blue-400"})}if(this.canUndo()){let e=this.nextUndoAction;this.fabMenuItems.unshift({label:this.translate.instant("fab.undo")+(e?` (${e})`:""),actionKey:"undo",iconName:"undo",cssClass:"bg-yellow-500 focus:ring-yellow-400"})}this.subscriptionService.canAccess("workout_generator")&&this.fabMenuItems.unshift({label:"fab.generate",actionKey:"generate_workout",iconName:"magic-wand",cssClass:"bg-purple-500 focus:ring-purple-400",isPremium:!0})}else this.fabMenuItems=[{label:"fab.start",actionKey:"start",iconName:"play",cssClass:"bg-blue-400 focus:ring-blue-600",isPremium:!1},{label:"fab.edit",actionKey:"edit",iconName:"edit",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1}]}onFabAction(t){switch(t){case"add_exercise":this.openExerciseSelectionModal();break;case"save_routine":this.onSubmit();break;case"start":this.startCurrentWorkout();break;case"edit":let e=this.liveFormAsRoutine()?.id;if(!e)return;this.checkEditRoutine(e);break;case"undo":this.undoLastChange();break;case"redo":this.redoLastChange();break;case"restore":this.restoreOriginal();break;case"generate_workout":this.openWorkoutGenerator();break;case"regenerate_workout":this.regenerateWorkout();break}}regenerateWorkout(){return W(this,null,function*(){let t=this.lastGenerationOptions();t?yield this.handleWorkoutGeneration(t):yield this.handleWorkoutGeneration("quick")})}resetTemplateAndStardWizard(){this.showCreationWizard()}isSwitchExerciseModalOpen=R(!1);exerciseToSwitchIndex=R(null);isShowingSimilarInSwitchModal=R(!1);exercisesForSwitchModal=R([]);handleExerciseActionMenuItemClick(t,e,i){switch(t.actionKey){case"ungroup":this.ungroupSuperset(e);break;case"make_emom":this.convertToSingleExerciseEmom(i);break;case"switchExercise":this.openSwitchExerciseModal(e);break;case"fill_latest":this.fillWithLatestPerformanceData(e);break;case"toggle_notes":this.toggleExerciseNotes(e);break;case"remove":this.removeExercise(e);break}this.closeExerciseActionMenu()}getExerciseActionMenuItems(t){let e=[],i=!!t.get("supersetId")?.value,r=this.getExerciseIndexByControl(t),o=this.isFirstInSuperset(r);return i?o&&e.push({label:"Ungroup",buttonClass:"bg-purple-500 text-white hover:bg-purple-700",actionKey:"ungroup",iconName:"ungroup"}):(e.push({label:this.translate.instant("workoutBuilder.exercise.remove"),buttonClass:"bg-red-500 text-white hover:bg-red-700",actionKey:"remove",iconName:"trash"}),e.push({label:this.translate.instant("workoutBuilder.exercise.fillWithLast"),buttonClass:"bg-green-500 text-white hover:bg-green-700 text-left",actionKey:"fill_latest",iconName:"task"}),e.push({label:this.translate.instant("workoutBuilder.exercise.toggleNotes"),buttonClass:"bg-yellow-500 text-gray-500 hover:bg-yellow-700 rounded-full focus:outline-none flex items-center p-2 transition-colors",actionKey:"toggle_notes",iconName:"clipboard-list"}),e.push({label:"Make EMOM",buttonClass:"bg-teal-500 text-white hover:bg-teal-700",actionKey:"make_emom",iconName:"clock"}),e.push({label:"Switch Exercise",buttonClass:"bg-blue-500 text-white hover:bg-blue-700",actionKey:"switchExercise",iconName:"change"})),e}openSwitchExerciseModal(t,e){e?.stopPropagation(),this.exerciseToSwitchIndex.set(t),this.exercisesForSwitchModal.set(this.availableExercises),this.isShowingSimilarInSwitchModal.set(!1),this.modalSearchTerm.set(""),this.isSwitchExerciseModalOpen.set(!0)}closeSwitchExerciseModal(){this.isSwitchExerciseModalOpen.set(!1),this.exerciseToSwitchIndex.set(null)}findAndShowSimilarExercises(){return W(this,null,function*(){let t=this.exerciseToSwitchIndex();if(t===null)return;let i=this.exercisesFormArray.at(t).get("exerciseId")?.value,r=this.availableExercises.find(o=>o.id===i);if(!r){this.toastService.error("Could not find the base exercise to search for similar ones.");return}try{let o=yield he(this.exerciseService.getSimilarExercises(r,12));o.length===0&&this.toastService.info("No similar exercises found."),this.exercisesForSwitchModal.set(o),this.isShowingSimilarInSwitchModal.set(!0)}catch{this.toastService.error("Failed to load similar exercises.")}})}onBackToSearchFromSimilar(){this.exercisesForSwitchModal.set(this.availableExercises),this.isShowingSimilarInSwitchModal.set(!1),this.modalSearchTerm.set("")}handleExerciseSwitch(t){let e=this.exerciseToSwitchIndex();if(e===null)return;let i=this.exercisesFormArray.at(e),r=i.get("exerciseName")?.value;i.patchValue({exerciseId:t.id,exerciseName:t.name}),this.toastService.success(`Switched '${r}' to '${t.name}'.`),this.closeSwitchExerciseModal()}expandAllSets(){this.isViewMode&&(this.expandedSetPath.set(null),this.isAllExpandedInViewMode.set(!0))}collapseAllSets(){this.isViewMode&&(this.expandedSetPath.set(null),this.isAllExpandedInViewMode.set(!1))}removeLastSet(t,e){return W(this,null,function*(){if(e.stopPropagation(),this.isViewMode)return;let i=this.workoutFormService.getSetsFormArray(t);if(i.length===0)return;let r=this.getExerciseIndexByControl(t),o=i.length-1;yield this.removeSet(t,r,o,e)})}fillWithLatestPerformanceData(t,e){return W(this,null,function*(){if(this.isViewMode){this.toastService.info("Cannot modify data in view mode.",3e3);return}e?.stopPropagation(),this.expandExerciseCardIfNeeded(t);let i=this.exercisesFormArray.at(t);if(!i){console.error(`Exercise control at index ${t} not found.`);return}let r=i.get("exerciseId")?.value;if(!r){this.toastService.warning("Please select an exercise first.",3e3);return}this.spinnerService.show("Loading last performance...");try{let o=yield he(this.trackingService.getLastPerformanceForExercise(r));if(!o||o.sets.length===0){this.toastService.info("No recent performance data found for this exercise.",3e3);return}this.workoutFormService.getSetsFormArray(i).controls.forEach((l,u)=>{let p=o.sets[u];if(p){let x={},v=p.weightLogged!=null?this.unitService.convertWeight(ii(p.weightLogged),this.unitService.currentWeightUnit(),"kg"):null;this.mode==="manualLogEntry"?(x.repsLogged=p.repsLogged,x.weightLogged=v,x.durationLogged=p.durationLogged,x.distanceLogged=p.distanceLogged,x.tempoLogged=p.tempoLogged):(x.targetReps=p.repsLogged,x.targetWeight=v,x.targetDuration=p.durationLogged,x.targetDistance=p.distanceLogged,x.targetTempo=p.tempoLogged),l.patchValue(x)}}),this.builderForm.markAsDirty(),this.toastService.success("Sets pre-filled with your last performance data.",3e3,"Success")}catch(o){console.error("Failed to load performance data:",o),this.toastService.error("Could not load performance data.",0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}})}getSetDistanceDisplay(t){function e(i){return i!=null}if(!t||!t.value||!t.value.sets||t.value.sets.length===0)return"";if(this.mode==="manualLogEntry"){let i=t.getRawValue();if(!i.sets||i.sets.length===0)return"";let r=[];for(let o of i.sets){let s=o?.distanceLogged;if(s==null)continue;let l=this.workoutUtilsService.getDistanceValue(s);typeof l=="number"&&l>0&&(s.type==="exact"?r.push(String(s.value)):s.type==="range"&&r.push(`${s.min}-${s.max}`))}return r.length>0?r.join("-"):""}else return this.workoutFormService.getSetsFormArray(t).controls.map(s=>this.getSetDisplayValue(s,"distance")).filter(s=>s&&s!=="-").join(", ")}cardColors=["#7f1d1d","#86198f","#4a044e","#1e1b4b","#1e3a8a","#064e3b","#14532d","#b91c1c","#c026d3","#701a75","#312e81","#2563eb","#047857","#15803d","#f97316","#ca8a04","#4d7c0f","#0f766e","#0369a1","#1d4ed8","#5b21b6"];openColorPicker(){return W(this,null,function*(){let t=this.liveFormAsRoutine();if(!t)return;let e=this.cardColors.map(r=>({text:"",role:"confirm",data:r,cssClass:"color-swatch",styles:{"background-color":r,width:"40px",height:"40px","border-radius":"50%",border:"2px solid white","box-shadow":"0 2px 4px rgba(0,0,0,0.2)"}}));e.push({text:"Clear Color",role:"confirm",data:"clear",cssClass:"bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 mt-4 col-span-5",icon:"trash"});let i=yield this.alertService.showConfirmationDialog(`Select a Color for "${t.name}"`,"",e,{customButtonDivCssClass:"grid grid-cols-5 gap-3 justify-center"});if(i&&i.data){i.data==="clear"?delete t.cardColor:t.cardColor=i.data;let r=yield this.workoutService.updateRoutine(t);this.toastService.success(`Color updated for "${t.name}"`)}})}getCardValueTextColor(){return"text-gray-700 dark:text-gray-200"}getCardTitleTextColor(){if(!this.liveFormAsRoutine()||this.liveFormAsRoutine()===void 0)return"";let t=this.liveFormAsRoutine();return t===void 0?"":t.cardColor?t.cardColor?"text-white":"":"text-gray-600 dark:text-gray-200"}previousGoalValue=null;getUniformSetValues(t){let e=this.workoutFormService.getSetsFormArray(t);if(!e||e.length===0)return null;let i=this.getIndexOfExercise(t),r=this.getVisibleColumnsForExercise(i),o=Object.keys(r).filter(v=>r[v]);if(o.length===0)return null;let s=e.at(0),l={};o.forEach(v=>{let k=this.getFormControlName(v),T=s.get(k);l[v]=T?this.workoutUtilsService.formatMetricTarget(T.value,v):"-"});let u=new Set(o);for(let v=1;v<e.length;v++){let k=e.at(v);for(let T of Array.from(u)){let G=this.getFormControlName(T),B=k.get(G);(B?this.workoutUtilsService.formatMetricTarget(B.value,T):"-")!==l[T]&&u.delete(T)}if(u.size===0)break}let p={},x=!1;for(let v of u){let k=l[v];k&&k!=="-"&&(p[v]=k,x=!0)}return x?p:null}getFieldsForSet(t,e){let i=this.liveFormAsRoutine();return i?this.workoutUtilsService.getFieldsForSet(i,t,e):this.workoutUtilsService.defaultHiddenFields()}promptRemoveField(t,e){return W(this,null,function*(){let i=this.liveFormAsRoutine();if(!i)return;let r=this.mode==="manualLogEntry",o=yield this.workoutUtilsService.promptRemoveField(i,t,e,r);if(o){let s=o.exercises[t].sets[e],l=this.workoutFormService.getSetsFormArray(this.exercisesFormArray.at(t)),u=this.workoutFormService.createSetFormGroup(s,this.mode==="manualLogEntry");l.setControl(e,u)}})}promptAddField(t,e){return W(this,null,function*(){let i=this.liveFormAsRoutine();if(!i)return;let r=this.mode==="manualLogEntry",o=yield this.workoutUtilsService.promptAddField(i,t,e,r);if(o){let s=o.exercises[t].sets[e],l=this.workoutFormService.getSetsFormArray(this.exercisesFormArray.at(t)),u=this.workoutFormService.createSetFormGroup(s,this.mode==="manualLogEntry");l.setControl(e,u)}})}getVisibleColumnsForExercise(t){let e=this.liveFormAsRoutine();if(!e)return{};let i=this.mode==="manualLogEntry";return this.workoutUtilsService.getVisibleExerciseColumns(e,t,i)}getGridClassForExercise(t){let e=this.getVisibleColumnsForExercise(t),i=2;return e.reps&&i++,e.weight&&i++,e.distance&&i++,e.duration&&i++,e.rest&&i++,this.isEmomExerciseByIndex(t)||i+1,`grid-cols-${Math.max(2,i)}`}toggleExerciseNotes(t,e){e?.stopPropagation(),this.expandedExerciseNotes.update(i=>i===t?null:t),this.expandExerciseCardIfNeeded(t),setTimeout(()=>{document.getElementById(`exerciseNotes-${t}`)?.focus()},300)}expandExerciseCardIfNeeded(t){(!this.expandedExercisePath()||this.expandedExercisePath()?.exerciseIndex!==t)&&this.expandExerciseCard(t)}getCollapsedSetRowClass(t,e){let i=this.getVisibleColumnsForExercise(t),r=2;i.reps&&r++,i.weight&&r++,i.distance&&r++,i.duration&&r++,i.rest&&r++;let o=`grid-cols-${Math.max(2,r)}`,s=this.exercisesFormArray.at(t),u=this.workoutFormService.getSetsFormArray(s).at(e);if(!(u instanceof ue))return`grid ${o} bg-white dark:bg-gray-800`;let p=u.get("type")?.value,x="bg-white dark:bg-gray-800";return p==="standard"?x="bg-gray-50 dark:bg-gray-700/50":p==="warmup"&&(x="bg-blue-50 dark:bg-blue-900/40"),`grid ${o} ${x}`}undoLastChange(){if(!this.canUndo())return;this.isUndoingOrRedoing=!0,this.historyIndex--;let t=this.history[this.historyIndex];this.restoreFormState(t.state),this.toastService.info(this.translate.instant("workoutBuilder.toasts.undoSuccessful")),this.updateHistorySignals(),this.refreshFabMenuItems(),this.audioService.playSound("magic")}redoLastChange(){if(!this.canRedo())return;this.isUndoingOrRedoing=!0,this.historyIndex++;let t=this.history[this.historyIndex];this.restoreFormState(t.state),this.toastService.info(this.translate.instant("workoutBuilder.toasts.redoSuccessful")),this.updateHistorySignals(),this.refreshFabMenuItems()}restoreOriginal(){return W(this,null,function*(){if(!this.canRestore()||!this.originalStateSnapshot)return;let t=yield this.alertService.showConfirm("Restore Original","Are you sure you want to discard all changes and restore the routine to its original state?","Restore");t&&t.data&&(this.isUndoingOrRedoing=!0,this.restoreFormState(this.originalStateSnapshot),this.history=[JSON.parse(JSON.stringify(this.originalStateSnapshot))],this.historyIndex=0,this.toastService.success("Routine has been restored to its original state."),this.updateHistorySignals(),this.canRestore.set(!1)),this.refreshFabMenuItems()})}restoreFormState(t){if(!t)return;this.exercisesFormArray.clear({emitEvent:!1}),(t.exercises||[]).forEach(i=>{let r=this.workoutFormService.createExerciseFormGroup(i,!0,this.mode==="manualLogEntry");this.exercisesFormArray.push(r,{emitEvent:!1})}),this.builderForm.patchValue(t)}history=[];historyIndex=-1;MAX_HISTORY_SIZE=20;isUndoingOrRedoing=!1;canUndo=R(!1);canRedo=R(!1);canRestore=R(!1);originalStateSnapshot=null;updateHistorySignals(){this.canUndo.set(this.historyIndex>0),this.canRedo.set(this.historyIndex<this.history.length-1)}handleWorkoutGeneration(t){return W(this,null,function*(){this.isGeneratorModalOpen.set(!1),this.spinnerService.show("Generating your workout...");let e=null;try{if(t==="quick"?(this.lastGenerationOptions.set(null),e=yield this.workoutGeneratorService.generateQuickWorkout()):e=yield this.workoutGeneratorService.generateWorkout(t),!e){this.errorMessage.set("Could not generate a workout with the selected options. Please try different criteria."),this.isGeneratedRoutine.set(!1),this.lastGenerationOptions.set(null);return}t!=="quick"?this.lastGenerationOptions.set(t):this.lastGenerationOptions.set(null),this.patchFormWithRoutineData(e),this.builderForm.markAsDirty(),this.isGeneratedRoutine.set(!0),this.toastService.success("Workout generated successfully!")}catch(i){this.errorMessage.set(i.message||"An unknown error occurred during workout generation.")}finally{this.spinnerService.hide(),this.refreshFabMenuItems()}})}openWorkoutGenerator(){this.isGeneratorModalOpen.set(!0)}isPartOfExpandedSuperset(t){let i=this.exercisesFormArray.at(t)?.get("supersetId")?.value;if(!i)return!1;let r=this.exercisesFormArray.controls.findIndex(s=>s.get("supersetId")?.value===i&&s.get("supersetOrder")?.value===0);return this.expandedExercisePath()?.exerciseIndex===r}baseExercise(){let t=this.exercisesFormArray.length>0?this.exercisesFormArray.at(0).get("exerciseId")?.value:void 0;return this.availableExercises.find(e=>e.id===t)}isBodyweight=ve(()=>this.baseExercise()?.category==="bodyweight-calisthenics");isCardio=ve(()=>this.baseExercise()?.category==="cardio");expandedSetAllPanel=R(null);repsToSetForAll=R(null);weightToSetForAll=R(null);durationToSetForAll=R(null);distanceToSetForAll=R(null);restToSetForAll=R(null);tempoToSetForAll=R(null);toggleSetAllPanel(t,e){e.stopPropagation(),this.expandedSetAllPanel.update(i=>i===t?null:t)}repsStep=1;weightStep=.1;durationStep=5;distanceStep=.1;restStep=5;applyToAllSets(t){let e=this.exercisesFormArray.at(t),i=this.workoutFormService.getSetsFormArray(e),r={},o=[];function s(k,T,G=!1){if(k==null)return null;let B=Number(k);return isNaN(B)?null:(B=Math.abs(B),G?Math.round(B*100)/100:Math.round(B/T)*T)}let l=s(this.repsToSetForAll(),this.repsStep);if(l!==null){let k=this.mode==="manualLogEntry"?"repsLogged":"targetReps";r[k]=Rt(l),o.push("reps")}let u=s(this.weightToSetForAll(),this.weightStep,!0);if(u!==null){let k=this.mode==="manualLogEntry"?"weightLogged":"targetWeight";r[k]=be(u),o.push("weight")}let p=s(this.durationToSetForAll(),this.durationStep);if(p!==null){let k=this.mode==="manualLogEntry"?"durationLogged":"targetDuration";r[k]=Ne(p),o.push("duration")}let x=s(this.distanceToSetForAll(),this.distanceStep);if(x!==null){let k=this.mode==="manualLogEntry"?"distanceLogged":"targetDistance";r[k]=ze(x),o.push("distance")}let v=s(this.restToSetForAll(),this.restStep);if(v!==null){let k=this.mode==="manualLogEntry"?"restLogged":"targetRest";r[k]=ie(v),o.push("rest")}if(this.tempoToSetForAll()!==null&&this.tempoToSetForAll().trim()!==""&&(r.targetTempo=this.tempoToSetForAll(),o.push("tempo")),Object.keys(r).length===0){this.toastService.info("No values entered to apply.");return}i.controls.forEach(k=>{let T=k,G=T.get("fieldOrder")?.value?[...T.get("fieldOrder")?.value]:[],B=!1;o.forEach(M=>{let N=this.getFormControlName(M);if(N&&!T.get(N)&&(T.addControl(N,this.fb.control(null)),this.isRoutineMode&&["reps","weight","duration","distance","rest"].includes(M))){let q=M.charAt(0).toUpperCase()+M.slice(1);T.addControl(`target${q}Min`,this.fb.control(null)),T.addControl(`target${q}Max`,this.fb.control(null))}G.includes(M)||(G.push(M),B=!0)}),B&&T.get("fieldOrder")?.patchValue(G),T.patchValue(r)}),this.repsToSetForAll.set(null),this.weightToSetForAll.set(null),this.durationToSetForAll.set(null),this.distanceToSetForAll.set(null),this.restToSetForAll.set(null),this.tempoToSetForAll.set(null),this.expandedSetAllPanel.set(null),this.toastService.success(`Applied values to all ${i.length} sets/rounds.`)}_getCorrectRestForSupersetExercise(t){if(!(t instanceof ue))return 0;let e=t.get("supersetType")?.value,i=t.get("supersetId")?.value;if(e==="emom"||!i)return 0;if(e==="standard"){let r=this.getExerciseIndexByControl(t);if(this.isLastInSuperset(r))return 60}return 0}isDraggingEnabled(t){return this.isEditableMode()&&!this.shouldShowExpandedExercise(t)&&!this.isSuperSet(t)}metricEnum=ti;repsTargetTypeEnum=Ni;restTargetTypeEnum=Xr;weightTargetTypeEnum=jr;durationTargetTypeEnum=Zr;distanceTargetTypeEnum=Qr;isGhostFieldVisible(t,e){return!!(this.isEditableMode()&&!this.isSuperSet(e)&&t&&t.length!==void 0&&(t.length<=1||t.length>2&&t.length%2==1))}intervalId=null;onShortPressIncrement(t,e){this.incrementValue(t,e)}onLongPressIncrement(t,e){this.isLongPressing=!0,this.intervalId=setInterval(()=>this.incrementValue(t,e),200)}onShortPressDecrement(t,e){this.decrementValue(t,e)}onLongPressDecrement(t,e){this.isLongPressing=!0,this.intervalId=setInterval(()=>this.decrementValue(t,e),200)}onPressRelease(){this.isLongPressing=!1,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}incrementValue(t,e){let i=this.appSettingsService.getSettings(),r=e==="weight",o=e==="duration"||e==="rest",s=r?i.weightStep||.5:1,l=this.getFormControlName(e),u=t.get(l);if(!u)return;let p=u.value;if(p&&typeof p=="object"&&p.type)switch(p.type){case"exact":case"min_plus":let v=p.seconds!==void 0?"seconds":"value";u.patchValue(z(A({},p),{[v]:Math.max(0,(p[v]||0)+s)}));break;case"range":o?u.patchValue(z(A({},p),{minSeconds:p.minSeconds!=null?Math.max(0,p.minSeconds+s):p.minSeconds,maxSeconds:p.maxSeconds!=null?Math.max(0,p.maxSeconds+s):p.maxSeconds})):u.patchValue(z(A({},p),{min:p.min!=null?Math.max(0,p.min+s):p.min,max:p.max!=null?Math.max(0,p.max+s):p.max}));break;case"percentage_1rm":u.patchValue(z(A({},p),{percentage:Math.min(100,(p.percentage||0)+s)}));break;default:break}else{let v=p?.toString()||"0",k=o?this.parseTimeToSeconds(v)||0:parseFloat(v)||0,T=parseFloat((k+s).toFixed(2));u.patchValue(T)}t.markAsDirty();let x=t.get("id")?.value;x&&!this.isLongPressing&&this.triggerAnimation(x)}decrementValue(t,e){let i=this.appSettingsService.getSettings(),r=e==="weight",o=e==="duration"||e==="rest",s=r?i.weightStep||.5:1,l=this.getFormControlName(e),u=t.get(l);if(!u)return;let p=u.value;if(p&&typeof p=="object"&&p.type)switch(p.type){case"exact":case"min_plus":let v=p.seconds!==void 0?"seconds":"value";u.patchValue(z(A({},p),{[v]:Math.max(1,(p[v]||0)-s)}));break;case"range":o?u.patchValue(z(A({},p),{minSeconds:p.minSeconds!=null?Math.max(1,p.minSeconds-s):p.minSeconds,maxSeconds:p.maxSeconds!=null?Math.max(1,p.maxSeconds-s):p.maxSeconds})):u.patchValue(z(A({},p),{min:p.min!=null?Math.max(1,p.min-s):p.min,max:p.max!=null?Math.max(1,p.max-s):p.max}));break;case"percentage_1rm":u.patchValue(z(A({},p),{percentage:Math.max(1,(p.percentage||0)-s)}));break;default:break}else{let v=p?.toString()||"0",k=o?this.parseTimeToSeconds(v)||0:parseFloat(v)||0,T=Math.max(0,parseFloat((k-s).toFixed(2)));u.patchValue(T)}t.markAsDirty();let x=t.get("id")?.value;x&&!this.isLongPressing&&this.triggerAnimation(x)}getFormControlName(t){let e=this.mode==="manualLogEntry";switch(t){case"reps":return e?"repsLogged":"targetReps";case"weight":return e?"weightLogged":"targetWeight";case"distance":return e?"distanceLogged":"targetDistance";case"duration":return e?"durationLogged":"targetDuration";case"rest":return e?"restLogged":"targetRest";case"tempo":return"targetTempo";default:return""}}getSetMetricDisplayValue(t,e){if(!(t instanceof ue))return"-";let i=this.getFormControlName(e),r=t.get(i);if(!r||r.value==null)return"-";let o=this.mode==="manualLogEntry";return this.workoutUtilsService.formatMetricTarget(r.value,e,o)}parseTimeToSeconds(t){if(!t)return 0;let e=t.toString().split(":").map(i=>parseInt(i,10)||0);return e.length===2?e[0]*60+e[1]:e[0]}getExerciseSetsLength(t){let e=this.exercisesFormArray.at(t);if(!e)return 0;let i=this.workoutFormService.getSetsFormArray(e);return i?i.length:0}updateTargetField(t,e,i,r){let o=t.get(e),s=o?.value;if(!o||!s)return;let l=r.target.value;if(l=l.replace(/[^0-9.]/g,""),l===""||isNaN(Number(l)))return;let u=Number(l);if(s.type==="range"){let p=z(A({},s),{[i]:u});o.patchValue(p)}else if(i==="value"&&(s.type==="exact"||s.type==="min_plus")){let p=z(A({},s),{value:u});o.patchValue(p)}t.markAsDirty()}incrementExactReps(t,e){let i=t.get("targetReps"),r=i?.value;if(!(!i||r?.type!=="exact"&&r?.type!=="min_plus")){if(r.type==="exact"){let o=Math.max(0,r.value+e),s=z(A({},r),{value:o});i.patchValue(s),t.markAsDirty()}else if(r.type==="min_plus"){let o=Math.max(0,r.value+e),s=z(A({},r),{value:o});i.patchValue(s),t.markAsDirty()}}}isAnimatingSet=R(null);animationTimeout=null;triggerAnimation(t){this.animationTimeout&&clearTimeout(this.animationTimeout),this.isAnimatingSet.set(t),this.animationTimeout=setTimeout(()=>{this.isAnimatingSet.set(null),this.animationTimeout=null},200)}newlyAddedSets=new Map;getMetricDisplayValue(t,e){let i=t.get(this.getTargetControlName(e))?.value,r=t.get(this.getLoggedControlName(e))?.value,o=this.isRoutineMode?i:r;return this.workoutUtilsService.formatMetricTarget(o,e)||"-"}getTargetControlName(t){switch(t){case"reps":return"targetReps";case"weight":return"targetWeight";case"duration":return"targetDuration";case"distance":return"targetDistance";case"rest":return"targetRest";default:return""}}getLoggedControlName(t){switch(t){case"reps":return"repsLogged";case"weight":return"weightLogged";case"duration":return"durationLogged";case"distance":return"distanceLogged";case"rest":return"restLogged";default:return""}}getMetricLabel(t){return"metrics."+Object.keys(ti)[t]}BuilderMode=to;isLongPressing=!1;allAvailableMetrics=["reps","weight","distance","duration","rest"];isMetricActiveForAllSets(t,e){let i=this.exercisesFormArray.at(t);return this.workoutFormService.getSetsFormArray(i).controls.every(o=>(o.get("fieldOrder")?.value||[]).includes(e))}toggleMetricForAllSets(t,e){let i=this.exercisesFormArray.at(t),r=this.workoutFormService.getSetsFormArray(i),o=!this.isMetricActiveForAllSets(t,e);r.controls.forEach(s=>{let l=s.get("fieldOrder")?.value||[];if(o){if(!l.includes(e)){l=[...l,e],s.get("fieldOrder")?.setValue(l);let u=this.getTargetControlName(e),p=this.getLoggedControlName(e),x=s;if(x.contains(u)&&!x.get(u)?.value)switch(e){case"rest":x.get(u)?.setValue(ie(60));break;case"weight":x.get(u)?.setValue(be(10));break;case"reps":x.get(u)?.setValue(Rt(8));break;case"distance":x.get(u)?.setValue(ze(2));break;case"duration":x.get(u)?.setValue(Ne(45));break}if(x.contains(p)&&!x.get(p)?.value)switch(e){case"rest":x.get(p)?.setValue(ie(60));break;case"weight":x.get(p)?.setValue(be(10));break;case"reps":x.get(p)?.setValue(Rt(8));break;case"distance":x.get(p)?.setValue(ze(2));break;case"duration":x.get(p)?.setValue(Ne(45));break}}}else if(l.includes(e)){l=l.filter(v=>v!==e),s.get("fieldOrder")?.setValue(l);let u=this.getTargetControlName(e),p=this.getLoggedControlName(e),x=s;x.contains(u)&&x.get(u)?.setValue(null),x.contains(p)&&x.get(p)?.setValue(null)}}),o?this.toastService.success(this.translate.instant("workoutBuilder.set.metricAdded",{metric:this.translate.instant("metrics."+e)}),2e3):this.toastService.info(this.translate.instant("workoutBuilder.set.metricRemoved",{metric:this.translate.instant("metrics."+e)}),2e3)}setMetricsForAllSets(t,e){let i=this.exercisesFormArray.at(t);this.workoutFormService.getSetsFormArray(i).controls.forEach(o=>{o.get("fieldOrder")?.setValue([...e])})}getExactInputValue(t,e){let i=t.get(this.getFormControlName(e))?.value;return i?e==="duration"||e==="rest"?i.seconds??null:i.value??null:null}onExactInputChange(t,e,i){let r=i.target,o=r.value===""?null:Number(r.value);(o===null||isNaN(o)||o<1)&&(o=1,r.value="1");let s=t.get(this.getFormControlName(e)),l=s?.value;l&&(e==="duration"||e==="rest"?s.patchValue(z(A({},l),{seconds:o})):s.patchValue(z(A({},l),{value:o})),t.markAsDirty())}focusedInput={};onInputFocus(t,e){this.focusedInput[t+"-"+e]=!0}onInputBlur(t,e){this.focusedInput[t+"-"+e]=!1}isInputFocused(t,e){return!!this.focusedInput[t+"-"+e]}focusInput(t,e){setTimeout(()=>{let i=document.querySelector(`input[data-set-id="${t}"][data-field="${e}"]`);i&&i.focus()})}lastTouchY=null;onInputWheel(t,e,i){i.preventDefault(),i.deltaY<0?this.incrementValue(t,e):i.deltaY>0&&this.decrementValue(t,e)}onInputTouchStart(t){t.touches.length===1&&(this.lastTouchY=t.touches[0].clientY)}onInputTouchMove(t,e,i){if(i.preventDefault(),i.touches.length===1&&this.lastTouchY!==null){let r=i.touches[0].clientY,o=r-this.lastTouchY;Math.abs(o)>20&&(o<0?this.decrementValue(t,e):this.incrementValue(t,e),this.lastTouchY=r)}}selectInputText(t){setTimeout(()=>t.select(),0)}getSubmitButtonLabel(){return this.mode==="routineBuilder"?this.translate.instant("workoutBuilder.routineBuilder.saveButton"):this.mode==="customProgramEntryBuilder"?this.translate.instant("workoutBuilder.routineBuilder.saveCustomRoutineButton"):this.isNewMode?this.translate.instant("workoutBuilder.logEntry.logButton"):this.translate.instant("workoutBuilder.logEntry.saveLogButton")}showCreationWizard(){return W(this,null,function*(){let t=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.wizard.templateOrBlankTitle"),this.translate.instant("workoutBuilder.wizard.templateOrBlankMsg"),[{name:"routineTemplate",type:"radio",label:this.translate.instant("workoutBuilder.wizard.templateOrBlankLabel"),value:"blank",options:[{label:"Blank (Custom)",value:"blank"},{label:"3x3",value:"3x3"},{label:"5x5",value:"5x5"},{label:"Push/Pull/Legs",value:"ppl"},{label:"5/3/1",value:"531"}],required:!0}],this.translate.instant("alertService.buttons.ok"));if(!t||!t.routineTemplate)return;let e=String(t.routineTemplate);if(e!=="blank"){yield this.createRoutineFromTemplate(e);return}this.exercisesFormArray.clear();let i=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.routineBuilder.nameLabel"),this.translate.instant("workoutBuilder.routineBuilder.nameWizardMsg"),[{name:"routineName",type:"text",label:this.translate.instant("workoutBuilder.routineBuilder.nameLabel"),placeholder:this.translate.instant("workoutBuilder.routineBuilder.namePlaceholder"),required:!0,autofocus:!0}],this.translate.instant("alertService.buttons.ok"));if(!i||!i.routineName)return;let r=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.routineBuilder.goalLabel"),this.translate.instant("workoutBuilder.routineBuilder.goalWizardMsg"),[{name:"routineGoal",type:"select",label:this.translate.instant("workoutBuilder.routineBuilder.goalLabel"),value:"hypertrophy",options:this.routineGoals.map(o=>({label:this.translate.instant(o.label),value:o.value})),required:!0}],this.translate.instant("alertService.buttons.ok"));!r||!r.routineGoal||this.builderForm.patchValue({name:i.routineName,goal:r.routineGoal})})}createRoutineFromTemplate(t){return W(this,null,function*(){let e=this.workoutService.generateRoutineFromTemplate(t,this.availableExercises),i;if(e.length===1)i=e[0];else{let r=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.wizard.pickRoutineTitle"),this.translate.instant("workoutBuilder.wizard.pickRoutineMsg"),[{name:"routinePick",type:"select",label:this.translate.instant("workoutBuilder.wizard.pickRoutineLabel"),value:e[0].id,options:e.map(o=>({label:o.name,value:o.id})),required:!0}],this.translate.instant("alertService.buttons.ok"));if(!r||!r.routinePick)return;i=e.find(o=>o.id===r.routinePick)||e[0]}this.patchFormWithRoutineData(i),this.toastService.success(this.translate.instant("workoutBuilder.wizard.templateCreated"),3e3)})}getActionDescription(t,e){if(e.exercises.length>t.exercises.length)return"Added Exercise";if(e.exercises.length<t.exercises.length)return"Removed Exercise";let i=t.exercises.some(o=>o.supersetId);return e.exercises.some(o=>o.supersetId)&&!i?"Created Superset":"Edited Routine"}get nextUndoAction(){return this.historyIndex>0&&this.history[this.historyIndex]?.action||null}get nextRedoAction(){return this.historyIndex<this.history.length-1&&this.history[this.historyIndex+1]?.action||null}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Be({type:n,selectors:[["app-workout-builder"]],viewQuery:function(e,i){if(e&1&&(Pe(hs,5),Pe(_s,5),Pe(fs,5),Pe(xs,5)),e&2){let r;Ae(r=Ve())&&(i.myExerciseInput=r.first),Ae(r=Ve())&&(i.setRepsInputs=r),Ae(r=Ve())&&(i.expandedSetElements=r),Ae(r=Ve())&&(i.expandedExerciseCard=r)}},inputs:{context:"context",initialRoutine:"initialRoutine",mode:"mode"},outputs:{routineConfirmed:"routineConfirmed",modalClose:"modalClose"},features:[We([Ir])],decls:32,vars:36,consts:[["tempoInputTemplate",""],["incrementerInputTemplate",""],["metricInputTemplate",""],["notPerformedYet",""],["expandedExerciseCard",""],["superSetControlPanel_Info",""],["detailedSetView",""],["noNotes",""],["allSetEditingPanel",""],["setElement",""],["expandedSetElement",""],["superSetControlPanel_rounds",""],["exerciseActionMenuContainer",""],["inputElem",""],["class","my-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-xl dark:bg-red-900/30 dark:border-red-600 dark:text-red-300",4,"ngIf"],[1,"container","mx-auto",3,"ngClass"],[1,"flex","items-center","justify-between","p-2"],[1,"flex","justify-between","items-center"],[1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],["name","back"],[1,"w-10","h-10"],[1,"flex","items-center","space-x-2","flex-shrink-0"],[4,"ngIf"],[1,"space-y-6","mb-6","p-1","rounded-xl","shadow-xl","overflow-hidden","min-h-screen",3,"formGroup"],[1,"space-y-2","p-2","rounded-xl","shadow-sm","dark:shadow-none","text-gray-700","dark:text-gray-200"],["class","p-4 bg-blue-50 dark:bg-blue-900/30 rounded-xl text-center",4,"ngIf"],["class","py-2 px-1 flex-col gap-2 flex items-center sticky bottom-0",4,"ngIf"],["itemIconName","plus-circle","itemIconClass","text-primary dark:text-primary-light",3,"searchTermChange","exercisesSelected","createCustomClicked","close","isOpen","searchTerm","isMultiSelect","title","exercises"],["itemIconName","change","itemIconClass","text-green-500",3,"searchTermChange","exerciseSelected","findSimilarClicked","backToSearchClicked","close","isOpen","searchTerm","title","exercises","searchPlaceholder","showSimilarButton","isShowingSimilarView"],[3,"isOpen","modalTitle","isOpenChange",4,"ngIf"],[3,"forceFullScreen","isOpen","modalTitle","isOpenChange",4,"ngIf"],[3,"actionClicked","actions","checkForPausedSession","scrollToBottomDisabled","scrollToTopDisabled"],[3,"close","generate","isOpen"],[1,"hidden","p-2.5"],[1,"my-4","p-3","bg-red-100","border","border-red-400","text-red-700","rounded-xl","dark:bg-red-900/30","dark:border-red-600","dark:text-red-300"],["class","relative",4,"ngIf"],[1,"relative"],["appBumpClick","",1,"text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-full","focus:outline-none","flex","items-center",3,"click"],["name","menu-action",1,"h-10","w-10"],["displayMode","dropdown",3,"gridClass","items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","gridClass","items","isVisible"],["class","text-gray-700 dark:text-gray-200",4,"ngIf"],["class","mt-2",4,"ngIf"],[4,"ngIf","ngIfElse"],["class","text-m text-gray-500 dark:text-gray-300",4,"ngIf"],[1,"block","text-xl","font-black","text-gray-700","dark:text-gray-200"],[1,"text-gray-700","dark:text-gray-200"],["for","routineName",1,"block","text-m","font-medium"],["type","text","id","routineName","formControlName","name",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-600","dark:border-gray-500",3,"placeholder","ngClass"],["class","text-red-500 dark:text-red-400 text-xs mt-1",4,"ngIf"],[1,"text-red-500","dark:text-red-400","text-xs","mt-1"],[1,"mt-1","block","w-full","shadow-sm","dark:shadow-none","text-gray-700","dark:text-gray-200",3,"innerHTML"],["for","description",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],[1,"block","text-m","text-gray-700","dark:text-gray-300"],[1,"font-medium"],["for","goal",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","goal","formControlName","goal",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","primaryCategory",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["id","primaryCategory","formControlName","primaryCategory",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","text-gray-700","dark:text-gray-200"],["for","secondaryCategory",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["type","text","id","secondaryCategory","formControlName","secondaryCategory",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","text-gray-700","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],[1,"mt-2"],[1,"flex","items-center","gap-2","flex-wrap"],[1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["class","bg-gray-200 text-gray-700 dark:bg-gray-600 text-gray-700 dark:text-gray-200 text-xs font-semibold px-2 py-1 rounded-full",4,"ngFor","ngForOf"],[1,"bg-gray-200","text-gray-700","dark:bg-gray-600","text-gray-700","dark:text-gray-200","text-xs","font-semibold","px-2","py-1","rounded-full"],["for","tags",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["type","text","id","tags","formControlName","tags",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","text-gray-700","dark:text-gray-200",3,"placeholder"],[1,"text-m","text-gray-500","dark:text-gray-300"],["class","text-sm text-gray-500 dark:text-gray-300 flex gap-1",4,"ngIf"],[1,"text-sm","text-gray-500","dark:text-gray-300","flex","gap-1"],[1,"text-sm","text-gray-500","dark:text-gray-300","italic","flex","gap-1","mb-2"],["class","flex items-center justify-between py-2",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","workoutDate",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","date","id","workoutDate","formControlName","workoutDate",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngClass"],["for","startTime",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","time","id","startTime","formControlName","startTime",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngClass"],["for","endTime",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","time","id","endTime","formControlName","endTime",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"change","ngClass"],["for","logWorkoutName",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","logWorkoutName","formControlName","name",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],["for","routineIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","routineIdForLog","formControlName","routineIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["for","programIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","programIdForLog","formControlName","programIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["for","overallNotesLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","overallNotesLog","formControlName","overallNotesLog","rows","2",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],[1,"flex","items-center","justify-between","py-2"],[1,"text-2xl","font-bold","text-gray-800","dark:text-gray-200"],["for","iterationIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["class","text-xs text-red-500 dark:text-primary-light",4,"ngIf"],["id","iterationIdForLog","formControlName","iterationIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"text-xs","text-red-500","dark:text-primary-light"],["for","scheduledDayIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","scheduledDayIdForLog","formControlName","scheduledDayIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["cdkDropList","","formArrayName","exercises","class","exercise-list-container",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],["class","text-center text-gray-500 dark:text-gray-400 border border-dashed dark:border-gray-700 rounded-xl mt-4",4,"ngIf"],["class","text-center py-4 text-gray-500 dark:text-gray-400",4,"ngIf"],["cdkDropList","","formArrayName","exercises",1,"exercise-list-container",3,"cdkDropListDropped","cdkDropListData","cdkDropListDisabled"],[4,"ngFor","ngForOf"],["appClickOutside","",1,"relative","group","exercise-card-wrapper",3,"clickOutside","ngClass"],["class","absolute left-1/2 -translate-x-1/2 z-20 flex space-x-2","style","top: -1.8rem;",4,"ngIf"],["cdkDrag","","appLongPressDrag","","longPressClass","is-long-pressing",1,"transition-all",3,"click","cdkDragDisabled","dragHandleSelector","longPressEnabled","longPressDelay","cdkDragData","cdkDragStartDelay","formGroupName","title"],["class","flex flex-col items-end space-y-2 flex-shrink-0 w-full sm:w-auto",4,"ngIf"],[1,"exercise-item-content"],["class","px-2 text-xl font-medium mt-0.5",3,"ngClass",4,"ngIf"],[1,"flex","items-center","space-x-1","pt-1","px-1"],["data-drag-handle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 flex item-center cursor-move rounded-xl",3,"title",4,"ngIf"],["type","checkbox","class","h-6 w-6 text-orange-600 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-orange-500 flex-shrink-0 disabled:opacity-50",3,"title","id","checked","change",4,"ngIf"],["class","flex-grow min-w-0 py-2 px-0",4,"ngIf"],["class","p-2",4,"ngIf"],["class","flex items-center justify-center py-2",4,"ngIf"],[1,"absolute","top-1","right-1","z-20",3,"ngClass"],["class","flex items-center space-x-1",4,"ngIf"],[1,"absolute","left-1/2","-translate-x-1/2","z-20","flex","space-x-2",2,"top","-1.8rem"],["type","button","class","bg-red-600 hover:bg-red-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button","class","bg-green-600 hover:bg-green-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button","class","bg-violet-600 hover:bg-violet-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],["type","button",1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],["type","button",1,"bg-violet-600","hover:bg-violet-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],[1,"flex","flex-col","items-end","space-y-2","flex-shrink-0","w-full","sm:w-auto"],[1,"p-2","bg-gray-100","dark:bg-gray-800","rounded-lg","shadow-sm","w-full"],[1,"flex","items-center","gap-x-2"],[1,"text-sm","font-semibold","text-gray-700","dark:text-gray-300"],[1,"text-lg","text-gray-900","dark:text-white"],[1,"flex","items-center","justify-start"],[1,"text-sm","ml-1",3,"ngClass"],["appBumpClick","","type","button",1,"flex","items-center","ml-2","text-xs","font-semibold","text-white","hover:underline","bg-blue-300","hover:bg-blue-500","rounded-xl","p-1",3,"click"],["name","change",1,"h-5","w-5","mr-1"],["class","col-span-2 flex items-center gap-x-2",4,"ngIf"],[1,"col-span-2","flex","items-center","gap-x-2"],[1,"text-sm","font-semibold","text-gray-700","dark:text-gray-300","flex-shrink-0",3,"for"],["type","number","formControlName","emomTimeSeconds","min","10",1,"w-full","p-1","mt-1","text-m","border-gray-300","dark:border-gray-500","rounded-xl","focus:ring-primary","dark:bg-gray-600","dark:text-gray-200","text-right",3,"id"],[1,"px-2","text-xl","font-medium","mt-0.5",3,"ngClass"],["data-drag-handle","",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","flex","item-center","cursor-move","rounded-xl",3,"title"],["name","reorder"],["type","checkbox",1,"h-6","w-6","text-orange-600","border-gray-300","dark:border-gray-600","rounded-xl","focus:ring-orange-500","flex-shrink-0","disabled:opacity-50",3,"change","title","id","checked"],[1,"flex-grow","min-w-0","py-2","px-0"],["class","flex items-center text-s text-gray-500 dark:text-gray-400 mt-0.5 gap-4 pl-2",4,"ngIf"],[1,"flex","items-center","text-s","text-gray-500","dark:text-gray-400","mt-0.5","gap-4","pl-2"],[1,"min-w-0"],[1,"flex"],[1,"font-semibold","text-gray-800","dark:text-gray-100","text-wrap","text-lg","max-exercise-length",3,"title"],["name","info","class","h-4 w-4 text-gray-400 dark:text-gray-300 cursor-help","width","20","height","20","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",3,"click",4,"ngIf"],[1,"text-xl","text-gray-500","dark:text-gray-400","truncate"],["name","info","width","20","height","20","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"h-4","w-4","text-gray-400","dark:text-gray-300","cursor-help",3,"click"],[1,"max-w-[250px]","sm:max-w-full","text-wrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"ml-1"],["class","mx-2",4,"ngIf"],[1,"mx-2"],["class","mx-1",4,"ngIf"],["class","inline-flex items-center",4,"ngIf"],[1,"mx-1"],[1,"inline-flex","items-center"],["name","duration",1,"h-4","w-4","mr-1"],["name","rest",1,"h-4","w-4","mr-1"],[1,"p-2"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","pb-2","pt-1","px-1","sm:pt-0","rounded-xl","bg-gray-100","dark:bg-gray-800",3,"click","ngClass"],[1,"flex-grow"],["class","text-xs font-mono block mb-1",3,"ngClass",4,"ngIf"],[1,"flex","items-center"],["alt","Exercise Icon",1,"object-contain","mr-3","flex-shrink-0",3,"src","ngClass"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-100","max-exercise-length"],["class","gap-x-2 gap-y-2 px-2 py-2 bg-white rounded-xl rounded-t-none dark:bg-gray-800 text-gray-900 dark:text-white ",3,"ngClass",4,"ngIf"],["class","space-y-1","id","expandedExerciseSetsContainer",4,"ngIf"],[1,"text-xs","font-mono","block","mb-1",3,"ngClass"],[1,"block","text-s","font-medium","text-gray-600","dark:text-gray-400","mb-0.5",3,"for"],["formControlName","notes","rows","1","appAutoGrow","",1,"mt-0.5","mb-2","block","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"id","readonly"],[1,"gap-x-2","gap-y-2","px-2","py-2","bg-white","rounded-xl","rounded-t-none","dark:bg-gray-800","text-gray-900","dark:text-white",3,"ngClass"],[1,"font-bold","text-xs","uppercase","text-gray-500","dark:text-gray-400","text-center"],["class","font-bold text-xs uppercase text-gray-500 dark:text-gray-400 text-center",4,"ngIf"],[1,"font-medium","flex","items-center","justify-center"],["class","flex items-center justify-center",4,"ngIf"],["class","col-span-full h-px bg-gray-200 dark:bg-gray-700",4,"ngIf"],[1,"flex","items-center","justify-center"],[1,"cursor-pointer",3,"click"],["name","clipboard-list",1,"h-8","w-8","text-gray-500","dark:text-white"],[1,"col-span-full","h-px","bg-gray-200","dark:bg-gray-700"],["id","expandedExerciseSetsContainer",1,"space-y-1"],[1,"flex-col","py-2","px-1","flex","gap-y-2"],["class","px-2 pt-2",4,"ngIf"],["formArrayName","sets",1,"space-y-1.5"],[4,"ngLet"],[3,"formGroupName","add-set-animated",4,"ngFor","ngForOf"],[1,"px-2","pt-2"],["appBumpClick","",1,"w-full","flex","justify-between","items-center","p-2","text-sm","font-semibold","text-gray-600","dark:text-gray-300","bg-gray-200","dark:bg-gray-700/60","rounded-xl","hover:bg-gray-300","dark:hover:bg-gray-700",3,"click"],["name","chevron-down",1,"h-5","w-5","transition-transform","duration-200"],[1,"overflow-hidden","transition-all","duration-300","ease-in-out"],[1,"flex","flex-wrap","gap-2","my-3","justify-center"],[1,"p-4","border","border-t-0","border-gray-200","dark:border-gray-700","rounded-b-xl","bg-white","dark:bg-gray-800"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-xs","font-medium","text-gray-500","dark:text-gray-200"],["type","number","min","1",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],["type","number","min","0",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],["type","number","min","0.1",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],[1,"mt-4","text-right"],["appBumpClick","",1,"px-4","py-2","bg-primary","text-white","text-sm","font-semibold","rounded-xl","shadow-sm","hover:bg-primary-dark","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-3","py-1","rounded-full","border","font-semibold","text-xs","transition",3,"click","ngClass"],[1,"flex","items-center","gap-x-3","py-1","px-2","text-xs","font-medium","text-gray-500","dark:text-gray-400","border-b","dark:border-gray-600",3,"ngClass"],[1,"flex-shrink-0","w-8","text-center"],[1,"flex-grow","min-w-0"],[1,"flex","items-center","justify-start","gap-x-4"],["class","w-16 text-center",4,"ngIf"],["class","w-20 text-center truncate",4,"ngIf"],["class","w-24 text-center",4,"ngIf"],[1,"flex-shrink-0","w-6"],[1,"w-16","text-center"],[1,"w-20","text-center","truncate"],[1,"w-24","text-center"],[3,"formGroupName"],["class","p-1 rounded-xl shadow-inner space-y-2 border-gray-400 ring-1 dark:ring-gray-500 z-10",3,"ngClass",4,"ngIf"],[1,"flex","items-center","gap-x-3","py-1.5","px-2","rounded-xl","hover:bg-gray-100","dark:hover:bg-gray-800/60","cursor-pointer","border","dark:border-gray-700","dark:text-white",3,"click","ngClass"],[1,"flex-shrink-0","w-8","text-s","text-center","font-medium"],["class","w-16 text-s text-center truncate",4,"ngIf"],["class","w-20 text-s text-center truncate",4,"ngIf"],["class","w-24 text-s text-center truncate",4,"ngIf"],[1,"flex-shrink-0"],["appBumpClick","","type","button",1,"flex","items-center","text-red-500","hover:text-red-600","dark:text-red-400","dark:hover:text-red-300","p-0.5","rounded-full","hover:bg-red-100","dark:hover:bg-red-900/30",3,"click","title"],["name","cancel",1,"h-4","w-4"],[1,"w-16","text-s","text-center","truncate"],[1,"w-20","text-s","text-center","truncate"],[1,"w-24","text-s","text-center","truncate"],[1,"p-1","rounded-xl","shadow-inner","space-y-2","border-gray-400","ring-1","dark:ring-gray-500","z-10",3,"ngClass"],[3,"click","ngClass"],[1,"flex","items-center","justify-end"],["class","flex w-fit items-center justify-center gap-1 bg-gray-200 dark:bg-gray-900/70 p-2 rounded-full",4,"ngIf"],["class","flex w-fit items-center justify-center gap-1 bg-gray-200 dark:bg-gray-900/70 py-1 px-2 rounded-full",4,"ngIf"],[1,"grid","grid-cols-2","sm:grid-cols-3","gap-x-3","gap-y-2","items-end"],[1,"col-span-full","sm:col-span-1"],[1,"block","text-s","font-medium","text-gray-600","dark:text-gray-400",3,"for"],["formControlName","type",1,"mt-0.5","w-full","p-1.5","text-m","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-70","disabled:cursor-not-allowed",3,"id","disabled"],[1,"flex","w-fit","items-center","justify-center","gap-1","bg-gray-200","dark:bg-gray-900/70","p-2","rounded-full"],[1,"flex","w-fit","items-center","justify-center","gap-1","bg-gray-200","dark:bg-gray-900/70","py-1","px-2","rounded-full"],[1,"flex","items-center","justify-between","text-s","font-medium","text-gray-600","dark:text-gray-400"],["appBumpClick","",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click"],["name","minus",1,"h-5","w-5"],["appBumpClick","","class","p-1.5 rounded-full bg-blue-500 dark:bg-blue-500/80 hover:bg-blue-500 text-white disabled:opacity-50 flex items-center",3,"click",4,"ngIf"],["appBumpClick","",1,"p-1.5","rounded-full","bg-blue-500","dark:bg-blue-500/80","hover:bg-blue-500","text-white","disabled:opacity-50","flex","items-center",3,"click"],["name","plus",1,"h-5","w-5"],["class","flex items-end justify-center h-full",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","items-end","justify-center","h-full"],["appBumpClick","",1,"flex","items-center","justify-center","w-full","p-2","h-16","border-2","border-dashed","border-gray-300","dark:border-gray-600","rounded-xl","text-gray-400","hover:bg-gray-200/50","dark:hover:bg-gray-700/50","transition-colors",3,"click"],["name","plus-circle",1,"h-6","w-6"],[1,"flex","items-center","justify-center","py-2"],[1,"flex","w-fit","items-center","justify-center","gap-1","bg-gray-200","dark:bg-gray-900/70","py-1","px-2","rounded-full","shadow-md"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click","aria-label"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-green-500","dark:bg-green-500/80","hover:bg-green-500","text-white","flex","items-center",3,"click","aria-label"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click","disabled","aria-label"],["name","minus",1,"h-6","w-6"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-green-500","dark:bg-green-500/80","hover:bg-green-500","text-white","disabled:opacity-50","flex","items-center",3,"click","aria-label"],["name","plus",1,"h-6","w-6"],[1,"flex","items-center","space-x-1"],["displayMode","dropdown",3,"items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","items","isVisible"],[1,"text-center","text-gray-500","dark:text-gray-400","border","border-dashed","dark:border-gray-700","rounded-xl","mt-4"],[1,"mb-2"],["appBumpClick","","type","button",1,"bg-green-500","hover:bg-green-600","text-white","text-m","font-medium","py-2","px-3","rounded-xl",3,"click"],[1,"text-center","py-4","text-gray-500","dark:text-gray-400"],[1,"p-4","bg-blue-50","dark:bg-blue-900/30","rounded-xl","text-center"],[1,"text-m","text-blue-700","dark:text-blue-300"],[1,"py-2","px-1","flex-col","gap-2","flex","items-center","sticky","bottom-0"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-primary","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-dark","disabled:opacity-50","min-w-[220px]",3,"click","disabled"],["name","save",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-green-600","hover:bg-green-800","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-800","disabled:opacity-50","min-w-[220px]",3,"click"],["name","plus-circle",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-yellow-600","hover:bg-yellow-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-yellow-500","min-w-[220px]",3,"click"],["name","restore",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-purple-600","hover:bg-purple-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-purple-500","min-w-[220px]",3,"click"],["name","random",1,"h-6","w-6","mr-1"],[3,"formGroup"],[1,"flex","items-center","justify-between","text-s","font-medium","text-gray-600","dark:text-gray-400",3,"for"],["type","text","formControlName","targetTempo","class","mt-0.5 input_number_class",3,"id","placeholder","readonly",4,"ngIf"],["type","text","formControlName","targetTempo",1,"mt-0.5","input_number_class",3,"placeholder","readonly"],["type","text","formControlName","targetTempo",1,"mt-0.5","input_number_class",3,"id","placeholder","readonly"],[1,"flex","items-stretch","w-full","shadow-sm","p-0.5","bg-gray-200","dark:bg-gray-700","rounded-xl"],["appBumpClick","","type","button","appPress","",1,"flex","items-center","px-3","py-5","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200","hover:bg-gray-300","dark:hover:bg-gray-600","rounded-l-xl","border-y","border-l","border-gray-200","dark:border-gray-700","transition-colors",3,"shortPress","longPress","pressRelease"],["name","minus",1,"h-6","w-6","pointer-events-none"],[1,"relative","w-full","flex-grow","rounded-xl","my-1","h-14"],[1,"absolute","inset-0","flex","items-center","justify-center","text-center","text-lg","font-bold","text-black","dark:text-gray-200","border-y","border-transparent","z-10","cursor-text","select-none",3,"click"],["type","number",1,"absolute","inset-0","w-full","h-full","px-1.5","py-2","text-center","text-lg","font-bold","bg-transparent","dark:bg-gray-800","rounded-xl","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","no-arrows","z-20",3,"input","focus","blur","wheel","touchstart","touchmove","value","readonly","ngClass"],["appBumpClick","","type","button","appPress","",1,"flex","items-center","px-3","py-5","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200","hover:bg-gray-300","dark:hover:bg-gray-600","rounded-r-xl","border-y","border-r","border-gray-200","dark:border-gray-700","transition-colors",3,"shortPress","longPress","pressRelease"],["name","plus",1,"h-6","w-6","pointer-events-none"],["type","button",1,"text-xs","text-blue-600","hover:text-blue-800","dark:text-blue-400","dark:hover:text-blue-300","font-semibold","p-0.5","rounded",3,"click"],["class","w-full px-2 py-5 text-center text-lg font-bold bg-gray-50 dark:bg-gray-800 border border-2 border-gray-200 dark:border-gray-700 text-black dark:text-gray-200 focus:ring-2 focus:ring-primary dark:focus:ring-primary-light focus:outline-none z-10 relative rounded-xl",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"flex","items-center","w-full","justify-center","bg-gray-200","dark:bg-gray-700","p-0.5","rounded-xl"],["type","number","placeholder","Min","min","0",1,"w-full","px-2","py-4","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border-y","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl","no-arrows","h-16",3,"input","readonly","value"],[1,"input_number_class_separator"],["type","number","placeholder","Max","min","0",1,"w-full","px-2","py-4","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border-y","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl","no-arrows","h-16",3,"input","readonly","value"],[1,"w-full","px-2","py-5","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border","border-2","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl"],["type","text",1,"mt-0.5","input_number_class",3,"formControlName","readonly"],[3,"isOpenChange","isOpen","modalTitle"],[1,"flex","flex-col","p-4","text-left","text-gray-700","dark:text-gray-200"],["name","","id","",1,"font-semibold","pb-2","dark:border-gray-600","dark:bg-gray-800",3,"disabled"],[1,"flex","justify-center"],["appBumpClick","",1,"w-fit","px-4","py-2","bg-primary","text-white","rounded-xl","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-primary-light","flex","items-center",3,"click"],["name","done",1,"h-6","w-6","mr-1"],[3,"isOpenChange","forceFullScreen","isOpen","modalTitle"],[3,"id","isModal"]],template:function(e,i){if(e&1){let r=D();w(0,Bs,2,1,"div",14),m(1,"div",15)(2,"header",16)(3,"div",17)(4,"button",18),E("click",function(){return y(r),b(i.handleCancel())}),F(5,"app-icon",19),c(),F(6,"div",20),c(),m(7,"div",21),w(8,Vs,2,1,"div",22),c()(),m(9,"form",23)(10,"section",24),w(11,oa,20,16,"ng-container",22)(12,wa,52,51,"ng-container",22),c(),w(13,nc,4,3,"section",22)(14,oc,4,3,"section",25)(15,cc,8,7,"div",26),c()(),w(16,pc,7,7,"ng-template",null,0,xe)(18,mc,11,10,"ng-template",null,1,xe)(20,Ic,22,20,"ng-template",null,2,xe),m(22,"app-exercise-selection-modal",27),_(23,"translate"),ee("searchTermChange",function(s){return y(r),X(i.modalSearchTerm,s)||(i.modalSearchTerm=s),b(s)}),E("exercisesSelected",function(s){return y(r),b(i.selectExercisesFromLibrary(s))})("createCustomClicked",function(){return y(r),b(i.handleTrulyCustomExerciseEntry())})("close",function(){return y(r),b(i.closeExerciseSelectionModal())}),c(),m(24,"app-exercise-selection-modal",28),_(25,"translate"),_(26,"translate"),ee("searchTermChange",function(s){return y(r),X(i.modalSearchTerm,s)||(i.modalSearchTerm=s),b(s)}),E("exerciseSelected",function(s){return y(r),b(i.handleExerciseSwitch(s))})("findSimilarClicked",function(){return y(r),b(i.findAndShowSimilarExercises())})("backToSearchClicked",function(){return y(r),b(i.onBackToSearchFromSimilar())})("close",function(){return y(r),b(i.closeSwitchExerciseModal())}),c(),w(27,Tc,10,9,"app-modal",29)(28,Mc,2,5,"app-modal",30),m(29,"app-fab-menu",31),E("actionClicked",function(s){return y(r),b(i.onFabAction(s))}),c(),m(30,"app-generate-workout-modal",32),E("close",function(){return y(r),b(i.isGeneratorModalOpen.set(!1))})("generate",function(s){return y(r),b(i.handleWorkoutGeneration(s))}),c(),F(31,"div",33)}if(e&2){let r,o;g("ngIf",i.errorMessage()),a(),g("ngClass",se(34,vs,i.context==="modal")),a(7),g("ngIf",i.liveFormAsRoutine()),a(),g("formGroup",i.builderForm),a(2),g("ngIf",i.isRoutineMode),a(),g("ngIf",i.mode===i.BuilderMode.manualLogEntry),a(),g("ngIf",i.mode===i.BuilderMode.manualLogEntry||((r=i.builderForm.get("goal"))==null?null:r.value)!==i.metricEnum.rest),a(),g("ngIf",((o=i.builderForm.get("goal"))==null?null:o.value)===i.metricEnum.rest),a(),g("ngIf",!i.isViewMode),a(7),g("isOpen",i.isExerciseModalOpen),J("searchTerm",i.modalSearchTerm),g("isMultiSelect",!0)("title",f(23,28,"workoutBuilder.modal.addTitle"))("exercises",i.availableExercises),a(2),g("isOpen",i.isSwitchExerciseModalOpen()),J("searchTerm",i.modalSearchTerm),g("title",f(25,30,i.isShowingSimilarInSwitchModal()?"workoutBuilder.modal.similarTitle":"workoutBuilder.modal.switchTitle"))("exercises",i.exercisesForSwitchModal())("searchPlaceholder",f(26,32,"workoutBuilder.modal.searchPlaceholder"))("showSimilarButton",!0)("isShowingSimilarView",i.isShowingSimilarInSwitchModal()),a(3),g("ngIf",i.notesModalsData()),a(),g("ngIf",i.exerciseDetailsId),a(),g("actions",i.fabMenuItems)("checkForPausedSession",!1)("scrollToBottomDisabled",!0)("scrollToTopDisabled",!0),a(),g("isOpen",i.isGeneratorModalOpen())}},dependencies:[dt,st,at,lt,kr,wr,Sr,Cr,zr,Pr,gt,ht,ut,Ar,Xt,pt,Br,Gr,Lr,Wr,Or,Nr,_t,mt,Zn,Kn,jn,Si,Ci,un,hn,mn,_n,ft,bi,gn,yt,ki,Hr,Ei,di,Yt,ct,cn,vt],styles:[".exercise-list-container[_ngcontent-%COMP%]{min-height:60px}.exercise-item[_ngcontent-%COMP%]{transition:transform .2s ease-out,box-shadow .2s ease-out}[_nghost-%COMP%]     .is-long-pressing{box-shadow:0 5px 15px #00000040;z-index:1000;box-shadow:inset 0 0 0 2px #e0460d,0 5px 15px #00000040;border-radius:5px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.4;background:#ccc;border:dotted 2px #999;min-height:100px;transition:transform .25s cubic-bezier(0,0,.2,1);display:block;margin-bottom:.5rem}.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;border-radius:.5rem;background-color:var(--card-background-color, white)}body.dark[_ngcontent-%COMP%]   .cdk-drag-preview[_ngcontent-%COMP%]{background-color:var(--dark-card-background-color, #1f2937)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .exercise-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{cursor:grab;padding:.25rem;color:#9ca3af;position:relative;top:.25rem;right:.25rem}.cdk-drag-handle[_ngcontent-%COMP%]:hover{color:#4b5563}.dark[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]{color:#6b7280}.dark[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]:hover{color:#d1d5db}@media (min-width: 640px){.cdk-drag-handle[_ngcontent-%COMP%]{position:static}}.superset-spacing[_ngcontent-%COMP%]{margin-top:0!important}.max-exercise-length[_ngcontent-%COMP%]{max-width:250px}@media (min-width: 768px){.max-exercise-length[_ngcontent-%COMP%]{max-width:100%}}.input_number_class[_ngcontent-%COMP%]{position:relative;z-index:10;height:4rem;width:100%;border-radius:.75rem;border-top-width:1px;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1));padding:.375rem;text-align:center;font-weight:700;--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(224 70 13 / var(--tw-ring-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.7}.input_number_class[_ngcontent-%COMP%]:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:focus:is(.dark *){--tw-ring-opacity: 1;--tw-ring-color: rgb(232 108 63 / var(--tw-ring-opacity, 1))}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:center;border-radius:.75rem;--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1));padding:.125rem}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]::-webkit-outer-spin-button, .wrapper_ranged_input_number_class[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]{-moz-appearance:textfield}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.input_number_class_separator[_ngcontent-%COMP%]{margin-left:.25rem;margin-right:.25rem;font-weight:700;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.input_number_class_separator[_ngcontent-%COMP%]:is(.dark *){--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#2c3240;border-radius:12px;position:relative;overflow:hidden}.numeric-stepper-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent!important;color:transparent;caret-color:#fff;border:none!important;box-shadow:none!important;outline:none!important;position:relative;z-index:2;width:100%;height:100%;text-align:center;font-size:1.5em;font-weight:700}.numeric-stepper-container[_ngcontent-%COMP%]   .input-number-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{position:absolute;z-index:1;left:0;right:0;text-align:center;color:#fff;pointer-events:none}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;border-top-width:1px;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1));padding:1.25rem .75rem;--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1));transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.no-arrows[_ngcontent-%COMP%]::-webkit-outer-spin-button, .no-arrows[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.no-arrows[_ngcontent-%COMP%]{-moz-appearance:textfield}"],data:{animation:[Oi("valueAnimation",[Jt(":increment",[Je({transform:"translateY(-100%)",opacity:0}),Qt("200ms ease-out",Je({transform:"translateY(0)",opacity:1}))]),Jt(":decrement",[Je({transform:"translateY(100%)",opacity:0}),Qt("200ms ease-out",Je({transform:"translateY(0)",opacity:1}))])]),Oi("exerciseExit",[Jt(":leave",[Je({opacity:1,transform:"translateX(0) scale(1)"}),Qt("350ms cubic-bezier(.36,1.01,.32,1)",Je({opacity:0,transform:"translateX(80px) scale(0.8)"}))])])]}})};export{Ii as a,Mi as b,yi as c,qd as d,jn as e,Kn as f,zd as g,Zn as h,bi as i,ki as j,Ti as k,wi as l,to as m,eo as n};

import{a as te}from"./chunk-FQWHMQAM.js";import{g as re,h as E}from"./chunk-O3KDX2L4.js";import{a as ie}from"./chunk-KD5FGTYH.js";import{C as A,Ca as f,Da as I,J as m,Jb as w,Ka as U,N as x,O as v,Oa as n,Ob as Q,Pa as V,Pb as X,Qa as h,Qb as ee,Ra as F,S as D,Wb as P,Za as N,a as M,aa as p,ab as k,b as R,bb as j,cb as G,db as W,eb as $,hb as H,ia as S,n as O,na as T,pb as Y,qb as K,rb as J,ua as g,ub as Z,va as r,vb as q,w as C,wa as i,xa as y,xb as z,yb as b}from"./chunk-IPM5J32U.js";var ne=(c,e)=>({"bg-primary hover:bg-primary-dark text-white border-primary dark:border-primary":c,"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700":e}),_=class c{workoutService=m(ee);trackingService=m(P);storageService=m(X);unitsService=m(E);alertService=m(Q);spinnerService=m(te);BACKUP_VERSION=1;BACKUP_KEY="fitTrackPro_backup";currentUnit=this.unitsService.currentUnit;constructor(){window.scrollTo(0,0)}selectUnit(e){this.unitsService.setUnitPreference(e)}exportData(){this.spinnerService.show("Exporting data...");let e={version:this.BACKUP_VERSION,timestamp:new Date().toISOString(),routines:this.workoutService.getDataForBackup(),workoutLogs:this.trackingService.getLogsForBackup(),personalBests:this.trackingService.getPBsForBackup()},t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),l=URL.createObjectURL(a),o=document.createElement("a"),s=re(new Date,"yyyyMMdd_HHmmss");o.download=`FitTrackPro_backup_${s}.json`,o.href=l,o.click(),URL.revokeObjectURL(l),console.log("Data export initiated."),this.spinnerService.hide()}importData(e){let t=e.target,a=t.files?.[0];if(!a){console.log("No file selected for import.");return}if(a.type!=="application/json"){alert("Invalid file type. Please select a JSON file."),t.value="";return}console.log(`Importing file: ${a.name}`);let l=new FileReader;l.onload=o=>{try{let s=o.target?.result,d=JSON.parse(s);if(typeof d!="object"||d===null){alert("Invalid backup file format. Expected an object."),t.value="";return}if(d.version!==this.BACKUP_VERSION){alert(`Invalid backup file version. Expected ${this.BACKUP_VERSION}, got ${d.version}. Please use a compatible backup file.`),t.value="";return}if(!d.routines||!d.workoutLogs||!d.personalBests){alert("Invalid backup file content. Missing essential data sections (routines, workoutLogs, personalBests)."),t.value="";return}this.alertService.showConfirm("WARNING","Importing data will OVERWRITE your current workout logs, routines, and personal bests. Are you sure you want to proceed?").then(u=>{u&&u.data?(this.workoutService.replaceData(d.routines),this.trackingService.replaceLogs(d.workoutLogs),this.trackingService.replacePBs(d.personalBests),console.log("Data import successful."),this.alertService.showAlert("Info","Data imported successfully!")):(console.log("Data import cancelled by user."),alert("Data import cancelled."))})}catch(s){console.error("Error processing imported file:",s),alert("Error processing backup file. Please ensure it is a valid JSON file.")}finally{t.value=""}},l.onerror=o=>{console.error("File reading error:",o),alert("Error reading file."),t.value=""},l.readAsText(a)}clearAllAppData(){this.alertService.showConfirm("WARNING","This will delete ALL your workout data (routines, logs, PBs). This cannot be undone. Are you sure?").then(e=>{e&&e.data&&(this.trackingService.clearAllWorkoutLogs_DEV_ONLY&&this.trackingService.clearAllWorkoutLogs_DEV_ONLY(),this.trackingService.clearAllPersonalBests_DEV_ONLY&&this.trackingService.clearAllPersonalBests_DEV_ONLY(),this.workoutService.clearAllRoutines_DEV_ONLY&&this.workoutService.clearAllRoutines_DEV_ONLY(),console.log("All application data cleared."),this.alertService.showConfirm("Info","All workout data has been cleared."))})}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=S({type:c,selectors:[["app-profile-settings"]],decls:47,vars:8,consts:[[1,"container","mx-auto","p-4"],[1,"mb-6","pb-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[1,"space-y-8"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-4"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["type","file","accept","application/json",1,"block","w-full","text-sm","text-gray-700","dark:text-gray-300","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-gray-200","file:text-gray-700","hover:file:bg-gray-300","dark:file:bg-gray-700","dark:file:text-gray-200","dark:hover:file:bg-gray-600",3,"change"],[1,"pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-sm","font-medium","text-red-600","dark:text-red-400","mb-2"],[1,"px-4","py-2","bg-red-500","hover:bg-red-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["routerLink","/profile/personal-bests",1,"px-4","py-2","bg-primary","hover:bg-primary-dark","text-white","font-semibold","rounded-md","shadow-sm","transition-colors","inline-flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-4","h-4","ml-2"],["fill-rule","evenodd","d","M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd"],[1,"flex","space-x-4"],[1,"px-4","py-2","border","rounded-md","transition-colors",3,"click","ngClass"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"header",1)(2,"h1",2),n(3,"Profile & Settings"),i()(),r(4,"div",3)(5,"section",4)(6,"h2",5),n(7,"Data Management"),i(),r(8,"div",6)(9,"div")(10,"p",7),n(11,"Backup your data to a JSON file."),i(),r(12,"button",8),f("click",function(){return a.exportData()}),n(13," Export Data "),i()(),r(14,"div")(15,"p",7),n(16,"Restore your data from a JSON backup file."),i(),r(17,"input",9),f("change",function(o){return a.importData(o)}),i()(),r(18,"div",10)(19,"h3",11),n(20,"Reset / Clear Data"),i(),r(21,"p",12),n(22,"WARNING: This action will delete all your saved data."),i(),r(23,"button",13),f("click",function(){return a.clearAllAppData()}),n(24," Clear All Data "),i()()()(),r(25,"section",4)(26,"h2",5),n(27,"Your Achievements"),i(),r(28,"div")(29,"p",7),n(30,"View all your tracked Personal Bests."),i(),r(31,"a",14),n(32," View Personal Bests "),x(),r(33,"svg",15),y(34,"path",16),i()()()(),v(),r(35,"section",4)(36,"h2",5),n(37,"General Settings"),i(),r(38,"div",6)(39,"div")(40,"p",7),n(41,"Weight Units"),i(),r(42,"div",17)(43,"button",18),f("click",function(){return a.selectUnit("kg")}),n(44," kg "),i(),r(45,"button",18),f("click",function(){return a.selectUnit("lbs")}),n(46," lbs "),i()()()()()()()),t&2&&(p(43),g("ngClass",N(2,ne,a.currentUnit()==="kg",a.currentUnit()!=="kg")),p(2),g("ngClass",N(5,ne,a.currentUnit()==="lbs",a.currentUnit()!=="lbs")))},dependencies:[b,Y,w],encapsulation:2})};function le(c,e){if(c&1&&(r(0,"tr")(1,"td",14),n(2),r(3,"span",15),n(4),k(5,"titlecase"),i()(),r(6,"td",16),n(7),i(),r(8,"td",17),n(9),i(),r(10,"td",18),n(11),k(12,"date"),i(),r(13,"td",19),n(14),k(15,"slice"),i()()),c&2){let t=e.$implicit,a=I(2);p(2),h(" ",t.exerciseName," "),p(2),h("(",j(5,7,t.primaryMuscleGroup),")"),p(3),h("",t.pbType," "),p(2),h(" ",a.formatPbValue(t)),p(2),V(G(12,9,t.timestamp,"mediumDate")),p(3),F("",W(15,12,t.notes,0,50),"",t&&t.notes&&t.notes.length>50?"...":"")}}function ce(c,e){if(c&1&&(r(0,"div")(1,"div",8)(2,"table",9)(3,"thead",10)(4,"tr")(5,"th",11),n(6," Exercise"),i(),r(7,"th",11),n(8," PB Type"),i(),r(9,"th",11),n(10," Best"),i(),r(11,"th",11),n(12," Date"),i(),r(13,"th",11),n(14," Notes"),i()()(),r(15,"tbody",12),T(16,le,16,16,"tr",13),i()()()()),c&2){let t=I();p(16),g("ngForOf",t.displayPersonalBests())}}function de(c,e){c&1&&(r(0,"div",20),x(),r(1,"svg",21),y(2,"path",22),i(),v(),r(3,"h2",23),n(4,"No Personal Bests Yet!"),i(),r(5,"p",24),n(6,"Keep logging your workouts to track your progress and achievements here."),i()())}var B=class c{trackingService=m(P);exerciseService=m(ie);unitsService=m(E);allPersonalBests=D({});allExercises=D([]);displayPersonalBests=H(()=>{let e=this.allPersonalBests(),t=this.allExercises();if(Object.keys(e).length===0||t.length===0)return[];let a=new Map(t.map(o=>[o.id,o])),l=[];for(let o in e)if(e.hasOwnProperty(o)){let s=a.get(o),d=e[o];s&&d.forEach(u=>{l.push(R(M({},u),{exerciseName:s.name,exerciseCategory:s.category,primaryMuscleGroup:s.primaryMuscleGroup}))})}return l.sort((o,s)=>{let d=o.exerciseName.localeCompare(s.exerciseName);if(d!==0)return d;let u=this.getPbTypeSortOrder(o.pbType),L=this.getPbTypeSortOrder(s.pbType);return u!==L?u-L:o.weightUsed!==void 0&&s.weightUsed!==void 0?(s.weightUsed??0)-(o.weightUsed??0):o.repsAchieved!==void 0&&s.repsAchieved!==void 0&&o.pbType.includes("Max Reps")&&s.pbType.includes("Max Reps")?s.repsAchieved-o.repsAchieved:o.durationPerformed!==void 0&&s.durationPerformed!==void 0&&o.pbType.includes("Max Duration")&&s.pbType.includes("Max Duration")?(s.durationPerformed??0)-(o.durationPerformed??0):o.pbType.localeCompare(s.pbType)})});constructor(){}ngOnInit(){O([this.trackingService.personalBests$.pipe(A(e=>console.log("Loaded PBs for PBs Page:",Object.keys(e).length)),C(1)),this.exerciseService.getExercises().pipe(A(e=>console.log("Loaded Exercises for PBs Page:",e.length)),C(1))]).subscribe(([e,t])=>{this.allPersonalBests.set(e),this.allExercises.set(t)})}getPbTypeSortOrder(e){return e.includes("1RM (Actual)")?0:e.includes("1RM (Estimated)")?1:e.includes("3RM (Actual)")?2:e.includes("5RM (Actual)")?3:e.includes("Heaviest Lifted")?4:e.includes("Max Reps (Bodyweight)")?5:e.includes("Max Duration")?6:100}formatPbValue(e){let t="";return e.weightUsed!==void 0&&e.weightUsed!==null?(t+=`${e.weightUsed}kg`,e.repsAchieved>0&&!(e.pbType.includes("RM (Actual)")&&e.repsAchieved===parseInt(e.pbType,10))&&(t+=` x ${e.repsAchieved}`)):e.repsAchieved>0&&e.pbType.includes("Max Reps")?t=`${e.repsAchieved} reps`:e.durationPerformed&&e.durationPerformed>0&&e.pbType.includes("Max Duration")&&(t=`${e.durationPerformed}s`),t||"N/A"}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=S({type:c,selectors:[["app-personal-bests"]],decls:13,vars:2,consts:[["noPBs",""],[1,"container","mx-auto","p-4"],[1,"mb-6","flex","justify-between","items-center"],["routerLink","/profile",1,"text-primary","dark:text-primary-light","hover:underline","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","mr-1"],["fill-rule","evenodd","d","M17 10a.75.75 0 0 1-.75.75H5.612l4.158 3.96a.75.75 0 1 1-1.04 1.08l-5.5-5.25a.75.75 0 0 1 0-1.08l5.5-5.25a.75.75 0 1 1 1.04 1.08L5.612 9.25H16.25A.75.75 0 0 1 17 10Z","clip-rule","evenodd"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[4,"ngIf","ngIfElse"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-md","overflow-hidden","mb-6"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-750"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900","dark:text-gray-100"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-300"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-semibold","text-primary","dark:text-primary-light"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","text-sm","text-gray-500","dark:text-gray-400","italic"],[1,"text-center","py-10","bg-white","dark:bg-gray-800","rounded-lg","shadow-md"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-16","h-16","mx-auto","text-gray-400","dark:text-gray-500","mb-4"],["stroke-linecap","round","stroke-linejoin","round","d","M15.983 4.202A1.043 1.043 0 0 1 16.5 4.5c.376 0 .703.246.875.588.081.162.1.344.073.526A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.457-16.184c.027-.182.045-.364.073-.526.172-.342.5-.588.875-.588a1.043 1.043 0 0 1 .517.298V1.5a.75.75 0 0 0-1.5 0v.38a8.05 8.05 0 0 0-4.772 4.192.75.75 0 0 0 .954.954 8.05 8.05 0 0 0 4.192-4.772h.38a1.5 1.5 0 0 0 1.5-1.5ZM12 18.75a6.75 6.75 0 1 0 0-13.5 6.75 6.75 0 0 0 0 13.5Z"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-gray-500","dark:text-gray-400"]],template:function(t,a){if(t&1&&(r(0,"div",1)(1,"div",2)(2,"a",3),x(),r(3,"svg",4),y(4,"path",5),i(),n(5," Back to Profile "),i(),v(),r(6,"h1",6),n(7,"Personal Bests"),i(),r(8,"div"),n(9," FILTERS "),i()(),T(10,ce,17,1,"div",7)(11,de,7,0,"ng-template",null,0,$),i()),t&2){let l=U(12);p(10),g("ngIf",a.displayPersonalBests().length>0)("ngIfElse",l)}},dependencies:[b,K,J,z,Z,q,w],encapsulation:2})};var He=[{path:"",component:_,title:"Profile & Settings"},{path:"personal-bests",component:B,title:"Personal Bests"}];export{He as PROFILE_SETTINGS_ROUTES};

import{A as x,B as p,Gb as h,I as g,M as n,Rb as m,Tb as v,_b as S,a as o,b as a,d as u,h as d,l as c,m as b,n as t,w as f,y as E}from"./chunk-LBCPHAYK.js";var w=class l{http=n(h);storageService=n(v);trackingService=n(S);EXERCISES_STORAGE_KEY="fitTrackPro_exercises";exercisesJsonUrl="assets/data/exercises.json";exercisesSubject;exercises$;serviceInitializedPromise;serviceInitializedResolve;constructor(){this.serviceInitializedPromise=new Promise(s=>{this.serviceInitializedResolve=s});let r=this.loadExercisesFromStorage();this.exercisesSubject=new d(r),this.exercises$=this.exercisesSubject.asObservable().pipe(p(1)),r.length===0?this.seedExercisesFromAssets():this.serviceInitializedResolve()}loadExercisesFromStorage(){return this.storageService.getItem(this.EXERCISES_STORAGE_KEY)||[]}saveExercisesToStorage(r){this.storageService.setItem(this.EXERCISES_STORAGE_KEY,r),this.exercisesSubject.next([...r].sort((s,e)=>s.name.localeCompare(e.name)))}seedExercisesFromAssets(){this.http.get(this.exercisesJsonUrl).pipe(E(1),f(r=>(console.error("ExerciseService: Failed to load seed exercises from JSON file:",r),c([])))).subscribe(r=>{r&&r.length>0&&this.exercisesSubject.getValue().length===0&&this.saveExercisesToStorage(r),this.serviceInitializedResolve()})}ensureInitialized(){return this.serviceInitializedPromise}getExercises(){return this.exercises$}getExerciseById(r){return this.exercises$.pipe(x(),t(s=>s.find(i=>i.id===r)))}addExercise(r){let s=this.exercisesSubject.getValue(),e=a(o({},r),{id:m()}),i=[...s,e];return this.saveExercisesToStorage(i),c(e)}updateExercise(r){let s=this.exercisesSubject.getValue(),e=s.findIndex(i=>i.id===r.id);if(e>-1){let i=[...s];return i[e]=o({},r),this.saveExercisesToStorage(i),c(r)}return b(()=>new Error(`Exercise with id ${r.id} not found for update.`))}deleteExercise(r){return u(this,null,function*(){let s=this.exercisesSubject.getValue();if(!s.find(i=>i.id===r))return console.warn(`ExerciseService: Exercise with id ${r} not found for deletion.`),Promise.reject(new Error("Exercise not found"));try{yield this.trackingService.handleExerciseDeletion(r);let i=s.filter(y=>y.id!==r);this.saveExercisesToStorage(i)}catch(i){throw console.error(`Error during exercise deletion process for ${r}:`,i),i}})}getExercisesByCategory(r){return this.getExercises().pipe(t(s=>s.filter(e=>e.category===r)))}getExercisesByMuscleGroup(r){return this.getExercises().pipe(t(s=>s.filter(e=>e.muscleGroups.includes(r))))}getUniqueCategories(){return this.getExercises().pipe(t(r=>[...new Set(r.map(s=>s.category))]))}getUniquePrimaryMuscleGroups(){return this.getExercises().pipe(t(r=>[...new Set(r.map(s=>s.primaryMuscleGroup))].sort()))}determineExerciseIcon(r,s){let e=s.toLowerCase();if(r&&r.equipment){let i=r.equipment.toLowerCase();if(i.includes("barbell"))return"barbell";if(i.includes("dumbbell"))return"dumbbell";if(i.includes("machine")||i.includes("cable"))return"machine";if(i.includes("body")||i.includes("none"))return"bodyweight";if(i.includes("kettlebell"))return"kettlebell";if(i.includes("resistance band"))return"resistance-band"}if(e.includes("barbell"))return"barbell";if(e.includes("dumbbell")||e.includes("db "))return"dumbbell";if(e.includes("squat")&&e.includes("barbell"))return"barbell";if(e.includes("squat")&&!e.includes("dumbbell")&&!e.includes("dumbbell"))return"bodyweight";if(e.includes("deadlift")||e.includes("bench press")||e.includes("row")&&(e.includes("barbell")||!e.includes("dumbbell"))||e.includes("curl")&&e.includes("barbell"))return"barbell";if(e.includes("curl")&&e.includes("dumbbell"))return"dumbbell";if(e.includes("machine")||e.includes("cable"))return"machine";if(e.includes("body")||e.includes("none"))return"bodyweight";if(e.includes("kettlebell"))return"kettlebell";if(e.includes("run")||e.includes("cardio")||e.includes("tapis")||e.includes("jog"))return"cardio";if(e.includes("resistance band"))return"resistance-band";if(r?.category){let i=r.category.toLowerCase();if((i==="strength"||i==="powerlifting"||i==="olympic weightlifting")&&(e.includes("squat")||e.includes("deadlift")||e.includes("bench")))return"barbell";if(i==="cardio")return"cardio";if(i==="calisthenics"||i==="plyometrics")return"bodyweight"}return"default-exercise"}getIconPath(r){return`assets/icons/${r||"default-exercise"}.svg`}static \u0275fac=function(s){return new(s||l)};static \u0275prov=g({token:l,factory:l.\u0275fac,providedIn:"root"})};export{w as a};

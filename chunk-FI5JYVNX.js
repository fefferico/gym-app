import{M as n,Mc as f,Nc as m,Q as a,Z as c,a as i,b as t,g as l,k as u}from"./chunk-4VPDC63E.js";var h=class o{storageService=a(m);alertService=a(f);USER_PROFILE_KEY="fitTrackPro_userProfile";IS_WIP=!0;userProfileSubject;userProfile$;username=c(void 0);constructor(){let e=this.storageService.getItem(this.USER_PROFILE_KEY);this.userProfileSubject=new u(e),this.userProfile$=this.userProfileSubject.asObservable(),this.userProfile$.subscribe(r=>{this.username.set(r?.username)}),this.showWipDisclaimer()}showWipDisclaimer(){return l(this,null,function*(){if(this.IS_WIP&&!this.getHideWipDisclaimer()){let e=yield this.alertService.present({header:"Work-in-Progress Disclaimer",message:"DISCLAIMER: This is a work-in-progress, browser-based app. This means your workout data won't be saved when you close the browser or clear your browser data. Be sure to regularly export your data and import it again when you return to the app.",backdropDismiss:!1,inputs:[{type:"checkbox",name:"hideDisclaimer",label:"Don't show this message again",value:!1}],buttons:[{text:"OK",role:"confirm"}]});e?.role==="confirm"&&e.values?.hideDisclaimer&&this.updateHideWipDisclaimer(!0)}})}getHideWipDisclaimer(){return this.userProfileSubject.getValue()?.hideWipDisclaimer??!1}updateHideWipDisclaimer(e){let r=this.getProfile()||{};this.saveProfile(t(i({},r),{hideWipDisclaimer:e}))}getProfile(){return this.userProfileSubject.getValue()}saveProfile(e){let r=this.getProfile()||{},s=i(i({},r),e);this.storageService.setItem(this.USER_PROFILE_KEY,s),this.userProfileSubject.next(s)}getUsername(){return this.userProfileSubject.getValue()?.username}updateUsername(e){let r=this.getProfile()||{};this.saveProfile(t(i({},r),{username:e}))}getMeasurements(){return this.userProfileSubject.getValue()?.measurements}updateMeasurements(e){let r=this.getProfile()||{},s=i(i({},r.measurements||{}),e);this.saveProfile(t(i({},r),{measurements:s}))}updateGender(e){let r=this.getProfile()||{};this.saveProfile(t(i({},r),{gender:e}))}getDataForBackup(){return this.getProfile()}replaceData(e){e?(this.storageService.setItem(this.USER_PROFILE_KEY,e),this.userProfileSubject.next(e)):(this.storageService.removeItem(this.USER_PROFILE_KEY),this.userProfileSubject.next(null))}clearUserProfile_DEV_ONLY(){this.replaceData(null),console.log("User profile data cleared.")}static \u0275fac=function(r){return new(r||o)};static \u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})};export{h as a};

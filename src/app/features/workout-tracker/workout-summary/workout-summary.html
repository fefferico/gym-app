<div class="container mx-auto p-4 py-8">
  <ng-container *ngIf="workoutLog() as log; else loadingOrNotFoundSummary">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 md:p-8 max-w-2xl mx-auto">
      <div class="text-center mb-8">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-green-500 mx-auto mb-3">
          <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.06-1.06l-3.002 3.001-1.502-1.502a.75.75 0 0 0-1.06 1.06L9.97 12.72l3.59-3.591Z" clip-rule="evenodd" />
        </svg>
        <h1 class="text-4xl font-bold text-gray-800 dark:text-gray-100">Workout Complete!</h1>
        <p class="text-lg text-gray-600 dark:text-gray-400 mt-1">Great job on finishing your session.</p>
      </div>

      <div class="space-y-4 mb-8">
        <div class="flex justify-between items-baseline p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
          <span class="text-sm font-medium text-gray-600 dark:text-gray-300">Routine:</span>
          <span class="text-md font-semibold text-gray-800 dark:text-gray-100">{{ log.routineName || 'Ad-hoc Workout' }}</span>
        </div>
        <div class="flex justify-between items-baseline p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
          <span class="text-sm font-medium text-gray-600 dark:text-gray-300">Date:</span>
          <span class="text-md font-semibold text-gray-800 dark:text-gray-100">{{ log.startTime | date:'fullDate' }}</span>
        </div>
        <div class="flex justify-between items-baseline p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
          <span class="text-sm font-medium text-gray-600 dark:text-gray-300">Duration:</span>
          <span class="text-md font-semibold text-gray-800 dark:text-gray-100">{{ log.durationMinutes }} minutes</span>
        </div>
        <div *ngIf="sessionTotalVolume() > 0" class="flex justify-between items-baseline p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
          <span class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Volume:</span>
          <span class="text-md font-semibold text-gray-800 dark:text-gray-100">{{ sessionTotalVolume() | number:'1.0-0' }} {{ unitsService.getUnitLabel() }}</span>
        </div>
      </div>

      <!-- Personal Bests Achieved This Session -->
      <div *ngIf="sessionPBs().length > 0" class="mb-8">
        <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-3 text-center border-b pb-2 dark:border-gray-700">
          ðŸŽ‰ New Personal Bests! ðŸŽ‰
        </h2>
        <ul class="space-y-2 mt-3">
          <li *ngFor="let pb of sessionPBs()" class="p-2 bg-green-50 dark:bg-green-900/30 rounded-md text-center">
            <p class="text-sm font-medium text-green-700 dark:text-green-300">{{ pb.exerciseName }} - {{ pb.pbType }}</p>
            <p class="text-lg font-bold text-green-600 dark:text-green-200">{{ pb.value }}</p>
          </li>
        </ul>
      </div>

      <!-- Overall Notes from Workout -->
      <div *ngIf="log.notes" class="mb-8 p-3 bg-yellow-50 dark:bg-yellow-900/30 rounded-md">
         <h3 class="text-sm font-medium text-yellow-800 dark:text-yellow-300 mb-1">Your Notes for this Session:</h3>
         <p class="text-sm text-yellow-700 dark:text-yellow-200 italic whitespace-pre-line">{{ log.notes }}</p>
      </div>


      <!-- Action Buttons -->
      <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700 space-y-3 md:space-y-0 md:flex md:justify-center md:space-x-4">
        <button (click)="viewFullLog()"
                class="w-full md:w-auto flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-dark">
          View Full Log Details
        </button>
        <button (click)="navigateToRoutines()"
                class="w-full md:w-auto flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
          Back to Routines
        </button>
      </div>
    </div>
  </ng-container>

  <ng-template #loadingOrNotFoundSummary>
    <div class="text-center py-20">
      <p class="text-xl text-gray-600 dark:text-gray-400">Loading workout summary...</p>
      <!-- Spinner -->
    </div>
  </ng-template>
</div>
<div class="container mx-auto p-1 sm:p-4">
    <div class="flex justify-between border-b border-gray-200 dark:border-gray-700 mb-6">
        <div>
            <header class="items-center">
                <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-200">My Statistics</h1>
            </header>
        </div>
        <div>
            <button (click)="goToPBs()" type="button"
                class="rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="1.5"
                    stroke="currentColor" class="w-8 h-8 transition-transform duration-300">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path
                            d="M12.0002 16C6.24021 16 5.21983 10.2595 5.03907 5.70647C4.98879 4.43998 4.96365 3.80673 5.43937 3.22083C5.91508 2.63494 6.48445 2.53887 7.62318 2.34674C8.74724 2.15709 10.2166 2 12.0002 2C13.7837 2 15.2531 2.15709 16.3771 2.34674C17.5159 2.53887 18.0852 2.63494 18.5609 3.22083C19.0367 3.80673 19.0115 4.43998 18.9612 5.70647C18.7805 10.2595 17.7601 16 12.0002 16Z"
                            stroke="currentColor" stroke-width="1.5"></path>
                        <path d="M12 16V19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                        <path
                            d="M15.5 22H8.5L8.83922 20.3039C8.93271 19.8365 9.34312 19.5 9.8198 19.5H14.1802C14.6569 19.5 15.0673 19.8365 15.1608 20.3039L15.5 22Z"
                            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        </path>
                        <path
                            d="M19 5L19.9486 5.31621C20.9387 5.64623 21.4337 5.81124 21.7168 6.20408C22 6.59692 22 7.11873 21.9999 8.16234L21.9999 8.23487C21.9999 9.09561 21.9999 9.52598 21.7927 9.87809C21.5855 10.2302 21.2093 10.4392 20.4569 10.8572L17.5 12.5"
                            stroke="currentColor" stroke-width="1.5"></path>
                        <path
                            d="M4.99994 5L4.05132 5.31621C3.06126 5.64623 2.56623 5.81124 2.2831 6.20408C1.99996 6.59692 1.99997 7.11873 2 8.16234L2 8.23487C2.00003 9.09561 2.00004 9.52598 2.20723 9.87809C2.41441 10.2302 2.79063 10.4392 3.54305 10.8572L6.49994 12.5"
                            stroke="currentColor" stroke-width="1.5"></path>
                        <path
                            d="M11.1459 6.02251C11.5259 5.34084 11.7159 5 12 5C12.2841 5 12.4741 5.34084 12.8541 6.02251L12.9524 6.19887C13.0603 6.39258 13.1143 6.48944 13.1985 6.55334C13.2827 6.61725 13.3875 6.64097 13.5972 6.68841L13.7881 6.73161C14.526 6.89857 14.895 6.98205 14.9828 7.26432C15.0706 7.54659 14.819 7.84072 14.316 8.42898L14.1858 8.58117C14.0429 8.74833 13.9714 8.83191 13.9392 8.93531C13.9071 9.03872 13.9179 9.15023 13.9395 9.37327L13.9592 9.57632C14.0352 10.3612 14.0733 10.7536 13.8435 10.9281C13.6136 11.1025 13.2682 10.9435 12.5773 10.6254L12.3986 10.5431C12.2022 10.4527 12.1041 10.4075 12 10.4075C11.8959 10.4075 11.7978 10.4527 11.6014 10.5431L11.4227 10.6254C10.7318 10.9435 10.3864 11.1025 10.1565 10.9281C9.92674 10.7536 9.96476 10.3612 10.0408 9.57632L10.0605 9.37327C10.0821 9.15023 10.0929 9.03872 10.0608 8.93531C10.0286 8.83191 9.95713 8.74833 9.81418 8.58117L9.68403 8.42898C9.18097 7.84072 8.92945 7.54659 9.01723 7.26432C9.10501 6.98205 9.47396 6.89857 10.2119 6.73161L10.4028 6.68841C10.6125 6.64097 10.7173 6.61725 10.8015 6.55334C10.8857 6.48944 10.9397 6.39258 11.0476 6.19887L11.1459 6.02251Z"
                            stroke="currentColor" stroke-width="1.5"></path>
                        <path d="M18 22H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                    </g>
                </svg>
                <span class="sr-only">Personal Bests</span>
            </button>
            <button (click)="toggleStatsFilterAccordion()" type="button"
                class="rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-8 h-8 transition-transform duration-300"
                    [class.rotate-180]="isStatsFilterAccordionOpen()">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0M3.75 18H7.5m3-6h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0M3.75 12H7.5" />
                </svg>
                <span class="sr-only">Toggle Date Filters</span>
            </button>
        </div>
    </div>

    <!-- Date Range Filter Section for Stats -->
    <div class="overflow-hidden transition-all duration-500 ease-in-out"
        [style.maxHeight]="isStatsFilterAccordionOpen() ? '500px' : '0px'" [class.mb-8]="isStatsFilterAccordionOpen()">
        <form [formGroup]="statsFilterForm" (ngSubmit)="applyStatsFilters()"
            class="p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md space-y-4 border dark:border-gray-700">
            <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-3">Filter Statistics by Date</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                <div>
                    <label for="statsDateFrom" class="block text-sm font-medium text-gray-700 dark:text-gray-300">From
                        Date</label>
                    <input type="date" id="statsDateFrom" formControlName="dateFrom"
                        class="mt-1 block w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-primary focus:border-primary dark:bg-gray-700 dark:text-gray-200">
                </div>
                <div>
                    <label for="statsDateTo" class="block text-sm font-medium text-gray-700 dark:text-gray-300">To
                        Date</label>
                    <input type="date" id="statsDateTo" formControlName="dateTo"
                        class="mt-1 block w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-primary focus:border-primary dark:bg-gray-700 dark:text-gray-200">
                </div>
                <div class="flex space-x-2 md:pt-6"> <!-- md:pt-6 to align with labels on larger screens -->
                    <button type="submit"
                        class="flex-1 bg-primary hover:bg-primary-dark text-white font-semibold py-2 px-4 rounded-md shadow-sm disabled:opacity-50">
                        Apply
                    </button>
                    <button type="button" (click)="resetStatsFilters()"
                        class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700">
                        Reset
                    </button>
                </div>
            </div>
        </form>
    </div>
    <!-- End Date Range Filter Section -->

    <!-- Main content area that depends on logs -->
    <ng-container *ngIf="allLogs().length > 0; else noDataOverall">
        <!-- This inner container shows content if there are logs in the filtered period OR if no filters are active (meaning show all-time) -->
        <div *ngIf="filteredLogsForStats().length > 0 || !hasActiveDateFilters(); else noDataInPeriod">

            <!-- Overall Stats Cards -->
            <section class="mb-8 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
                <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md text-center">
                    <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2">Workouts <span
                            *ngIf="hasActiveDateFilters()">(Period)</span></h2>
                    <p class="text-4xl font-bold text-primary dark:text-primary-light">{{ workoutsInPeriodCount() }}</p>
                </div>
                <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md text-center">
                    <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2">Total Volume <span
                            *ngIf="hasActiveDateFilters()">(Period)</span></h2>
                    <p class="text-4xl font-bold text-primary dark:text-primary-light">
                        {{ volumeInPeriod() | number:'1.0-0' }} <span class="text-lg font-medium">{{
                            unitsService.getUnitLabel() }}</span>
                    </p>
                </div>

                <!-- Current Streak Card with Flame Icon -->
                <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md text-center">
                    <div class="flex items-center justify-center mb-2 text-gray-600 dark:text-gray-300">
                        <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300">Current Streak</h2>
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="1.5"
                            stroke="currentColor" class="w-8 h-8 transition-transform duration-300">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <path
                                    d="M20 15C20 19.2545 17.3819 21.1215 15.3588 21.751C14.9274 21.8853 14.6438 21.3823 14.9019 21.0115C15.7823 19.7462 16.8 17.8159 16.8 16C16.8 14.0494 15.1559 11.7465 13.8721 10.3261C13.5786 10.0014 13.0667 10.2163 13.0507 10.6537C12.9976 12.1029 12.7689 14.0418 11.7828 15.5614C11.6241 15.806 11.2872 15.8262 11.1063 15.5975C10.7982 15.2079 10.4901 14.7265 10.182 14.3462C10.016 14.1414 9.71604 14.1386 9.52461 14.3198C8.77825 15.0265 7.73333 16.1286 7.73333 17.5C7.73333 18.4893 8.20479 19.7206 8.69077 20.6741C8.91147 21.1071 8.50204 21.615 8.08142 21.3715C6.24558 20.3088 4 18.1069 4 15C4 11.8536 8.31029 7.49484 9.95605 3.37694C10.2157 2.72714 11.0161 2.42181 11.5727 2.84585C14.9439 5.41391 20 10.3781 20 15Z"
                                    stroke="currentColor" stroke-width="1.5"></path>
                            </g>
                        </svg>

                    </div>
                    <p class="text-4xl font-bold text-primary dark:text-primary-light">
                        {{ currentWorkoutStreakInfo().length }} <span class="text-lg font-medium">{{
                            currentWorkoutStreakInfo().length === 1 ? 'day' : 'days' }}</span>
                    </p>
                    <div *ngIf="currentWorkoutStreakInfo().length > 0 && currentWorkoutStreakInfo().startDate && currentWorkoutStreakInfo().endDate"
                        class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                        {{ currentWorkoutStreakInfo().startDate | date:'mediumDate' }}
                        <span
                            *ngIf="!isSameDate(currentWorkoutStreakInfo().startDate, currentWorkoutStreakInfo().endDate)">
                            - {{ currentWorkoutStreakInfo().endDate | date:'mediumDate' }}
                        </span>
                    </div>
                    <p *ngIf="currentWorkoutStreakInfo().length === 0"
                        class="text-xs text-gray-500 dark:text-gray-400 mt-1">No current streak.</p>
                </div>

                <!-- Longest Streak Card with Cup Icon -->
                <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md text-center">
                    <div class="flex items-center justify-center mb-2 text-gray-600 dark:text-gray-300">
                        <h2 class="text-xl font-semibold">Longest Streak</h2>
                        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="1.5"
                            stroke="currentColor" class="w-8 h-8 transition-transform duration-300">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <g>
                                    <path fill="currentColor"
                                        d="M54,22C54,9.869,44.131,0,32,0S10,9.869,10,22c0,6.816,3.117,12.92,8,16.958V62 c0,0.758,0.428,1.45,1.105,1.789C19.388,63.931,19.694,64,19.998,64c0.426,0,0.848-0.136,1.202-0.4L32,55.5l10.8,8.1 c0.354,0.265,0.775,0.4,1.2,0.4c0.305,0,0.611-0.069,0.895-0.211C45.572,63.45,46,62.758,46,62V38.958 C50.883,34.92,54,28.816,54,22z M20,62V40.425c0.645,0.421,1.312,0.809,2,1.161V60.5L20,62z M32,53l-8,6V42.487 C26.481,43.46,29.178,44,32,44s5.519-0.54,8-1.513V59L32,53z M44,62l-2-1.5V41.586c0.688-0.353,1.355-0.74,2-1.161V62z M32,42 c-11.028,0-20-8.972-20-20S20.972,2,32,2s20,8.972,20,20S43.028,42,32,42z">
                                    </path>
                                    <path fill="currentColor"
                                        d="M32,4c-9.925,0-18,8.075-18,18s8.075,18,18,18s18-8.075,18-18S41.925,4,32,4z M32,38 c-8.822,0-16-7.178-16-16S23.178,6,32,6s16,7.178,16,16S40.822,38,32,38z">
                                    </path>
                                    <path fill="currentColor"
                                        d="M39.147,19.361l-4.309-0.658l-1.936-4.123c-0.165-0.352-0.518-0.575-0.905-0.575s-0.74,0.224-0.905,0.575 l-1.936,4.123l-4.309,0.658c-0.37,0.057-0.678,0.315-0.797,0.671s-0.029,0.747,0.232,1.016l3.146,3.227l-0.745,4.564 c-0.062,0.378,0.099,0.758,0.411,0.979s0.725,0.243,1.061,0.058l3.841-2.124l3.841,2.124C35.99,29.959,36.157,30,36.323,30 c0.202,0,0.404-0.062,0.576-0.183c0.312-0.221,0.473-0.601,0.411-0.979l-0.745-4.564l3.146-3.227 c0.262-0.269,0.352-0.66,0.232-1.016S39.518,19.418,39.147,19.361z M34.781,23.239c-0.222,0.228-0.322,0.546-0.271,0.859 l0.495,3.029l-2.522-1.395c-0.151-0.083-0.317-0.125-0.484-0.125s-0.333,0.042-0.484,0.125l-2.522,1.395l0.495-3.029 c0.051-0.313-0.05-0.632-0.271-0.859l-2.141-2.194l2.913-0.445c0.329-0.05,0.612-0.261,0.754-0.563l1.257-2.678l1.257,2.678 c0.142,0.303,0.425,0.514,0.754,0.563l2.913,0.445L34.781,23.239z">
                                    </path>
                                </g>
                            </g>
                        </svg>

                    </div>
                    <p class="text-4xl font-bold text-primary dark:text-primary-light">
                        {{ longestWorkoutStreakInfo().length }} <span class="text-lg font-medium">{{
                            longestWorkoutStreakInfo().length === 1 ? 'day' : 'days' }}</span>
                    </p>
                    <div *ngIf="longestWorkoutStreakInfo().length > 0 && longestWorkoutStreakInfo().startDate && longestWorkoutStreakInfo().endDate"
                        class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                        From: {{ longestWorkoutStreakInfo().startDate | date:'mediumDate' }}
                        <br>
                        To: {{ longestWorkoutStreakInfo().endDate | date:'mediumDate' }}
                    </div>
                    <p *ngIf="longestWorkoutStreakInfo().length === 0"
                        class="text-xs text-gray-500 dark:text-gray-400 mt-1">No workouts logged yet.</p>
                </div>
            </section>

            <!-- CHARTS SECTION -->
            <section class="mb-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md min-h-[350px] overflow-hidden">
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-300 mb-3">Volume by Muscle Group <span
                            *ngIf="hasActiveDateFilters()">(Period)</span></h3>
                    <div *ngIf="muscleGroupChartDataForPeriod().length > 0; else noChartDataMsg" class="chart-wrapper">
                        <ngx-charts-bar-vertical [results]="muscleGroupChartDataForPeriod()" [scheme]="colorScheme"
                            [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="false"
                            [showXAxisLabel]="showXAxisLabel" [showYAxisLabel]="showYAxisLabel"
                            [xAxisLabel]="xAxisLabelMuscle" [yAxisLabel]="yAxisLabelVolume"
                            (select)="onChartSelect($event)" class="chart-container">
                        </ngx-charts-bar-vertical>
                    </div>
                    <ng-template #noChartDataMsg>
                        <p class="text-sm text-gray-500 dark:text-gray-400 italic text-center pt-10">Not enough data for
                            this chart.</p>
                    </ng-template>
                </div>

                <div *ngIf="hasWeeklyVolumeChartData; else noChartDataMsg" class="chart-wrapper">
                    <ngx-charts-line-chart [results]="weeklyVolumeChartDataForPeriod()" [gradient]="gradient"
                        [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="false" [showXAxisLabel]="showXAxisLabel"
                        [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabelWeek" [yAxisLabel]="yAxisLabelVolume"
                        [autoScale]="true" [scheme]="colorScheme" (select)="onChartSelect($event)"
                        class="chart-container">
                    </ngx-charts-line-chart>
                </div>
                <ng-template #noChartDataMsg>
                    <p class="text-sm text-gray-500 dark:text-gray-400 italic text-center pt-10">Not enough data for
                        this chart.</p>
                </ng-template>
            </section>

            <!-- Weekly Summaries Table -->
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-300 mb-4">Weekly Summary <span
                        *ngIf="hasActiveDateFilters()">(Period)</span></h2>
                <div *ngIf="weeklySummariesTableDataForPeriod().length > 0; else noWeeklyDataMsg"
                    class="overflow-x-auto bg-white dark:bg-gray-700 rounded-lg shadow-md">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Week</th>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Workouts</th>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Total Volume (kg)</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-700">
                            <tr *ngFor="let summary of weeklySummariesTableDataForPeriod()">
                                <td
                                    class="px-2 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100">
                                    {{ summary.weekLabel }} - {{ summary.weekLabelStart }}-{{ summary.weekLabelEnd }}
                                </td>
                                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">{{
                                    summary.workoutCount }}</td>
                                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">{{
                                    summary.totalVolume | number:'1.0-0' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <ng-template #noWeeklyDataMsg>
                    <p class="text-gray-500 dark:text-gray-400 italic">No weekly data to display for this period.</p>
                </ng-template>
            </section>

            <!-- Muscle Group Performance Table -->
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-300 mb-4 ">Volume by Muscle Group <span
                        *ngIf="hasActiveDateFilters()">(Period)</span></h2>
                <div *ngIf="muscleGroupPerformanceTableDataForPeriod().length > 0; else noMuscleDataMsg"
                    class="overflow-x-auto bg-white dark:bg-gray-700 rounded-lg shadow-md">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider text-balance">
                                    Muscle Group</th>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Workouts</th>
                                <th scope="col"
                                    class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Total Volume (kg)</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-700">
                            <tr *ngFor="let perf of muscleGroupPerformanceTableDataForPeriod()">
                                <td
                                    class="px-2 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100 text-balance">
                                    {{ perf.muscleGroup | titlecase }}</td>
                                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">{{
                                    perf.workoutCount }}</td>
                                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">{{
                                    perf.volume | number:'1.0-0' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <ng-template #noMuscleDataMsg>
                    <p class="text-gray-500 dark:text-gray-400 italic">No muscle group performance data to display for
                        this period.</p>
                </ng-template>
            </section>
        </div> <!-- End of *ngIf="filteredLogsForStats().length > 0 || !hasActiveDateFilters()" -->

        <!-- Message specifically for when filters are active but yield no results -->
        <ng-template #noDataInPeriod>
            <div *ngIf="hasActiveDateFilters() && filteredLogsForStats().length === 0"
                class="text-center py-12 px-6 bg-white dark:bg-gray-700 rounded-lg shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-16 h-16 mx-auto text-gray-400 dark:text-gray-500 mb-4">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <h3 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2">No Workout Data in Selected
                    Period</h3>
                <p class="text-gray-500 dark:text-gray-400">Try adjusting the date range or reset filters to view
                    all-time statistics.</p>
            </div>
        </ng-template>

    </ng-container> <!-- End of *ngIf="allLogs().length > 0" -->

    <ng-template #noDataOverall>
        <div class="text-center py-12 px-6 bg-white dark:bg-gray-700 rounded-lg shadow-md">
            <!-- Your existing "No Data for Statistics" SVG and message -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-16 h-16 mx-auto text-gray-400 dark:text-gray-500 mb-4">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941">
                </path>
            </svg>
            <h3 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2">No Data for Statistics</h3>
            <p class="text-gray-500 dark:text-gray-400">Complete some <button (click)="browseRoutines()"
                    class="text-primary dark:text-primary-light hover:underline">workouts</button> to see your
                statistics here</p>
        </div>
    </ng-template>
</div>

<!-- Added some SCSS for chart wrapper to help with responsiveness -->
<style>
    .chart-wrapper {
        width: 100%;
        height: 300px;
        /* Or your desired chart height */
        display: block;
        /* Ensures ngx-charts can calculate its dimensions */
    }

    .chart-container .ngx-charts {
        /* Target ngx-charts specifically if needed */
        overflow: visible !important;
        /* Sometimes helps with labels being cut off */
    }
</style>
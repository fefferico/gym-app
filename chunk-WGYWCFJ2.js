import{A as x,B as p,Gb as h,I as g,M as n,Rb as m,Tb as v,_b as S,a as o,b as a,d as u,h as d,l as c,m as b,n as t,w as f,y as E}from"./chunk-LBCPHAYK.js";var w=class l{http=n(h);storageService=n(v);trackingService=n(S);EXERCISES_STORAGE_KEY="fitTrackPro_exercises";exercisesJsonUrl="assets/data/exercises.json";exercisesSubject;exercises$;serviceInitializedPromise;serviceInitializedResolve;constructor(){this.serviceInitializedPromise=new Promise(s=>{this.serviceInitializedResolve=s});let e=this.loadExercisesFromStorage();this.exercisesSubject=new d(e),this.exercises$=this.exercisesSubject.asObservable().pipe(p(1)),e.length===0?this.seedExercisesFromAssets():this.serviceInitializedResolve()}loadExercisesFromStorage(){return this.storageService.getItem(this.EXERCISES_STORAGE_KEY)||[]}saveExercisesToStorage(e){this.storageService.setItem(this.EXERCISES_STORAGE_KEY,e),this.exercisesSubject.next([...e].sort((s,r)=>s.name.localeCompare(r.name)))}seedExercisesFromAssets(){this.http.get(this.exercisesJsonUrl).pipe(E(1),f(e=>(console.error("ExerciseService: Failed to load seed exercises from JSON file:",e),c([])))).subscribe(e=>{e&&e.length>0&&this.exercisesSubject.getValue().length===0&&this.saveExercisesToStorage(e),this.serviceInitializedResolve()})}ensureInitialized(){return this.serviceInitializedPromise}getExercises(){return this.exercises$}getExerciseById(e){return this.exercises$.pipe(x(),t(s=>s.find(i=>i.id===e)))}addExercise(e){let s=this.exercisesSubject.getValue(),r=a(o({},e),{id:m()}),i=[...s,r];return this.saveExercisesToStorage(i),c(r)}updateExercise(e){let s=this.exercisesSubject.getValue(),r=s.findIndex(i=>i.id===e.id);if(r>-1){let i=[...s];return i[r]=o({},e),this.saveExercisesToStorage(i),c(e)}return b(()=>new Error(`Exercise with id ${e.id} not found for update.`))}deleteExercise(e){return u(this,null,function*(){let s=this.exercisesSubject.getValue();if(!s.find(i=>i.id===e))return console.warn(`ExerciseService: Exercise with id ${e} not found for deletion.`),Promise.reject(new Error("Exercise not found"));try{yield this.trackingService.handleExerciseDeletion(e);let i=s.filter(y=>y.id!==e);this.saveExercisesToStorage(i)}catch(i){throw console.error(`Error during exercise deletion process for ${e}:`,i),i}})}getExercisesByCategory(e){return this.getExercises().pipe(t(s=>s.filter(r=>r.category===e)))}getExercisesByMuscleGroup(e){return this.getExercises().pipe(t(s=>s.filter(r=>r.muscleGroups.includes(e))))}getUniqueCategories(){return this.getExercises().pipe(t(e=>[...new Set(e.map(s=>s.category))]))}getUniquePrimaryMuscleGroups(){return this.getExercises().pipe(t(e=>[...new Set(e.map(s=>s.primaryMuscleGroup))].sort()))}determineExerciseIcon(e,s){let r=s.toLowerCase();if(e&&e.equipment){let i=e.equipment.toLowerCase();if(i.includes("barbell"))return"barbell";if(i.includes("dumbbell"))return"dumbbell";if(i.includes("machine")||i.includes("cable"))return"machine";if(i.includes("body")||i.includes("none"))return"bodyweight";if(i.includes("kettlebell"))return"kettlebell";if(i.includes("resistance band"))return"resistance-band"}if(r.includes("barbell"))return"barbell";if(r.includes("dumbbell")||r.includes("db "))return"dumbbell";if(r.includes("squat")&&!r.includes("dumbbell")||r.includes("deadlift")||r.includes("bench press")||r.includes("row")&&(r.includes("barbell")||!r.includes("dumbbell"))||r.includes("curl")&&r.includes("barbell"))return"barbell";if(r.includes("curl")&&r.includes("dumbbell"))return"dumbbell";if(r.includes("machine")||r.includes("cable"))return"machine";if(r.includes("body")||r.includes("none"))return"bodyweight";if(r.includes("kettlebell"))return"kettlebell";if(r.includes("run")||r.includes("cardio")||r.includes("tapis")||r.includes("jog"))return"cardio";if(r.includes("resistance band"))return"resistance-band";if(e?.category){let i=e.category.toLowerCase();if((i==="strength"||i==="powerlifting"||i==="olympic weightlifting")&&(r.includes("squat")||r.includes("deadlift")||r.includes("bench")))return"barbell";if(i==="cardio")return"cardio";if(i==="calisthenics"||i==="plyometrics")return"bodyweight"}return"default-exercise"}getIconPath(e){return`assets/icons/${e||"default-exercise"}.svg`}static \u0275fac=function(s){return new(s||l)};static \u0275prov=g({token:l,factory:l.\u0275fac,providedIn:"root"})};export{w as a};

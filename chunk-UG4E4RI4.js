import{a as dn,b as cn}from"./chunk-KXHJ4RUZ.js";import{a as _n}from"./chunk-AXH4QLPZ.js";import{b as fn}from"./chunk-Z4TZUIZO.js";import{P as mn}from"./chunk-G43NHZIQ.js";import{a as pn}from"./chunk-6G3JKOK5.js";import{a as ni}from"./chunk-NKW74HA2.js";import{a as gn,b as hn}from"./chunk-ZCI4ICVD.js";import{a as un}from"./chunk-BYMK47GQ.js";import{a as ri}from"./chunk-XUCDL42V.js";import{a as oi}from"./chunk-YYSXDDXE.js";import{B as Ge,C as nn,E as ie,F as on,I as Jt,M as Xt,P as ei,S as ti,T as an,U as qe,V as ii,W as ln,b as Et,c as Bi,d as Ur,e as $r,f as jr,g as Kr,h as Zr,i as Yr,j as Qr,k as Jr,l as Xr,m as Kt,o as Pi,q as Tt,r as Ai,s as Vi,t as en,u as Zt,v as ye,w as tn,x as Yt,y as Oe,z as rn}from"./chunk-XKPEWNK7.js";import{c as Qt,u as me,x as sn}from"./chunk-FTHZU3WL.js";import{$ as Ke,$a as Ae,$b as Ir,$c as $t,B as Xe,Ba as Fi,Bb as ve,Bc as Qe,Ca as Ct,Cb as Ie,D as Ii,Da as kt,Dc as Ut,E as Ot,Eb as ae,F as ue,Fb as Di,G as Me,H as et,Ha as mr,Hb as rt,I as Wt,Ia as gr,Ib as We,Ja as p,Jb as xr,Jc as U,K as $,Ka as u,Kb as vr,Kc as Dr,L as $e,La as d,Lb as nt,Lc as dt,M as Se,Ma as F,Mb as ot,Mc as Le,N as lr,Na as O,Nb as st,Nc as ct,O as S,Oa as W,Ob as yr,Oc as Rr,Pa as ke,Pb as br,Pc as pe,Q as dr,Qa as D,Qb as wr,Qc as It,Ra as I,Rb as Sr,Rc as ut,Sa as c,Sb as Cr,Sc as Br,T as y,Tb as zt,Tc as Pr,U as b,Ub as at,Vc as Ar,Wa as Re,Wb as kr,X as je,Xa as Be,Xb as Er,Xc as Vr,Y as _e,Ya as Pe,Yc as Lr,Za as Q,Zb as lt,Zc as Or,_ as R,_a as it,_c as Wr,a as Te,ab as hr,ad as pt,b as yt,ba as fe,bb as h,bd as mt,c as H,ca as cr,cb as E,d as or,da as Nt,db as C,dd as Nr,eb as J,f as ki,fa as ur,fb as Gt,fd as Gr,ga as pr,gb as K,gd as jt,h as He,hb as Z,hd as gt,i as se,ib as Y,id as qr,ja as a,jb as _r,jc as Tr,jd as zr,l as he,la as q,lb as Ve,ld as ht,m as de,ma as Fe,mb as Ye,md as _t,n as sr,na as Ti,nb as te,o as Ue,oa as wt,ob as j,od as Ne,p as Vt,pa as tt,pb as qt,pc as Mr,pd as ft,qa as Mi,qd as xt,ra as Ce,rc as Fr,rd as Hr,sa as St,t as ar,tb as _,u as Lt,ua as De,ub as f,v as Je,va as Ze,vb as Ee,w as Ei,wa as ce,wb as fr,xb as xe,xc as Ri,y as bt,yc as Ht,z as we,za as w}from"./chunk-C767T4VF.js";import{a as A,b as N,c as nr,g as L}from"./chunk-GAL4ENT6.js";var Li;function no(){if(Li==null){let n=typeof document<"u"?document.head:null;Li=!!(n&&(n.createShadowRoot||n.attachShadow))}return Li}function si(n){if(no()){let t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Mt(n){return n.composedPath?n.composedPath()[0]:n.target}function xn(n){return n.buttons===0||n.detail===0}function vn(n){let t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}function ai(n,t=0){return oo(n)?Number(n):arguments.length===2?t:0}function oo(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function be(n){return n instanceof fe?n.nativeElement:n}var li=new WeakMap,yn=(()=>{class n{_appRef;_injector=S(je);_environmentInjector=S(dr);load(e){let i=this._appRef=this._appRef||this._injector.get(Fi),r=li.get(i);r||(r={loaders:new Set,refs:[]},li.set(i,r),i.onDestroy(()=>{li.get(i)?.refs.forEach(o=>o.destroy()),li.delete(i)})),r.loaders.has(e)||(r.loaders.add(e),r.refs.push(vr(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Oi;try{Oi=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Oi=!1}var Wi=(()=>{class n{_platformId=S(Nt);isBrowser=this._platformId?Ir(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Oi)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var so=new Se("cdk-dir-doc",{providedIn:"root",factory:ao});function ao(){return S(_e)}var lo=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function co(n){let t=n?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?lo.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var Ni=(()=>{class n{get value(){return this.valueSignal()}valueSignal=R("ltr");change=new q;constructor(){let e=S(so,{optional:!0});if(e){let i=e.body?e.body.dir:null,r=e.documentElement?e.documentElement.dir:null;this.valueSignal.set(co(i||r||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Gi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Ze({type:n});static \u0275inj=$e({})}return n})();var uo=20,bn=(()=>{class n{_ngZone=S(Fe);_platform=S(Wi);_renderer=S(tt).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new H;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=uo){return this._platform.isBrowser?new yt(i=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=e>0?this._scrolled.pipe(Ei(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):se()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){let r=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(Je(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(e){let i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,e)&&i.push(o)}),i}_scrollableContainsElement(e,i){let r=be(i),o=e.getElementRef().nativeElement;do if(r==o)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var po=20,wn=(()=>{class n{_platform=S(Wi);_listeners;_viewportSize;_change=new H;_document=S(_e);constructor(){let e=S(Fe),i=S(tt).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=o=>this._change.next(o);this._listeners=[i.listen("window","resize",r),i.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,i=this._getWindow(),r=e.documentElement,o=r.getBoundingClientRect(),s=-o.top||e.body.scrollTop||i.scrollY||r.scrollTop||0,l=-o.left||e.body.scrollLeft||i.scrollX||r.scrollLeft||0;return{top:s,left:l}}change(e=po){return e>0?this._change.pipe(Ei(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var di=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Ze({type:n});static \u0275inj=$e({})}return n})(),Sn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Ze({type:n});static \u0275inj=$e({imports:[Gi,di,Gi,di]})}return n})();var qi={},Cn=(()=>{class n{_appId=S(cr);getId(e){return this._appId!=="ng"&&(e+=this._appId),qi.hasOwnProperty(e)||(qi[e]=0),`${e}${qi[e]++}`}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kn(n){return Array.isArray(n)?n:[n]}function Ui(n){let t=n.cloneNode(!0),e=t.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();t.removeAttribute("id");for(let r=0;r<e.length;r++)e[r].removeAttribute("id");return i==="canvas"?Tn(n,t):(i==="input"||i==="select"||i==="textarea")&&In(n,t),En("canvas",n,t,Tn),En("input, textarea, select",n,t,In),t}function En(n,t,e,i){let r=t.querySelectorAll(n);if(r.length){let o=e.querySelectorAll(n);for(let s=0;s<r.length;s++)i(r[s],o[s])}}var mo=0;function In(n,t){t.type!=="file"&&(t.value=n.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${mo++}`)}function Tn(n,t){let e=t.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function Qi(n){let t=n.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function $i(n,t,e){let{top:i,bottom:r,left:o,right:s}=n;return e>=i&&e<=r&&t>=o&&t<=s}function go(n,t){let e=t.left<n.left,i=t.left+t.width>n.right,r=t.top<n.top,o=t.top+t.height>n.bottom;return e||i||r||o}function Rt(n,t,e){n.top+=t,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function Mn(n,t,e,i){let{top:r,right:o,bottom:s,left:l,width:g,height:m}=n,x=g*t,v=m*t;return i>r-v&&i<s+v&&e>l-x&&e<o+x}var ci=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Qi(e)})})}handleScroll(t){let e=Mt(t),i=this.positions.get(e);if(!i)return null;let r=i.scrollPosition,o,s;if(e===this._document){let m=this.getViewportScrollPosition();o=m.top,s=m.left}else o=e.scrollTop,s=e.scrollLeft;let l=r.top-o,g=r.left-s;return this.positions.forEach((m,x)=>{m.clientRect&&e!==x&&e.contains(x)&&Rt(m.clientRect,l,g)}),r.top=o,r.left=s,{top:l,left:g}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Gn(n,t){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let i=t.createElement("div");return e.forEach(r=>i.appendChild(r)),i}function Ji(n,t,e){for(let i in t)if(t.hasOwnProperty(i)){let r=t[i];r?n.setProperty(i,r,e?.has(i)?"important":""):n.removeProperty(i)}return n}function vt(n,t){let e=t?"":"none";Ji(n.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function Fn(n,t,e){Ji(n.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function ui(n,t){return t&&t!="none"?n+" "+t:n}function Dn(n,t){n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.transform=Bt(t.left,t.top)}function Bt(n,t){return`translate3d(${Math.round(n)}px, ${Math.round(t)}px, 0)`}function Rn(n){let t=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*t}function ho(n){let t=getComputedStyle(n),e=zi(t,"transition-property"),i=e.find(l=>l==="transform"||l==="all");if(!i)return 0;let r=e.indexOf(i),o=zi(t,"transition-duration"),s=zi(t,"transition-delay");return Rn(o[r])+Rn(s[r])}function zi(n,t){return n.getPropertyValue(t).split(",").map(i=>i.trim())}var _o=new Set(["position"]),ji=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,e,i,r,o,s,l,g,m,x){this._document=t,this._rootElement=e,this._direction=i,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=l,this._initialTransform=g,this._zIndex=m,this._renderer=x}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),Bn(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return ho(this._preview)}addEventListener(t,e){return this._renderer.listen(this._preview,t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,i=t?t.template:null,r;if(i&&t){let o=t.matchSize?this._initialDomRect:null,s=t.viewContainer.createEmbeddedView(i,t.context);s.detectChanges(),r=Gn(s,this._document),this._previewEmbeddedView=s,t.matchSize?Dn(r,o):r.style.transform=Bt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=Ui(this._rootElement),Dn(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return Ji(r.style,{"pointer-events":"none",margin:Bn(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},_o),vt(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(o=>r.classList.add(o)):r.classList.add(e)),r}};function Bn(n){return"showPopover"in n}var fo={passive:!0},Pn={passive:!1},xo={passive:!1,capture:!0},vo=800,An="cdk-drag-placeholder",Vn=new Set(["position"]),Ki=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=R(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new H;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Te.EMPTY;_pointerUpSubscription=Te.EMPTY;_scrollSubscription=Te.EMPTY;_resizeSubscription=Te.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>vt(e,t)))}_disabled=!1;beforeStarted=new H;started=new H;released=new H;ended=new H;entered=new H;exited=new H;dropped=new H;moved=this._moveEvents;data;constrainPosition;constructor(t,e,i,r,o,s,l){this._config=e,this._document=i,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._renderer=l,this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new ci(i),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>be(i)),this._handles.forEach(i=>vt(i,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=be(t);if(e!==this._rootElement){this._removeRootElementListeners();let i=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[i.listen(e,"mousedown",this._pointerDown,Pn),i.listen(e,"touchstart",this._pointerDown,fo),i.listen(e,"dragstart",this._nativeDragStart,Pn)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?be(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&go(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),i=0,r=0;e.left<t.left?i=t.left-e.left:e.right>t.right&&(i=t.right-e.right),e.top<t.top?r=t.top-e.top:e.bottom>t.bottom&&(r=t.bottom-e.bottom);let o=this._activeTransform.x,s=this._activeTransform.y,l=o+i,g=s+r;this._rootElement.style.transform=Bt(l,g),this._activeTransform={x:l,y:g},this._passiveTransform={x:l,y:g}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),vt(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),vt(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let r=Math.abs(e.x-this._pickupPositionOnPage.x),o=Math.abs(e.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let l=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),g=this._dropContainer;if(!l){this._endDragSequence(t);return}(!g||!g.isDragging()&&!g.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=i.x-r.x+this._passiveTransform.x,o.y=i.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Ft(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),i=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",yo,xo)}),i){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),l=this._marker=this._marker||this._document.createComment("");o.insertBefore(l,r),this._initialTransform=r.style.transform||"",this._preview=new ji(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,e)),Fn(r,!1,Vn),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:t}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let i=this.isDragging(),r=Ft(e),o=!r&&e.button!==0,s=this._rootElement,l=Mt(e),g=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+vo>Date.now(),m=r?vn(e):xn(e);if(l&&l.draggable&&e.type==="mousedown"&&e.preventDefault(),i||o||g||m)return;if(this._handles.length){let k=s.style;this._rootElementTapHighlight=k.webkitTapHighlightColor||"",k.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(k=>this._updateOnScroll(k)),this._boundaryElement&&(this._boundaryRect=Qi(this._boundaryElement));let x=this._previewTemplate;this._pickupPositionInElement=x&&x.template&&!x.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let v=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:v.x,y:v.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){Fn(this._rootElement,!0,Vn),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,i=e.getItemIndex(this),r=this._getPointerPositionOnPage(t),o=this._getDragDistance(r),s=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,s,o,r,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),l=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,l),this._dropContainer=o,this._dropContainer.enter(this,t,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let r=l=>{(!l||this._preview&&Mt(l)===this._preview.element&&l.propertyName==="transform")&&(s(),i(),clearTimeout(o))},o=setTimeout(r,e*1.5),s=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=Gn(this._placeholderRef,this._document)):i=Ui(this._rootElement),i.style.pointerEvents="none",i.classList.add(An),i}_getPointerPositionInElement(t,e,i){let r=e===this._rootElement?null:e,o=r?r.getBoundingClientRect():t,s=Ft(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition(),g=s.pageX-o.left-l.left,m=s.pageY-o.top-l.top;return{x:o.left-t.left+g,y:o.top-t.top+m}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),i=Ft(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,r=i.pageX-e.left,o=i.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=o,l.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:r}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:g,height:m}=this._getPreviewRect(),x=l.top+s,v=l.bottom-(m-s),k=l.left+o,T=l.right-(g-o);i=Ln(i,k,T),r=Ln(r,x,v)}return{x:i,y:r}}_updatePointerDirectionDelta(t){let{x:e,y:i}=t,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-o.x),l=Math.abs(i-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=e>o.x?1:-1,o.x=e),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>o.y?1:-1,o.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,vt(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,e){let i=1/this.scale,r=Bt(t*i,e*i),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=ui(r,this._initialTransform)}_applyPreviewTransform(t,e){let i=this._previewTemplate?.template?void 0:this._initialTransform,r=Bt(t,e);this._preview.setTransform(ui(r,i))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||i.width===0&&i.height===0)return;let o=r.left-i.left,s=i.right-r.right,l=r.top-i.top,g=i.bottom-r.bottom;r.width>i.width?(o>0&&(t+=o),s>0&&(t-=s)):t=0,r.height>i.height?(l>0&&(e+=l),g>0&&(e-=g)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:Ft(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let i=Mt(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Rt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=si(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let i=this._previewContainer||"global";if(i==="parent")return t;if(i==="global"){let r=this._document;return e||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return be(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}_conditionallyInsertAnchor(t,e,i){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let r=this._anchor??=Ui(this._placeholder);r.classList.remove(An),r.classList.add("cdk-drag-anchor"),r.style.transform="",i?i.before(r):be(e.element).appendChild(r)}}};function Ln(n,t,e){return Math.max(t,Math.min(e,n))}function Ft(n){return n.type[0]==="t"}function yo(n){n.preventDefault()}function gi(n,t,e){let i=On(t,n.length-1),r=On(e,n.length-1);if(i===r)return;let o=n[i],s=r<i?-1:1;for(let l=i;l!==r;l+=s)n[l]=n[l+s];n[r]=o}function On(n,t){return Math.max(0,Math.min(t,n))}var pi=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,e,i,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,e,i,r);if(s===-1&&o.length>0)return null;let l=this.orientation==="horizontal",g=o.findIndex(P=>P.drag===t),m=o[s],x=o[g].clientRect,v=m.clientRect,k=g>s?1:-1,T=this._getItemOffsetPx(x,v,k),B=this._getSiblingOffsetPx(g,o,k),M=o.slice();return gi(o,g,s),o.forEach((P,le)=>{if(M[le]===P)return;let z=P.drag===t,V=z?T:B,ee=z?t.getPlaceholderElement():P.drag.getRootElement();P.offset+=V;let X=Math.round(P.offset*(1/P.drag.scale));l?(ee.style.transform=ui(`translate3d(${X}px, 0, 0)`,P.initialTransform),Rt(P.clientRect,0,V)):(ee.style.transform=ui(`translate3d(0, ${X}px, 0)`,P.initialTransform),Rt(P.clientRect,V,0))}),this._previousSwap.overlaps=$i(v,e,i),this._previousSwap.drag=m.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:g,currentIndex:s}}enter(t,e,i,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(t,e,i):r,s=this._activeDraggables,l=s.indexOf(t),g=t.getPlaceholderElement(),m=s[o];if(m===t&&(m=s[o+1]),!m&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(m=s[0]),l>-1&&s.splice(l,1),m&&!this._dragDropRegistry.isDragging(m)){let x=m.getRootElement();x.parentElement.insertBefore(g,x),s.splice(o,0,t)}else this._element.appendChild(g),s.push(t);g.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let i=this._itemPositions.find(r=>r.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(e=>e.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{Rt(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:Qi(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,e,i){let r=this.orientation==="horizontal",o=r?e.left-t.left:e.top-t.top;return i===-1&&(o+=r?e.width-t.width:e.height-t.height),o}_getSiblingOffsetPx(t,e,i){let r=this.orientation==="horizontal",o=e[t].clientRect,s=e[t+i*-1],l=o[r?"width":"height"]*i;if(s){let g=r?"left":"top",m=r?"right":"bottom";i===-1?l-=s.clientRect[g]-o[m]:l+=o[g]-s.clientRect[m]}return l}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,r=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let s=i[i.length-1].clientRect;return r?t>=s.right:e>=s.bottom}else{let s=i[0].clientRect;return r?t<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(t,e,i,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:l,clientRect:g})=>{if(l===t)return!1;if(r){let m=o?r.x:r.y;if(l===this._previousSwap.drag&&this._previousSwap.overlaps&&m===this._previousSwap.delta)return!1}return o?e>=Math.floor(g.left)&&e<Math.floor(g.right):i>=Math.floor(g.top)&&i<Math.floor(g.bottom)});return s===-1||!this._sortPredicate(s,t)?-1:s}},Zi=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,e){this._document=t,this._dragDropRegistry=e}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<e.length;i++){let r=e[i];this._relatedNodes.push([r,r.nextSibling])}this.withItems(t)}sort(t,e,i,r){let o=this._getItemIndexFromPointerPosition(t,e,i),s=this._previousSwap;if(o===-1||this._activeItems[o]===t)return null;let l=this._activeItems[o];if(s.drag===l&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let g=this.getItemIndex(t),m=t.getPlaceholderElement(),x=l.getRootElement();o>g?x.after(m):x.before(m),gi(this._activeItems,g,o);let v=this._getRootNode().elementFromPoint(e,i);return s.deltaX=r.x,s.deltaY=r.y,s.drag=l,s.overlaps=x===v||x.contains(v),{previousIndex:g,currentIndex:o}}enter(t,e,i,r){let o=this._activeItems.indexOf(t);o>-1&&this._activeItems.splice(o,1);let s=r==null||r<0?this._getItemIndexFromPointerPosition(t,e,i):r;s===-1&&(s=this._getClosestItemIndexToPointer(t,e,i));let l=this._activeItems[s];l&&!this._dragDropRegistry.isDragging(l)?(this._activeItems.splice(s,0,t),l.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[r,o]=this._relatedNodes[i];r.parentNode===t&&r.nextSibling!==o&&(o===null?t.appendChild(r):o.parentNode===t&&t.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,i){let r=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(i)),o=r?this._activeItems.findIndex(s=>{let l=s.getRootElement();return r===l||l.contains(r)}):-1;return o===-1||!this._sortPredicate(o,t)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=si(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let l=this._activeItems[s];if(l!==t){let{x:g,y:m}=l.getRootElement().getBoundingClientRect(),x=Math.hypot(e-g,i-m);x<r&&(r=x,o=s)}}return o}},Wn=.05,qn=.05,ge=(function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n})(ge||{}),ne=(function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n})(ne||{}),Yi=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new H;entered=new H;exited=new H;dropped=new H;sorted=new H;receivingStarted=new H;receivingStopped=new H;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Te.EMPTY;_verticalScrollDirection=ge.NONE;_horizontalScrollDirection=ne.NONE;_scrollNode;_stopScrollTimers=new H;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,e,i,r,o){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=o;let s=this.element=be(t);this._document=i,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new ci(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,r,o,s,l,g={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:l,event:g})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(r=>r.isDragging()).every(r=>t.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof pi&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new Zi(this._document,this._dragDropRegistry);else{let e=new pi(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,i)=>this.sortPredicate(e,i,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=be(this.element),i=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(t);return i>-1&&this._scrollableElements.splice(i,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,r){if(this.sortingDisabled||!this._domRect||!Mn(this._domRect,Wn,e,i))return;let o=this._sortStrategy.sort(t,e,i,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,r=ge.NONE,o=ne.NONE;if(this._parentPositions.positions.forEach((s,l)=>{l===this._document||!s.clientRect||i||Mn(s.clientRect,Wn,t,e)&&([r,o]=bo(l,s.clientRect,this._direction,t,e),(r||o)&&(i=l))}),!r&&!o){let{width:s,height:l}=this._viewportRuler.getViewportSize(),g={width:s,height:l,top:0,right:s,bottom:l,left:0};r=zn(g,e),o=Hn(g,t),i=window}i&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=i,(r||o)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),ar(0,ki).pipe(et(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===ge.UP?t.scrollBy(0,-e):this._verticalScrollDirection===ge.DOWN&&t.scrollBy(0,e),this._horizontalScrollDirection===ne.LEFT?t.scrollBy(-e,0):this._horizontalScrollDirection===ne.RIGHT&&t.scrollBy(e,0)})};_isOverContainer(t,e){return this._domRect!=null&&$i(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(r=>r._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._domRect||!$i(this._domRect,e,i)||!this.enterPredicate(t,this))return!1;let r=this._getShadowRoot().elementFromPoint(e,i);return r?r===this._container||this._container.contains(r):!1}_startReceiving(t,e){let i=this._activeSiblings;!i.has(t)&&e.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=si(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function zn(n,t){let{top:e,bottom:i,height:r}=n,o=r*qn;return t>=e-o&&t<=e+o?ge.UP:t>=i-o&&t<=i+o?ge.DOWN:ge.NONE}function Hn(n,t){let{left:e,right:i,width:r}=n,o=r*qn;return t>=e-o&&t<=e+o?ne.LEFT:t>=i-o&&t<=i+o?ne.RIGHT:ne.NONE}function bo(n,t,e,i,r){let o=zn(t,r),s=Hn(t,i),l=ge.NONE,g=ne.NONE;if(o){let m=n.scrollTop;o===ge.UP?m>0&&(l=ge.UP):n.scrollHeight-m>n.clientHeight&&(l=ge.DOWN)}if(s){let m=n.scrollLeft;e==="rtl"?s===ne.RIGHT?m<0&&(g=ne.RIGHT):n.scrollWidth+m>n.clientWidth&&(g=ne.LEFT):s===ne.LEFT?m>0&&(g=ne.LEFT):n.scrollWidth-m>n.clientWidth&&(g=ne.RIGHT)}return[l,g]}var Dt={capture:!0},Hi={passive:!1,capture:!0},wo=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=De({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,r){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return n})(),Xi=(()=>{class n{_ngZone=S(Fe);_document=S(_e);_styleLoader=S(yn);_renderer=S(tt).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new H;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=R([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new H;pointerUp=new H;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Hi)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(wo),this._activeDragInstances.update(r=>[...r,e]),this._activeDragInstances().length===1)){let r=i.type.startsWith("touch"),o=l=>this.pointerUp.next(l),s=[["scroll",l=>this._scroll.next(l),Dt],["selectstart",this._preventDefaultWhileDragging,Hi]];r?s.push(["touchend",o,Dt],["touchcancel",o,Dt]):s.push(["mouseup",o,Dt]),r||s.push(["mousemove",l=>this.pointerMove.next(l),Hi]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([l,g,m])=>this._renderer.listen(this._document,l,g,m))})}}stopDragging(e){this._activeDragInstances.update(i=>{let r=i.indexOf(e);return r>-1?(i.splice(r,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this._scroll];return e&&e!==this._document&&i.push(new yt(r=>this._ngZone.runOutsideAngular(()=>{let o=this._renderer.listen(e,"scroll",s=>{this._activeDragInstances().length&&r.next(s)},Dt);return()=>{o()}}))),Lt(...i)}registerDirectiveNode(e,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,i)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),So={dragStartThreshold:5,pointerDirectionChangeThreshold:5},er=(()=>{class n{_document=S(_e);_ngZone=S(Fe);_viewportRuler=S(wn);_dragDropRegistry=S(Xi);_renderer=S(tt).createRenderer(null,null);constructor(){}createDrag(e,i=So){return new Ki(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Yi(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mi=new Se("CDK_DRAG_PARENT");var Un=new Se("CdkDragHandle"),Qc=(()=>{class n{element=S(fe);_parentDrag=S(mi,{optional:!0,skipSelf:!0});_dragDropRegistry=S(Xi);_stateChanges=new H;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let e=this.element.nativeElement.parentElement;for(;e;){let i=this._dragDropRegistry.getDragDirectiveForNode(e);if(i){this._parentDrag=i,i._addHandle(this);break}e=e.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ce({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",We]},features:[Ve([{provide:Un,useExisting:n}])]})}return n})(),$n=new Se("CDK_DRAG_CONFIG"),jn=new Se("CdkDropList"),Kn=(()=>{class n{element=S(fe);dropContainer=S(jn,{optional:!0,skipSelf:!0});_ngZone=S(Fe);_viewContainerRef=S(St);_dir=S(Ni,{optional:!0});_changeDetectorRef=S(rt);_selfHandle=S(Un,{optional:!0,self:!0});_parentDrag=S(mi,{optional:!0,skipSelf:!0});_dragDropRegistry=S(Xi);_destroyed=new H;_handles=new or([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new q;released=new q;ended=new q;entered=new q;exited=new q;dropped=new q;moved=new yt(e=>{let i=this._dragRef.moved.pipe(de(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(e);return()=>{i.unsubscribe()}});_injector=S(je);constructor(){let e=this.dropContainer,i=S($n,{optional:!0}),r=S(er);this._dragRef=r.createDrag(this.element,{dragStartThreshold:i&&i.dragStartThreshold!=null?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&i.pointerDirectionChangeThreshold!=null?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(et(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){Ti(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,r=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),r=i.indexOf(e);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):be(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof r=="object"&&r?r:ai(r),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(we(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){let r=this._dragDropRegistry.getDragDirectiveForNode(i);if(r){e.withParent(r._dragRef);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:l,draggingDisabled:g,rootElementSelector:m,previewContainer:x}=e;this.disabled=g??!1,this.dragStartDelay=r||0,this.lockAxis=i||null,o&&(this.constrainPosition=o),s&&(this.previewClass=s),l&&(this.boundaryElement=l),m&&(this.rootElementSelector=m),x&&(this.previewContainer=x)}_setupHandlesListener(){this._handles.pipe(Wt(e=>{let i=e.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Me(e=>Lt(...e.map(i=>i._stateChanges.pipe(ue(i))))),et(this._destroyed)).subscribe(e=>{let i=this._dragRef,r=e.element.nativeElement;e.disabled?i.disableHandle(r):i.enableHandle(r)})}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ce({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){i&2&&Ae("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",We],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",xr]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Ve([{provide:mi,useExisting:n}]),Ke]})}return n})(),Nn=new Se("CdkDropListGroup");var Zn=(()=>{class n{element=S(fe);_changeDetectorRef=S(rt);_scrollDispatcher=S(bn);_dir=S(Ni,{optional:!0});_group=S(Nn,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new H;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=S(Cn).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new q;entered=new q;exited=new q;sorted=new q;_unsortedItems=new Set;constructor(){let e=S(er),i=S($n,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let i=this._latestSortedRefs.indexOf(e._dragRef);i>-1&&(this._latestSortedRefs.splice(i,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=n._dropLists.indexOf(this);e>-1&&n._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(ue(this._dir.value),et(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=kn(this.connectedTo).map(r=>{if(typeof r=="string"){let o=n._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{i.indexOf(r)===-1&&i.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(r)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=ai(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),Lt(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:l}=e;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=l||"vertical",this.lockAxis=i||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ce({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,r){i&2&&(kt("id",r.id),Ae("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",We],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",We],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",We],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",We]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Ve([{provide:Nn,useValue:void 0},{provide:jn,useExisting:n}])]})}return n})();var Co=new Se("CdkDragPlaceholder"),Jc=(()=>{class n{templateRef=S(wt);_drag=S(mi,{optional:!0});data;constructor(){this._drag?._setPlaceholderTemplate(this)}ngOnDestroy(){this._drag?._resetPlaceholderTemplate(this)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ce({type:n,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[Ve([{provide:Co,useExisting:n}])]})}return n})();var Yn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Ze({type:n});static \u0275inj=$e({providers:[er],imports:[di]})}return n})();var Eo=["exerciseSearchFied"],Io=["scrollContainer"],To=(n,t,e)=>({"border border-4 border-primary":n,"bg-gray-200 dark:bg-gray-600":t,"bg-gray-100 dark:bg-gray-500":e}),Mo=n=>({count:n}),Fo=n=>({date:n}),Do=(n,t)=>t.name;function Ro(n,t){if(n&1&&(u(0,"option",22),h(1),_(2,"titlecase"),d()),n&2){let e=t.$implicit;p("value",e.id),a(),E(f(2,2,e.label))}}function Bo(n,t){if(n&1&&(u(0,"option",22),h(1),_(2,"titlecase"),d()),n&2){let e=t.$implicit;p("value",e.id),a(),E(f(2,2,e.name))}}function Po(n,t){if(n&1){let e=D();u(0,"div")(1,"label",43),h(2),_(3,"translate"),d(),u(4,"input",44,1),_(6,"translate"),Y("ngModelChange",function(r){y(e);let o=c(2);return Z(o.searchTerm,r)||(o.searchTerm=r),b(r)}),I("keydown.enter",function(){y(e);let r=c(2);return b(r.onSearchEnter())}),d()()}if(n&2){let e=c(2);a(2),E(f(3,4,"exerciseSelectionModal.searchLabel")),a(2),p("placeholder",_r(f(6,6,"exerciseSelectionModal.searchExerciseLabel"))),K("ngModel",e.searchTerm)}}function Ao(n,t){if(n&1){let e=D();u(0,"button",45),I("click",function(){y(e);let r=c(2);return b(r.onFindSimilar())}),h(1),_(2,"translate"),d()}n&2&&(a(),C(" ",f(2,1,"exerciseSelectionModal.showSimilar")," "))}function Vo(n,t){if(n&1){let e=D();u(0,"button",46),I("click",function(){y(e);let r=c(2);return b(r.onBackToSearch())}),F(1,"app-icon",47),h(2),_(3,"translate"),d()}n&2&&(a(2),C(" ",f(3,1,"exerciseSelectionModal.backToSearch")," "))}function Lo(n,t){if(n&1&&(u(0,"div",50),h(1),d()),n&2){let e=c().$implicit;a(),C(" ",e.label," ")}}function Oo(n,t){if(n&1&&(u(0,"span",57),h(1),_(2,"titlecase"),_(3,"titlecase"),d()),n&2){let e=c(2).$implicit;a(),J("",f(2,2,e.category)," ",e.primaryMuscleGroup?f(3,4," - "+e.primaryMuscleGroup):"")}}function Wo(n,t){n&1&&(O(0),h(1),_(2,"translate"),W()),n&2&&(a(),E(f(2,1,"exerciseSelectionModal.custom")))}function No(n,t){n&1&&(O(0),h(1," | "),W())}function Go(n,t){if(n&1&&(O(0),h(1),_(2,"translate"),W()),n&2){let e=c(3).$implicit;a(),E(Ee(2,1,"exerciseSelectionModal.count",te(4,Mo,e.usageCount)))}}function qo(n,t){n&1&&(O(0),h(1," | "),W())}function zo(n,t){if(n&1&&(O(0),h(1),_(2,"date"),_(3,"translate"),W()),n&2){let e=c(3).$implicit;a(),E(Ee(3,5,"exerciseSelectionModal.lastUsed",te(8,Fo,fr(2,1,e.lastUsedAt,"dd-MM-yy","UTC"))))}}function Ho(n,t){if(n&1&&(u(0,"span",58),h(1," [ "),w(2,Wo,3,3,"ng-container",24)(3,No,2,0,"ng-container",24)(4,Go,3,6,"ng-container",24)(5,qo,2,0,"ng-container",24)(6,zo,4,10,"ng-container",24),h(7," ] "),d()),n&2){let e=c(2).$implicit;a(2),p("ngIf",e.isCustom),a(),p("ngIf",e.isCustom&&(e.usageCount!=null||e.lastUsedAt)),a(),p("ngIf",e.usageCount!=null),a(),p("ngIf",e.usageCount!=null&&e.lastUsedAt),a(),p("ngIf",e.lastUsedAt)}}function Uo(n,t){if(n&1&&(u(0,"span",61),h(1),d()),n&2){let e=t.ngIf;a(),C(" ",e," ")}}function $o(n,t){if(n&1){let e=D();O(0),w(1,Uo,2,1,"span",59),u(2,"input",60),I("change",function(){y(e);let r=c(2).$implicit,o=c(2);return b(o.toggleSelection(r))})("click",function(r){return y(e),b(r.stopPropagation())}),d(),W()}if(n&2){let e=c(2).$implicit,i=c(2);a(),p("ngIf",i.getSelectionIndex(e)),a(),p("checked",i.isSelected(e))}}function jo(n,t){if(n&1&&F(0,"app-icon",62),n&2){let e=c(4);hr("h-6 w-6 mr-1 flex-shrink-0 "+e.itemIconClass()),p("name",e.itemIconName())}}function Ko(n,t){if(n&1){let e=D();u(0,"li",51),I("click",function(){y(e);let r=c().$implicit,o=c(2);return b(o.onExerciseClicked(r))}),u(1,"div",52)(2,"span",53),h(3),d(),w(4,Oo,4,6,"span",54)(5,Ho,8,5,"span",55),d(),w(6,$o,3,2,"ng-container",56)(7,jo,1,3,"ng-template",null,2,xe),d()}if(n&2){let e=Q(8),i=c(),r=i.$implicit,o=i.odd,s=c(2);p("ngClass",qt(6,To,s.isSelected(r),o&&!s.isSelected(r),!o&&!s.isSelected(r))),a(3),E(r.name),a(),p("ngIf",r.category),a(),p("ngIf",r.isCustom||r.lastUsedAt||r.usageCount!=null),a(),p("ngIf",s.isMultiSelect())("ngIfElse",e)}}function Zo(n,t){if(n&1&&(O(0),w(1,Lo,2,1,"div",48)(2,Ko,9,10,"li",49),W()),n&2){let e=t.$implicit,i=c(2);a(),p("ngIf",!i.isExercise(e)),a(),p("ngIf",i.isExercise(e))}}function Yo(n,t){if(n&1&&(u(0,"li",63),h(1),_(2,"translate"),d()),n&2){let e=c(2);a(),C(" ",f(2,1,e.isShowingSimilarView()?"exerciseSelectionModal.noSimilar":"exerciseSelectionModal.noMatches")," ")}}function Qo(n,t){if(n&1){let e=D();u(0,"button",64),I("click",function(){y(e);let r=c(2);return b(r.confirmSelection())}),F(1,"app-icon",65),h(2),_(3,"translate"),d()}if(n&2){let e=c(2);p("disabled",e.selectionCount()===0),a(2),J(" ",f(3,3,"exerciseSelectionModal.addSelected")," ",e.selectionCount()>0?"("+e.selectionCount()+")":""," ")}}function Jo(n,t){if(n&1){let e=D();u(0,"button",66),I("click",function(){y(e);let r=c(2);return b(r.onCreateCustom())}),F(1,"app-icon",67),h(2),_(3,"translate"),d()}n&2&&(a(2),C(" ",f(3,1,"exerciseSelectionModal.createCustom")," "))}function Xo(n,t){if(n&1){let e=D();u(0,"div",4)(1,"div",5),I("clickOutside",function(){y(e);let r=c();return b(r.onClose())}),u(2,"div",6)(3,"div",7)(4,"h3",8),h(5),d(),u(6,"button",9),I("click",function(){y(e);let r=c();return b(r.onClose())}),F(7,"app-icon",10),d()()(),u(8,"div",11)(9,"div",7)(10,"h4",12),h(11),_(12,"translate"),d(),u(13,"button",13),I("click",function(){y(e);let r=c();return b(r.toggleFilterAccordion())}),F(14,"app-icon",14),d()()(),u(15,"div",15)(16,"div",16)(17,"div",17)(18,"div")(19,"label",18),h(20),_(21,"translate"),d(),u(22,"select",19),I("change",function(r){y(e);let o=c();return b(o.onCategoryChange(r))}),u(23,"option",20),h(24),_(25,"translate"),d(),w(26,Ro,3,4,"option",21),_(27,"async"),d()(),u(28,"div")(29,"label",18),h(30),_(31,"translate"),d(),u(32,"select",19),I("change",function(r){y(e);let o=c();return b(o.onMuscleGroupChange(r))}),u(33,"option",20),h(34),_(35,"translate"),d(),mr(36,Bo,3,4,"option",22,Do),_(38,"async"),d()()(),u(39,"div",23),w(40,Po,7,8,"div",24)(41,Ao,3,3,"button",25)(42,Vo,4,3,"button",26),d(),u(43,"div")(44,"label",18),h(45),_(46,"translate"),d(),u(47,"select",19),I("change",function(r){y(e);let o=c();return b(o.onSortModeChange(r))}),u(48,"option",27),h(49),_(50,"translate"),d(),u(51,"option",28),h(52),_(53,"translate"),d(),u(54,"option",29),h(55),_(56,"translate"),d()()(),u(57,"div",30)(58,"button",31),I("click",function(){y(e);let r=c();return b(r.clearFilters())}),F(59,"app-icon",32),h(60),_(61,"translate"),d()()()(),u(62,"div",33,0)(64,"ul",34),w(65,Zo,3,2,"ng-container",35)(66,Yo,3,3,"li",36),d()(),u(67,"div",37)(68,"div",38),w(69,Qo,4,5,"button",39)(70,Jo,4,3,"button",40),u(71,"button",41),I("click",function(){y(e);let r=c();return b(r.onClose())}),F(72,"app-icon",42),h(73),_(74,"translate"),d()()()()()}if(n&2){let e,i=c();p("ngClass",i.customPB()),a(5),E(i.title()),a(6),E(f(12,29,"exerciseSelectionModal.filtersTitle")),a(3),Ae("rotate-180",i.isFilterAccordionOpen()),a(),it("max-height",i.isFilterAccordionOpen()?"600px":"0px"),a(5),E(f(21,31,"exerciseSelectionModal.categoryLabel")),a(2),p("value",i.selectedCategory()||""),a(2),E(f(25,33,"exerciseSelectionModal.allCategories")),a(2),p("ngForOf",f(27,35,i.categories$)),a(4),E(f(31,37,"exerciseSelectionModal.muscleGroupLabel")),a(2),p("value",((e=i.selectedMuscleGroup())==null?null:e.id)||""),a(2),E(f(35,39,"exerciseSelectionModal.allMuscles")),a(2),gr(f(38,41,i.primaryMuscleGroups$)),a(4),p("ngIf",!i.isShowingSimilarView()),a(),p("ngIf",i.showSimilarButton()&&!i.isShowingSimilarView()),a(),p("ngIf",i.isShowingSimilarView()),a(3),E(f(46,43,"exerciseSelectionModal.sortByLabel")),a(2),p("value",i.sortMode()),a(2),E(f(50,45,"exerciseSelectionModal.sort.alpha")),a(3),E(f(53,47,"exerciseSelectionModal.sort.lastUsed")),a(3),E(f(56,49,"exerciseSelectionModal.sort.frequency")),a(5),C(" ",f(61,51,"exerciseSelectionModal.clearFilters")),a(5),p("ngForOf",i.processedExercises())("ngForTrackBy",i.trackByExerciseOrHeader),a(),p("ngIf",i.processedExercises().length===0),a(3),p("ngIf",i.isMultiSelect()&&i.selectionCount()>0),a(),p("ngIf",i.showCreateCustomLink()||!i.processedExercises()||!i.processedExercises().length),a(3),C(" ",f(74,53,"exerciseSelectionModal.cancel")," ")}}var hi=class n{constructor(t){this.document=t;Ie(()=>{let e=this.exercises();e&&e.length>0?this.exerciseService.getTranslatedExerciseList(e).pipe(we(1)).subscribe(i=>{this.translatedExercises.set(i)}):this.translatedExercises.set([]),this.muscleMapService.getTranslatedMuscles().pipe(we(1)).subscribe(i=>{this.translatedMuscles.set(i)})}),Ie(()=>{let e=this.translatedExercises(),i=this.usageCounts(),r=e.map(o=>N(A({},o),{usageCount:i.get(o.id)||0}));this.enrichedExercises.set(r)}),Ie(()=>{this.sortMode(),this.scrollContainer?.nativeElement&&(this.scrollContainer.nativeElement.scrollTop=0),this.sortMode()==="lastUsed"&&this.isFilterAccordionOpen.set(!1)}),Ie(()=>{this.isOpen()?this.document.body.classList.add("overflow-hidden"):this.document.body.classList.remove("overflow-hidden")}),Ie(e=>{e(()=>{this.document.body.classList.remove("overflow-hidden")})})}exerciseService=S(qe);trackingService=S(ei);toastService=S(_t);translate=S(Ne);muscleMapService=S(ti);translatedMuscles=R([]);isMultiSelect=ae(!1);isFocusInputOnStart=ae(!1);customPB=ae("");exerciseSelected=new q;exercisesSelected=new q;selectedExerciseIds=R([]);selectionCount=ve(()=>this.selectedExerciseIds().length);ngOnChanges(t){t.isOpen&&t.isOpen.currentValue&&(this.isFocusInputOnStart()&&this.checkForInputFocus(),this.clearFilters(!1))}enrichedExercises=R([]);usageCounts=Et(this.trackingService.getExerciseUsageCounts(),{initialValue:new Map});dataSub;myExerciseInput;scrollContainer;translatedExercises=R([]);isOpen=Di(!1);title=ae("Select Exercise");exercises=ae.required();searchPlaceholder=ae("Search exercises...");itemIconName=ae("done");itemIconClass=ae("text-primary dark:text-primary-light");showSimilarButton=ae(!1);showCreateCustomLink=ae(!1);isShowingSimilarView=ae(!1);close=new q;findSimilarClicked=new q;createCustomClicked=new q;backToSearchClicked=new q;searchTerm=Di("");isFilterAccordionOpen=R(!1);selectedCategory=R(null);selectedMuscleGroup=R(null);sortMode=R("alpha");categories$=this.exerciseService.getUniqueCategories();primaryMuscleGroups$=this.exerciseService.getUniquePrimaryMuscleGroups();processedExercises=ve(()=>{let t=this.searchTerm()?.toLowerCase()??"",e=this.enrichedExercises(),i=this.sortMode(),r=this.selectedCategory(),o=this.selectedMuscleGroup();if(r&&(e=e.filter(s=>s.category===r)),o&&(e=e.filter(s=>s.primaryMuscleGroup===o.id||Array.isArray(s.muscleGroups)&&s.muscleGroups.includes(o.id))),t){let s=this.exerciseService.normalizeExerciseNameForSearch(t);e=e.filter(l=>{let g=this.getMuscleNameById(l.primaryMuscleGroup||""),m=(l.muscleGroups||[]).map(v=>this.getMuscleNameById(v)).join(" "),x=[l._searchId,l._searchName,l.name].filter(Boolean).join(" ");return s.split(" ").every(v=>l.name.toLowerCase().includes(v)||x.toLowerCase().includes(v)||l.category?.toLowerCase().includes(v)||l.description?.toLowerCase().includes(v)||g?.toLowerCase().includes(v)||m.toLowerCase().includes(v))})}switch(i){case"lastUsed":return e.sort((s,l)=>(l.lastUsedAt?new Date(l.lastUsedAt).getTime():0)-(s.lastUsedAt?new Date(s.lastUsedAt).getTime():0)),e;case"frequency":return e.sort((s,l)=>(l.usageCount||0)-(s.usageCount||0)),this.groupExercisesByFrequency(e);case"alpha":default:return e.sort((s,l)=>s.name.localeCompare(l.name)),this.groupExercisesAlphabetically(e)}});groupExercisesAlphabetically(t){if(t.length===0)return[];let e=[],i="";for(let r of t){let o=r.name[0].toUpperCase();o!==i&&(i=o,e.push({isHeader:!0,label:o})),e.push(r)}return e}groupExercisesByFrequency(t){if(t.length===0)return[];let e=[],i="",r=o=>o>=30?this.translate.instant("exerciseSelectionModal.frequencyGroups.gt30"):o>=10?this.translate.instant("exerciseSelectionModal.frequencyGroups.lt30"):o>=5?this.translate.instant("exerciseSelectionModal.frequencyGroups.lt10"):this.translate.instant("exerciseSelectionModal.frequencyGroups.lt5");for(let o of t){let s=o.usageCount||0,l=r(s);l!==i&&(i=l,e.push({isHeader:!0,label:l})),e.push(o)}return e}isExercise(t){return!t.isHeader}onExerciseClicked(t){this.isMultiSelect()?this.toggleSelection(t):(this.exerciseSelected.emit(t),this.onClose())}toggleSelection(t){let e=this.selectedExerciseIds();e.includes(t.id)?this.selectedExerciseIds.set(e.filter(i=>i!==t.id)):this.selectedExerciseIds.set([...e,t.id])}isSelected(t){return this.selectedExerciseIds().includes(t.id)}confirmSelection(){let t=this.selectedExerciseIds();if(t.length===0){this.toastService.info(this.translate.instant("exerciseSelectionModal.toasts.noSelection"));return}let i=this.enrichedExercises().filter(r=>t.includes(r.id));this.exercisesSelected.emit(i),this.onClose()}onClose(){this.isOpen.set(!1),this.selectedExerciseIds.set([]),this.close.emit()}onFindSimilar(){this.findSimilarClicked.emit(),this.isFilterAccordionOpen.set(!1)}onCreateCustom(){this.createCustomClicked.emit()}onBackToSearch(){this.backToSearchClicked.emit()}onSearchEnter(){let t=this.processedExercises().filter(e=>this.isExercise(e));t.length===1&&this.onExerciseClicked(t[0])}ngAfterViewInit(){this.isOpen()&&this.isFocusInputOnStart()&&this.checkForInputFocus()}checkForInputFocus(){setTimeout(()=>{this.myExerciseInput?.nativeElement.focus(),this.myExerciseInput?.nativeElement.select()},100)}toggleFilterAccordion(){this.isFilterAccordionOpen.update(t=>!t)}onCategoryChange(t){this.selectedCategory.set(t.target.value||null)}onMuscleGroupChange(t){let e=t.target;if(!e.value||!this.primaryMuscleGroups$){this.selectedMuscleGroup.set(null);return}this.primaryMuscleGroups$?.subscribe(i=>{let r=i.find(o=>o.id===e.value)||null;this.selectedMuscleGroup.set(r)})}muscleToMuscleValue(t){return t.id}onSortModeChange(t){let e=t.target.value;this.sortMode.set(e)}clearFilters(t=!0){this.selectedCategory.set(null),this.selectedMuscleGroup.set(null),this.searchTerm.set(""),this.sortMode.set("alpha"),this.selectedExerciseIds.set([]),t&&this.toastService.info(this.translate.instant("exerciseSelectionModal.toasts.filtersCleared"))}getMuscleNameById(t){return this.translatedMuscles().find(e=>e.id===t)?.name||t}getMuscleById(t){return this.translatedMuscles().find(e=>e.id===t)||null}getSelectionIndex(t){if(!this.isMultiSelect())return null;let i=this.selectedExerciseIds().findIndex(r=>r===t.id);return i!==-1?i+1:null}trackByExerciseOrHeader(t,e){return e.isHeader?"header-"+e.label:"exercise-"+e.id}isMobileScreen(){return window.innerWidth<640}static \u0275fac=function(e){return new(e||n)(Ce(_e))};static \u0275cmp=De({type:n,selectors:[["app-exercise-selection-modal"]],viewQuery:function(e,i){if(e&1&&(Re(Eo,5),Re(Io,5)),e&2){let r;Be(r=Pe())&&(i.myExerciseInput=r.first),Be(r=Pe())&&(i.scrollContainer=r.first)}},inputs:{isMultiSelect:[1,"isMultiSelect"],isFocusInputOnStart:[1,"isFocusInputOnStart"],customPB:[1,"customPB"],isOpen:[1,"isOpen"],title:[1,"title"],exercises:[1,"exercises"],searchPlaceholder:[1,"searchPlaceholder"],itemIconName:[1,"itemIconName"],itemIconClass:[1,"itemIconClass"],showSimilarButton:[1,"showSimilarButton"],showCreateCustomLink:[1,"showCreateCustomLink"],isShowingSimilarView:[1,"isShowingSimilarView"],searchTerm:[1,"searchTerm"]},outputs:{exerciseSelected:"exerciseSelected",exercisesSelected:"exercisesSelected",isOpen:"isOpenChange",close:"close",findSimilarClicked:"findSimilarClicked",createCustomClicked:"createCustomClicked",backToSearchClicked:"backToSearchClicked",searchTerm:"searchTermChange"},features:[Ke],decls:1,vars:1,consts:[["scrollContainer",""],["exerciseSearchFied",""],["singleSelectIcon",""],["class","fixed inset-0 z-[70] flex flex-col bg-white dark:bg-gray-800 transition-opacity",3,"ngClass",4,"ngIf"],[1,"fixed","inset-0","z-[70]","flex","flex-col","bg-white","dark:bg-gray-800","transition-opacity",3,"ngClass"],[1,"relative","flex","flex-col","w-full","h-full","overflow-hidden","text-left","transition-all",3,"clickOutside"],[1,"px-5","py-2","flex-shrink-0","border-b","border-gray-200","dark:border-gray-600"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","focus:outline-none",3,"click"],["name","cancel",1,"w-6","h-6"],[1,"px-4","pt-2","flex-shrink-0"],[1,"font-semibold","text-gray-700","dark:text-gray-200"],[1,"rounded-md","text-gray-600","dark:text-gray-300","hover:bg-gray-200","dark:hover:bg-gray-700","focus:outline-none","transition-all","duration-300","ease-in-out",3,"click"],["name","filter",1,"w-10","h-10","transition-transform","duration-300"],[1,"overflow-hidden","transition-all","duration-300","ease-in-out","px-4","flex-shrink-0"],[1,"py-4","space-y-4"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],[1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","dark:bg-gray-700","dark:text-gray-200",3,"change","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-center"],[4,"ngIf"],["class","justify-center inline-flex items-center mt-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",3,"click",4,"ngIf"],["class","justify-center inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",3,"click",4,"ngIf"],["value","alpha"],["value","lastUsed"],["value","frequency"],[1,"text-right"],[1,"inline-flex","text-sm","text-blue-600","dark:text-blue-400","hover:bg-blue-500","dark:hover:text-white","rounded-xl","p-2",3,"click"],["name","trash",1,"h-6","w-6","mr-1"],[1,"flex-grow","min-h-0","px-4","sm:px-6","py-2","overflow-y-auto","custom-scrollbar"],[1,"space-y-1"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","text-gray-500 dark:text-gray-400 text-center p-4",4,"ngIf"],[1,"bg-gray-50","dark:bg-gray-800","px-4","py-2","flex","justify-center","sticky","bottom-0"],[1,"flex","flex-col","sm:flex-row","gap-2","w-full","max-w-xs"],["type","button","class",`w-full rounded-md px-4 py-2 text-xl font-semibold text-white shadow-sm
                     bg-primary hover:bg-primary-dark focus-visible:outline focus-visible:outline-2
                     focus-visible:outline-offset-2 focus-visible:outline-primary-focus
                     disabled:opacity-50 disabled:cursor-not-allowed mb-1 sm:mb-0`,3,"disabled","click",4,"ngIf"],["type","button","class",`w-full rounded-md px-4 py-2 text-lg font-semibold text-white shadow-sm
                     bg-green-500 hover:bg-green-700 focus-visible:outline focus-visible:outline-2
                     focus-visible:outline-offset-2 focus-visible:outline-primary-focus
                     disabled:opacity-50 disabled:cursor-not-allowed flex items-center`,3,"click",4,"ngIf"],["type","button",1,"w-full","rounded-md","bg-white","dark:bg-gray-600","px-3","py-2","text-xl","font-semibold","text-gray-900","dark:text-gray-200","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-500","hover:bg-gray-50","dark:hover:bg-gray-500","flex","items-center","justify-center",3,"click"],["name","cancel",1,"w-6","h-6","mr-1"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1","text-left"],["type","text",1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","dark:bg-gray-700","dark:text-gray-200",3,"ngModelChange","keydown.enter","placeholder","ngModel"],[1,"justify-center","inline-flex","items-center","mt-2","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","shadow-sm","text-white","bg-blue-600","hover:bg-blue-700",3,"click"],[1,"justify-center","inline-flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","text-sm","font-medium","rounded-md","shadow-sm","text-gray-700","dark:text-gray-200","bg-white","dark:bg-gray-700","hover:bg-gray-50","dark:hover:bg-gray-600",3,"click"],["name","back",1,"w-5","h-5","mr-2"],["class","py-2 px-3 sticky top-0 bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-200 font-bold text-lg z-10",4,"ngIf"],["appBumpClick","","class","p-3 mx-1 rounded-md cursor-pointer transition-colors duration-150 ease-in-out flex justify-between items-center",3,"ngClass","click",4,"ngIf"],[1,"py-2","px-3","sticky","top-0","bg-gray-200","dark:bg-gray-800","text-gray-600","dark:text-gray-200","font-bold","text-lg","z-10"],["appBumpClick","",1,"p-3","mx-1","rounded-md","cursor-pointer","transition-colors","duration-150","ease-in-out","flex","justify-between","items-center",3,"click","ngClass"],[1,"flex-grow"],[1,"font-medium","text-gray-800","dark:text-gray-200"],["class","block text-xs text-gray-500 dark:text-gray-400",4,"ngIf"],["class","block text-xs text-gray-500 dark:text-gray-400 italic",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"block","text-xs","text-gray-500","dark:text-gray-400"],[1,"block","text-xs","text-gray-500","dark:text-gray-400","italic"],["class","p-2 mx-1 inline-flex items-center justify-center rounded-full bg-primary text-white text-xs font-bold w-6 h-6",4,"ngIf"],["type","checkbox",1,"form-checkbox","h-6","w-6","rounded-full","flex-shrink-0","text-primary","dark:text-primary-light","bg-gray-200","dark:bg-gray-800","border-gray-400","dark:border-gray-500","focus:ring-primary-focus","dark:focus:ring-primary-dark","cursor-pointer",3,"change","click","checked"],[1,"p-2","mx-1","inline-flex","items-center","justify-center","rounded-full","bg-primary","text-white","text-xs","font-bold","w-6","h-6"],[3,"name"],[1,"text-gray-500","dark:text-gray-400","text-center","p-4"],["type","button",1,"w-full","rounded-md","px-4","py-2","text-xl","font-semibold","text-white","shadow-sm","bg-primary","hover:bg-primary-dark","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-focus","disabled:opacity-50","disabled:cursor-not-allowed","mb-1","sm:mb-0",3,"click","disabled"],["name","done",1,"w-6","h-6","mr-2"],["type","button",1,"w-full","rounded-md","px-4","py-2","text-lg","font-semibold","text-white","shadow-sm","bg-green-500","hover:bg-green-700","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-focus","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center",3,"click"],["name","plus-circle",1,"w-6","h-6","mr-2"]],template:function(e,i){e&1&&w(0,Xo,75,55,"div",3),e&2&&p("ngIf",i.isOpen())},dependencies:[lt,nt,ot,st,gt,pt,mt,dt,ct,ut,ht,xt,ri,Sn,zt,at,kr,ft],encapsulation:2})};var _i=class n{constructor(t){this.fb=t}unitsService=S(Jt);translate=S(Ne);workoutUtilsService=S(oi);appSettingsService=S(Qt);injector=S(je);createSetFormGroup(t,e=!1,i,r){let o=t&&t.id||(typeof crypto<"u"?crypto.randomUUID():""),s=t?.fieldOrder||[],l=t?.notes||"",g=t?.type||"standard",m="targetTempo"in(t||{})&&t.targetTempo||"",x,v=new Date().toISOString(),k,T,B,M,P,le;if(t){let X=G=>"repsLogged"in G,oe=G=>"targetReps"in G;if(e){let G=t;k=G.repsLogged??null,T=G.weightLogged??null,B=G.durationLogged??null,M=G.distanceLogged??null,P=G.restLogged??null,x=G.plannedSetId,v=G.timestamp}else{let G=t;k=G.targetReps??null,T=G.targetWeight??null,B=G.targetDuration??null,M=G.targetDistance??null,P=G.targetRest??null,x=G.id}}let z=A({},t),V={id:[o],type:[g],notes:[l||""],fieldOrder:[s||[]]};if(e)V.repsLogged=[k??null,[X=>{let oe=X.parent;if(!oe)return null;let G=oe.get("weightLogged")?.value,At=oe.get("durationLogged")?.value;return(G==null||G==="")&&(At==null||At==="")&&typeof i=="function"?i(1)(X):null}]],V.weightLogged=[T??null],V.durationLogged=[B??null],V.distanceLogged=[M??null],V.plannedSetId=[x],V.timestamp=[v],V.tempo=[m],V.restLogged=[P];else{let X=null;z.targetReps&&typeof z.targetReps=="object"?X=z.targetReps:z.min!=null&&z.max!=null?X={type:"range",min:z.min,max:z.max}:z.targetReps!=null&&(X={type:"exact",value:z.targetReps}),V.targetReps=[X],V.targetWeight=[T??null],V.targetDuration=[B??null],V.targetDistance=[M??null],V.targetRest=[P??null],V.targetTempo=[m??null]}let ee=e?{}:{validators:typeof r=="function"?r():null};return this.fb.group(V,ee)}createExerciseFormGroup(t,e=!1,i=!1,r,o,s,l,g){let m=t?.exerciseId?r?.find(k=>k.id===t.exerciseId):null,x=t?.sets||[];return this.fb.group({id:[t?.id],exerciseId:[t?.exerciseId],exerciseName:[m?.name||t?.exerciseName],notes:[t?.notes||""],sets:this.fb.array(x.map(k=>this.createSetFormGroup(k,i,l,g))),supersetId:[t?.supersetId||null],supersetOrder:[t?.supersetOrder??null],supersetType:[t?.supersetType??"standard"],emomTimeSeconds:[t?.emomTimeSeconds??null]})}createExerciseFormGroupFromLoggedExercise(t,e,i,r,o,s){let l=e?.find(m=>m.id===t.exerciseId);return this.fb.group({id:[t.id],exerciseId:[t.exerciseId],exerciseName:[l?.name||t.exerciseName],notes:[t.notes||""],sets:this.fb.array(t.sets.map(m=>this.createSetFormGroup(m,!0,o,s))),supersetId:[t.supersetId||null],supersetOrder:[t.supersetOrder??null],supersetType:[t.supersetType??"standard"],emomTimeSeconds:[t.emomTimeSeconds??null]})}getSetsFormArray(t){return t.get("sets")??this.fb.array([])}static \u0275fac=function(e){return new(e||n)(lr(jt))};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};var fi=class n{constructor(t,e){this.renderer=t;this.el=e;this.mouseDownHandler=this.onMouseDown.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.pressEndHandler=this.onPressEnd.bind(this)}longPressEnabled=!0;longPressDelay=300;longPressClass="is-long-pressing";dragHandleSelector;classTargetSelector;longPress=new q;timer;isPressing=!1;mouseDownHandler;touchStartHandler;pressEndHandler;ngOnInit(){let t=this.el.nativeElement;t.addEventListener("mousedown",this.mouseDownHandler),t.addEventListener("mouseup",this.pressEndHandler),t.addEventListener("mouseleave",this.pressEndHandler),t.addEventListener("touchstart",this.touchStartHandler,{passive:!1}),t.addEventListener("touchend",this.pressEndHandler),t.addEventListener("touchcancel",this.pressEndHandler)}onMouseDown(t){!this.longPressEnabled||t.button!==0||this.dragHandleSelector&&!t.target.closest(this.dragHandleSelector)||this.startTimer()}onTouchStart(t){this.longPressEnabled&&(this.dragHandleSelector&&!t.target.closest(this.dragHandleSelector)||this.startTimer())}startTimer(){this.isPressing=!0,this.timer=setTimeout(()=>{this.isPressing&&(this.renderer.addClass(this.el.nativeElement,this.longPressClass),this.longPress.emit())},this.longPressDelay)}onPressEnd(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.isPressing=!1,this.renderer.removeClass(this.el.nativeElement,this.longPressClass)}ngOnDestroy(){let t=this.el.nativeElement;t.removeEventListener("mousedown",this.mouseDownHandler),t.removeEventListener("mouseup",this.pressEndHandler),t.removeEventListener("mouseleave",this.pressEndHandler),t.removeEventListener("touchstart",this.touchStartHandler),t.removeEventListener("touchend",this.pressEndHandler),t.removeEventListener("touchcancel",this.pressEndHandler),this.onPressEnd()}static \u0275fac=function(e){return new(e||n)(Ce(Mi),Ce(fe))};static \u0275dir=ce({type:n,selectors:[["","appLongPressDrag",""]],inputs:{longPressEnabled:"longPressEnabled",longPressDelay:"longPressDelay",longPressClass:"longPressClass",dragHandleSelector:"dragHandleSelector",classTargetSelector:"classTargetSelector"},outputs:{longPress:"longPress"}})};var xi=class n{textAreaElement=S(fe).nativeElement;onInput(){this.adjustHeight()}ngOnInit(){setTimeout(()=>this.adjustHeight(),0)}adjustHeight(){this.textAreaElement.style.height="auto",this.textAreaElement.style.height=`${this.textAreaElement.scrollHeight}px`}static \u0275fac=function(e){return new(e||n)};static \u0275dir=ce({type:n,selectors:[["textarea","appAutoGrow",""]],hostBindings:function(e,i){e&1&&I("input",function(){return i.onInput()})}})};var vi=class n{constructor(t,e){this.viewContainer=t;this.templateRef=e}context={ngLet:null};viewRef=null;set ngLet(t){this.context.ngLet=t,this.viewRef||(this.viewRef=this.viewContainer.createEmbeddedView(this.templateRef,this.context))}static \u0275fac=function(e){return new(e||n)(Ce(St),Ce(wt))};static \u0275dir=ce({type:n,selectors:[["","ngLet",""]],inputs:{ngLet:"ngLet"}})};var es=(n,t)=>({"bg-blue-500 text-white dark:bg-blue-700":n,"bg-gray-300 text-gray-600 dark:bg-gray-600 dark:text-gray-300 line-through":t});function ts(n,t){if(n&1&&(u(0,"option",18),h(1),d()),n&2){let e=t.$implicit;p("ngValue",e),a(),E(e.label)}}function is(n,t){if(n&1){let e=D();u(0,"div")(1,"label",40)(2,"input",41),I("change",function(){let r=y(e).$implicit,o=c(2);return b(o.toggleMuscle("target",r))}),d(),h(3),_(4,"translate"),d()()}if(n&2){let e=t.$implicit,i=c(2);a(2),p("value",e.id)("checked",i.options.targetMuscles.includes(e.id))("disabled",i.options.avoidMuscles.includes(e.id)),a(),C(" ",f(4,4,e.name)," ")}}function rs(n,t){if(n&1){let e=D();u(0,"div")(1,"label",40)(2,"input",41),I("change",function(){let r=y(e).$implicit,o=c(2);return b(o.toggleMuscle("avoid",r))}),d(),h(3),_(4,"translate"),d()()}if(n&2){let e=t.$implicit,i=c(2);a(2),p("value",e.id)("checked",i.options.avoidMuscles.includes(e.id))("disabled",i.options.targetMuscles.includes(e.id)),a(),C(" ",f(4,4,e.name)," ")}}function ns(n,t){n&1&&(u(0,"p",46),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"generateWorkoutModal.noPersonalGym")))}function os(n,t){if(n&1){let e=D();u(0,"button",47),I("click",function(){let r=y(e).$implicit,o=c(3);return b(o.toggleExcludePersonalGymEquipment(r))}),h(1),_(2,"titlecase"),d()}if(n&2){let e=t.$implicit,i=c(3);p("ngClass",j(4,es,!i.options.excludeEquipment.includes(e.toLowerCase()),i.options.excludeEquipment.includes(e.toLowerCase()))),a(),C(" ",f(2,2,e)," ")}}function ss(n,t){if(n&1&&(u(0,"div",42),w(1,ns,3,3,"p",43),u(2,"div",44),w(3,os,3,7,"button",45),d()()),n&2){let e=c(2);a(),p("ngIf",e.allPersonalGymEquipment().length===0),a(2),p("ngForOf",e.allPersonalGymEquipment())}}function as(n,t){if(n&1){let e=D();u(0,"button",54),I("click",function(){let r=y(e).$implicit,o=c(4);return b(o.addExcludedEquipment(r))}),h(1),_(2,"titlecase"),d()}if(n&2){let e=t.$implicit;a(),C(" ",f(2,1,e)," ")}}function ls(n,t){if(n&1&&(u(0,"div",52),w(1,as,3,3,"button",53),d()),n&2){let e=c(3);a(),p("ngForOf",e.filteredAvailableEquipmentToExclude())}}function ds(n,t){if(n&1){let e=D();u(0,"span",59)(1,"span"),h(2),_(3,"titlecase"),d(),u(4,"button",60),I("click",function(){let r=y(e).$implicit,o=c(4);return b(o.removeExcludedEquipment(r))}),F(5,"app-icon",61),d()()}if(n&2){let e=t.$implicit;a(2),E(f(3,1,e))}}function cs(n,t){if(n&1&&(u(0,"div",55)(1,"label",56),h(2," Excluded equipment "),d(),u(3,"div",57),w(4,ds,6,3,"span",58),d()()),n&2){let e=c(3);a(4),p("ngForOf",e.options.excludeEquipment)}}function us(n,t){if(n&1){let e=D();u(0,"div",33)(1,"label",48),h(2,"Exclude Equipment (Optional)"),d(),u(3,"input",49),Y("ngModelChange",function(r){y(e);let o=c(2);return Z(o.excludeEquipmentSearchTerm,r)||(o.excludeEquipmentSearchTerm=r),b(r)}),d(),w(4,ls,2,1,"div",50)(5,cs,5,1,"div",51),d()}if(n&2){let e=c(2);a(3),K("ngModel",e.excludeEquipmentSearchTerm),a(),p("ngIf",e.filteredAvailableEquipmentToExclude().length>0&&e.excludeEquipmentSearchTerm().length>0),a(),p("ngIf",e.options.excludeEquipment.length>0)}}function ps(n,t){n&1&&(u(0,"p",46),h(1," No equipment excluded. "),d())}function ms(n,t){if(n&1){let e=D();u(0,"span",59)(1,"span"),h(2),_(3,"titlecase"),d(),u(4,"button",60),I("click",function(){let r=y(e).$implicit,o=c(4);return b(o.removeExcludedEquipment(r))}),F(5,"app-icon",61),d()()}if(n&2){let e=t.$implicit;a(2),E(f(3,1,e))}}function gs(n,t){if(n&1&&(u(0,"div",63),w(1,ps,2,0,"p",43)(2,ms,6,3,"span",58),d()),n&2){let e=c(3);a(),p("ngIf",e.options.excludeEquipment.length===0),a(),p("ngForOf",e.options.excludeEquipment)}}function hs(n,t){if(n&1){let e=D();u(0,"button",54),I("click",function(){let r=y(e).$implicit,o=c(4);return b(o.addExcludedEquipment(r))}),h(1),_(2,"titlecase"),d()}if(n&2){let e=t.$implicit;a(),C(" ",f(2,1,e)," ")}}function _s(n,t){if(n&1&&(u(0,"div",52),w(1,hs,3,3,"button",53),d()),n&2){let e=c(3);a(),p("ngForOf",e.filteredAvailableEquipmentToExclude())}}function fs(n,t){if(n&1){let e=D();u(0,"label",48),h(1,"Exclude personal gym equipment (Optional)"),d(),w(2,gs,3,2,"div",62),u(3,"input",49),Y("ngModelChange",function(r){y(e);let o=c(2);return Z(o.excludeEquipmentSearchTerm,r)||(o.excludeEquipmentSearchTerm=r),b(r)}),d(),w(4,_s,2,1,"div",50)}if(n&2){let e=c(2);a(2),p("ngIf",e.options.excludeEquipment.length>0),a(),K("ngModel",e.excludeEquipmentSearchTerm),a(),p("ngIf",e.filteredAvailableEquipmentToExclude().length>0&&e.excludeEquipmentSearchTerm().length>0)}}function xs(n,t){if(n&1){let e=D();u(0,"div",2),I("click",function(){y(e);let r=c();return b(r.close.emit())}),u(1,"div",3),I("click",function(r){return y(e),b(r.stopPropagation())}),u(2,"header",4)(3,"div",5),F(4,"app-icon",6),u(5,"h3",7),h(6),_(7,"translate"),d()(),u(8,"button",8),I("click",function(){y(e);let r=c();return b(r.close.emit())}),F(9,"app-icon",9),d()(),u(10,"div",10)(11,"div",11)(12,"div")(13,"label",12),h(14),_(15,"translate"),u(16,"strong"),h(17),_(18,"translate"),d()(),u(19,"input",13),Y("ngModelChange",function(r){y(e);let o=c();return Z(o.options.duration,r)||(o.options.duration=r),b(r)}),d()(),u(20,"div")(21,"label",12),h(22),_(23,"translate"),d(),u(24,"select",14),Y("ngModelChange",function(r){y(e);let o=c();return Z(o.options.goal,r)||(o.options.goal=r),b(r)}),u(25,"option",15),h(26),_(27,"translate"),d(),u(28,"option",16),h(29),_(30,"translate"),d(),u(31,"option",17),h(32),_(33,"translate"),d()()(),u(34,"div")(35,"label",12),h(36,"Exercise Category"),d(),u(37,"select",14),Y("ngModelChange",function(r){y(e);let o=c();return Z(o.options.exerciseCategory,r)||(o.options.exerciseCategory=r),b(r)}),u(38,"option",18),h(39,"Any"),d(),w(40,ts,2,2,"option",19),d()(),u(41,"div",20)(42,"label",12),h(43),_(44,"translate"),d(),u(45,"select",14),Y("ngModelChange",function(r){y(e);let o=c();return Z(o.options.split,r)||(o.options.split=r),b(r)}),u(46,"option",21),h(47),_(48,"translate"),d(),u(49,"option",22),h(50),_(51,"translate"),d(),u(52,"option",23),h(53),_(54,"translate"),d()()(),u(55,"div",24)(56,"label",25),h(57),_(58,"translate"),d(),u(59,"div",26),w(60,is,5,6,"div",27),d()(),u(61,"div",24)(62,"label",12),h(63),_(64,"translate"),d(),u(65,"div",26),w(66,rs,5,6,"div",27),d()(),u(67,"div",28)(68,"label",12),h(69),_(70,"translate"),d(),u(71,"label",29)(72,"input",30),Y("ngModelChange",function(r){y(e);let o=c();return Z(o.options.usePersonalGym,r)||(o.options.usePersonalGym=r),b(r)}),I("change",function(){y(e);let r=c();return b(r.onUsePersonalGymChange())}),d(),h(73),_(74,"translate"),d(),w(75,ss,4,2,"div",31)(76,us,6,3,"div",32),d(),w(77,fs,5,3,"ng-template",33,0,xe),d()(),u(79,"footer",34)(80,"div",35)(81,"button",36),I("click",function(){y(e);let r=c();return b(r.generateQuick())}),F(82,"app-icon",37),h(83),_(84,"translate"),d(),u(85,"button",38),I("click",function(){y(e);let r=c();return b(r.generateDetailed())}),F(86,"app-icon",39),h(87),_(88,"translate"),d()()()()()}if(n&2){let e=Q(78),i=c();p("ngClass",i.customPB()),a(6),E(f(7,31,"generateWorkoutModal.title")),a(8),C("",f(15,33,"generateWorkoutModal.durationLabel"),": "),a(3),J("",i.options.duration," ",f(18,35,"generateWorkoutModal.durationUnit")),a(2),K("ngModel",i.options.duration),a(3),E(f(23,37,"generateWorkoutModal.goalLabel")),a(2),K("ngModel",i.options.goal),a(2),E(f(27,39,"generateWorkoutModal.goals.hypertrophy")),a(3),E(f(30,41,"generateWorkoutModal.goals.strength")),a(3),C("",f(33,43,"generateWorkoutModal.goals.endurance")," "),a(5),K("ngModel",i.options.exerciseCategory),a(),p("ngValue",null),a(2),p("ngForOf",i.categories()),a(3),E(f(44,45,"generateWorkoutModal.splitLabel")),a(2),K("ngModel",i.options.split),a(2),E(f(48,47,"generateWorkoutModal.splits.fullBody")),a(3),E(f(51,49,"generateWorkoutModal.splits.upperLower")),a(3),E(f(54,51,"generateWorkoutModal.splits.ppl")),a(4),E(f(58,53,"generateWorkoutModal.targetMusclesLabel")),a(3),p("ngForOf",i.allMuscleGroups()),a(3),E(f(64,55,"generateWorkoutModal.avoidMusclesLabel")),a(3),p("ngForOf",i.allMuscleGroups()),a(3),E(f(70,57,"generateWorkoutModal.equipmentLabel")),a(3),K("ngModel",i.options.usePersonalGym),a(),C(" ",f(74,59,"generateWorkoutModal.usePersonalGymLabel")," "),a(2),p("ngIf",i.options.usePersonalGym),a(),p("ngIf",!i.options.usePersonalGym)("ngIfElse",e),a(7),C(" ",f(84,61,"generateWorkoutModal.fab.quick")," "),a(4),C(" ",f(88,63,"generateWorkoutModal.fab.detailed")," ")}}var yi=class n{constructor(t){this.document=t;Ie(()=>{this.isOpen?this.document.body.classList.add("overflow-hidden"):this.document.body.classList.remove("overflow-hidden")}),Ie(e=>{e(()=>{this.document.body.classList.remove("overflow-hidden")})})}isOpen=!1;customPB=ae("");close=new q;generate=new q;exerciseService=S(qe);personalGymService=S(ni);muscleMapService=S(ti);exerciseCategory=S(an);categories=R([]);allMuscleGroups=R([]);allAvailableEquipment=R([]);allPersonalGymEquipment=R([]);equipmentSearchTerm=R("");excludeEquipmentSearchTerm=R("");filteredAvailableEquipment=ve(()=>{let t=this.equipmentSearchTerm().toLowerCase().trim();return t?this.allAvailableEquipment().filter(e=>e.toLowerCase().includes(t)&&!this.options.equipment.includes(e)):[]});options={duration:45,goal:"hypertrophy",split:"fullBody",targetMuscles:[],avoidMuscles:[],usePersonalGym:!0,equipment:[],excludeEquipment:[]};ngOnInit(){return L(this,null,function*(){let t=this.exerciseService.getUniquePrimaryMuscleGroups(),e=this.muscleMapService.musclesMap$,i=sr([t,e]).pipe(de(([l,g])=>l.map(x=>g.get(typeof x=="string"?x:x.id)).filter(x=>x!==void 0).sort((x,v)=>x.name.localeCompare(v.name))));this.categories.set(this.exerciseCategory.getHydratedCategories());let r=yield he(i);this.allMuscleGroups.set(r);let o=yield he(this.exerciseService.getUniqueEquipment());this.allAvailableEquipment.set(o);let s=yield he(this.personalGymService.getAllEquipment());this.allPersonalGymEquipment.set(s.map(l=>l.category)),this.updateEquipmentFromPersonalGym()})}ngOnChanges(t){t.isOpen&&t.isOpen.currentValue===!0&&(this.resetOptions(),this.updateEquipmentFromPersonalGym())}toggleMuscle(t,e){let i=t==="target"?this.options.targetMuscles:this.options.avoidMuscles,r=i.indexOf(e.id);r>-1?i.splice(r,1):i.push(e.id)}generateQuick(){this.generate.emit("quick")}generateDetailed(){this.generate.emit(A({},this.options))}resetOptions(){this.options={duration:45,goal:"hypertrophy",split:"fullBody",targetMuscles:[],avoidMuscles:[],usePersonalGym:!0,equipment:[],excludeEquipment:[]},this.equipmentSearchTerm.set(""),this.excludeEquipmentSearchTerm.set("")}selectEquipment(t){this.options.equipment.includes(t)||this.options.equipment.push(t),this.equipmentSearchTerm.set("")}removeEquipment(t){let e=this.options.equipment.indexOf(t);e>-1&&this.options.equipment.splice(e,1)}toggleExcludePersonalGymEquipment(t){let e=this.options.excludeEquipment.indexOf(t.toLowerCase());e>-1?this.options.excludeEquipment.splice(e,1):this.options.excludeEquipment.push(t.toLowerCase()),this.updateEquipmentFromPersonalGym()}filteredAvailableEquipmentToExclude=ve(()=>{let t=this.excludeEquipmentSearchTerm().toLowerCase().trim();if(!t)return[];let e=this.allAvailableEquipment(),i=this.allPersonalGymEquipment();return(this.options.usePersonalGym?i:e).filter(o=>o.toLowerCase().includes(t)&&!this.options.excludeEquipment.includes(o.toLowerCase()))});addExcludedEquipment(t){let e=t.toLowerCase();this.options.excludeEquipment.includes(e)||this.options.excludeEquipment.push(e),this.excludeEquipmentSearchTerm.set("")}removeExcludedEquipment(t){let e=this.options.excludeEquipment.indexOf(t);e>-1&&this.options.excludeEquipment.splice(e,1)}onUsePersonalGymChange(){this.options.excludeEquipment=[],this.equipmentSearchTerm.set(""),this.updateEquipmentFromPersonalGym()}updateEquipmentFromPersonalGym(){if(this.options.usePersonalGym){let t=this.allPersonalGymEquipment(),e=this.options.excludeEquipment;this.options.equipment=t.filter(i=>!e.includes(i.toLowerCase()))}else this.options.equipment=[]}static \u0275fac=function(e){return new(e||n)(Ce(_e))};static \u0275cmp=De({type:n,selectors:[["app-generate-workout-modal"]],inputs:{isOpen:"isOpen",customPB:[1,"customPB"]},outputs:{close:"close",generate:"generate"},features:[Ke],decls:1,vars:1,consts:[["usePersonalGymSection",""],["class","fixed inset-0 z-[100] flex flex-col bg-gray-100 dark:bg-gray-800",3,"ngClass","click",4,"ngIf"],[1,"fixed","inset-0","z-[100]","flex","flex-col","bg-gray-100","dark:bg-gray-800",3,"click","ngClass"],[1,"w-full","h-full","flex","flex-col",3,"click"],[1,"px-5","py-2","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center","flex-shrink-0","bg-white/80","dark:bg-gray-800/80","backdrop-blur-sm"],[1,"flex","items-center","gap-3"],["name","magic-wand",1,"h-7","w-7","text-primary","dark:text-primary-light"],[1,"text-xl","font-semibold","text-gray-800","dark:text-gray-100"],[1,"p-1.5","rounded-full","text-gray-500","hover:text-gray-700",3,"click"],["name","cancel",1,"h-6","w-6"],[1,"overflow-y-auto","flex-grow","p-4","sm:p-6","pb-24"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-6","gap-y-6","max-w-4xl","mx-auto"],[1,"block","text-sm","font-medium","dark:text-gray-100"],["type","range","min","15","max","120","step","5",1,"w-full","h-2","rounded-md","appearance-none","cursor-pointer",3,"ngModelChange","ngModel"],[1,"block","w-full","p-2","border","rounded-md","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngModelChange","ngModel"],["value","hypertrophy"],["value","strength"],["value","muscular endurance"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"md:col-span-2"],["value","fullBody"],["value","upper-lower"],["value","push-pull-legs"],[1,"dark:text-gray-200"],[1,"block","text-sm","font-medium"],[1,"max-h-32","overflow-y-auto","p-2","border","rounded-md","dark:border-gray-600"],[4,"ngFor","ngForOf"],[1,"md:col-span-2","dark:text-gray-200"],[1,"flex","items-center","gap-2","my-2"],["type","checkbox",3,"ngModelChange","change","ngModel"],["class","p-2 border rounded-md bg-gray-100 dark:bg-gray-800",4,"ngIf"],["class","md:col-span-2 text-black dark:text-gray-200 relative",4,"ngIf","ngIfElse"],[1,"md:col-span-2","text-black","dark:text-gray-200","relative"],[1,"px-6","py-4","border-t","border-gray-200","dark:border-gray-700","flex-shrink-0","bg-white","dark:bg-gray-700","sticky","bottom-0"],[1,"flex","flex-col","sm:flex-row","sm:justify-end","sm:space-x-4","space-y-3","sm:space-y-0"],["type","button",1,"w-full","text-white","sm:w-auto","inline-flex","justify-center","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","dark:text-gray-200","bg-green-600","hover:bg-green-700",3,"click"],["name","random",1,"h-5","w-5","mr-2"],["type","button",1,"w-full","sm:w-auto","inline-flex","justify-center","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-purple-500","hover:bg-purple-700",3,"click"],["name","magic-wand",1,"h-5","w-5","mr-2"],[1,"flex","items-center","gap-2"],["type","checkbox",3,"change","value","checked","disabled"],[1,"p-2","border","rounded-md","bg-gray-100","dark:bg-gray-800"],["class","text-sm italic text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"flex","flex-wrap","gap-2"],["type","button","class","px-3 py-1.5 text-xs font-semibold rounded-full transition-colors",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"text-sm","italic","text-gray-500","dark:text-gray-400"],["type","button",1,"px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors",3,"click","ngClass"],[1,"block","text-sm","font-medium","dark:text-gray-100","my-1"],["type","text","placeholder","Search equipment to exclude...",1,"block","w-full","p-2","border","rounded-md","dark:bg-gray-800","dark:border-gray-600","focus:ring-primary","focus:border-primary",3,"ngModelChange","ngModel"],["class","absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-md shadow-lg max-h-40 overflow-y-auto",4,"ngIf"],["class","relative border rounded-md px-3 pt-5 pb-2 mt-4 dark:border-gray-600",4,"ngIf"],[1,"absolute","z-10","w-full","mt-1","bg-white","dark:bg-gray-800","border","dark:border-gray-600","rounded-md","shadow-lg","max-h-40","overflow-y-auto"],["type","button","class","w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-600",3,"click"],[1,"relative","border","rounded-md","px-3","pt-5","pb-2","mt-4","dark:border-gray-600"],[1,"absolute","top-0","left-3","-mt-2","px-2","text-xs","font-medium","text-gray-500","dark:text-gray-400","bg-white","dark:bg-gray-700","rounded-md"],[1,"flex","flex-wrap","gap-2","min-h-[40px]"],["class","flex items-center gap-x-2 px-3 py-1.5 text-xs font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-700 dark:text-white",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-x-2","px-3","py-1.5","text-xs","font-semibold","rounded-full","bg-red-100","text-red-800","dark:bg-red-700","dark:text-white"],["type","button",1,"text-red-800/70","hover:text-red-800","focus:outline-none","dark:text-white/70","dark:hover:text-white",3,"click"],["name","cancel",1,"h-4","w-4"],["class","p-2 border rounded-md mb-2 min-h-[40px] bg-white dark:bg-gray-800 flex flex-wrap gap-2",4,"ngIf"],[1,"p-2","border","rounded-md","mb-2","min-h-[40px]","bg-white","dark:bg-gray-800","flex","flex-wrap","gap-2"]],template:function(e,i){e&1&&w(0,xs,89,65,"div",1),e&2&&p("ngIf",i.isOpen)},dependencies:[lt,nt,ot,st,ht,gt,pt,mt,dt,Ar,Dr,$t,ct,ut,xt,at,ft],encapsulation:2})};var bi=class n{exerciseService=S(qe);personalGymService=S(ni);workoutService=S(ii);toastService=S(_t);generateQuickWorkout(){return L(this,null,function*(){console.log("Starting QUICK workout generation...");let t={usePersonalGym:!0,avoidMuscles:[],split:"fullBody",targetMuscles:[],duration:45,goal:"hypertrophy",equipment:[],excludeEquipment:[]},e=yield this.getSelectableExercises(t);if(e.length<5)return this.toastService.error("Not enough exercises available to generate a workout.",0,"Error"),null;let i=new Map;e.forEach(m=>{m.primaryMuscleGroup&&(i.has(m.primaryMuscleGroup)||i.set(m.primaryMuscleGroup,[]),i.get(m.primaryMuscleGroup).push(m))});let r={legs:["quadriceps","Hamstrings","Glutes","Calves"],push:["Chest","Shoulders","Triceps"],pull:["Lats","Traps","Biceps","Lower back","Back"],core:["Abs","Obliques","Core"]},o=[],s=new Set,l=m=>{let x=this.shuffleArray(m.filter(v=>i.has(v)));for(let v of x){let k=i.get(v),T=this.pickUniqueExercise(k,Array.from(s));if(T){o.push(this.createSimpleWorkoutExercise(T)),s.add(T.id);return}}};if(l(r.legs),l(r.push),l(r.pull),l(r.core),o.length<5){let m=Array.from(i.keys());l(m)}return o.length<3?(console.error("Quick generation failed: could not build a balanced workout."),null):{id:`generated-${U()}`,name:"Quick Surprise Workout",description:`A randomly generated full-body session created on ${new Date().toLocaleDateString()}.`,exercises:this.shuffleArray(o),goal:"hypertrophy",isFavourite:!1,isHidden:!0}})}tryGenerateWithCriteria(t){return L(this,null,function*(){let e=yield this.getSelectableExercises(t);return e.length<2?null:this.buildExerciseList(e,t)})}getSelectableExercises(t){return L(this,null,function*(){let i=(yield he(this.exerciseService.getExercises())).filter(s=>!s.isHidden&&s.category!=="stretching");t.exerciseCategory&&t.exerciseCategory&&(i=i.filter(s=>s.category===t.exerciseCategory?.id));let r=[];if(t.usePersonalGym?r=(yield he(this.personalGymService.getAllEquipment())).map(l=>l.category.toLowerCase()):t.equipment.length>0&&(r=t.equipment.map(s=>s.toLowerCase())),r.length>0&&(i=i.filter(s=>{if(s.category==="bodyweightCalisthenics"||!s.equipment&&(!s.equipmentNeeded||s.equipmentNeeded.length===0))return!0;let l=(s.equipment||"").toLowerCase(),g=(s.equipmentNeeded||[]).map(m=>m.toLowerCase());return r.some(m=>l&&l.includes(m)?!0:g.some(x=>x.includes(m)))})),t.avoidMuscles.length>0){let s=new Set(t.avoidMuscles);i=i.filter(l=>l&&l.primaryMuscleGroup&&!s.has(l.primaryMuscleGroup))}let o=this.determineTargetMuscles(t.split,t.targetMuscles);if(o.size>0&&(i=i.filter(s=>s.primaryMuscleGroup&&o.has(s.primaryMuscleGroup.toLowerCase()))),t.excludeEquipment&&t.excludeEquipment.length>0){let s=t.excludeEquipment.map(l=>l.toLowerCase());i=i.filter(l=>{let g=(l.equipment||"").toLowerCase(),m=(l.equipmentNeeded||[]).map(v=>v.toLowerCase());return!s.some(v=>g.includes(v)||m.some(k=>k.includes(v)))})}return i})}determineTargetMuscles(t,e){if(e.length>0)return new Set(e);switch(t){case"upper-lower":return new Set(["chest","lats","shoulders","biceps","triceps","traps","lower back","forearms","abs","obliques"]);case"push-pull-legs":return new Set(["chest","shoulders","triceps"]);case"fullBody":default:return new Set(["quadriceps","hamstrings","glutes","calves","chest","lats","shoulders","biceps","triceps","lower back","traps","abs"])}}buildExerciseList(t,e){let i=[],r=0,o=e.duration*60,s=15,l=new Set;t.forEach(v=>{v.equipment&&v.category!=="bodyweightCalisthenics"&&l.add(v.equipment.toLowerCase()),(v.equipmentNeeded||[]).forEach(k=>l.add(k.toLowerCase()))});let g=this.shuffleArray(Array.from(l)),m=this.shuffleArray(t),x=new Map;for(;r<o&&i.length<s&&m.length>0;){let v=null,k=-1,T=g.find(z=>!i.some(V=>V.exercise.equipment?.toLowerCase()===z||V.exercise.equipmentNeeded?.map(ee=>ee.toLowerCase()).includes(z)));if(T){let z=this.shuffleArray(m.filter(V=>V.equipment?.toLowerCase()===T||V.equipmentNeeded?.map(ee=>ee.toLowerCase()).includes(T)));z.length>0&&(v=z[0],k=m.findIndex(V=>V.id===v.id))}if(!v&&m.length>0&&(v=m[0],k=0),!v)break;m.splice(k,1);let B=v.primaryMuscleGroup;if(!B)continue;let M=x.get(B)||0;if(M>=3)continue;let P=this.createWorkoutExercise(v,e.goal),le=this.workoutService.getEstimatedRoutineDuration({exercises:[P]})*60;r+le>o+120||(i.push(P),r+=le,B&&x.set(B?.toString(),M+1))}return this.shuffleArray(i)}pickUniqueExercise(t,e){let i=this.shuffleArray([...t]);for(let r of i)if(!e.includes(r.id))return r;return null}shuffleArray(t){for(let e=t.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}createWorkoutExercise(t,e){let i=3,r={min:8,max:12},o=60,s=300;switch(e){case"strength":i=4,r={min:4,max:6},o=90;break;case"muscular endurance":i=3,r={min:15,max:20},o=45,s=600;break;case"hypertrophy":default:i=3,r={min:8,max:12},o=60;break}let l={};t.category==="cardio"?l={fieldOrder:["duration","distance","rest"],targetDuration:Oe(s),targetDistance:Ge(1)}:t.category==="bodyweightCalisthenics"?l={fieldOrder:["reps","rest"],targetReps:{type:"range",min:r.min,max:r.max}}:l={fieldOrder:["reps","weight","rest"],targetReps:{type:"range",min:r.min,max:r.max},targetWeight:ye(10)};let g=Array.from({length:i},()=>A({id:U(),type:"standard",targetRest:ie(o)},l));return{id:U(),exerciseId:t.id,exerciseName:t.name,sets:g,supersetId:null,supersetOrder:null,type:"standard",exercise:t}}createSimpleWorkoutExercise(t){let e;return t.category==="cardio"?e=Array.from({length:3},()=>({id:U(),type:"standard",fieldOrder:["duration","distance","rest"],targetDuration:Oe(300),targetDistance:Ge(1),targetRest:ie(90)})):t.category==="bodyweightCalisthenics"?e=Array.from({length:3},()=>({id:U(),type:"standard",fieldOrder:["reps","rest"],targetReps:Vi(10),targetRest:ie(60)})):e=Array.from({length:3},()=>({id:U(),type:"standard",fieldOrder:["reps","weight","rest"],targetReps:Vi(10),targetWeight:ye(10),targetRest:ie(60)})),{id:U(),exerciseId:t.id,exerciseName:t.name,sets:e,supersetId:null,supersetOrder:null}}generateWorkout(t){return L(this,null,function*(){console.log("Starting workout generation with options:",t);let e=yield this.tryGenerateWithCriteria(t);if(!e||e.length<2){console.warn("Generation failed with strict criteria. Fallback 1: Ignoring equipment constraints."),this.toastService.info("Not enough specific exercises found. Broadening search...",3e3,"Expanding Search");let o=N(A({},t),{usePersonalGym:!1,equipment:[]});e=yield this.tryGenerateWithCriteria(o)}if(!e||e.length<2){console.warn("Generation failed after relaxing equipment. Fallback 2: Ignoring target muscle constraints."),this.toastService.info("Still not enough. Ignoring specific muscle targets...",3e3,"Expanding Further");let o=N(A({},t),{targetMuscles:[]});e=yield this.tryGenerateWithCriteria(o)}if(!e||e.length===0)return console.error("CRITICAL: Workout generation failed even with all fallbacks."),null;let i=`Generated ${t.split.replace("-"," ")} Workout`;return{id:`generated-${U()}`,name:i,description:`Generated on ${new Date().toLocaleDateString()} for a ~${t.duration} minute, ${t.goal}-focused session.`,exercises:e,goal:t.goal,isFavourite:!1,isHidden:!0}})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};var eo=[{id:"strengthTraining",name:"workout-categories.strengthTraining"},{id:"cardioEndurance",name:"workout-categories.cardioEndurance"},{id:"flexibilityMobility",name:"workout-categories.flexibilityMobility"},{id:"mindBodyRecovery",name:"workout-categories.mindBodyRecovery"},{id:"sportSpecific",name:"workout-categories.sportSpecific"},{id:"quickWorkouts",name:"workout-categories.quickWorkouts"},{id:"specialty",name:"workout-categories.specialty"},{id:"targetedWorkouts",name:"workout-categories.targetedWorkouts"},{id:"guidedPrograms",name:"workout-categories.guidedPrograms"},{id:"equipmentSpecific",name:"workout-categories.equipmentSpecific"},{id:"custom",name:"workout-categories.custom"}];var wi=class n{translate=S(Ne);allCategories$=se(eo);categoryMap$=this.allCategories$.pipe(de(t=>new Map(t.map(e=>[e.id,e]))),Ot(1));translatedCategories$=this.translate.onLangChange.pipe(ue(null),Me(()=>this.allCategories$.pipe(Me(t=>{if(!t.length)return se([]);let e=t.map(i=>`workout-categories.${i.id}`);return this.translate.get(e).pipe(de(i=>t.map(r=>N(A({},r),{name:i[`workout-categories.${r.id}`]||r.name}))))}))),Ot(1));getTranslatedCategories(){return this.translatedCategories$}static \u0275fac=function(e){return new(e||n)};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};var ir=(s=>(s.NONE="None",s.WARM_UP="WarmUp",s.MAIN_LIFT="MainLift",s.CARDIO="Cardio",s.FINISHER="Finisher",s.COOL_DOWN="CoolDown",s))(ir||{});var vs=["exerciseSearchFied"],ys=["setRepsInput"],bs=["expandedSetElement"],ws=["expandedExerciseCard"],Ss=n=>({"pb-32":n}),Si=(n,t)=>({"border-red-500 dark:border-red-400":n,"border-gray-300 dark:border-gray-500":t}),Cs=n=>({week:n}),ks=n=>({day:n}),Es=n=>({"top-3":n}),rr=n=>({count:n}),Is=n=>({"background-color":n}),Ts=n=>({"rounded-b-none":n}),Ms=(n,t)=>({"w-8 h-8 ":n,"w-10 h-10 py-1":t}),Fs=(n,t)=>({order:n,total:t}),Pt=()=>({standalone:!0}),Ds=(n,t)=>({"bg-primary text-white border-primary-light":n,"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 border-gray-300 dark:border-gray-600":t}),Rs=n=>[n],Bs=(n,t)=>({"bg-gray-50 dark:bg-gray-700/50":n,"bg-blue-50 dark:bg-blue-700/50":t}),Ps=()=>["warmup","dropset","failure","amrap","myorep","restpause"],As=(n,t)=>({"bg-gray-100 dark:bg-gray-800/50":n,"bg-blue-100 dark:bg-blue-800/50":t}),ze=(n,t)=>({setControl:n,field:t}),Vs=(n,t,e)=>({setControl:n,exIndex:t,setIndex:e}),Ls=n=>({"animating-input-text":n});function Os(n,t){if(n&1&&(u(0,"div",35),h(1),d()),n&2){let e=c();a(),C(" ",e.errorMessage(),`
`)}}function Ws(n,t){if(n&1){let e=D();u(0,"app-action-menu",41),I("itemClick",function(r){y(e);let o=c(3);return b(o.handleActionMenuItemClick(r))})("closeMenu",function(){y(e);let r=c(3);return b(r.onCloseActionMenu())}),d()}if(n&2){let e=c(2).ngIf,i=c();p("gridClass"," grid grid-cols-2 ")("items",i.getRoutineDropdownActionItems(e.id,"dropdown"))("isVisible",i.areActionsVisible(e.id))}}function Ns(n,t){if(n&1){let e=D();u(0,"div",37)(1,"button",38),I("click",function(r){y(e);let o=c().ngIf,s=c();return b(s.toggleActions(o.id,r))}),F(2,"app-icon",39),d(),w(3,Ws,1,3,"app-action-menu",40),d()}if(n&2){let e=c().ngIf,i=c();a(3),p("ngIf",i.areActionsVisible(e.id))}}function Gs(n,t){if(n&1&&(u(0,"div"),w(1,Ns,4,1,"div",36),d()),n&2){let e=t.ngIf,i=c();a(),p("ngIf",e.id&&!i.isNewMode&&i.mode!==i.BuilderMode.customProgramEntryBuilder)}}function qs(n,t){if(n&1&&(u(0,"div")(1,"label",46),h(2),d()()),n&2){let e,i=c(2);a(2),E((e=i.builderForm.get("name"))==null?null:e.value)}}function zs(n,t){n&1&&(u(0,"span"),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.routineBuilder.nameRequired")))}function Hs(n,t){if(n&1&&(u(0,"div",51),w(1,zs,3,3,"span",23),d()),n&2){let e,i=c(3);a(),p("ngIf",(e=i.builderForm.get("name"))==null||e.errors==null?null:e.errors.required)}}function Us(n,t){if(n&1&&(u(0,"div",47)(1,"label",48),h(2),_(3,"translate"),d(),F(4,"input",49),_(5,"translate"),w(6,Hs,2,1,"div",50),d()),n&2){let e,i,r=c(2);a(2),E(f(3,4,"workoutBuilder.routineBuilder.nameLabel")),a(2),p("placeholder",f(5,6,"workoutBuilder.routineBuilder.namePlaceholder"))("ngClass",j(8,Si,((e=r.builderForm.get("name"))==null?null:e.invalid)&&((e=r.builderForm.get("name"))==null?null:e.touched),!((e=r.builderForm.get("name"))!=null&&e.invalid&&((e=r.builderForm.get("name"))!=null&&e.touched)))),a(2),p("ngIf",((i=r.builderForm.get("name"))==null?null:i.invalid)&&(((i=r.builderForm.get("name"))==null?null:i.dirty)||((i=r.builderForm.get("name"))==null?null:i.touched)))}}function $s(n,t){if(n&1&&(u(0,"div"),F(1,"p",52),d()),n&2){let e=c(2);a(),p("innerHTML",e.sanitizedDescription,ur)}}function js(n,t){n&1&&(u(0,"div")(1,"label",53),h(2),_(3,"translate"),d(),F(4,"textarea",54),_(5,"translate"),d()),n&2&&(a(2),E(f(3,2,"workoutBuilder.routineBuilder.descriptionLabel")),a(2),p("placeholder",f(5,4,"workoutBuilder.routineBuilder.descriptionPlaceholder")))}function Ks(n,t){if(n&1&&(u(0,"div")(1,"label",55)(2,"span",56),h(3),_(4,"translate"),d(),h(5),d()()),n&2){let e,i=c(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.goalLabel"),": "),a(2),C(" ",((e=i.builderForm.get("goal"))==null||e.value==null?null:e.value.toUpperCase())||"")}}function Zs(n,t){if(n&1&&(u(0,"option",61),h(1),_(2,"translate"),d()),n&2){let e=t.$implicit;p("value",e.value),a(),C(" ",f(2,2,e.label)," ")}}function Ys(n,t){if(n&1&&(u(0,"div",47)(1,"label",57),h(2),_(3,"translate"),d(),u(4,"select",58)(5,"option",59),h(6),_(7,"translate"),d(),w(8,Zs,3,4,"option",60),d()()),n&2){let e=c(2);a(2),E(f(3,3,"workoutBuilder.routineBuilder.goalLabel")),a(4),E(f(7,5,"workoutBuilder.routineBuilder.goalPlaceholder")),a(2),p("ngForOf",e.routineGoals)}}function Qs(n,t){if(n&1&&(u(0,"div")(1,"label",55)(2,"span",56),h(3),_(4,"translate"),d(),h(5),d()()),n&2){let e,i=c(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.primaryCategoryLabel"),": "),a(2),C(" ",(e=i.builderForm.get("primaryCategory"))==null?null:e.value," ")}}function Js(n,t){if(n&1&&(u(0,"option",61),h(1),d()),n&2){let e=t.$implicit;p("value",e.id),a(),C(" ",e.name," ")}}function Xs(n,t){if(n&1&&(u(0,"div")(1,"label",62),h(2),_(3,"translate"),d(),u(4,"select",63)(5,"option",59),h(6),_(7,"translate"),d(),w(8,Js,2,2,"option",60),d()()),n&2){let e=c(2);a(2),C(" ",f(3,3,"workoutBuilder.routineBuilder.primaryCategoryLabel")," "),a(4),C("",f(7,5,"workoutBuilder.routineBuilder.primaryCategoryPlaceholder")," "),a(2),p("ngForOf",e.categories())}}function ea(n,t){if(n&1&&(u(0,"div")(1,"label",55)(2,"span",56),h(3),_(4,"translate"),d(),h(5),d()()),n&2){let e,i=c(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.secondaryCategoryLabel"),": "),a(2),C(" ",(e=i.builderForm.get("secondaryCategory"))==null?null:e.value," ")}}function ta(n,t){n&1&&(u(0,"div")(1,"label",64),h(2),_(3,"translate"),d(),F(4,"input",65),_(5,"translate"),d()),n&2&&(a(2),C(" ",f(3,2,"workoutBuilder.routineBuilder.secondaryCategoryLabel")," "),a(2),p("placeholder",f(5,4,"workoutBuilder.routineBuilder.secondaryCategoryPlaceholder")))}function ia(n,t){if(n&1&&(u(0,"span",70),h(1),d()),n&2){let e=t.$implicit;a(),C(" ",e.trim()," ")}}function ra(n,t){if(n&1&&(u(0,"div",66)(1,"div",67)(2,"label",68),h(3),_(4,"translate"),d(),w(5,ia,2,1,"span",69),d()()),n&2){let e,i=c(2);a(3),C("",f(4,2,"workoutBuilder.routineBuilder.tagsLabel"),": "),a(2),p("ngForOf",(e=i.builderForm.get("tags"))==null?null:e.value.split(","))}}function na(n,t){n&1&&(u(0,"div")(1,"label",71),h(2),_(3,"translate"),d(),F(4,"input",72),_(5,"translate"),d()),n&2&&(a(2),C(" ",f(3,2,"workoutBuilder.routineBuilder.tagsLabel")," "),a(2),p("placeholder",f(5,4,"workoutBuilder.routineBuilder.tagsPlaceholder")))}function oa(n,t){if(n&1&&(u(0,"div",75)(1,"span",56),h(2),_(3,"translate"),d(),h(4),d()),n&2){let e=c().ngIf;a(2),E(f(3,2,"workoutBuilder.routineBuilder.lastDuration")),a(2),C(" ",e.duration," min ")}}function sa(n,t){if(n&1&&(O(0),u(1,"div",73)(2,"span",56),h(3),_(4,"translate"),d(),h(5),_(6,"millisecondsDate"),d(),w(7,oa,5,4,"div",74),W()),n&2){let e=t.ngIf;a(3),E(f(4,3,"workoutBuilder.routineBuilder.lastPerformed")),a(2),C(" ",f(6,5,e.startTime)," "),a(2),p("ngIf",e.duration)}}function aa(n,t){n&1&&(u(0,"div",76),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.routineBuilder.notPerformed")," "))}function la(n,t){if(n&1&&(u(0,"div",73)(1,"span",56),h(2),_(3,"translate"),d(),h(4),d()),n&2){let e=c(2);a(2),E(f(3,2,"workoutBuilder.routineBuilder.estimatedDuration")),a(2),C(" ~",e.getRoutineDuration()," min ")}}function da(n,t){if(n&1&&(u(0,"div",73)(1,"span",56),h(2),_(3,"translate"),d(),h(4),d()),n&2){let e=c(2);a(2),E(f(3,2,"workoutBuilder.routineBuilder.totExercises")),a(2),C(" ",e.getTotalExerciseCount()," ")}}function ca(n,t){if(n&1&&(O(0),w(1,qs,3,1,"div",23)(2,Us,7,11,"div",42)(3,$s,2,1,"div",23)(4,js,6,6,"div",23)(5,Ks,6,4,"div",23)(6,Ys,9,7,"div",42)(7,Qs,6,4,"div",23)(8,Xs,9,7,"div",23)(9,ea,6,4,"div",23)(10,ta,6,6,"div",23)(11,ra,6,4,"div",43)(12,na,6,6,"div",23)(13,sa,8,7,"ng-container",44)(14,aa,3,3,"ng-template",null,3,xe),u(16,"div"),w(17,la,5,4,"div",45),d(),u(18,"div"),w(19,da,5,4,"div",45),d(),W()),n&2){let e,i,r,o,s=Q(15),l=c();a(),p("ngIf",l.isViewMode),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.isViewMode),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.isViewMode),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.isViewMode&&((e=l.builderForm.get("primaryCategory"))==null?null:e.value)),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.isViewMode&&((i=l.builderForm.get("secondaryCategory"))==null?null:i.value)),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.isViewMode&&((r=l.builderForm.get("tags"))==null?null:r.value)),a(),p("ngIf",l.isEditableMode()),a(),p("ngIf",l.lastLogForCurrentRoutine())("ngIfElse",s),a(4),p("ngIf",l.liveFormAsRoutine()&&l.getRoutineDuration()>0),a(2),p("ngIf",(l.liveFormAsRoutine()&&((o=l.liveFormAsRoutine())==null?null:o.exercises)&&((o=l.liveFormAsRoutine())==null||o.exercises==null?null:o.exercises.length))??0)}}function ua(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(3);a(),E(e.getLogTitleForProgramEntry())}}function pa(n,t){if(n&1&&(u(0,"header",93)(1,"h1",94),w(2,ua,2,1,"span",23),d()()),n&2){let e=c(2);a(2),p("ngIf",e.isEditableMode)}}function ma(n,t){n&1&&(u(0,"span"),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.logEntry.dateRequired")))}function ga(n,t){if(n&1&&(u(0,"div",51),w(1,ma,3,3,"span",23),d()),n&2){let e,i=c(2);a(),p("ngIf",(e=i.builderForm.get("workoutDate"))==null||e.errors==null?null:e.errors.required)}}function ha(n,t){n&1&&(u(0,"span"),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.logEntry.startTimeRequired")))}function _a(n,t){if(n&1&&(u(0,"div",51),w(1,ha,3,3,"span",23),d()),n&2){let e,i=c(2);a(),p("ngIf",(e=i.builderForm.get("startTime"))==null||e.errors==null?null:e.errors.required)}}function fa(n,t){n&1&&(u(0,"span"),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.logEntry.endTimeRequired")))}function xa(n,t){if(n&1&&(u(0,"div",51),w(1,fa,3,3,"span",23),d()),n&2){let e,i=c(2);a(),p("ngIf",(e=i.builderForm.get("endTime"))==null||e.errors==null?null:e.errors.required)}}function va(n,t){if(n&1&&(u(0,"option",61),h(1),d()),n&2){let e=t.$implicit;p("value",e.id),a(),E(e.name)}}function ya(n,t){if(n&1&&(u(0,"option",61),h(1),d()),n&2){let e=t.$implicit;p("value",e.id),a(),C("",e.name," ")}}function ba(n,t){n&1&&(u(0,"span",98),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.logEntry.iterationWarning")))}function wa(n,t){if(n&1&&(u(0,"option",61),h(1),d()),n&2){let e=t.$implicit;p("value",e),a(),E(e)}}function Sa(n,t){if(n&1&&(u(0,"div")(1,"label",95),h(2),_(3,"translate"),d(),w(4,ba,3,3,"span",96),u(5,"select",97)(6,"option",59),h(7),_(8,"translate"),d(),w(9,wa,2,2,"option",60),d()()),n&2){let e,i=c(2);a(2),E(f(3,5,"workoutBuilder.logEntry.iterationLabel")),a(2),p("ngIf",i.isEditableMode),a(),p("disabled",!((e=i.builderForm.get("programIdForLog"))!=null&&e.value)||i.availableIterationIds.length===0),a(2),E(f(8,7,"workoutBuilder.logEntry.iterationPlaceholder")),a(2),p("ngForOf",i.availableIterationIds)}}function Ca(n,t){n&1&&(u(0,"span",98),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.logEntry.scheduledDayWarning")))}function ka(n,t){if(n&1&&(u(0,"option",61),h(1),_(2,"translate"),_(3,"translate"),d()),n&2){let e=t.$implicit;p("value",e.id),a(),J("",e.weekNumber?Ee(2,3,"workoutBuilder.logEntry.weekLabel",te(9,Cs,e.weekNumber)):""," - ",e.dayName?Ee(3,6,"workoutBuilder.logEntry.dayLabel",te(11,ks,e.dayName)):""," ")}}function Ea(n,t){if(n&1&&(u(0,"div")(1,"label",99),h(2),_(3,"translate"),d(),w(4,Ca,3,3,"span",96),u(5,"select",100)(6,"option",59),h(7),_(8,"translate"),d(),w(9,ka,4,13,"option",60),d()()),n&2){let e,i=c(2);a(2),C("",f(3,5,"workoutBuilder.logEntry.scheduledDayLabel")," "),a(2),p("ngIf",i.isEditableMode),a(),p("disabled",!((e=i.builderForm.get("programIdForLog"))!=null&&e.value)||i.availableScheduledDayIds.length===0),a(2),E(f(8,7,"workoutBuilder.logEntry.scheduledDayPlaceholder")),a(2),p("ngForOf",i.availableScheduledDayInfos)}}function Ia(n,t){if(n&1){let e=D();O(0),w(1,pa,3,1,"header",77),u(2,"div",78)(3,"div")(4,"label",79),h(5),_(6,"translate"),d(),F(7,"input",80),w(8,ga,2,1,"div",50),d(),u(9,"div")(10,"label",81),h(11),_(12,"translate"),d(),F(13,"input",82),w(14,_a,2,1,"div",50),d(),u(15,"div")(16,"label",83),h(17),_(18,"translate"),d(),u(19,"input",84),I("change",function(){y(e);let r=c();return b(r.handleEndTimeChange())}),d(),w(20,xa,2,1,"div",50),d()(),u(21,"div")(22,"label",85),h(23),_(24,"translate"),d(),F(25,"input",86),_(26,"translate"),d(),u(27,"div")(28,"label",87),h(29),_(30,"translate"),d(),u(31,"select",88)(32,"option",59),h(33),_(34,"translate"),d(),w(35,va,2,2,"option",60),d()(),u(36,"div")(37,"label",89),h(38),_(39,"translate"),d(),u(40,"select",90)(41,"option",59),h(42),_(43,"translate"),d(),w(44,ya,2,2,"option",60),d()(),w(45,Sa,10,9,"div",23)(46,Ea,10,9,"div",23),u(47,"div")(48,"label",91),h(49),_(50,"translate"),d(),F(51,"textarea",92),d(),W()}if(n&2){let e,i,r,o,s,l,g,m=c();a(),p("ngIf",m.checkIfLogForProgram()),a(4),E(f(6,22,"workoutBuilder.logEntry.dateLabel")),a(2),p("ngClass",j(42,Si,((e=m.builderForm.get("workoutDate"))==null?null:e.invalid)&&((e=m.builderForm.get("workoutDate"))==null?null:e.touched),!((e=m.builderForm.get("workoutDate"))!=null&&e.invalid&&((e=m.builderForm.get("workoutDate"))!=null&&e.touched)))),a(),p("ngIf",((i=m.builderForm.get("workoutDate"))==null?null:i.invalid)&&(((i=m.builderForm.get("workoutDate"))==null?null:i.dirty)||((i=m.builderForm.get("workoutDate"))==null?null:i.touched))),a(3),E(f(12,24,"workoutBuilder.logEntry.startTimeLabel")),a(2),p("ngClass",j(45,Si,((r=m.builderForm.get("startTime"))==null?null:r.invalid)&&((r=m.builderForm.get("startTime"))==null?null:r.touched),!((r=m.builderForm.get("startTime"))!=null&&r.invalid&&((r=m.builderForm.get("startTime"))!=null&&r.touched)))),a(),p("ngIf",((o=m.builderForm.get("startTime"))==null?null:o.invalid)&&(((o=m.builderForm.get("startTime"))==null?null:o.dirty)||((o=m.builderForm.get("startTime"))==null?null:o.touched))),a(3),E(f(18,26,"workoutBuilder.logEntry.endTimeLabel")),a(2),p("ngClass",j(48,Si,((s=m.builderForm.get("endTime"))==null?null:s.invalid)&&((s=m.builderForm.get("endTime"))==null?null:s.touched),!((s=m.builderForm.get("endTime"))!=null&&s.invalid&&((s=m.builderForm.get("endTime"))!=null&&s.touched)))),a(),p("ngIf",((l=m.builderForm.get("endTime"))==null?null:l.invalid)&&(((l=m.builderForm.get("endTime"))==null?null:l.dirty)||((l=m.builderForm.get("endTime"))==null?null:l.touched))),a(3),E(f(24,28,"workoutBuilder.logEntry.titleLabel")),a(2),p("placeholder",f(26,30,"workoutBuilder.logEntry.titlePlaceholder")),a(4),E(f(30,32,"workoutBuilder.logEntry.basedOnRoutineLabel")),a(2),p("disabled",(g=m.builderForm.get("programIdForLog"))==null?null:g.value),a(2),E(f(34,34,"workoutBuilder.logEntry.adHocOption")),a(2),p("ngForOf",m.availableRoutines),a(3),E(f(39,36,"workoutBuilder.logEntry.basedOnProgramLabel")),a(4),E(f(43,38,"workoutBuilder.logEntry.adHocProgramOption")),a(2),p("ngForOf",m.availablePrograms),a(),p("ngIf",m.initialProgramIdForLogEdit),a(),p("ngIf",m.initialProgramIdForLogEdit),a(3),E(f(50,40,"workoutBuilder.logEntry.notesLabel"))}}function Ta(n,t){if(n&1){let e=D();u(0,"button",126),I("click",function(){y(e);let r=c(5);return b(r.removeSelectedExercises())}),h(1),_(2,"translate"),d()}if(n&2){let e=c(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.removeExercisesButton",te(4,rr,e.selectedExerciseIndicesForMultipleRemoval().length))," ")}}function Ma(n,t){if(n&1){let e=D();u(0,"button",127),I("click",function(){y(e);let r=c(5);return b(r.openSectionSelectionModal())}),F(1,"app-icon",128),u(2,"span"),h(3),d()()}n&2&&(a(3),E("Section"))}function Fa(n,t){if(n&1){let e=D();u(0,"button",129),I("click",function(){y(e);let r=c(5);return b(r.groupSelectedAsSuperset())}),h(1),_(2,"translate"),d()}if(n&2){let e=c(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.groupButton",te(4,rr,e.selectedExerciseIndicesForSuperset().length))," ")}}function Da(n,t){if(n&1){let e=D();u(0,"button",130),I("click",function(){y(e);let r=c(2).index,o=c(3);return b(o.ungroupSuperset(r))}),h(1),_(2,"translate"),d()}if(n&2){let e=c(5);a(),C(" ",Ee(2,1,"workoutBuilder.superset.ungroupButton",te(4,rr,e.selectedExerciseIndicesForSuperset().length))," ")}}function Ra(n,t){if(n&1&&(u(0,"div",121),w(1,Ta,3,6,"button",122)(2,Ma,4,1,"button",123)(3,Fa,3,6,"button",124)(4,Da,3,6,"button",125),d()),n&2){let e=c(4);a(),p("ngIf",e.canRemoveSelectedExercises()&&e.selectedExerciseIndicesForSuperset().length>=2),a(),p("ngIf",e.selectedExerciseIndicesForSuperset().length>0),a(),p("ngIf",!e.canUngroupSelectedExercises()&&e.selectedExerciseIndicesForSuperset().length>=2),a(),p("ngIf",e.canUngroupSelectedExercises()&&e.selectedExerciseIndicesForSuperset().length>=2)}}function Ba(n,t){if(n&1&&(u(0,"div",131)(1,"span",132),h(2),d()()),n&2){let e=t.ngIf;a(),p("ngStyle",te(2,Is,e.color)),a(),C(" ",e.label," ")}}function Pa(n,t){if(n&1&&(u(0,"div",143)(1,"label",144),h(2),_(3,"translate"),d(),F(4,"input",145),d()),n&2){let e=c(2).index;a(),p("for","emomTime-"+e),a(),C("",f(3,3,"workoutBuilder.set.time")," (s):"),a(2),p("id","emomTime-"+e)}}function Aa(n,t){if(n&1){let e=D();u(0,"div",133,5)(2,"div",134)(3,"div",135)(4,"span",136),h(5),_(6,"translate"),d(),u(7,"strong",137),h(8),d()(),u(9,"div",138)(10,"span",136),h(11),_(12,"translate"),d(),u(13,"strong",139),h(14),_(15,"titlecase"),d(),u(16,"button",140),I("click",function(){y(e);let r=c().$implicit,o=c(3);return b(o.changeSupersetType(r))}),F(17,"app-icon",141),h(18),_(19,"translate"),d()(),w(20,Pa,5,5,"div",142),d()()}if(n&2){let e,i,r=c().$implicit,o=c(3);a(5),C(" ",f(6,7,"workoutBuilder.superset.rounds"),": "),a(3),E(o.workoutFormService.getSetsFormArray(r).length),a(3),C("",f(12,9,"workoutBuilder.set.type"),": "),a(2),p("ngClass",o.standarSuperSetOrEmomClass(r,!0)),a(),C(" ",f(15,11,((e=r.get("supersetType"))==null?null:e.value)||"standard")," "),a(4),C(" ",f(19,13,"workoutBuilder.changeType")," "),a(2),p("ngIf",((i=r.get("supersetType"))==null?null:i.value)==="emom")}}function Va(n,t){if(n&1&&(u(0,"div",146),h(1),d()),n&2){let e=c().$implicit,i=c(3);p("ngClass",i.standarSuperSetOrEmomClass(e,!1)),a(),C(" ",i.standarSuperSetOrEmomLabel(e)," ")}}function La(n,t){n&1&&(u(0,"div",147),_(1,"translate"),F(2,"app-icon",148),d()),n&2&&p("title",f(1,1,"workoutBuilder.exercise.dragToReorder"))}function Oa(n,t){if(n&1){let e=D();u(0,"input",149),_(1,"translate"),I("change",function(r){y(e);let o=c().index,s=c(3);return b(s.toggleExerciseSelection(o,r))}),d()}if(n&2){let e=c().index,i=c(3);p("title",f(1,3,"workoutBuilder.exercise.selectForSuperset"))("id","superset-select-"+e)("checked",i.selectedExerciseIndicesForSuperset().includes(e))}}function Wa(n,t){if(n&1){let e=D();u(0,"app-icon",158),I("click",function(r){y(e);let o=c(3).$implicit,s=c(3);return b(s.openModal(o.value,r))}),d()}}function Na(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(2).ngIf,i=c(6);a(),Gt("",e.reps," x ",e.weight," ",i.unitService.getWeightUnitSuffix())}}function Ga(n,t){if(n&1&&(u(0,"span"),h(1),_(2,"translate"),d()),n&2){let e=c(2).ngIf;a(),J("",f(2,2,"workoutBuilder.set.reps"),": ",e.reps)}}function qa(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(2).ngIf,i=c(6);a(),J("",e.weight," ",i.unitService.getWeightUnitSuffix())}}function za(n,t){if(n&1&&(O(0),w(1,Na,2,3,"span",23)(2,Ga,3,4,"span",23)(3,qa,2,2,"span",23),W()),n&2){let e=c().ngIf;a(),p("ngIf",e.reps&&e.weight),a(),p("ngIf",e.reps&&!e.weight),a(),p("ngIf",!e.reps&&e.weight)}}function Ha(n,t){n&1&&(u(0,"span",162),h(1,"|"),d())}function Ua(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(2).ngIf,i=c(6);a(),J("",e.distance," ",i.unitService.getDistanceMeasureUnitSuffix())}}function $a(n,t){n&1&&(u(0,"span",165),h(1,"/"),d())}function ja(n,t){if(n&1&&(u(0,"span",166),F(1,"app-icon",167),h(2),d()),n&2){let e=c(2).ngIf,i=c(6);a(2),C(" ",i.workoutUtilsService.formatSecondsToTime(e.duration)," ")}}function Ka(n,t){if(n&1&&(O(0),w(1,Ua,2,2,"span",23)(2,$a,2,0,"span",163)(3,ja,3,1,"span",164),W()),n&2){let e=c().ngIf;a(),p("ngIf",e.distance),a(),p("ngIf",e.distance&&e.duration),a(),p("ngIf",e.duration)}}function Za(n,t){n&1&&(u(0,"span",162),h(1,"|"),d())}function Ya(n,t){if(n&1&&(O(0),u(1,"span",166),F(2,"app-icon",168),h(3),d(),W()),n&2){let e=c().ngIf,i=c(6);a(3),C(" ",i.workoutUtilsService.formatSecondsToTime(e.rest)," ")}}function Qa(n,t){if(n&1&&(O(0,null,7),u(2,"p",159)(3,"span"),h(4),_(5,"translate"),_(6,"translate"),d(),u(7,"span",160),h(8," ( "),w(9,za,4,3,"ng-container",23)(10,Ha,2,0,"span",161)(11,Ka,4,3,"ng-container",23)(12,Za,2,0,"span",161)(13,Ya,4,1,"ng-container",23),h(14," ) "),d()(),W()),n&2){let e,i=t.ngIf,r=c(3),o=r.$implicit,s=r.index,l=c(3);a(4),C(" ",(l.isSuperSet(s)?f(6,8,"workoutBuilder.superset.rounds")+": ":f(5,6,"workoutBuilder.set.totalSets")+": ")+((e=o.get("sets"))==null||e.value==null?null:e.value.length)," "),a(5),p("ngIf",i.reps||i.weight),a(),p("ngIf",(i.reps||i.weight)&&(i.distance||i.duration)),a(),p("ngIf",i.distance||i.duration),a(),p("ngIf",(i.reps||i.weight||i.distance||i.duration)&&i.rest),a(),p("ngIf",i.rest)}}function Ja(n,t){if(n&1&&(u(0,"p"),h(1),_(2,"translate"),_(3,"translate"),d()),n&2){let e,i=c(4).$implicit,r=c(3);a(),J(" ",r.isEmomExercise(i)?"":f(2,2,"workoutBuilder.set.set")+": "+(i==null||(e=i.get("sets"))==null?null:e.value.length)," ",!r.isExerciseCardioOnlyCtrl(i)&&r.getSetReps(i)?"( "+f(3,4,"workoutBuilder.set.reps")+": "+r.getSetReps(i)+" )":""," ")}}function Xa(n,t){if(n&1&&(u(0,"p"),h(1),_(2,"translate"),d()),n&2){let e=c(4).$implicit,i=c(3);a(),Gt(" ",f(2,3,"workoutBuilder.set.weight")," (",i.unitService.getWeightUnitSuffix(),"): ",i.getSetWeightsUsed(e)," ")}}function el(n,t){if(n&1&&(u(0,"p"),h(1),_(2,"translate"),d()),n&2){let e=c(4).$implicit,i=c(3);a(),Gt(" ",f(2,3,"workoutBuilder.set.distance")," (",i.unitService.getDistanceMeasureUnitSuffix(),"): ",i.getSetDistanceDisplay(e)," ")}}function tl(n,t){if(n&1&&w(0,Ja,4,6,"p",23)(1,Xa,3,5,"p",23)(2,el,3,5,"p",23),n&2){let e,i,r=c(3).$implicit,o=c(3);p("ngIf",(r==null||(e=r.get("sets"))==null||e.value==null?null:e.value.length)>=1),a(),p("ngIf",(r==null||(i=r.get("sets"))==null?null:i.value)&&(r==null||(i=r.get("sets"))==null?null:i.value.length)>=1&&o.checkIfWeightedExercise(r)),a(),p("ngIf",o.isExerciseCardioOnlyCtrl(r)&&o.getSetDistanceDisplay(r))}}function il(n,t){if(n&1&&(u(0,"div",152)(1,"div",153)(2,"div",154)(3,"h3",155),h(4),d(),w(5,Wa,1,0,"app-icon",156),d(),u(6,"div",157),w(7,Qa,15,10,"ng-container",44)(8,tl,3,3,"ng-template",null,6,xe),d()()()),n&2){let e,i,r,o=Q(9),s=c(2).$implicit,l=c(3);a(3),p("title",(e=s.get("exerciseName"))==null?null:e.value),a(),C(" ",(i=s.get("exerciseName"))==null?null:i.value," "),a(),p("ngIf",(r=s.get("exerciseId"))==null?null:r.value),a(2),p("ngIf",l.getUniformSetValues(s))("ngIfElse",o)}}function rl(n,t){if(n&1&&(u(0,"div",150),w(1,il,10,5,"div",151),d()),n&2){let e=c().$implicit,i=c(3);a(),p("ngIf",i.workoutFormService.getSetsFormArray(e).controls.length>0)}}function nl(n,t){if(n&1&&(u(0,"span",178),h(1),_(2,"translate"),d()),n&2){let e,i=c(2),r=i.$implicit,o=i.index,s=c(3);p("ngClass",s.standarSuperSetOrEmomClass(r,!0)),a(),C(" ",Ee(2,2,"workoutBuilder.superset.exerciseLabel",j(5,Fs,(((e=r.get("supersetOrder"))==null?null:e.value)??0)+1,s.getSupersetSize(o)))," ")}}function ol(n,t){if(n&1){let e=D();u(0,"app-icon",158),I("click",function(r){y(e);let o=c(2).$implicit,s=c(3);return b(s.openModal(o.value,r))}),d()}}function sl(n,t){if(n&1&&(u(0,"div")(1,"label",179),h(2),_(3,"translate"),d(),F(4,"textarea",180),d()),n&2){let e=c(2).index,i=c(3);a(),p("for","exerciseNotes-"+e),a(),C(" ",f(3,4,i.isRoutineMode?"workoutBuilder.exercise.notesLabel":"workoutBuilder.exercise.loggedNotesLabel")," "),a(2),p("id","exerciseNotes-"+e)("readonly",i.isViewMode)}}function al(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.reps")))}function ll(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.weight")))}function dl(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.distance")))}function cl(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.time")," (s)"))}function ul(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.rest")," (s)"))}function pl(n,t){n&1&&(u(0,"div",182),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.set.notes")))}function ml(n,t){if(n&1&&(u(0,"div",187)(1,"strong"),h(2),d()()),n&2){let e=c().$implicit,i=c(6);a(2),E(i.workoutUtilsService.formatMetricTarget(e.targetReps,i.metricEnum.reps)||"-")}}function gl(n,t){if(n&1&&(u(0,"div",187)(1,"strong"),h(2),d()()),n&2){let e=c().$implicit,i=c(6);a(2),J("",i.getSetTargetDisplay(e,i.metricEnum.weight)||"-","",i.getSetTargetDisplay(e,i.metricEnum.weight)!=="-"?" "+i.unitService.getWeightUnitSuffix():"")}}function hl(n,t){if(n&1&&(u(0,"div",187)(1,"strong"),h(2),d()()),n&2){let e=c().$implicit,i=c(6);a(2),J("",i.getSetTargetDisplay(e,i.metricEnum.distance)||"-","",i.getSetTargetDisplay(e,i.metricEnum.distance)!=="-"?" "+i.unitService.getDistanceMeasureUnitSuffix():"")}}function _l(n,t){if(n&1&&(u(0,"div",187)(1,"strong"),h(2),d()()),n&2){let e=c().$implicit,i=c(6);a(2),E(i.getSetTargetDisplay(e,i.metricEnum.duration)||"-")}}function fl(n,t){if(n&1&&(u(0,"div",187)(1,"strong"),h(2),d()()),n&2){let e=c().$implicit,i=c(6);a(2),E(i.getSetTargetDisplay(e,i.metricEnum.rest)||"-")}}function xl(n,t){if(n&1){let e=D();O(0),u(1,"div",188),I("click",function(){y(e);let r=c(2).$implicit,o=c(6);return b(o.showNotesModal(r.notes))}),F(2,"app-icon",189),d(),W()}}function vl(n,t){n&1&&(u(0,"span"),h(1,"-"),d())}function yl(n,t){if(n&1&&(u(0,"div",187),w(1,xl,3,0,"ng-container",44)(2,vl,2,0,"ng-template",null,8,xe),d()),n&2){let e=Q(3),i=c().$implicit;a(),p("ngIf",i.notes)("ngIfElse",e)}}function bl(n,t){n&1&&F(0,"div",190)}function wl(n,t){if(n&1&&(O(0),u(1,"div",184),h(2),d(),w(3,ml,3,1,"div",185)(4,gl,3,2,"div",185)(5,hl,3,2,"div",185)(6,_l,3,1,"div",185)(7,fl,3,1,"div",185)(8,yl,4,2,"div",185)(9,bl,1,0,"div",186),W()),n&2){let e=t.$implicit,i=t.index,r=t.last,o=c(3).$implicit,s=c(3);a(2),E(i+1),a(),p("ngIf",s.checkIfRepsIsVisible(e)),a(),p("ngIf",s.checkIfWeightIsVisible(e)),a(),p("ngIf",s.checkIfDistanceIsVisible(e)),a(),p("ngIf",s.checkIfDurationIsVisible(e)&&!s.isEmom(o)),a(),p("ngIf",s.checkIfRestIsVisible(e)&&!s.isEmom(o)),a(),p("ngIf",s.checkIfNotesIsVisible(e)),a(),p("ngIf",!r)}}function Sl(n,t){if(n&1&&(u(0,"div",181)(1,"div",182),h(2),_(3,"translate"),d(),w(4,al,3,3,"div",183)(5,ll,3,3,"div",183)(6,dl,3,3,"div",183)(7,cl,3,3,"div",183)(8,ul,3,3,"div",183)(9,pl,3,3,"div",183)(10,wl,10,8,"ng-container",105),d()),n&2){let e,i=c(2).$implicit,r=c(3);p("ngClass",r.getGridColsForViewExercise(i)),a(2),C(" ",f(3,9,"workoutBuilder.set.header")),a(2),p("ngIf",r.checkIfRepsIsVisible(i)),a(),p("ngIf",r.checkIfWeightIsVisible(i)),a(),p("ngIf",r.checkIfDistanceIsVisible(i)),a(),p("ngIf",r.checkIfDurationIsVisible(i)&&!r.isEmom(i)),a(),p("ngIf",r.checkIfRestIsVisible(i)&&!r.isEmom(i)),a(),p("ngIf",r.checkIfNotesIsVisible(i)),a(),p("ngForOf",(e=i.get("sets"))==null?null:e.value)}}function Cl(n,t){if(n&1){let e=D();O(0),u(1,"button",210),I("click",function(){let r=y(e).$implicit,o=c(4).index,s=c(3);return b(s.toggleMetricForAllSets(o,r))}),h(2),_(3,"translate"),d(),W()}if(n&2){let e=t.$implicit,i=c(4).index,r=c(3);a(),p("ngClass",j(4,Ds,r.isMetricActiveForAllSets(i,e),!r.isMetricActiveForAllSets(i,e))),a(),C(" ",f(3,2,"metrics."+e)," ")}}function kl(n,t){if(n&1){let e=D();u(0,"div",197)(1,"button",198),I("click",function(r){y(e);let o=c(3).index,s=c(3);return b(s.toggleSetAllPanel(o,r))}),u(2,"span"),h(3),_(4,"translate"),d(),F(5,"app-icon",199),d(),u(6,"div",200,9)(8,"div",201),w(9,Cl,4,7,"ng-container",105),d(),u(10,"div",202)(11,"div",203)(12,"div")(13,"label",204),h(14),_(15,"translate"),d(),u(16,"input",205),Y("ngModelChange",function(r){y(e);let o=c(6);return Z(o.repsToSetForAll,r)||(o.repsToSetForAll=r),b(r)}),d()(),u(17,"div")(18,"label",204),h(19),_(20,"translate"),d(),u(21,"input",206),Y("ngModelChange",function(r){y(e);let o=c(6);return Z(o.weightToSetForAll,r)||(o.weightToSetForAll=r),b(r)}),d()(),u(22,"div")(23,"label",204),h(24),_(25,"translate"),d(),u(26,"input",205),Y("ngModelChange",function(r){y(e);let o=c(6);return Z(o.durationToSetForAll,r)||(o.durationToSetForAll=r),b(r)}),d()(),u(27,"div")(28,"label",204),h(29),_(30,"translate"),d(),u(31,"input",207),Y("ngModelChange",function(r){y(e);let o=c(6);return Z(o.distanceToSetForAll,r)||(o.distanceToSetForAll=r),b(r)}),d()(),u(32,"div")(33,"label",204),h(34),_(35,"translate"),d(),u(36,"input",205),Y("ngModelChange",function(r){y(e);let o=c(6);return Z(o.restToSetForAll,r)||(o.restToSetForAll=r),b(r)}),d()()(),u(37,"div",208)(38,"button",209),I("click",function(){y(e);let r=c(3).index,o=c(3);return b(o.applyToAllSets(r))}),h(39),_(40,"translate"),d()()()()()}if(n&2){let e=c(3).index,i=c(3);a(3),E(f(4,30,"setValueForAllSets")),a(2),Ae("rotate-180",i.expandedSetAllPanel()===e),a(),it("max-height",i.expandedSetAllPanel()===e?"500px":"0px"),a(3),p("ngForOf",i.allAvailableMetrics),a(5),E(f(15,32,"metrics.reps")),a(2),K("ngModel",i.repsToSetForAll),p("ngModelOptions",Ye(44,Pt))("step",i.repsStep),a(3),J("",f(20,34,"metrics.weight")," (",i.unitService.getWeightUnitSuffix(),")"),a(2),K("ngModel",i.weightToSetForAll),p("ngModelOptions",Ye(45,Pt))("step",i.weightStep),a(3),C("",f(25,36,"metrics.duration")," (s)"),a(2),K("ngModel",i.durationToSetForAll),p("ngModelOptions",Ye(46,Pt))("step",i.durationStep),a(3),J("",f(30,38,"metrics.distance")," (",i.unitService.getDistanceMeasureUnitSuffix(),")"),a(2),K("ngModel",i.distanceToSetForAll),p("ngModelOptions",Ye(47,Pt))("step",i.distanceStep),a(3),C("",f(35,40,"metrics.rest")," (s)"),a(2),K("ngModel",i.restToSetForAll),p("ngModelOptions",Ye(48,Pt))("step",i.restStep),a(2),p("disabled",i.repsToSetForAll()===null&&i.weightToSetForAll()===null&&i.durationToSetForAll()===null&&i.distanceToSetForAll()===null&&i.restToSetForAll()===null),a(),C(" ",f(40,42,"applyToAllSets")," ")}}function El(n,t){n&1&&(u(0,"div",219),h(1),_(2,"translate"),d()),n&2&&(a(),E(f(2,1,"workoutBuilder.set.reps")))}function Il(n,t){if(n&1&&(u(0,"div",220),h(1),_(2,"translate"),d()),n&2){let e=c(7);a(),J("",f(2,2,"workoutBuilder.set.weight")," (",e.unitService.getWeightUnitSuffix(),")")}}function Tl(n,t){if(n&1&&(u(0,"div",220),h(1),_(2,"translate"),d()),n&2){let e=c(7);a(),J("",f(2,2,"workoutBuilder.set.distance")," (",e.unitService.getDistanceMeasureUnitSuffix(),")")}}function Ml(n,t){n&1&&(u(0,"div",219),h(1),_(2,"translate"),d()),n&2&&(a(),C("",f(2,1,"workoutBuilder.set.time")," (s)"))}function Fl(n,t){n&1&&(u(0,"div",221),h(1),_(2,"translate"),d()),n&2&&(a(),C("",f(2,1,"workoutBuilder.set.rest")," (s)"))}function Dl(n,t){if(n&1&&(O(0),u(1,"div",211)(2,"div",212),h(3),_(4,"translate"),d(),u(5,"div",213)(6,"div",214),w(7,El,3,3,"div",215)(8,Il,3,4,"div",216)(9,Tl,3,4,"div",216)(10,Ml,3,3,"div",215)(11,Fl,3,3,"div",217),d()(),F(12,"div",218),d(),W()),n&2){let e=t.ngLet,i=c(3).index,r=c(3);a(),p("ngClass",r.getGridClassForExercise(i)),a(2),E(f(4,7,"workoutBuilder.set.header")),a(4),p("ngIf",e[r.metricEnum.reps]),a(),p("ngIf",e[r.metricEnum.weight]),a(),p("ngIf",e[r.metricEnum.distance]),a(),p("ngIf",e[r.metricEnum.duration]),a(),p("ngIf",e[r.metricEnum.rest])}}function Rl(n,t){if(n&1&&(u(0,"div",232),h(1),d()),n&2){let e=c(3).$implicit,i=c(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.reps)," ")}}function Bl(n,t){if(n&1&&(u(0,"div",233),h(1),d()),n&2){let e=c(3).$implicit,i=c(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.weight)," ")}}function Pl(n,t){if(n&1&&(u(0,"div",233),h(1),d()),n&2){let e=c(3).$implicit,i=c(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.distance)," ")}}function Al(n,t){if(n&1&&(u(0,"div",232),h(1),d()),n&2){let e=c(3).$implicit,i=c(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.duration)," ")}}function Vl(n,t){if(n&1&&(u(0,"div",234),h(1),d()),n&2){let e=c(3).$implicit,i=c(6);a(),C(" ",i.getMetricDisplayValue(e,i.metricEnum.rest)," ")}}function Ll(n,t){if(n&1){let e=D();O(0),u(1,"div",224),I("click",function(r){y(e);let o=c(2).index,s=c(3).index,l=c(3);return b(l.toggleSetExpansion(s,o,r))}),u(2,"div",225),h(3),d(),u(4,"div",213)(5,"div",214),w(6,Rl,2,1,"div",226)(7,Bl,2,1,"div",227)(8,Pl,2,1,"div",227)(9,Al,2,1,"div",226)(10,Vl,2,1,"div",228),d()(),u(11,"div",229)(12,"button",230),_(13,"translate"),I("click",function(r){y(e);let o=c(2).index,s=c(3),l=s.$implicit,g=s.index,m=c(3);return b(m.removeSet(l,g,o,r))}),F(14,"app-icon",231),d()()(),W()}if(n&2){let e,i=t.ngLet,r=c(2),o=r.$implicit,s=r.index,l=c(3).index,g=c(3);a(),p("ngClass",te(11,Rs,g.getGridClassForExercise(l)))("ngClass",j(13,Bs,((e=o.get("type"))==null?null:e.value)==="standard",((e=o.get("type"))==null?null:e.value)==="warmup")),a(2),C(" #",s+1),a(3),p("ngIf",i[g.metricEnum.reps]),a(),p("ngIf",i[g.metricEnum.weight]),a(),p("ngIf",i[g.metricEnum.distance]),a(),p("ngIf",i[g.metricEnum.duration]),a(),p("ngIf",i[g.metricEnum.rest]),a(2),p("title",f(13,9,"workoutBuilder.set.removeSet"))}}function Ol(n,t){if(n&1&&(u(0,"div"),w(1,Ll,15,16,"ng-container",195),d()),n&2){let e=c(4).index,i=c(3);a(),p("ngLet",i.getVisibleColumnsForExercise(e))}}function Wl(n,t){if(n&1){let e=D();u(0,"div",244)(1,"button",230),_(2,"translate"),I("click",function(r){y(e);let o=c(2).index,s=c(3),l=s.$implicit,g=s.index,m=c(3);return b(m.removeSet(l,g,o,r))}),F(3,"app-icon",231),d()()}n&2&&(a(),p("title",f(2,1,"workoutBuilder.set.removeSet")))}function Nl(n,t){if(n&1){let e=D();u(0,"button",250),I("click",function(r){y(e);let o=c(3).index,s=c(3).index;return c(3).promptAddField(s,o),b(r.stopPropagation())}),F(1,"app-icon",251),d()}}function Gl(n,t){if(n&1){let e=D();u(0,"div",245)(1,"label",246),h(2),_(3,"translate"),d(),u(4,"button",247),I("click",function(r){y(e);let o=c(2).index,s=c(3).index;return c(3).promptRemoveField(s,o),b(r.stopPropagation())}),F(5,"app-icon",248),d(),w(6,Nl,2,0,"button",249),d()}if(n&2){let e=c(2).index,i=c(3).index,r=c(3);a(2),C("",f(3,2,"workoutBuilder.set.metrics"),":"),a(4),p("ngIf",r.getFieldsForSet(i,e).hidden.length>0)}}function ql(n,t){if(n&1&&(u(0,"option",61),h(1),d()),n&2){let e=t.$implicit;p("value",e.value),a(),E(e.label)}}function zl(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4).$implicit,i=c(6),r=Q(21);a(),p("ngTemplateOutlet",r)("ngTemplateOutletContext",j(2,ze,e,i.metricEnum.reps))}}function Hl(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4).$implicit,i=c(6),r=Q(21);a(),p("ngTemplateOutlet",r)("ngTemplateOutletContext",j(2,ze,e,i.metricEnum.weight))}}function Ul(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4).$implicit,i=c(6),r=Q(21);a(),p("ngTemplateOutlet",r)("ngTemplateOutletContext",j(2,ze,e,i.metricEnum.distance))}}function $l(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4).$implicit,i=c(6),r=Q(21);a(),p("ngTemplateOutlet",r)("ngTemplateOutletContext",j(2,ze,e,i.metricEnum.duration))}}function jl(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4),i=e.$implicit,r=e.index,o=c(3).index;c(3);let s=Q(17);a(),p("ngTemplateOutlet",s)("ngTemplateOutletContext",qt(2,Vs,i,o,r))}}function Kl(n,t){if(n&1&&(u(0,"div"),ke(1,255),d()),n&2){let e=c(4).$implicit,i=c(6),r=Q(21);a(),p("ngTemplateOutlet",r)("ngTemplateOutletContext",j(2,ze,e,i.metricEnum.rest))}}function Zl(n,t){if(n&1&&(O(0)(1,253),w(2,zl,2,5,"div",254)(3,Hl,2,5,"div",254)(4,Ul,2,5,"div",254)(5,$l,2,5,"div",254)(6,jl,2,6,"div",254)(7,Kl,2,5,"div",254),W()()),n&2){let e=t.$implicit,i=c(9);a(),p("ngSwitch",e),a(),p("ngSwitchCase",i.metricEnum.reps),a(),p("ngSwitchCase",i.metricEnum.weight),a(),p("ngSwitchCase",i.metricEnum.distance),a(),p("ngSwitchCase",i.metricEnum.duration),a(),p("ngSwitchCase",i.metricEnum.tempo),a(),p("ngSwitchCase",i.metricEnum.rest)}}function Yl(n,t){if(n&1){let e=D();u(0,"div",256)(1,"button",257),I("click",function(r){y(e);let o=c(3).index,s=c(3).index;return c(3).promptAddField(s,o),b(r.stopPropagation())}),F(2,"app-icon",258),d()()}}function Ql(n,t){if(n&1&&(O(0),w(1,Zl,8,7,"ng-container",105)(2,Yl,3,0,"div",252),W()),n&2){let e=t.ngIf,i=c(5).index,r=c(3);a(),p("ngForOf",e),a(),p("ngIf",r.isGhostFieldVisible(e,i))}}function Jl(n,t){if(n&1&&(u(0,"div")(1,"label",179),h(2),_(3,"translate"),d(),F(4,"textarea",180),d()),n&2){let e=c(2).index,i=c(3).index,r=c(3);a(),p("for","setNotes-"+i+e),a(),C(" ",f(3,4,(r.isRoutineMode,"workoutBuilder.set.notes"))," "),a(2),p("id","setNotes-"+i+e)("readonly",r.isViewMode)}}function Xl(n,t){if(n&1){let e=D();u(0,"div",235,11)(2,"div",236),I("click",function(r){y(e);let o=c().index,s=c(3).index,l=c(3);return b(l.toggleSetExpansion(s,o,r))}),h(3),_(4,"translate"),_(5,"translate"),u(6,"div",237),w(7,Wl,4,3,"div",238),d()(),u(8,"div",187),w(9,Gl,7,4,"div",239),d(),u(10,"div",240)(11,"div",241)(12,"label",242),h(13),_(14,"translate"),d(),u(15,"select",243),w(16,ql,2,2,"option",60),d()(),w(17,Ql,3,2,"ng-container",23),d(),w(18,Jl,5,6,"div",23),d()}if(n&2){let e,i,r,o=c(),s=o.$implicit,l=o.index,g=c(3),m=g.$implicit,x=g.index,v=c(3);p("ngClass",j(20,As,!Ye(19,Ps).includes(((e=s.get("type"))==null?null:e.value)??""),((e=s.get("type"))==null?null:e.value)==="warmup")),a(2),p("ngClass",v.setLabelClass(m)),a(),J(" #",l+1," ",v.isSuperSet(x)?f(4,13,"workoutBuilder.set.round"):f(5,15,"workoutBuilder.set.set")," "),a(4),p("ngIf",v.isEditableMode()),a(2),p("ngIf",v.isEditableMode()&&!v.isSuperSet(x)),a(3),p("for","setType-exp-"+x+"-"+l),a(),E(f(14,17,"workoutBuilder.set.type")),a(2),p("id","setType-exp-"+x+"-"+l)("disabled",v.isViewMode),a(),p("ngForOf",v.availableSetTypes),a(),p("ngIf",(i=s.get("fieldOrder"))==null?null:i.value),a(),p("ngIf",(r=s.get("notes"))==null?null:r.value)}}function ed(n,t){if(n&1&&(u(0,"div",222,10),w(2,Ol,2,1,"div",23)(3,Xl,19,23,"div",223),d()),n&2){let e=t.index,i=c(3).index,r=c(3);Ae("add-set-animated",r.isNewlyAdded(i,e)),p("formGroupName",e),a(2),p("ngIf",!r.isSetExpanded(i,e)),a(),p("ngIf",r.isSetExpanded(i,e))}}function td(n,t){if(n&1){let e=D();u(0,"div",259)(1,"div",260)(2,"label",246),h(3),_(4,"translate"),d(),u(5,"button",261),_(6,"translate"),I("click",function(r){y(e);let o=c(3).$implicit,s=c(3);return b(s.removeLastSet(o,r))}),F(7,"app-icon",248),d(),u(8,"button",262),_(9,"translate"),I("click",function(r){y(e);let o=c(3),s=o.$implicit,l=o.index;return c(3).addSet(s,l),b(r.stopPropagation())}),F(10,"app-icon",251),d()()()}n&2&&(a(3),C("",f(4,3,"workoutBuilder.set.set"),":"),a(2),Ct("aria-label",f(6,5,"workoutBuilder.set.removeLastSet")),a(3),Ct("aria-label",f(9,7,"workoutBuilder.set.addSet")))}function id(n,t){if(n&1&&(u(0,"div",191)(1,"div",192)(2,"div",135)(3,"span",136),h(4),_(5,"translate"),d(),u(6,"strong",137),h(7),d()(),w(8,kl,41,49,"div",193),d(),u(9,"div",194),w(10,Dl,13,9,"ng-container",195)(11,ed,4,5,"div",196),d(),w(12,td,11,9,"div",118),d()),n&2){let e=c(2),i=e.$implicit,r=e.index,o=c(3);a(4),C(" ",f(5,6,"workoutBuilder.set.totalSets"),": "),a(3),E(o.workoutFormService.getSetsFormArray(i).length),a(),p("ngIf",o.isEditableMode()&&o.getExerciseSetsLength(r)>1),a(2),p("ngLet",o.getVisibleColumnsForExercise(r)),a(),p("ngForOf",o.workoutFormService.getSetsFormArray(i).controls),a(),p("ngIf",!o.isSuperSet(r))}}function rd(n,t){if(n&1){let e=D();u(0,"div",169)(1,"div",170),I("click",function(r){y(e);let o=c().index,s=c(3);return b(s.expandExerciseCard(o,r))}),u(2,"div",171),w(3,nl,3,8,"span",172),u(4,"div",173),F(5,"img",174),_(6,"async"),u(7,"h3",175),h(8),_(9,"translate"),d(),w(10,ol,1,0,"app-icon",156),d()()(),w(11,sl,5,6,"div",23)(12,Sl,11,11,"div",176)(13,id,13,8,"div",177),d()}if(n&2){let e,i,r,o,s=c(),l=s.$implicit,g=s.index,m=c(3);a(),p("ngClass",te(13,Ts,!m.isEditableMode())),a(2),p("ngIf",(e=l.get("supersetId"))==null?null:e.value),a(2),p("src",f(6,9,m.getIconPath((i=l.get("exerciseId"))==null?null:i.value)),pr)("ngClass",j(15,Ms,!m.isSetExpanded(g,0),m.isSetExpanded(g,0))),a(3),C(" ",((r=l.get("exerciseName"))==null?null:r.value)||f(9,11,"workoutBuilder.exercise.selectPlaceholder")," "),a(2),p("ngIf",(o=l.get("exerciseId"))==null?null:o.value),a(),p("ngIf",m.expandedExerciseNotes()===g),a(),p("ngIf",m.shouldShowExpandedExercise(g)&&m.isViewMode),a(),p("ngIf",m.shouldShowExpandedExercise(g)&&m.isEditableMode())}}function nd(n,t){if(n&1){let e=D();u(0,"div",259,12)(2,"div",245)(3,"span",136),h(4),_(5,"translate"),d(),u(6,"button",263),_(7,"translate"),I("click",function(r){y(e);let o=c().$implicit,s=c(3);return b(s.removeRoundFromSuperset(o,r))}),F(8,"app-icon",264),d(),u(9,"button",265),_(10,"translate"),I("click",function(r){y(e);let o=c().$implicit,s=c(3);return b(s.addRoundToSuperset(o,r))}),F(11,"app-icon",266),d()()()}if(n&2){let e=c().$implicit,i=c(3);a(4),C(" ",f(5,4,"workoutBuilder.superset.rounds"),": "),a(2),p("disabled",i.workoutFormService.getSetsFormArray(e).length<=1),Ct("aria-label",f(7,6,"workoutBuilder.set.removeLastSet")),a(3),Ct("aria-label",f(10,8,"workoutBuilder.set.addSet"))}}function od(n,t){if(n&1){let e=D();u(0,"app-action-menu",269),I("itemClick",function(r){y(e);let o=c(2),s=o.$implicit,l=o.index,g=c(3);return b(g.handleExerciseActionMenuItemClick(r,l,s))})("closeMenu",function(){y(e);let r=c(5);return b(r.closeExerciseActionMenu())}),d()}if(n&2){let e=c(2),i=e.$implicit,r=e.index,o=c(3);p("items",o.getExerciseActionMenuItems(i))("isVisible",o.isExerciseActionMenuVisible(r))}}function sd(n,t){if(n&1){let e=D();u(0,"div",267)(1,"div",37,13)(3,"button",38),I("click",function(r){y(e);let o=c().index,s=c(3);return b(s.toggleExerciseActionMenu(o,r))}),F(4,"app-icon",39),d(),w(5,od,1,2,"app-action-menu",268),d()()}if(n&2){let e=c().index,i=c(3);a(5),p("ngIf",i.isExerciseActionMenuVisible(e))}}function ad(n,t){if(n&1){let e=D();O(0),u(1,"div",106,4),I("clickOutside",function(){y(e);let r=c(3);return b(r.closeExerciseActionMenu())}),w(3,Ra,5,4,"div",107),u(4,"div",108),_(5,"translate"),I("click",function(r){let o=y(e).index,s=c(3);return b(s.expandExerciseCard(o,r))}),w(6,Ba,3,4,"div",109)(7,Aa,21,15,"div",110),u(8,"div",111),w(9,Va,2,2,"div",112),u(10,"div",113),w(11,La,3,3,"div",114)(12,Oa,2,5,"input",115)(13,rl,2,1,"div",116),d(),w(14,rd,14,18,"div",117),d(),w(15,nd,12,10,"div",118),d(),u(16,"div",119),w(17,sd,6,1,"div",120),d()(),W()}if(n&2){let e=t.$implicit,i=t.index,r=c(3);a(),it("z-index",r.isExerciseActionMenuVisible(i)?50:"auto"),p("@exerciseExit",void 0)("ngClass",r.getExerciseCardClass(e,i)),a(2),p("ngIf",r.isEditableMode()&&r.selectedExerciseIndicesForSuperset().length>=1&&i===r.firstSelectedExerciseIndexForSuperset),a(),p("cdkDragDisabled",!r.isDraggingEnabled(i))("dragHandleSelector",r.shouldShowExpandedExercise(i)?"[data-drag-handle]":void 0)("longPressEnabled",r.isEditableMode()&&!r.shouldShowExpandedExercise(i))("longPressDelay",150)("cdkDragData",e)("cdkDragStartDelay",110)("formGroupName",i)("title",r.isEditableMode()&&!r.shouldShowExpandedExercise(i)?f(5,23,"workoutBuilder.exercise.dragToReorder"):""),a(2),p("ngIf",r.getSectionBadgeInfo(e)),a(),p("ngIf",r.isEditableMode()&&r.isSuperSet(i)&&r.isFirstInSuperset(i)),a(2),p("ngIf",r.isFirstInSuperset(i)),a(2),p("ngIf",r.isDraggingEnabled(i)),a(),p("ngIf",(r.isEditableMode()||r.isNewMode)&&!r.isViewMode&&!r.shouldShowExpandedExercise(i)),a(),p("ngIf",!r.shouldShowExpandedExercise(i)),a(),p("ngIf",r.shouldShowExpandedExercise(i)),a(),p("ngIf",r.isEditableMode()&&r.isSuperSet(i)&&r.isLastInSuperset(i)),a(),p("ngClass",te(25,Es,r.isSuperSet(i))),a(),p("ngIf",r.isEditableMode()&&(!r.isSuperSet(i)||r.isSuperSet(i)&&r.isFirstInSuperset(i)))}}function ld(n,t){if(n&1){let e=D();u(0,"div",104),I("cdkDropListDropped",function(r){y(e);let o=c(2);return b(o.onExerciseDrop(r))}),w(1,ad,18,27,"ng-container",105),d()}if(n&2){let e=c(2);p("cdkDropListData",e.exercisesFormArray.controls)("cdkDropListDisabled",!e.isEditableMode()),a(),p("ngForOf",e.exercisesFormArray.controls)}}function dd(n,t){if(n&1){let e=D();u(0,"div",270)(1,"p",271),h(2,"Select a routine or ADD EXERCISEs manually to log"),d(),u(3,"button",272),I("click",function(){y(e);let r=c(2);return b(r.openExerciseSelectionModal())}),h(4),_(5,"translate"),d()()}n&2&&(a(4),C(" + ",f(5,1,"workoutBuilder.logEntry.addFirstExercise")," "))}function cd(n,t){n&1&&(u(0,"div",273),h(1),_(2,"translate"),d()),n&2&&(a(),C(" ",f(2,1,"workoutBuilder.logEntry.noExercisesInRoutine")," "))}function ud(n,t){if(n&1&&(u(0,"section"),w(1,ld,2,3,"div",101)(2,dd,6,3,"div",102)(3,cd,3,3,"div",103),d()),n&2){let e,i,r=c();a(),p("ngIf",r.exercisesFormArray.length>0),a(),p("ngIf",r.mode===r.BuilderMode.manualLogEntry&&r.exercisesFormArray.length===0&&!((e=r.builderForm.get("routineIdForLog"))!=null&&e.value)),a(),p("ngIf",r.mode===r.BuilderMode.manualLogEntry&&r.exercisesFormArray.length===0&&((i=r.builderForm.get("routineIdForLog"))==null?null:i.value))}}function pd(n,t){n&1&&(u(0,"section",274)(1,"p",275),h(2),_(3,"translate"),d()()),n&2&&(a(2),E(f(3,1,"workoutBuilder.restDayMessage")))}function md(n,t){if(n&1){let e=D();u(0,"div",270)(1,"button",279),I("click",function(){y(e);let r=c(2);return b(r.openExerciseSelectionModal())}),F(2,"app-icon",280),h(3),_(4,"translate"),d()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.addExerciseButton")," "))}function gd(n,t){if(n&1){let e=D();u(0,"div")(1,"button",281),I("click",function(){y(e);let r=c(2);return b(r.resetTemplateAndStardWizard())}),F(2,"app-icon",282),h(3),_(4,"translate"),d()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.buttons.resetTemplateButton")," "))}function hd(n,t){if(n&1){let e=D();u(0,"div")(1,"button",283),I("click",function(){y(e);let r=c(2);return b(r.regenerateWorkout())}),F(2,"app-icon",284),h(3),_(4,"translate"),d()()}n&2&&(a(3),C(" ",f(4,1,"workoutBuilder.buttons.regenButton")," "))}function _d(n,t){if(n&1){let e=D();u(0,"div",276),w(1,md,5,3,"div",102),u(2,"button",277),I("click",function(){y(e);let r=c();return b(r.onSubmit())}),F(3,"app-icon",278),h(4),_(5,"translate"),d(),w(6,gd,5,3,"div",23)(7,hd,5,3,"div",23),d()}if(n&2){let e,i=c();a(),p("ngIf",i.mode!==i.BuilderMode.manualLogEntry&&((e=i.builderForm.get("goal"))==null?null:e.value)!==i.metricEnum.rest),a(),p("disabled",i.isFormInvalid()),a(2),C(" ",f(5,5,i.getSubmitButtonLabel())," "),a(2),p("ngIf",i.isNewMode&&i.isEditableMode()&&i.mode!==i.BuilderMode.manualLogEntry),a(),p("ngIf",i.isGeneratedRoutine())}}function fd(n,t){if(n&1&&(O(0),F(1,"input",288),_(2,"translate"),W()),n&2){let e=c(2);a(),p("placeholder",f(2,2,"workoutBuilder.set.tempoPlaceholder"))("readonly",e.isViewMode)}}function xd(n,t){if(n&1&&(F(0,"input",289),_(1,"translate")),n&2){let e=c(),i=e.exIndex,r=e.setIndex,o=c();p("id","tempo-exp-"+i+"-"+r)("placeholder",f(1,3,"workoutBuilder.set.tempoPlaceholder"))("readonly",o.isViewMode)}}function vd(n,t){if(n&1&&(u(0,"div",285)(1,"label",286)(2,"span"),h(3),_(4,"translate"),d()(),w(5,fd,3,4,"ng-container",23)(6,xd,2,5,"input",287),d()),n&2){let e=t.setControl,i=t.exIndex,r=t.setIndex,o=c();p("formGroup",e),a(),p("for","tempo-exp-"+i+"-"+r),a(2),E(f(4,5,"workoutBuilder.set.tempo")),a(2),p("ngIf",o.mode===o.BuilderMode.routineBuilder),a(),p("ngIf",o.mode===o.BuilderMode.manualLogEntry)}}function yd(n,t){if(n&1){let e=D();u(0,"div",285)(1,"div",290)(2,"button",291),I("shortPress",function(){let r=y(e),o=r.setControl,s=r.field,l=c();return b(l.onShortPressDecrement(o,s))})("longPress",function(){let r=y(e),o=r.setControl,s=r.field,l=c();return b(l.onLongPressDecrement(o,s))})("pressRelease",function(){y(e);let r=c();return b(r.onPressRelease())}),F(3,"app-icon",292),d(),u(4,"div",293)(5,"span",294),I("click",function(){let r,o=y(e),s=o.setControl,l=o.field,g=c();return b(g.focusInput((r=s.get("id"))==null?null:r.value,l))}),h(6),d(),u(7,"input",295,14),I("input",function(r){let o=y(e),s=o.setControl,l=o.field,g=c();return b(g.onExactInputChange(s,l,r))})("focus",function(){let r,o=y(e),s=o.setControl,l=o.field,g=Q(8),m=c();return m.onInputFocus((r=s.get("id"))==null?null:r.value,l),b(m.selectInputText(g))})("blur",function(){let r,o=y(e),s=o.setControl,l=o.field,g=c();return b(g.onInputBlur((r=s.get("id"))==null?null:r.value,l))})("wheel",function(r){let o=y(e),s=o.setControl,l=o.field,g=c();return b(g.onInputWheel(s,l,r))})("touchstart",function(r){y(e);let o=c();return b(o.onInputTouchStart(r))})("touchmove",function(r){let o=y(e),s=o.setControl,l=o.field,g=c();return b(g.onInputTouchMove(s,l,r))}),d()(),u(9,"button",296),I("shortPress",function(){let r=y(e),o=r.setControl,s=r.field,l=c();return b(l.onShortPressIncrement(o,s))})("longPress",function(){let r=y(e),o=r.setControl,s=r.field,l=c();return b(l.onLongPressIncrement(o,s))})("pressRelease",function(){y(e);let r=c();return b(r.onPressRelease())}),F(10,"app-icon",297),d()()()}if(n&2){let e,i,r=t.setControl,o=t.field,s=c();p("formGroup",r),a(5),p("@valueAnimation",s.getExactInputValue(r,o)),a(),C(" ",s.getSetMetricDisplayValue(r,o)||0," "),a(),p("value",s.getExactInputValue(r,o))("readonly",s.isViewMode)("ngClass",te(8,Ls,s.isAnimatingSet()===((e=r.get("id"))==null?null:e.value))),kt("data-set-id",(i=r.get("id"))==null?null:i.value)("data-field",o)}}function bd(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(2);a(),C("(",e.unitService.currentWeightUnit(),")")}}function wd(n,t){n&1&&(u(0,"span"),h(1,"(s)"),d())}function Sd(n,t){if(n&1&&(u(0,"span"),h(1),d()),n&2){let e=c(2);a(),C("(",e.unitService.currentDistanceMeasureUnit(),")")}}function Cd(n,t){n&1&&(u(0,"span"),h(1,"(s)"),d())}function kd(n,t){if(n&1){let e=D();O(0),u(1,"div",301)(2,"input",302),I("input",function(r){y(e);let o=c(),s=o.setControl,l=o.field,g=c();return b(g.updateTargetField(s,g.getFormControlName(l),"min",r))}),d(),u(3,"span",303),h(4,"-"),d(),u(5,"input",304),I("input",function(r){y(e);let o=c(),s=o.setControl,l=o.field,g=c();return b(g.updateTargetField(s,g.getFormControlName(l),"max",r))}),d()(),W()}if(n&2){let e,i,r=c(),o=r.setControl,s=r.field,l=c();a(2),p("readonly",l.isViewMode)("value",((e=o.get(l.getFormControlName(s)))==null||e.value==null?null:e.value.min)??((e=o.get(l.getFormControlName(s)))==null||e.value==null?null:e.value.minSeconds)),a(3),p("readonly",l.isViewMode)("value",((i=o.get(l.getFormControlName(s)))==null||i.value==null?null:i.value.max)??((i=o.get(l.getFormControlName(s)))==null||i.value==null?null:i.value.maxSeconds))}}function Ed(n,t){if(n&1&&(O(0),ke(1,255),W()),n&2){let e=c(),i=e.setControl,r=e.field;c();let o=Q(19);a(),p("ngTemplateOutlet",o)("ngTemplateOutletContext",j(2,ze,i,r))}}function Id(n,t){if(n&1&&(O(0),ke(1,255),W()),n&2){let e=c(),i=e.setControl,r=e.field;c();let o=Q(19);a(),p("ngTemplateOutlet",o)("ngTemplateOutletContext",j(2,ze,i,r))}}function Td(n,t){if(n&1&&(O(0),ke(1,255),W()),n&2){let e=c(),i=e.setControl,r=e.field;c();let o=Q(19);a(),p("ngTemplateOutlet",o)("ngTemplateOutletContext",j(2,ze,i,r))}}function Md(n,t){if(n&1&&(u(0,"div",305)(1,"span"),h(2),d()()),n&2){let e,i=c(),r=i.setControl,o=i.field,s=c();a(2),E(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Fd(n,t){if(n&1&&(u(0,"div",305)(1,"span"),h(2),d()()),n&2){let e,i=c(),r=i.setControl,o=i.field,s=c();a(2),E(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Dd(n,t){if(n&1&&(u(0,"div",305)(1,"span"),h(2),d()()),n&2){let e,i=c(),r=i.setControl,o=i.field,s=c();a(2),E(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Rd(n,t){if(n&1&&(u(0,"div",305)(1,"span"),h(2),d()()),n&2){let e,i=c(),r=i.setControl,o=i.field,s=c();a(2),E(s.workoutUtilsService.formatMetricTarget((e=r.get(s.getFormControlName(o)))==null?null:e.value,o))}}function Bd(n,t){if(n&1&&(O(0),F(1,"input",306),W()),n&2){let e=c().field,i=c();a(),p("formControlName",i.getFormControlName(e))("readonly",i.isViewMode)}}function Pd(n,t){if(n&1){let e=D();u(0,"div",285)(1,"label",246)(2,"span"),h(3),_(4,"translate"),w(5,bd,2,1,"span",23)(6,wd,2,0,"span",23)(7,Sd,2,1,"span",23)(8,Cd,2,0,"span",23),d(),u(9,"button",298),I("click",function(r){let o=y(e),s=o.setControl,l=o.field,g=c();return b(g.openMetricSchemeModal(s,l,r))}),h(10),_(11,"translate"),d()(),O(12,253),w(13,kd,6,4,"ng-container",254)(14,Ed,2,5,"ng-container",254)(15,Id,2,5,"ng-container",254)(16,Td,2,5,"ng-container",254)(17,Md,3,1,"div",299)(18,Fd,3,1,"div",299)(19,Dd,3,1,"div",299)(20,Rd,3,1,"div",299)(21,Bd,2,2,"ng-container",300),W(),d()}if(n&2){let e,i=t.setControl,r=t.field,o=c();p("formGroup",i),a(3),C("",f(4,16,"metrics."+r)," "),a(2),p("ngIf",r===o.metricEnum.weight),a(),p("ngIf",r===o.metricEnum.duration),a(),p("ngIf",r===o.metricEnum.distance),a(),p("ngIf",r===o.metricEnum.rest),a(2),C(" ",f(11,18,"common.edit")," "),a(2),p("ngSwitch",(e=i.get(o.getFormControlName(r)))==null||e.value==null?null:e.value.type),a(),p("ngSwitchCase","range"),a(),p("ngSwitchCase","exact"),a(),p("ngSwitchCase","min_plus"),a(),p("ngSwitchCase","percentage_1rm"),a(),p("ngSwitchCase","bodyweight"),a(),p("ngSwitchCase","max"),a(),p("ngSwitchCase","amrap"),a(),p("ngSwitchCase","max_fraction")}}function Ad(n,t){if(n&1){let e=D();u(0,"app-modal",307),_(1,"translate"),I("isOpenChange",function(){y(e);let r=c();return b(r.notesModalsData.set(null))}),u(2,"div",308)(3,"textarea",309),h(4),d(),u(5,"div",310)(6,"button",311),I("click",function(){y(e);let r=c();return b(r.notesModalsData.set(null))}),F(7,"app-icon",312),h(8),_(9,"translate"),d()()()()}if(n&2){let e=t.ngIf;p("isOpen",!!e)("modalTitle",f(1,5,"workoutBuilder.modal.notesTitle")),a(3),p("disabled",!0),a(),E(e),a(4),C(" ",f(9,7,"workoutBuilder.modal.close")," ")}}function Vd(n,t){if(n&1){let e=D();u(0,"app-modal",313),Y("isOpenChange",function(r){y(e);let o=c();return Z(o.isSimpleModalOpen,r)||(o.isSimpleModalOpen=r),b(r)}),F(1,"app-exercise-detail",314),d()}if(n&2){let e=c();p("forceFullScreen",!0),K("isOpen",e.isSimpleModalOpen),p("modalTitle",e.exerciseDetailsName),a(),p("id",e.exerciseDetailsId)("isModal",!0)}}var io=(r=>(r.routineBuilder="routineBuilder",r.customProgramEntryBuilder="customProgramEntryBuilder",r.manualLogEntry="manualLogEntry",r.newFromLog="newFromLog",r))(io||{});var to=class n{context="route";initialRoutine=null;mode="routineBuilder";routineConfirmed=new q;modalClose=new q;fb=S(jt);router=S(Fr);route=S(Mr);workoutService=S(ii);trainingService=S(ln);exerciseService=S(qe);unitService=S(Jt);spinnerService=S(un);alertService=S(Hr);toastService=S(_t);trackingService=S(ei);cdr=S(rt);ngZone=S(Fe);platformId=S(Nt);appSettingsService=S(Qt);translate=S(Ne);workoutGeneratorService=S(bi);subscriptionService=S(sn);audioService=S(cn);workoutUtilsService=S(oi);workoutCategoryService=S(wi);workoutFormService=S(_i);isRoutineMode=!1;availableRepSchemes=[];availableExerciseCategories=[];setRepsInputs;expandedSetElements;expandedExerciseCard;myExerciseInput;isAllExpandedInViewMode=R(!1);expandedExerciseNotes=R(null);exerciseInfoTooltipString=this.translate.instant("workoutBuilder.exerciseInfoTooltip");lastRoutineDuration=0;liveFormAsRoutine;loadedRoutine=R(void 0);lastLoggedRoutineInfo=R({});builderForm;isEditableMode=R(!1);isEditMode=!1;isNewMode=!0;isViewMode=!1;pastSession=!1;currentRoutineId=null;currentProgramId=null;dateParam=null;currentLogId=null;routeSub;initialRoutineIdForLogEdit=void 0;initialProgramIdForLogEdit=void 0;initialProgramIterationIdForLogEdit=void 0;initialProgramScheduledIdForLogEdit=void 0;subscriptions=new Te;expandedSetPath=R(null);expandedExercisePath=R(null);lastLogForCurrentRoutine=ve(()=>{let t=this.liveFormAsRoutine(),e=this.lastLoggedRoutineInfo();return!t||!e?null:e[t.id]||null});availableSetTypes=[{value:"standard",label:this.translate.instant("workoutBuilder.setTypes.standard")},{value:"warmup",label:this.translate.instant("workoutBuilder.setTypes.warmup")},{value:"superset",label:this.translate.instant("workoutBuilder.setTypes.superset")},{value:"amrap",label:this.translate.instant("workoutBuilder.setTypes.amrap")},{value:"dropset",label:this.translate.instant("workoutBuilder.setTypes.dropset")},{value:"failure",label:this.translate.instant("workoutBuilder.setTypes.failure")},{value:"myorep",label:this.translate.instant("workoutBuilder.setTypes.myorep")},{value:"restpause",label:this.translate.instant("workoutBuilder.setTypes.restpause")},{value:"custom",label:this.translate.instant("workoutBuilder.setTypes.custom")}];routineGoals=[{value:"hypertrophy",label:"workoutBuilder.goals.hypertrophy"},{value:"strength",label:"workoutBuilder.goals.strength"},{value:"tabata",label:"workoutBuilder.goals.tabata"},{value:"muscular endurance",label:"workoutBuilder.goals.muscularEndurance"},{value:"cardiovascular endurance",label:"workoutBuilder.goals.cardiovascularEndurance"},{value:"fat loss / body composition",label:"workoutBuilder.goals.fatLoss"},{value:"mobility & flexibility",label:"workoutBuilder.goals.mobility"},{value:"power / explosiveness",label:"workoutBuilder.goals.power"},{value:"speed & agility",label:"workoutBuilder.goals.speed"},{value:"balance & coordination",label:"workoutBuilder.goals.balance"},{value:"skill acquisition",label:"workoutBuilder.goals.skill"},{value:"rehabilitation / injury prevention",label:"workoutBuilder.goals.rehabilitation"},{value:"mental health / stress relief",label:"workoutBuilder.goals.mentalHealth"},{value:"general health & longevity",label:"workoutBuilder.goals.generalHealth"},{value:"sport-specific performance",label:"workoutBuilder.goals.sportSpecific"},{value:"maintenance",label:"workoutBuilder.goals.maintenance"},{value:"rest",label:"workoutBuilder.goals.rest"},{value:"custom",label:"workoutBuilder.goals.custom"}];isExerciseModalOpen=!1;availableExercises=[];availableRoutines=[];availablePrograms=[];availableIterationIds=[];availableScheduledDayIds=[];availableScheduledDayInfos=[];modalSearchTerm=R("");filteredAvailableExercises=ve(()=>{let t=this.modalSearchTerm().trim().toLowerCase();return!t||t.length<2?this.availableExercises:this.availableExercises.filter(e=>e._searchName?.includes(t)||e._searchCategory?.includes(t)||e._searchDescription?.includes(t)||e._searchPrimaryMuscle?.includes(t))});selectedExerciseIndicesForSuperset=R([]);selectedExerciseIndicesForMultipleRemoval=R([]);sanitizer=S(Tr);sanitizedDescription="";previousFormState=null;defaultMetricFieldOrder=["reps","weight","distance","duration","rest"];isGeneratorModalOpen=R(!1);isGeneratedRoutine=R(!1);lastGenerationOptions=R(null);constructor(){this.spinnerService.show(),this.builderForm=this.fb.group({name:[""],description:[""],goal:[""],primaryCategory:[""],secondaryCategory:[""],tags:[""],workoutDate:[""],startTime:[""],endTime:[""],overallNotesLog:[""],routineIdForLog:[""],programIdForLog:[""],iterationIdForLog:[""],scheduledDayIdForLog:[""],exercises:this.fb.array([])});let t=this.builderForm.valueChanges.pipe(ue(this.builderForm.getRawValue()),de(e=>{let i=this.mapFormToRoutine(e);return this.mode==="manualLogEntry"&&this.currentLogId?N(A({},i),{workoutLogId:this.currentLogId}):i}));this.liveFormAsRoutine=Et(t,{initialValue:void 0}),this.builderForm.valueChanges.pipe(bt(500),ue(this.builderForm.getRawValue()),Ii()).subscribe(([e,i])=>{if(this.originalStateSnapshot||(this.originalStateSnapshot=JSON.parse(JSON.stringify(e))),this.history.length>0&&JSON.stringify(e)!==JSON.stringify(i)&&this.canRestore.set(!0),this.isUndoingOrRedoing){this.isUndoingOrRedoing=!1;return}this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1));let r=this.getActionDescription(e,i);this.history.push({state:JSON.parse(JSON.stringify(i)),action:r}),this.historyIndex++,this.history.length>this.MAX_HISTORY_SIZE&&(this.history.shift(),this.historyIndex--),this.updateHistorySignals(),this.refreshFabMenuItems()})}categories=Et(this.workoutCategoryService.getTranslatedCategories(),{initialValue:[]});ngOnInit(){console.log("WorkoutBuilderComponent mode:",this.mode,"context:",this.context),window.scrollTo(0,0),this.isRoutineMode=this.mode==="routineBuilder"||this.mode==="customProgramEntryBuilder"||this.mode==="newFromLog",this.availableRepSchemes=this.workoutUtilsService.getAvailableRepsSchemes("builder"),this.loadAvailableExercises(),this.subscriptions.add(this.workoutService.routines$.pipe(we(1)).subscribe(o=>{this.availableRoutines=o})),this.subscriptions.add(this.trainingService.programs$.pipe(we(1)).subscribe(o=>{this.availablePrograms=o})),this.routeSub=this.route.data.pipe(Me(o=>{this.isGeneratedRoutine.set(!1),this.context||(this.context="route"),this.context==="route"&&(this.mode=o.mode||"routineBuilder",this.isNewMode=o.isNew===!0),this.context==="modal"&&window.scrollTo(0,0),console.log(`Builder ngOnInit: Mode=${this.mode}, isNewMode=${this.isNewMode}`),console.log(`isNewMode: ${this.isNewMode}`);let s=this.route.snapshot.queryParamMap.get("openGenerator");s==="true"&&this.isNewMode&&this.mode==="routineBuilder"&&setTimeout(()=>{this.spinnerService.hide(),this.openWorkoutGenerator()},150),this.spinnerService.hide(),this.isRoutineMode&&this.isNewMode&&s!=="true"&&this.mode!=="newFromLog"&&this.showCreationWizard(),this.currentRoutineId=this.route.snapshot.paramMap.get("routineId"),this.currentLogId=this.route.snapshot.paramMap.get("logId"),this.currentProgramId=this.route.snapshot.queryParamMap.get("programId"),this.pastSession=this.route.snapshot.queryParamMap.get("pastSession")?!!this.route.snapshot.queryParamMap.get("pastSession"):!1,this.initialProgramIdForLogEdit=this.currentProgramId,this.initialProgramIterationIdForLogEdit=this.route.snapshot.queryParamMap.get("iterationId"),this.initialProgramScheduledIdForLogEdit=this.route.snapshot.queryParamMap.get("scheduledDayId");let l=this.route.snapshot.queryParamMap.get("date");if(this.dateParam=l?new Date(l):null,this.isViewMode=this.isRoutineMode&&!!this.currentRoutineId&&!this.isNewMode&&this.route.snapshot.routeConfig?.path?.includes("view")||!1,this.isEditMode=!this.isNewMode&&!this.isViewMode||this.mode==="customProgramEntryBuilder",this.isEditableMode.set(this.isEditMode||this.isNewMode),console.log(`Builder isEditableMode: Mode=${this.isEditableMode()}`),this.configureFormValidatorsAndFieldsForMode(),this.expandedSetPath.set(null),this.exercisesFormArray.clear({emitEvent:!1}),this.builderForm.reset(this.getDefaultFormValuesForMode(),{emitEvent:!1}),this.isRoutineMode){if(this.mode==="customProgramEntryBuilder"&&this.initialRoutine)return this.loadedRoutine.set(this.initialRoutine),this.patchFormWithRoutineData(this.initialRoutine),se(null);if(this.currentLogId&&this.isNewMode)return this.trackingService.getWorkoutLogById(this.currentLogId);if(this.currentRoutineId&&(this.isEditMode||this.isViewMode))return this.workoutService.getRoutineById(this.currentRoutineId)}else if(this.mode==="manualLogEntry"){if(this.currentLogId&&this.isEditMode)return this.trackingService.getWorkoutLogById(this.currentLogId);if(this.currentRoutineId&&this.isNewMode)return this.workoutService.getRoutineById(this.currentRoutineId)}return se(null)}),Wt(o=>{o?(this.isEditMode&&(this.originalStateSnapshot=JSON.parse(JSON.stringify(o))),this.mode==="newFromLog"&&this.currentLogId&&this.isNewMode?this.prefillRoutineFormFromLog(o):this.mode==="routineBuilder"?(this.loadedRoutine.set(o),this.patchFormWithRoutineData(o)):this.mode==="manualLogEntry"&&this.isEditMode&&this.currentLogId?(this.patchFormWithLogData(o),this.loadedRoutine.set(this.mapFormToRoutine(this.builderForm.getRawValue()))):this.mode==="manualLogEntry"&&this.isNewMode&&this.currentRoutineId&&this.prefillLogFormFromRoutine(o)):!this.isNewMode&&(this.currentRoutineId||this.currentLogId)&&(this.toastService.error("Data not found.",0,this.translate.instant("common.error")),this.router.navigate([this.mode==="routineBuilder"?"/workout":"/history/list"])),this.isViewMode?this.expandAllSets():this.toggleFormState(!1),this.refreshFabMenuItems()})).subscribe(),this.subscriptions.add(this.routeSub),this.mode==="manualLogEntry"&&(this.builderForm.get("routineIdForLog")?.valueChanges.subscribe(o=>{if(this.isEditMode&&o===this.initialRoutineIdForLogEdit&&!this.builderForm.get("routineIdForLog")?.dirty||this.isEditMode&&o===this.initialProgramIdForLogEdit&&!this.builderForm.get("programIdForLog")?.dirty)return;let s=this.availableRoutines.find(l=>l.id===o);s?this.prefillLogFormFromRoutine(s,!1):(this.exercisesFormArray.clear(),this.isEditMode||this.builderForm.get("name")?.setValue("Ad-hoc Workout"))}),this.builderForm.get("programIdForLog")?.valueChanges.subscribe(o=>{o?(this.builderForm.get("routineIdForLog")?.disable(),this.initialProgramIdForLogEdit=o,this.retrieveProgramInfo(o),this.builderForm.get("iterationIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("routineIdForLog")?.setValue("",{emitEvent:!1}),this.exercisesFormArray.clear()):(this.builderForm.get("routineIdForLog")?.enable(),this.initialProgramIdForLogEdit=void 0,this.availableIterationIds=[],this.availableScheduledDayIds=[],this.availableScheduledDayInfos=[],this.builderForm.get("iterationIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.setValue("",{emitEvent:!1}))}),this.builderForm.get("scheduledDayIdForLog")?.valueChanges.subscribe(o=>{let s=this.availableScheduledDayInfos.find(l=>l.id===o);if(!s){this.exercisesFormArray.clear(),this.builderForm.get("routineIdForLog")?.setValue("",{emitEvent:!1}),this.builderForm.get("name")?.setValue("Ad-hoc Workout",{emitEvent:!1});return}he(this.workoutService.getRoutineById(s.routineId)).then(l=>{l?(this.builderForm.get("name")?.setValue(`Log: ${l.name}`,{emitEvent:!1}),this.builderForm.get("routineIdForLog")?.setValue(l.id,{emitEvent:!1}),this.exercisesFormArray.clear({emitEvent:!1}),l.exercises.forEach(g=>{this.exercisesFormArray.push(this.workoutFormService.createExerciseFormGroup(g,!1,!0),{emitEvent:!1})}),s.iterationId&&this.builderForm.get("iterationIdForLog")?.setValue(s.iterationId,{emitEvent:!1})):(this.toastService.error(`Routine with ID ${s.routineId} not found.`,0,this.translate.instant("common.error")),this.exercisesFormArray.clear())}).catch(l=>{console.error("Failed to fetch routine for scheduled day:",l),this.toastService.error("Could not load routine details.",0,this.translate.instant("common.error")),this.exercisesFormArray.clear()})}));let t=this.builderForm.get("goal")?.valueChanges.pipe(Xe()).subscribe(o=>L(this,null,function*(){if(this.previousGoalValue&&this.previousGoalValue==="tabata")return;if(this.previousGoalValue!==o&&o!=="tabata"&&(this.previousGoalValue=o),this.isRoutineMode&&o==="rest"){for(;this.exercisesFormArray.length;)this.exercisesFormArray.removeAt(0);this.exercisesFormArray.clearValidators()}let s=this.exercisesFormArray.controls;if(this.isRoutineMode&&o==="tabata"){let l=this.exercisesFormArray.controls;if(l.length<2){this.toastService.warning("Tabata routines require at least 2 exercises. Please add more exercises first.",5e3),this.builderForm.get("goal")?.setValue(this.previousGoalValue,{emitEvent:!1});return}let g=yield this.alertService.showConfirm("Convert to Tabata?","This will convert all exercises into a single superset. Each round will be set to 20 seconds of work and 10 seconds of rest. Are you sure?","Convert","Cancel");if(!g||!g.data){this.builderForm.get("goal")?.setValue(this.previousGoalValue,{emitEvent:!1});return}let m=U();l.forEach((x,v)=>{let k=x.get("sets");for(;k.length>1;)k.removeAt(1);if(k.length===0){let T={id:U(),type:"standard",targetRest:ie(10),targetDuration:Oe(20),fieldOrder:["weight","reps"]};k.push(this.workoutFormService.createSetFormGroup(T,!1))}k.at(0).patchValue({targetDuration:20,targetRest:10,targetReps:null,targetWeight:null,targetDistance:null,targetTempo:null},{emitEvent:!1}),x.patchValue({supersetId:m,supersetOrder:v,supersetType:"standard",type:"superset"},{emitEvent:!1})}),this.toastService.info("Routine converted to Tabata format.")}else if(this.isRoutineMode&&this.builderForm.get("goal")?.value!=="tabata"){let l=this.exercisesFormArray.at(0);l&&l.get("supersetId")?.value&&l.get("sets")?.value?.length===this.exercisesFormArray.length&&(this.exercisesFormArray.controls.forEach(g=>{g.patchValue({supersetId:null,supersetOrder:null,type:"standard"},{emitEvent:!1})}),this.toastService.info("Tabata grouping removed.",3e3))}this.exercisesFormArray.updateValueAndValidity()}));this.subscriptions.add(t);let e=this.builderForm.get("description")?.valueChanges.subscribe(o=>{this.updateSanitizedDescription(o||"")});this.subscriptions.add(e);let i=this.builderForm.get("sets")?.valueChanges.subscribe(o=>{this.getRoutineDuration()});this.subscriptions.add(i);let r=this.builderForm.get("supersetRounds")?.valueChanges.subscribe(o=>{this.getRoutineDuration()});this.subscriptions.add(r)}retrieveProgramRoutines(t){let e=this.availablePrograms.find(i=>i.id===t);return e?e.schedule&&e.schedule.length>0?e.schedule:[]:[]}retrieveProgramIterationIds(t){let e=this.availablePrograms.find(i=>i.id===t);return e?e.history&&e.history.length>0?e.history.map(i=>i.id).filter(i=>!!i):e.iterationId?[e.iterationId]:[]:[]}retrieveProgramScheduledDayInfo(t){let e=this.availablePrograms.find(r=>r.id===t);if(!e)return[];let i=[];if(e.schedule&&e.schedule.length>0){let r=e.schedule;i.push(...r)}if(e.weeks&&e.weeks.length>0){let r=e.weeks.flatMap(o=>o.schedule?o.schedule:[]);i.push(...r)}return[...new Set(i)]}retrieveProgramScheduledDayIds(t){let e=this.availablePrograms.find(r=>r.id===t);if(!e)return[];let i=[];if(e.schedule&&e.schedule.length>0){let r=e.schedule.map(o=>o.id).filter(o=>!!o);i.push(...r)}if(e.weeks&&e.weeks.length>0){let r=e.weeks.flatMap(o=>o.schedule?o.schedule.map(s=>s.id).filter(s=>!!s):[]);i.push(...r)}return[...new Set(i)]}updateSanitizedDescription(t){this.sanitizedDescription=this.sanitizer.bypassSecurityTrustHtml(t)}getDefaultFormValuesForMode(){let t={name:"",description:"",goal:"",primaryCategory:"",secondaryCategory:"",tags:"",workoutDate:"",startTime:"",endTime:"",overallNotesLog:"",routineIdForLog:"",programIdForLog:"",iterationIdForLog:"",scheduledDayIdForLog:"",exercises:[]};if(this.mode==="manualLogEntry"){let e=new Date;return N(A({},t),{goal:"custom",workoutDate:me(e,"yyyy-MM-dd"),startTime:me(e,"HH:mm"),endTime:me(e,"HH:mm")})}return A({},t)}configureFormValidatorsAndFieldsForMode(){let t=this.builderForm.get("name"),e=this.builderForm.get("goal"),i=this.builderForm.get("workoutDate"),r=this.builderForm.get("startTime"),o=this.builderForm.get("endTime");t?.clearValidators(),e?.clearValidators(),i?.clearValidators(),r?.clearValidators(),o?.clearValidators(),this.isRoutineMode?(t?.setValidators(Le.required),e?.setValidators(Le.required),this.builderForm.get("exercises")?.setValidators(Le.nullValidator)):(i?.setValidators(Le.required),r?.setValidators(Le.required),o?.setValidators(Le.required),this.builderForm.get("exercises")?.setValidators(Le.required)),this.builderForm.updateValueAndValidity({emitEvent:!1})}toggleFormState(t){t?this.builderForm.disable({emitEvent:!1}):(this.builderForm.enable({emitEvent:!1}),this.isRoutineMode?(this.builderForm.get("workoutDate")?.disable({emitEvent:!1}),this.builderForm.get("startTime")?.disable({emitEvent:!1}),this.builderForm.get("endTime")?.disable({emitEvent:!1}),this.builderForm.get("overallNotesLog")?.disable({emitEvent:!1}),this.builderForm.get("routineIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("programIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("iterationIdForLog")?.disable({emitEvent:!1}),this.builderForm.get("scheduledDayIdForLog")?.disable({emitEvent:!1})):(this.builderForm.get("description")?.disable({emitEvent:!1}),this.builderForm.get("goal")?.disable({emitEvent:!1}),this.checkIfLogForProgram()&&(this.builderForm.get("programIdForLog")?.disable(),this.builderForm.get("routineIdForLog")?.disable(),this.pastSession?(this.builderForm.get("iterationIdForLog")?.disable(),this.builderForm.get("scheduledDayIdForLog")?.disable()):(this.builderForm.get("iterationIdForLog")?.enable(),this.builderForm.get("scheduledDayIdForLog")?.enable()),this.builderForm.get("workoutDate")?.disable())))}checkIfLogForProgram(){return!!(this.currentProgramId&&this.mode==="manualLogEntry"&&this.dateParam&&this.currentRoutineId)}getLogTitleForProgramEntry(){if(this.checkIfLogForProgram()){let t=this.availablePrograms.find(i=>i.id===this.currentProgramId),e=this.availableRoutines.find(i=>i.id===this.currentRoutineId);if(t)return`Log for Program: ${t.name} - Routine: ${e?.name||"Ad-hoc"}`}return"Ad-hoc Workout"}get exercisesFormArray(){return this.builderForm.get("exercises")}addRepsListener(t){let e=this.setupRepsListener(t);this.subscriptions.add(e)}setupRepsListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(bt(300),ue(null),Ue(r=>{let o=e.controls;return He(o).pipe(Ue((s,l)=>{let m=[s.get("targetReps")?.valueChanges].filter(x=>!!x);return m.length===0?se(null):He(m).pipe(Vt(),de(()=>({setIndex:l,exerciseId:t.get("id")?.value})),Xe((x,v)=>JSON.stringify(x)===JSON.stringify(v)))}))}),Je(r=>r!==null)).subscribe(r=>{console.log(`Reps Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}setupDurationListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(bt(300),ue(null),Ue(r=>{let o=e.controls;return He(o).pipe(Ue((s,l)=>{let g=s.get("targetDurationMin"),m=s.get("targetDurationMax"),x=[g?.valueChanges,m?.valueChanges].filter(v=>!!v);return x.length===0?se(null):He(x).pipe(Vt(),de(()=>({setIndex:l,exerciseId:t.get("id")?.value})),Xe((v,k)=>JSON.stringify(v)===JSON.stringify(k)))}))}),Je(r=>r!==null)).subscribe(r=>{console.log(`Duration Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}addDurationListener(t){this.setupDurationListener(t)}addDistanceListener(t){let e=this.workoutFormService.getSetsFormArray(t),i=e.valueChanges.pipe(bt(300),ue(null),Ue(r=>{let o=e.controls;return He(o).pipe(Ue((s,l)=>{let m=[s.get("targetDistance")?.valueChanges].filter(x=>!!x);return m.length===0?se(null):He(m).pipe(Vt(),de(()=>({setIndex:l,exerciseId:t.get("id")?.value})),Xe((x,v)=>JSON.stringify(x)===JSON.stringify(v)))}))}),Je(r=>r!==null)).subscribe(r=>{console.log(`Distance Range changed on Ex: ${r.exerciseId}, Set: ${r.setIndex}`),this.getRoutineDuration()});this.subscriptions.add(i)}loadAvailableExercises(){this.exerciseService.getExercises().pipe(we(1),Me(t=>!t||t.length===0?se([]):this.exerciseService.getTranslatedExerciseList(t))).subscribe(t=>{this.availableExercises=t.filter(e=>!e.isHidden).map(e=>N(A({},e),{_searchName:this.exerciseService.normalizeExerciseNameForSearch(e.name).toLowerCase(),_searchCategory:e.category?e.category.toLowerCase():"",_searchDescription:e.description?e.description.toLowerCase():"",_searchPrimaryMuscle:e.primaryMuscleGroup?e.primaryMuscleGroup.toLowerCase():""}))})}updateExerciseNamesInForm(){let t=new Map(this.availableExercises.map(e=>[e.id,e.name]));this.exercisesFormArray.controls.forEach(e=>{let i=e,r=i.get("exerciseId")?.value,o=i.get("exerciseName")?.value;if(r){let s=t.get(r);s&&s!==o&&i.get("exerciseName")?.patchValue(s,{emitEvent:!1})}})}patchFormWithRoutineData(t){this.builderForm.patchValue({name:t.name,description:t.description,goal:t.goal??"",primaryCategory:t.primaryCategory??"",secondaryCategory:t.secondaryCategory??"",tags:t.tags?.join(", ")||""}),this.updateSanitizedDescription(t.description||""),this.exercisesFormArray.clear(),t.exercises&&t.exercises.forEach(e=>{let i=this.workoutFormService.createExerciseFormGroup(e,!0,!1);i.addControl("section",this.fb.control(e.section??null)),this.exercisesFormArray.push(i),this.addRepsListener(i),this.addDurationListener(i)}),this.updateExerciseNamesInForm(),this.builderForm.markAsPristine()}patchFormWithLogData(t){this.initialRoutineIdForLogEdit=t.routineId,this.initialProgramIdForLogEdit=t.programId,this.initialProgramIterationIdForLogEdit=t.iterationId,this.initialProgramScheduledIdForLogEdit=t.scheduledDayId,this.builderForm.patchValue({name:t.routineName||"Logged Workout",workoutDate:me(Xt(t.date),"yyyy-MM-dd"),startTime:me(new Date(t.startTime),"HH:mm"),endTime:t.endTime?me(new Date(t.endTime),"HH:mm"):t.startTime&&t.durationMinutes?me(new Date(new Date(t.startTime).getTime()+t.durationMinutes*6e4),"HH:mm"):"",overallNotesLog:t.notes||"",routineIdForLog:t.routineId||"",programIdForLog:t.programId||"",iterationIdForLog:t.iterationId||"",scheduledDayIdForLog:t.scheduledDayId||""}),t.programId&&(this.availableIterationIds=this.retrieveProgramIterationIds(t.programId),this.availableScheduledDayIds=this.retrieveProgramScheduledDayIds(t.programId),this.availableScheduledDayInfos=this.retrieveProgramScheduledDayInfo(t.programId)),this.exercisesFormArray.clear(),t.exercises.forEach(e=>{let i=this.workoutFormService.createExerciseFormGroupFromLoggedExercise(e);this.exercisesFormArray.push(i)}),this.toggleFormState(!1),this.expandedSetPath.set(null),this.builderForm.markAsPristine()}prefillLogFormFromRoutine(t,e=!0){this.currentProgramId&&this.retrieveProgramInfo(this.currentProgramId);let i={name:`${this.translate.instant("workoutBuilder.logEntry.logForProgramTitle",{programName:"",routineName:""})}${t.name}`,routineIdForLog:t.id,iterationIdForLog:this.initialProgramIterationIdForLogEdit,scheduledDayIdForLog:this.initialProgramScheduledIdForLogEdit};if(e){let r=new Date,o=this.dateParam?this.dateParam:r;i.programIdForLog=this.currentProgramId||null,i.workoutDate=me(o,"yyyy-MM-dd"),i.startTime=me(o,"HH:mm")}this.builderForm.patchValue(i,{emitEvent:!1}),this.exercisesFormArray.clear({emitEvent:!1}),t.exercises.forEach(r=>{let o=this.workoutFormService.createExerciseFormGroup(r,!0,!0);this.exercisesFormArray.push(o,{emitEvent:!1})}),this.builderForm.markAsDirty()}prefillRoutineFormFromLog(t){this.builderForm.patchValue({name:`${t.routineName||this.translate.instant("workoutBuilder.logEntry.adHocTitle")} - As Routine`,description:t.notes||"",goal:this.availableRoutines.find(e=>e.id===t.routineId)?.goal||"custom"},{emitEvent:!1}),this.updateSanitizedDescription(t.notes||""),this.exercisesFormArray.clear({emitEvent:!1}),t.exercises.forEach(e=>{let i=this.createRoutineExerciseFromLoggedExercise(e);this.exercisesFormArray.push(i,{emitEvent:!1})}),this.toggleFormState(!1),this.builderForm.markAsDirty(),this.builderForm.updateValueAndValidity(),this.loadedRoutine.set(this.mapFormToRoutine(this.builderForm.getRawValue()))}createRoutineExerciseFromLoggedExercise(t){let e=this.availableExercises.find(o=>o.id===t.exerciseId),i=t.sets.map(o=>{let s={id:this.workoutService.generateExerciseSetId(),targetReps:o.targetReps??o.repsLogged,targetWeight:o.targetWeight??o.weightLogged??void 0,targetDuration:o.targetDuration??o.durationLogged,targetDistance:o.targetDistance??o.distanceLogged,targetTempo:o.targetTempo,targetRest:o.targetRest??o.restLogged??ie(60),type:o.type,notes:o.notes,fieldOrder:o.fieldOrder};return this.workoutFormService.createSetFormGroup(s,!1)}),r=this.fb.group({id:this.workoutService.generateWorkoutExerciseId(),exerciseId:[t.exerciseId,Le.required],exerciseName:[e?.name||t.exerciseName],notes:[t.notes||""],sets:this.fb.array(i),supersetId:[t.supersetId||null],supersetOrder:[t.supersetOrder??null]});return this.addRepsListener(r),this.addDurationListener(r),r}createRangeValidator(){return t=>(t instanceof pe&&["targetReps","targetDuration","targetRest","targetWeight","targetDistance"].forEach(i=>{let r=t.get(i),o=r?.value;if(o&&typeof o=="object"&&o.type==="range"){let l=o.min??o.minSeconds,g=o.max??o.maxSeconds;if(l!=null&&g!=null&&g<l)r.setErrors({min:!0});else if(r?.hasError("min")){let s=r.errors||{},{min:m}=s,x=nr(s,["min"]);r.setErrors(Object.keys(x).length>0?x:null)}}}),null)}scrollExpandedExerciseIntoView(){let t=this.expandedExercisePath();if(t){let e=this.expandedExerciseCard.get(t.exerciseIndex)?.nativeElement;e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}}scrollExpandedSetIntoView(){let t=this.expandedSetPath();if(t){let e=this.expandedSetElements.get(t.exerciseIndex)?.nativeElement;if(e){let r=e.querySelectorAll(".set-item")[t.setIndex];if(r){let l=r.getBoundingClientRect().top+window.pageYOffset-120;window.scrollTo({top:l,behavior:"smooth"})}}}}scrollIntoView(){setTimeout(()=>{let t=this.exercisesFormArray.length-1,e=this.expandedSetElements.get(t)?.nativeElement;e&&e.scrollIntoView({behavior:"smooth",block:"start"})},2e3)}openExerciseSelectionModal(){this.isViewMode||(this.modalSearchTerm.set(""),setTimeout(()=>{this.isExerciseModalOpen=!0},150))}closeExerciseSelectionModal(){this.isExerciseModalOpen=!1}onModalSearchTermChange(t){let e=t.target;this.modalSearchTerm.set(e.value)}selectExercisesFromLibrary(t){t.forEach(e=>{let i=this.isExerciseCardioOnly(e.id),r=[];i?r=["duration","distance","rest"]:r=["reps","weight","rest"];let o={id:this.workoutService.generateExerciseSetId(),type:"standard",fieldOrder:r,targetReps:i?void 0:Tt(8),targetWeight:i?void 0:ye(10),targetRest:ie(60),targetDuration:i?Oe(60):void 0,targetDistance:i?Ge(1):void 0,targetTempo:void 0,notes:void 0},s={id:this.workoutService.generateWorkoutExerciseId(),exerciseId:e.id,exerciseName:e.name,sets:[o],supersetId:null,supersetOrder:null},l;this.isRoutineMode?(l=this.workoutFormService.createExerciseFormGroup(s,!0,!1),this.addRepsListener(l),this.addDurationListener(l),this.addDistanceListener(l),this.exercisesFormArray.push(l)):(l=this.workoutFormService.createExerciseFormGroup(s,!1,!0),this.exercisesFormArray.push(l)),t.indexOf(e)===t.length-1&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.ngZone.run(()=>{this.toggleSetExpansion(this.exercisesFormArray.length-1,0)})},0)})}),this.closeExerciseSelectionModal(),this.audioService.playSound("pop")}ngAfterViewInit(){this.expandedSetElements.changes.subscribe(t=>{let e=t.first;e&&this.expandedSetPath()&&setTimeout(()=>{e.nativeElement.scrollIntoView({behavior:"smooth",block:"center"})},100)}),this.previousGoalValue=this.builderForm.get("goal")?.value}addSet(t,e){if(this.isViewMode)return;let i=t.get("supersetId")?.value;if(i){this.exercisesFormArray.controls.forEach((s,l)=>{let g=s;if(g.get("supersetId")?.value===i){let m=this.workoutFormService.getSetsFormArray(g),x=this.createSyncedSet(m,s);m.push(x)}});let o=this.workoutFormService.getSetsFormArray(t).length-1}else{let r=this.workoutFormService.getSetsFormArray(t),o=this.createSyncedSet(r,t);r.push(o),this.cdr.detectChanges();let s=r.length-1}this.audioService.playSound("correct"),this.handleAnimationForNewSet(e)}isNewlyAdded(t,e){return this.newlyAddedSets.get(t)===e}handleAnimationForNewSet(t){if(t<0)return;let e=this.exercisesFormArray.controls.at(t);if(!e)return;let i=this.workoutFormService.getSetsFormArray(e).controls.length-1;this.newlyAddedSets.set(t,i),setTimeout(()=>{this.newlyAddedSets.delete(t)},500)}createSyncedSet(t,e){if(t.length>0){let i=t.at(t.length-1).value,r=A({},i);return delete r.id,this.workoutFormService.createSetFormGroup(r,this.mode==="manualLogEntry")}else return this.workoutFormService.createSetFormGroup(void 0,this.mode==="manualLogEntry")}removeSet(t,e,i,r){return L(this,null,function*(){if(r?.stopPropagation(),this.isViewMode)return;let o=t.get("supersetId")?.value,s=this.workoutFormService.getSetsFormArray(t),l=!1;if(o)if(s.length===1){let g=yield this.alertService.showConfirm("Remove Last Round?","This will remove the exercise from the superset. Are you sure?","Remove Exercise","Cancel");if(g&&g.data){this.exercisesFormArray.removeAt(e),l=!0;let m=this.exercisesFormArray.controls.filter(v=>v.get("supersetId")?.value===o),x=m[0]?.get("supersetType")?.value==="emom";m.length<2&&!x?m.length===1&&(m[0].patchValue({supersetId:null,supersetOrder:null,type:"standard"}),this.toastService.info("Superset ungrouped.",2e3)):m.length>0&&this.recalculateSupersetOrders(),this.showUndoWithToast("Exercise removed from superset"),this.audioService.playSound("whoosh")}else return}else this.exercisesFormArray.controls.forEach(g=>{if(g.get("supersetId")?.value===o){let m=this.workoutFormService.getSetsFormArray(g);i<m.length&&m.removeAt(i)}}),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.toasts.roundRemoved")),this.audioService.playSound("whoosh");else if(s.length===1){let g=yield this.alertService.showConfirm(this.translate.instant("compactPlayer.removeLastSet"),this.translate.instant("workoutBuilder.exercise.removeLastSet"),this.translate.instant("workoutBuilder.exercise.remove"),this.translate.instant("common.cancel"));if(g&&g.data)this.exercisesFormArray.removeAt(e),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.toasts.exerciseRemoved")),this.audioService.playSound("whoosh");else return}else s.removeAt(i),l=!0,this.showUndoWithToast(this.translate.instant("workoutBuilder.set.setRemoved")),this.audioService.playSound("whoosh");if(l){let g=this.expandedSetPath();g&&g.exerciseIndex===e&&g.setIndex===i?this.expandedSetPath.set(null):g&&g.exerciseIndex===e&&g.setIndex>i?this.expandedSetPath.set({exerciseIndex:e,setIndex:g.setIndex-1}):g&&g.exerciseIndex>e&&this.expandedSetPath.set({exerciseIndex:g.exerciseIndex-1,setIndex:g.setIndex})}})}showUndoWithToast(t){this.toastService.clearAll(),this.toastService.showWithAction(t,this.translate.instant("common.undo"),()=>this.undoLastChange(),this.translate.instant("common.info"),this.translate.instant("common.actionCompleted"))}toggleSetExpansion(t,e,i){if(this.closeExerciseActionMenu(),i?.stopPropagation(),navigator.vibrate&&navigator.vibrate(50),i&&(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLSelectElement))return;let r=this.expandedSetPath();r?.exerciseIndex===t&&r?.setIndex===e?this.expandedSetPath.set(null):(this.expandedSetPath.set({exerciseIndex:t,setIndex:e}),this.cdr.detectChanges(),setTimeout(()=>{this.scrollExpandedSetIntoView();let s=this.expandedSetElements.find((l,g)=>g===e)?.nativeElement},50))}isSetExpanded(t,e){let i=this.expandedSetPath();return i?.exerciseIndex===t&&i?.setIndex===e}collapseExpandedSet(t=!1,e){e&&e.target.closest(".view-mode-controls")||(this.isAllExpandedInViewMode.set(!1),this.expandedSetPath.set(null),e?.stopPropagation())}getFormErrors(t){let e={};return Object.keys(t.controls).forEach(i=>{let r=t.get(i).errors;if(r&&(e[i]=r),t.get(i)instanceof pe||t.get(i)instanceof Gr){let o=this.getFormErrors(t.get(i));Object.keys(o).length>0&&(e[i]=o)}}),e}get f(){return this.builderForm.controls}toggleExerciseSelection(t,e){this.isViewMode||(e?.stopPropagation(),this.toggleExerciseSelectionForMultipleRemoval(t,e),this.toggleExerciseSelectionForSuperset(t,e))}toggleExerciseSelectionForMultipleRemoval(t,e){if(this.isViewMode)return;e?.stopPropagation();let i=e.target;this.selectedExerciseIndicesForMultipleRemoval.update(r=>{let o;return i.checked?o=r.includes(t)?r:[...r,t]:o=r.filter(s=>s!==t),o.sort((s,l)=>s-l)})}removeSelectedExercises(){if(this.isViewMode)return;this.selectedExerciseIndicesForMultipleRemoval().sort((e,i)=>i-e).forEach(e=>{this.exercisesFormArray.removeAt(e)}),this.selectedExerciseIndicesForMultipleRemoval.set([]),this.selectedExerciseIndicesForSuperset.set([]),this.recalculateSupersetOrders(),this.expandedSetPath.set(null),this.audioService.playSound("whoosh")}toggleExerciseSelectionForSuperset(t,e){if(this.isViewMode)return;e?.stopPropagation();let i=e.target;this.selectedExerciseIndicesForSuperset.update(r=>{let o;return i.checked?o=r.includes(t)?r:[...r,t]:o=r.filter(s=>s!==t),o.sort((s,l)=>s-l)})}canRemoveSelectedExercises(){return this.selectedExerciseIndicesForMultipleRemoval().length>0&&!this.isViewMode}canUngroupSelectedExercises(){let t=this.selectedExerciseIndicesForSuperset();if(t.length===0)return!1;let e=Array.from(new Set(t.map(r=>this.exercisesFormArray.at(r).get("supersetId")?.value).filter(r=>!!r)));return Array.from(new Set(e)).length===1}onExerciseDrop(t){if(!this.isViewMode&&t.previousContainer===t.container){let e=this.exercisesFormArray;gi(e.controls,t.previousIndex,t.currentIndex),e.updateValueAndValidity(),this.selectedExerciseIndicesForSuperset.set([]),this.handleSupersetIntegrityAfterDrag(t.previousIndex,t.currentIndex),this.recalculateSupersetOrders(),this.expandedSetPath.set(null)}}handleSupersetIntegrityAfterDrag(t,e){let i=new Set;if(i.add(t),i.add(e),t<e)for(let o=t;o<=e;o++)i.add(o);else for(let o=e;o<=t;o++)i.add(o);let r=new Set;i.forEach(o=>{if(o<this.exercisesFormArray.length){let l=this.exercisesFormArray.at(o).get("supersetId")?.value;l&&r.add(l)}}),r.forEach(o=>{this.exercisesFormArray.controls.forEach(s=>{let l=s;l.get("supersetId")?.value===o&&l.patchValue({supersetId:null,supersetOrder:null})})}),this.recalculateSupersetOrders()}recalculateSupersetOrders(){let t=new Map;this.exercisesFormArray.controls.forEach(e=>{let i=e,r=i.get("supersetId")?.value;r?(t.has(r)||t.set(r,[]),t.get(r).push(i)):i.patchValue({supersetOrder:null},{emitEvent:!1})}),t.forEach((e,i)=>{(e[0].get("supersetType")?.value||"standard")==="standard"&&e.length<2?e.forEach(o=>{o.patchValue({supersetId:null,supersetOrder:null})}):(e.sort((o,s)=>this.exercisesFormArray.controls.indexOf(o)-this.exercisesFormArray.controls.indexOf(s)),e.forEach((o,s)=>{o.patchValue({supersetOrder:s},{emitEvent:!1})}))}),this.exercisesFormArray.updateValueAndValidity({emitEvent:!1})}groupSelectedAsSuperset(){return L(this,null,function*(){if(this.isViewMode)return;let t=this.selectedExerciseIndicesForSuperset().sort((B,M)=>B-M);if(t.length<2){this.toastService.warning(this.translate.instant("workoutBuilder.toasts.supersetSizeError"),3e3,"Superset Error");return}for(let B=1;B<t.length;B++)if(t[B]!==t[B-1]+1){this.toastService.warning(this.translate.instant("workoutBuilder.toasts.supersetOrderError"),5e3,"Superset Error");return}let e=!1,i=[{text:"STANDARD",role:"confirm",data:"standard",cssClass:"bg-orange-500 text-white"},{text:"EMOM",role:"confirm",data:"emom",cssClass:"bg-teal-500 text-white"}],r=yield this.alertService.showConfirmationDialog(this.translate.instant("workoutBuilder.superset.selectGroupType"),this.translate.instant("workoutBuilder.superset.howToGroup"),i);if(!r||!r.data){this.toastService.info("Grouping cancelled.",2e3);return}let o=r.data,s,l=null;if(o==="emom"){e=!0;let B=[{name:"emomTime",type:"number",label:this.translate.instant("workoutBuilder.superset.emomTimePerRound"),value:"60",attributes:{min:"10",required:!0}},{name:"numSets",type:"number",label:this.translate.instant("workoutBuilder.superset.numRounds"),value:"5",attributes:{min:"1",required:!0}}],M=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.superset.setEmomDetails"),this.translate.instant("workoutBuilder.superset.configureEmom"),B);if(!M||!M.emomTime||!M.numSets)return;l=Number(M.emomTime),s=Number(M.numSets)}else{let B=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.superset.setSupersetRounds"),this.translate.instant("workoutBuilder.superset.howManyRounds"),[{name:"numSets",type:"number",label:this.translate.instant("workoutBuilder.superset.numRounds"),value:"3",attributes:{min:"1",required:!0}}]);if(!B||!B.numSets){this.toastService.info(this.translate.instant("workoutBuilder.superset.groupingCancelled"),2e3);return}s=Number(B.numSets)}let g=[],x=this.unitService.convertWeight(15,this.unitService.currentWeightUnit(),"kg");for(let[B,M]of t.entries()){let P=this.exercisesFormArray.at(M),le=P.get("exerciseName")?.value,z=P.get("exerciseId")?.value,V=this.availableExercises.find(G=>G.id===z),ee=V?V.category!=="cardio":!1,X=[{name:"reps",type:"number",label:`${this.translate.instant("workoutBuilder.set.reps")}`,value:"8",attributes:{min:"0",required:!0}}];ee&&X.push({name:"weight",type:"number",label:`${this.translate.instant("workoutBuilder.set.weight")} (${this.unitService.getWeightUnitSuffix()})`,value:String(Math.round(x)),attributes:{min:"0"}});let oe=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.superset.setExerciseTargets"),this.translate.instant("workoutBuilder.superset.enterTargets",{weight:ee?" and weight":"",exerciseName:le}),X);if(!oe||!oe.reps){this.toastService.info(this.translate.instant("workoutBuilder.superset.supersetCreationCancelled"),2e3);return}g.push({reps:Number(oe.reps),weight:ee&&oe.weight!==void 0?Number(oe.weight):void 0})}let v=U(),k=t.length;t.forEach((B,M)=>{let P=this.exercisesFormArray.at(B),{reps:le,weight:z}=g[M];P.patchValue({supersetId:v,supersetOrder:M,supersetType:o,emomTimeSeconds:l,type:"superset"});let V=P.get("sets"),ee={type:"exact",value:le},X=z!==void 0?ye(this.unitService.convertWeight(z,"kg",this.unitService.currentWeightUnit())):void 0,oe=ie(0);o==="standard"&&M===k-1&&(oe=ie(60));let G=[];ee&&G.push("weight"),X&&G.push("reps"),oe&&G.push("rest");let At={id:U(),type:"superset",targetReps:ee,targetWeight:X,fieldOrder:G,targetRest:oe};V.clear();for(let Ci=0;Ci<s;Ci++){let ro=this.workoutFormService.createSetFormGroup(At,!1);V.push(ro)}}),this.selectedExerciseIndicesForSuperset.set([]);let T=o==="emom"?this.translate.instant("workoutBuilder.superset.emomCreated",{numberOfSets:s}):this.translate.instant("workoutBuilder.superset.supersetCreated",{numberOfSets:s});this.toastService.success(T,4e3,"Success"),this.expandedSetPath.set(null),this.toggleSetExpansion(t[0],0)})}ungroupSuperset(t){if(this.isViewMode)return;let i=this.exercisesFormArray.at(t).get("supersetId")?.value;i&&(this.exercisesFormArray.controls.forEach(r=>{let o=r;o.get("supersetId")?.value===i&&o.patchValue({supersetId:null,supersetOrder:null,supersetType:"standard",emomTimeSeconds:null})}),this.selectedExerciseIndicesForSuperset.set([]),this.toastService.info("Superset ungrouped",3e3,"Ungrouped"))}removeExercise(t,e){if(this.isViewMode)return;e?.stopPropagation();let r=this.exercisesFormArray.at(t).get("supersetId")?.value;this.exercisesFormArray.removeAt(t),this.selectedExerciseIndicesForSuperset.set([]),r&&this.recalculateSupersetOrders(),this.expandedSetPath.set(null),this.showUndoWithToast("Exercise removed"),this.audioService.playSound("whoosh")}errorMessage=R(null);onSubmit(){return L(this,null,function*(){if(this.isViewMode){this.toastService.info(this.translate.instant("workoutBuilder.toasts.viewMode"),3e3,this.translate.instant("workoutBuilder.toasts.viewMode"));return}this.recalculateSupersetOrders();let t=this.builderForm.getRawValue();if(this.isRoutineMode&&t.goal==="tabata"){let r=this.exercisesFormArray.controls;if(r.length>=2){let o=r[0].get("supersetId")?.value,s=r[0].get("sets").length;if(!o||!r.every(l=>l.get("supersetId")?.value===o)){this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataValidationError1"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}if(!r.every(l=>l.get("sets").length===s)){this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataValidationError2"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}this.exercisesFormArray.controls.forEach(l=>{l.get("sets").controls.forEach(m=>{m.patchValue({targetDuration:20,targetRest:10,targetReps:null,targetWeight:null,targetDistance:null},{emitEvent:!1})})})}else{this.toastService.error(this.translate.instant("workoutBuilder.toasts.tabataSizeError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.spinnerService.hide();return}}let e=this.isRoutineMode&&this.builderForm.get("goal")?.value==="rest";if(this.isRoutineMode&&(this.builderForm.get("name")?.invalid||this.builderForm.get("goal")?.invalid)||this.mode==="manualLogEntry"&&(this.builderForm.get("workoutDate")?.invalid||this.builderForm.get("startTime")?.invalid||this.builderForm.get("endTime")?.invalid)){this.builderForm.markAllAsTouched();let r=[];this.builderForm.get("name")?.invalid&&r.push(this.translate.instant("workoutBuilder.routineBuilder.nameLabel")),this.builderForm.get("goal")?.invalid&&r.push(this.translate.instant("workoutBuilder.routineBuilder.goalLabel")),this.builderForm.get("workoutDate")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.dateLabel")),this.builderForm.get("startTime")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.startTimeLabel")),this.builderForm.get("endTime")?.invalid&&r.push(this.translate.instant("workoutBuilder.logEntry.endTimeLabel")),this.toastService.error(`${this.translate.instant("workoutBuilder.toasts.validationError",{errors:r.join(", ")})}`,0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(!e&&this.exercisesFormArray.length===0){this.toastService.error(this.mode==="manualLogEntry"?this.translate.instant("workoutBuilder.toasts.noExercisesLogError"):this.translate.instant("workoutBuilder.toasts.noExercisesRoutineError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(!e&&!this.validateSupersetIntegrity()){this.toastService.error(this.translate.instant("workoutBuilder.toasts.invalidSupersetError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle"));return}if(this.builderForm.invalid){this.toastService.error(this.translate.instant("workoutBuilder.toasts.formError"),0,this.translate.instant("workoutBuilder.toasts.validationErrorTitle")),this.builderForm.markAllAsTouched();return}let i=this.builderForm.getRawValue();this.spinnerService.show(this.isNewMode?"Saving...":"Updating...");try{if(this.isRoutineMode){let r=this.mapFormToRoutine(i),o;if(this.context==="modal"){this.routineConfirmed.emit(r),this.toastService.success("Routine created!",2e3,"Success"),this.modalClose.emit();return}if(this.isNewMode)o=yield this.workoutService.addRoutine(r);else{let s=this.liveFormAsRoutine()?this.liveFormAsRoutine()?.cardColor:"";r.cardColor=s;let l=yield this.workoutService.updateRoutine(r);if(l)o=l;else return}this.toastService.success(`Routine ${this.isNewMode?"created":"updated"}!`,4e3,"Success"),this.isNewMode&&o&&(this.isEditMode=!0,this.isNewMode=!1,this.currentRoutineId=o.id,this.router.navigate(["/workout/routine/edit",o.id],{replaceUrl:!0}))}else{let r=i.workoutDate,o=i.startTime,s=i.endTime,l=`${r}T${o}:00`,g=`${r}T${s}:00`,m=Xt(l).getTime(),x=Xt(g).getTime();x<m&&(x+=1440*60*1e3);let v=i.exercises.map(T=>{let B=T.sets.map(M=>({id:M.id||U(),exerciseName:T.exerciseName,plannedSetId:M.plannedSetId,exerciseId:T.exerciseId,type:M.type,repsLogged:M.repsLogged,weightLogged:M.weightLogged?ye(this.unitService.convertWeight(this.workoutUtilsService.getWeightValue(M.weightLogged),"kg",this.unitService.currentWeightUnit())):void 0,distanceLogged:M.distanceLogged,durationLogged:M.durationLogged,restLogged:M.restLogged,notes:M.notes,targetReps:M.targetReps,targetWeight:M.targetWeight,targetDuration:M.targetDuration,targetTempo:M.targetTempo,targetRest:M.targetRest,rpe:void 0,timestamp:M.timestamp||new Date().toISOString(),fieldOrder:M.fieldOrder}));return{id:T.id,exerciseId:T.exerciseId,exerciseName:T.exerciseName,notes:T.notes,sets:B,supersetId:T.supersetId,supersetOrder:T.supersetOrder,supersetType:T.supersetType||"standard",emomTimeSeconds:T.emomTimeSeconds||null}}),k={date:me(new Date(m),"yyyy-MM-dd"),startTime:m,endTime:x,durationMinutes:Math.round(x?(x-m)/6e4:(Date.now()-m)/6e4),routineId:i.routineIdForLog||void 0,routineName:i.routineIdForLog?this.availableRoutines.find(T=>T.id===i.routineIdForLog)?.name||i.name||"Workout from Routine":i.name||this.translate.instant("workoutBuilder.logEntry.adHocTitle"),programId:i.programIdForLog||void 0,notes:i.overallNotesLog,exercises:v,iterationId:i.iterationIdForLog||void 0,scheduledDayId:i.scheduledDayIdForLog||void 0,dayName:"AAAA"};if(this.isEditMode&&this.currentLogId){let T=N(A({},k),{id:this.currentLogId});yield this.trackingService.updateWorkoutLog(T),this.toastService.success(this.translate.instant("workoutBuilder.toasts.logUpdated"),4e3,"Success"),this.router.navigate(["/history/log",this.currentLogId])}else{let T=k,B=yield this.trackingService.addWorkoutLog(T);this.toastService.success(this.translate.instant("workoutBuilder.toasts.logSaved"),4e3,"Success"),this.router.navigate(["/history/log",B.id])}}this.builderForm.markAsPristine()}catch(r){console.error("Error saving:",r),this.toastService.error(`Failed to save: ${r.message||"Unknown error"}`,0,"Save Error")}finally{this.spinnerService.hide()}})}handleCancel(){this.context==="modal"?this.modalClose.emit():this.router.navigate([this.mode==="routineBuilder"?"/workout":"/history/list"])}validateSupersetIntegrity(){let t=this.exercisesFormArray.value,e=new Map;for(let i of t)i.supersetId&&(e.has(i.supersetId)||e.set(i.supersetId,[]),e.get(i.supersetId).push(i));for(let[i,r]of e.entries()){let o=r.length>0&&r[0].supersetType==="emom";if(r.length<2&&!o)return!1;if(r.length>1){let s=r.sort((g,m)=>(g.supersetOrder??1/0)-(m.supersetOrder??1/0));for(let g=0;g<s.length;g++)if(s[g].supersetOrder!==g)return!1;let l=s.map(g=>this.exercisesFormArray.controls.findIndex(m=>m.get("id")?.value===g.id));for(let g=1;g<l.length;g++)if(l[g]!==l[g-1]+1)return!1}}return!0}get firstSelectedExerciseIndexForSuperset(){let t=this.selectedExerciseIndicesForSuperset();return t.length>0?t[0]:null}startCurrentWorkout(){if(this.currentRoutineId){let t=this.workoutService.checkPlayerMode(this.currentRoutineId);this.router.navigate([t,this.currentRoutineId])}else this.toastService.error("Cannot start workout: Routine ID is missing",0,this.translate.instant("common.error"))}enableEditMode(){this.isViewMode&&this.currentRoutineId&&(this.isViewMode=!1,this.isEditMode=!0,this.toggleFormState(!1),this.toastService.info("Edit mode enabled",3e3,"Mode Changed"))}ngOnDestroy(){this.subscriptions.unsubscribe()}getSupersetSize(t){return this.workoutService.getSupersetSize(this.liveFormAsRoutine(),t)}getExerciseCardClass(t,e){let i=t.get("supersetId")?.value,r=t.get("supersetType")?.value==="emom",o=!!i&&!r,s=this.selectedExerciseIndicesForSuperset().includes(e),l=t.get("sets")?.value||[],g=l.length>0&&l.every(P=>P.type==="warmup"),m=t.get("supersetOrder")?.value??0,x=this.getSupersetSize(e),v=m===0,k=m===x-1,T=x===1,B=t.get("section")?.value,M={};if(r?M={"border-teal-500 dark:border-teal-400 border-r-2 border-l-2":!0,"bg-teal-50 dark:bg-teal-900/10":!s,"bg-teal-100 dark:bg-teal-800/50":s,"rounded-xl border-4":T,"mb-2":T||k,"mt-4":T||v,"rounded-t-xl border-x-2 border-t-2":v&&!T,"border-x-2":!v,"rounded-b-xl border-b-2":k||T}:o?M={"border-primary border-r-2 border-l-2":!0,"bg-orange-100 dark:bg-orange-900/10":!s,"bg-orange-200 dark:bg-orange-800/50":s,"rounded-t-xl border-x-2 border-t-2 mt-2":v,"border-x-2":!v,"rounded-b-xl border-b-2 mb-2":k}:M={"border rounded-xl mb-2":!0,"bg-blue-50 dark:bg-blue-900/40 border-blue-400":g&&!s,"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600":!g&&!s&&!B,"mt-5":this.isEditableMode()&&this.selectedExerciseIndicesForSuperset().length>=2&&e===this.firstSelectedExerciseIndexForSuperset},!s&&!r&&!o&&B)switch(M["border-l-4"]=!0,B){case"WarmUp":M["border-amber-500 dark:border-amber-500"]=!0;break;case"MainLift":M["border-red-500 dark:border-red-500"]=!0;break;case"Cardio":M["border-blue-500 dark:border-blue-500"]=!0;break;case"Finisher":M["border-purple-500 dark:border-purple-500"]=!0;break;case"CoolDown":M["border-emerald-500 dark:border-emerald-500"]=!0;break}return s&&(M["ring-2 ring-yellow-400 dark:ring-yellow-300"]=!0),M["shadow-sm"]=!0,M["cursor-grab"]=this.isEditableMode(),M["cursor-pointer"]=!this.isEditableMode(),M}hasAdjacentSupersets(t){let e=this.exercisesFormArray;if(t<0||t>=e.length)return!1;let i=e.at(t).get("supersetId")?.value;if(!i)return!1;if(t>0){let r=e.at(t-1).get("supersetId")?.value;if(r&&r===i)return!0}if(t<e.length-1){let r=e.at(t+1).get("supersetId")?.value;if(r&&r===i)return!0}return!1}isSupersetSpacing(t){if(t<=0)return!1;let e=this.exercisesFormArray.at(t).get("id")?.value,i=this.exercisesFormArray.at(t-1).get("id")?.value;return t>0&&e&&e!==i}handleTrulyCustomExerciseEntry(t=!1){return L(this,null,function*(){let e=[{name:"exerciseName",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName"),value:"",attributes:{required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName")},{name:"numSets",type:"number",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets"),value:"3",attributes:{min:"1",required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets")},{name:"equipmentNeeded",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment")},{name:"description",type:"textarea",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription")}];t&&this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));let i=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.exercise.newCustomExerciseTitle"),this.translate.instant("workoutBuilder.exercise.newCustomExerciseMsg"),e,this.translate.instant("workoutBuilder.exercise.newCustomExerciseBtn"));if(i&&i.exerciseName){let r=String(i.exerciseName).trim(),o=String(i.description).trim(),s=i.numSets?parseInt(String(i.numSets),10):3;if(!r||s<=0){this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));return}let l=Array.from({length:s},()=>({id:`custom-adhoc-set-${U()}`,fieldOrder:["reps","weight","rest"],targetReps:Pi(8),targetWeight:ye(10),targetDuration:void 0,targetRest:ie(60),type:"standard",notes:""})),m={id:`custom-adhoc-ex-${r.trim().toLowerCase().replace(/\s+/g,"-")}-${U()}`,name:r,description:o,category:"custom",muscleGroups:[],primaryMuscleGroup:void 0,imageUrls:[]};this.closeExerciseSelectionModal(),this.exerciseService.addExercise(m);let x={id:this.workoutService.generateWorkoutExerciseId(),exerciseId:m.id,exerciseName:m.name,sets:l,supersetId:null,supersetOrder:null},v=this.workoutFormService.createExerciseFormGroup(x,!0,!1);this.exercisesFormArray.push(v),this.toggleSetExpansion(this.exercisesFormArray.length-1,0),this.addRepsListener(v),this.addDurationListener(v)}else{if(!i)return;this.handleTrulyCustomExerciseEntry(!0);return}})}getRoutineDuration(){return this.liveFormAsRoutine()?this.workoutService.getEstimatedRoutineDuration(this.mapFormToRoutine(this.builderForm.getRawValue())):0}getTotalExerciseCount(){return this.exercisesFormArray.length}mapFormToRoutineOLD(t){let e=this.loadedRoutine(),i=t.tags,r=[];return typeof i=="string"?r=i.split(",").map(s=>s.trim()).filter(s=>s.length>0):Array.isArray(i)&&(r=i),{id:this.currentRoutineId||U(),name:t.name,description:t.description,goal:t.goal,primaryCategory:t.primaryCategory||void 0,secondaryCategory:t.secondaryCategory||void 0,tags:r,exercises:t.goal==="rest"?[]:t.exercises.map(s=>{let l=!!s.supersetId;return{id:s.id||U(),exerciseId:s.exerciseId,exerciseName:s.exerciseName,notes:s.notes,sets:s.sets.map(g=>N(A({},g),{targetWeight:this.unitService.convertWeight(g.targetWeight,"kg",this.unitService.currentWeightUnit())??null,targetDuration:g.targetDuration??null,targetDistance:g.targetDistance??null,targetTempo:g.targetTempo??null})),supersetId:s.supersetId||null,supersetOrder:l?s.supersetOrder:null,supersetType:l?s.supersetType||"standard":null,emomTimeSeconds:l&&s.supersetType==="emom"?s.emomTimeSeconds:null,type:s.type}}),isFavourite:e?.isFavourite,isHidden:e?.isHidden,lastPerformed:e?.lastPerformed,isDisabled:!1,cardColor:e?.cardColor||void 0,createdAt:e?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}mapFormToRoutine(t){let e=this.loadedRoutine(),i=t.tags,r=[];typeof i=="string"?r=i.split(",").map(k=>k.trim()).filter(k=>k.length>0):Array.isArray(i)&&(r=i);let o=t.exercises||[],s=[],l=new Map,g=[];t.goal!=="rest"&&o.forEach(k=>{let T=!!k.supersetId,B=k.section,M={id:k.id||U(),exerciseId:k.exerciseId,exerciseName:k.exerciseName,notes:k.notes,sets:k.sets.map(P=>N(A({},P),{targetWeight:this.unitService.convertWeight(P.targetWeight,"kg",this.unitService.currentWeightUnit())??null,targetDuration:P.targetDuration??null,targetDistance:P.targetDistance??null,targetTempo:P.targetTempo??null})),supersetId:k.supersetId||null,supersetOrder:T?k.supersetOrder:null,supersetType:T?k.supersetType||"standard":null,emomTimeSeconds:T&&k.supersetType==="emom"?k.emomTimeSeconds:null,section:B??void 0};g.push(M)});let m=[];return["WarmUp","MainLift","Cardio","Finisher","CoolDown"].forEach(k=>{let T=g.filter(B=>B.section===k);T.length>0&&m.push({id:U(),type:k,titleI18nKey:`workoutSections.${k}`,exercises:T})}),{id:this.currentRoutineId||U(),name:t.name,description:t.description,goal:t.goal,primaryCategory:t.primaryCategory||void 0,secondaryCategory:t.secondaryCategory||void 0,tags:r,exercises:g,sections:m.length>0?m:void 0,isFavourite:e?.isFavourite,isHidden:e?.isHidden,lastPerformed:e?.lastPerformed,isDisabled:!1,cardColor:e?.cardColor||void 0,createdAt:e?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}isSuperSet(t){let e=this.liveFormAsRoutine()?.exercises;return!(!e||!e[t]?.supersetId)}getRoutineDropdownActionItems(t,e){let i="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-primary flex items-center text-sm hover:text-white dark:hover:text-gray-100 dark:hover:text-white",r="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-red-600 flex items-center text-sm hover:text-gray-100 hover:animate-pulse",o=N(A({},mn),{buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}}),s={label:"actionButtons.edit",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},l={label:"actionButtons.expand",actionKey:"expand",iconName:"ungroup",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},g={label:"actionButtons.collapse",actionKey:"collapse",iconName:"collapse",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},m={label:"actionButtons.delete",actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+r,data:{routineId:t}},x={label:"actionButtons.logs",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},v=[{label:"actionButtons.start",actionKey:"start",iconName:"play",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},{label:"actionButtons.copy",actionKey:"clone",iconName:"copy",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{routineId:t}},x];return this.isViewMode&&(v.push(s),this.exercisesFormArray?.length>0&&(v.push(l),v.push(g))),v.push(o),v.push({isDivider:!0}),v.push(m),v}checkEditRoutine(t){return L(this,null,function*(){let e=this.workoutService.getPausedSession();if(this.workoutService.isPausedSession()&&e&&e?.routineId===t){yield this.alertService.showAlert(this.translate.instant("workoutService.alerts.editRunningTitle"),this.translate.instant("workoutService.alerts.editRunningMessage")).then(()=>{});return}this.router.navigate(["/workout/routine/edit",t])})}handleActionMenuItemClick(t,e){let i=this.liveFormAsRoutine()?.id;if(i){switch(t.actionKey){case"start":this.startCurrentWorkout();break;case"edit":this.checkEditRoutine(i);break;case"clone":this.cloneAndEditRoutine(i);break;case"color":this.openColorPicker();break;case"delete":this.deleteRoutine(i);break;case"history":this.goToRoutineHistory(i);break;case"collapse":this.collapseAllSets();break;case"expand":this.expandAllSets();break}this.activeRoutineIdActions.set(null)}}goToRoutineHistory(t){this.router.navigate(["/history/list"],t?{queryParams:{routineId:t}}:{})}activeRoutineIdActions=R(null);toggleActions(t,e){e.stopPropagation(),this.activeRoutineIdActions.update(i=>i===t?null:t)}areActionsVisible(t){return this.activeRoutineIdActions()===t}onCloseActionMenu(){this.activeRoutineIdActions.set(null)}deleteRoutine(t,e){return L(this,null,function*(){let i=yield this.alertService.showConfirm("Delete Routine","Are you sure you want to delete this workout? This action cannot be undone","Delete");if(i&&i.data)try{this.spinnerService.show(),yield this.workoutService.deleteRoutine(t),this.toastService.success("Workout deleted successfully"),this.router.navigate(["/workout"])}catch{this.toastService.error("Failed to delete workout")}finally{this.spinnerService.hide()}})}cloneAndEditRoutine(t,e){return L(this,null,function*(){let i=this.liveFormAsRoutine();if(!i){this.toastService.error("Routine not found for cloning",0,this.translate.instant("common.error"));return}let r=N(A({},structuredClone(i)),{name:i.name+" (Copy)",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});try{this.spinnerService.show(),r=yield this.workoutService.addRoutine(r),this.toastService.success(`Routine "${r.name}" cloned successfully.`,3e3,"Routine Cloned"),this.router.navigate(["/workout/routine/edit",r.id])}catch(o){console.error("Error during routine cloning:",o),this.toastService.error("Failed to clone routine",0,"Clone Failed")}finally{this.spinnerService.hide()}})}checkIfTimedExercise(t){let e=t?.getRawValue();return!e||!e.sets?!1:e.sets.some(i=>i.duration!=null||i.durationMin!=null||i.durationMax!=null||i.durationLogged!=null)}checkIfWeightedExercise(t){return t?.getRawValue()?.sets.some(i=>i.weightLogged||i.targetWeight)}getSetReps(t){let e=t?.getRawValue()?.sets;if(!e||e.length===0)return"";let i=e.map(o=>this.getSetDisplayValue(new pe({targetReps:new It(o.targetReps||o.repsLogged),repsLogged:new It(o.weightLogged)}),"reps")),r=i.join(", ");return i.every(o=>o===i[0])?"x "+i[0]:(r.length>15&&(r=r.substring(0,15)+"..."),r)}openMetricSchemeModal(t,e,i){return L(this,null,function*(){if(i?.stopPropagation(),this.isViewMode||!(t instanceof pe))return;let r,o=this.getFormControlNameForBuilder(e);if(!o)return;let s=this.mode==="manualLogEntry";switch(e){case"reps":r=Ur.filter(m=>m.availableInBuilder&&!s||m.availableInLogs);break;case"weight":r=jr.filter(m=>m.availableInBuilder&&!s||m.availableInLogs);break;case"duration":r=Zr.filter(m=>m.availableInBuilder&&!s||m.availableInLogs);break;case"distance":r=Qr.filter(m=>m.availableInBuilder&&!s||m.availableInLogs);break;case"rest":r=Xr.filter(m=>m.availableInBuilder&&!s||m.availableInLogs);break;default:this.toastService.error(`Scheme editing is not supported for metric: ${e}`);return}let l=t.get(o)?.value;if(r=r.filter(m=>m.type!==l?.type),r.length===0){this.toastService.error(`No further available schemes found for metric: ${e}. Consider that while logging metric types different from 'exact' are not allowed`,6e3,this.translate.instant("common.error"));return}let g=yield this.workoutUtilsService.showSchemeModal(e,l??null,r);g&&g.data&&(t.get(o)?.patchValue(g.data),t.markAsDirty())})}getFormControlNameForBuilder(t){let e=this.mode==="manualLogEntry";switch(t){case"reps":return e?this.getLoggedControlName("reps"):this.getTargetControlName("reps");case"weight":return e?this.getLoggedControlName("weight"):this.getTargetControlName("weight");case"duration":return e?this.getLoggedControlName("duration"):this.getTargetControlName("duration");case"distance":return e?this.getLoggedControlName("distance"):this.getTargetControlName("distance");case"rest":return e?this.getLoggedControlName("rest"):this.getTargetControlName("rest");default:return""}}isRangeMode(t,e,i){if(i?.stopPropagation(),!(t instanceof pe))return!1;let r=e?String(e).charAt(0).toUpperCase()+String(e).slice(1):"",o=t.get(`target${r}Min`),s=t.get(`target${r}Max`);return o?.value!=null||s?.value!=null}getSetDurationDisplay(t){if(!t||!t.value||!t.value.sets||t.value.sets.length===0)return"";if(this.mode==="manualLogEntry"){let i=t.getRawValue().sets.map(r=>r.durationLogged).filter(r=>r!=null&&Yt(r)>0);return i.length>0?i.join("-"):""}else return this.workoutFormService.getSetsFormArray(t).controls.map(o=>this.getSetDisplayValue(o,this.metricEnum.duration)).filter(o=>o&&o!=="-").join(", ")}getSetDisplayValue(t,e){if(!t)return"-";let i={reps:en,rest:on,weight:tn,duration:rn,distance:nn,tempo:g=>g?String(g):"-"};if(i[e]){let g=t.get(this.getFormControlName(e))?.value;return i[e](g)||"-"}let r=e?String(e).charAt(0).toUpperCase()+String(e).slice(1):"",o=t.get(`target${r}Min`)?.value,s=t.get(`target${r}Max`)?.value,l=t.get(`target${r}`)?.value;if(o!=null||s!=null){if(o!=null&&s!=null)return o===s?`${o}`:`${o}-${s}`;if(o!=null)return`${o}+`;if(s!=null)return`Up to ${s}`}return l!=null?String(l):"-"}getSetWeightsUsed(t){let e=t?.getRawValue()?.sets;if(!e||e.length===0)return"";let r=e.map(o=>this.getSetDisplayValue(new pe({targetWeight:new It(o.targetWeight||o.weightLogged),weightLogged:new It(o.weightLogged)}),this.metricEnum.weight)).join(", ");return r.length>15&&(r=r.substring(0,15)+"..."),r}getSetdurationLogged(t){return this.currentLogId?t?.getRawValue()?.sets.map(i=>i.durationLogged?this.workoutUtilsService.getDurationValue(i.durationLogged):"").join(" - "):t?.getRawValue()?.sets.map(i=>i.targetDuration?this.workoutUtilsService.getDurationValue(i.targetDuration):"").join(" - ")}getIconPath(t){if(!t)return se(this.exerciseService.getIconPath("default-exercise"));let e=this.liveFormAsRoutine()?.exercises.find(i=>i.exerciseId===t);return e?this.exerciseService.getExerciseById(e.exerciseId).pipe(de(i=>{if(i){let r=this.exerciseService.determineExerciseIcon(i,i.name);return this.exerciseService.getIconPath(r)}else return this.exerciseService.getIconPath("default-exercise")})):se(this.exerciseService.getIconPath("default-exercise"))}checkTextClass(t,e){if(!t)return"text-gray-700 dark:text-gray-300";let i={type:"exact",value:0},r=0,o=0;if(e==="reps"?(i=t.repsLogged??i,o=Ai(t.targetReps)??Ai(Pi(0))):e==="duration"?(r=Yt(t.durationLogged)??0,o=Yt(t.targetDuration)??0):e==="weight"&&(r=Zt(t.weightLogged)??0,o=Zt(t.targetWeight)??0),e==="reps"){let s=i.type==="exact"?i.value:i.type==="range"?i.min:void 0;return s&&s>o?"text-green-500 dark:text-green-400":s&&s<o?"text-red-500 dark:text-red-400":"text-gray-800 dark:text-white"}else return r>o?"text-green-500 dark:text-green-400":r<o?"text-red-500 dark:text-red-400":"text-gray-800 dark:text-white"}notesModalsData=R(null);showNotesModal(t){this.notesModalsData.set(t)}expandExerciseCard(t,e){if(this.closeExerciseActionMenu(),e){let l=e.target;if(l.closest("button")||["INPUT","TEXTAREA","SELECT"].includes(l.tagName)||l.closest("#expandedExerciseSetsContainer"))return}if(e?.stopPropagation(),t<0||t>=this.exercisesFormArray.length){this.expandedExercisePath.set(null),this.expandedSetPath.set(null);return}let r=this.exercisesFormArray.at(t).get("supersetId")?.value,o=t;this.expandedExercisePath()?.exerciseIndex===o?(this.expandedExercisePath.set(null),this.expandedSetPath.set(null),this.expandedExerciseNotes.set(null)):(this.expandedExercisePath.set({exerciseIndex:o}),this.scrollExpandedExerciseIntoView())}getSetControl(t,e){return t.get("sets").at(e)}shouldShowExpandedExercise(t){return this.expandedExercisePath()?.exerciseIndex===t}isExerciseDetailModalOpen=R(!1);isSimpleModalOpen=R(!1);exerciseDetailsId="";exerciseDetailsName="";openModal(t,e){e?.stopPropagation(),this.exerciseDetailsId=t.exerciseId,this.exerciseDetailsName=t.exerciseName||"Exercise details",this.isSimpleModalOpen.set(!0)}isExerciseCardioOnlyCtrl(t){let e=t.value?.exerciseId;return this.isExerciseCardioOnly(e)}isExerciseCardioOnly(t){if(!t)return!1;let e=this.availableExercises.find(i=>i.id===t);return e&&e.category?e.category==="cardio":!1}handleEndTimeChange(){let t=this.builderForm.get("workoutDate"),e=this.builderForm.get("startTime"),i=this.builderForm.get("endTime");if(!t||!e||!i)return;let r=t.value,o=e.value,s=i.value;if(!r||!o||!s)return;let l=new Date(`${r}T${o}:00`),g=new Date(`${r}T${s}:00`);if(g.getTime()<l.getTime()){g.setDate(g.getDate()+1);let m=me(g,"yyyy-MM-dd");t.setValue(m,{emitEvent:!1}),this.toastService.info("End time was before start time, assuming next day")}}retrieveProgramInfo(t){this.availableIterationIds=this.retrieveProgramIterationIds(t),this.availableScheduledDayIds=this.retrieveProgramScheduledDayIds(t),this.availableScheduledDayInfos=this.retrieveProgramScheduledDayInfo(t)}isFormInvalid(){return this.builderForm.invalid||this.exercisesFormArray.length===0&&!(this.isRoutineMode&&this.builderForm.get("goal")?.value==="rest")}getSetTargetDisplay(t,e){let i=this.workoutUtilsService.getSetTargetDisplay(t,e);return i.length>15&&(i=i.substring(0,15)+"..."),i}changeSupersetType(t){return L(this,null,function*(){if(this.isViewMode||!(t instanceof pe))return;let e=t.get("supersetId")?.value;if(!e)return;let r=(t.get("supersetType")?.value||"standard")==="standard"?"emom":"standard",o=60;if(r==="emom"){let s=yield this.alertService.showPromptDialog("Set EMOM Time","Enter the time for each round in seconds (e.g., 60 for EMOM, 120 for E2MOM).",[{name:"emomTime",type:"number",value:"60",attributes:{min:"10",required:!0}}]);if(s&&s.emomTime)o=Number(s.emomTime);else return}else o=null;this.ngZone.run(()=>{this.syncSupersetProperties(e,r,o),this.toastService.success(`Superset converted to ${r.toUpperCase()}`,3e3,"Type Changed"),this.expandedSetPath.set(null),this.toggleSetExpansion(this.getExerciseIndexByControl(t),0),this.cdr.detectChanges()})})}getExerciseIndexByControl(t){return this.exercisesFormArray.controls.findIndex(e=>e===t)}getSetIndexByControl(t){let e=t.parent;return e&&e.controls?e.controls.indexOf(t):-1}getSetPathByControl(t){let e=t.parent;if(!e||!e.controls)return null;let i=e.controls.indexOf(t);if(i===-1)return null;let r=e.parent;if(!r||!r.parent)return null;let o=r.parent.controls.indexOf(r);return o===-1?null:{exerciseIndex:o,setIndex:i}}syncSupersetProperties(t,e,i){this.exercisesFormArray.controls.filter(o=>o.get("supersetId")?.value===t).forEach(o=>{let s=o,l=this.getExerciseIndexByControl(s);s.patchValue({supersetType:e,emomTimeSeconds:i},{emitEvent:!1});let g=0;e==="standard"&&this.isLastInSuperset(l)&&(g=60),this.workoutFormService.getSetsFormArray(s).controls.forEach(x=>{x.patchValue({targetRest:g},{emitEvent:!1})})}),this.cdr.detectChanges()}isFirstInSuperset(t){let e=this.exercisesFormArray.at(t);return e?.get("supersetId")?.value?e.get("supersetOrder")?.value===0:!1}getNumberOfRoundsAsArray(t){let i=this.exercisesFormArray.at(t).get("sets")?.length||0;return Array.from({length:i},(r,o)=>o)}isLastInSuperset(t){let e=this.exercisesFormArray.at(t),i=e?.get("supersetId")?.value,r=this.exercisesFormArray.controls.filter(s=>s.get("supersetId")?.value===i).length,o=e?.get("supersetOrder")?.value;return!i||r==null||o==null?!1:o===r-1}isMiddleInSuperset(t){return this.exercisesFormArray.at(t)?.get("supersetId")?.value?!this.isFirstInSuperset(t)&&!this.isLastInSuperset(t):!1}getIndexOfExercise(t){return this.exercisesFormArray.controls.indexOf(t)}getSupersetGroupExercises(t){let i=this.exercisesFormArray.at(t)?.get("supersetId")?.value;return i?this.exercisesFormArray.controls.filter(r=>r.get("supersetId")?.value===i).sort((r,o)=>(r.get("supersetOrder")?.value??0)-(o.get("supersetOrder")?.value??0)):[]}standarSuperSetOrEmomClass(t,e=!1){let i=" absolute -left-2 top-2 text-white text-xs font-bold rounded-xl shadow-lg z-10 transform translate-x-3 -translate-y-6 p-1";return t.get("supersetType")?.value=="emom"?e?"font-bold text-teal-600 dark:text-teal-400":i+" bg-teal-400 text-white":t.get("supersetType")?.value!=="emom"?e?"font-bold text-primary":i+" bg-primary text-white":""}setLabelClass(t){let e="flex text-white text-xl font-bold rounded-xl shadow-lg z-10 p-1 w-full bg-primary justify-between items-center";return t.get("supersetType")?.value=="emom"?e+" bg-teal-400 text-white":t.get("supersetType")?.value!=="emom"?e+" bg-primary text-white":""}standarSuperSetOrEmomLabel(t){let e=t.get("sets")?.value?.length||1,i=e>1?` (${e} ROUNDS)`:` (${e} ROUND)`;return t.get("supersetType")?.value=="emom"?`EMOM${i} - Every ${t.get("emomTimeSeconds")?.value||60}s`:t.get("supersetType")?.value!=="emom"?`SUPERSET${i}`:""}convertToSingleExerciseEmom(t,e){return L(this,null,function*(){if(this.isViewMode||!(t instanceof pe))return;e?.stopPropagation();let i=this.getExerciseIndexByControl(t);this.expandExerciseCardIfNeeded(i);let r=[{name:"emomTime",type:"number",label:"Time per Round (s)",value:"60",attributes:{min:"10",required:!0}},{name:"numSets",type:"number",label:"Number of Rounds (Sets)",value:"10",attributes:{min:"1",required:!0}}],o=yield this.alertService.showPromptDialog("Create Single-Exercise EMOM","Configure EMOM parameters.",r);if(!o||!o.emomTime||!o.numSets)return;let s=Number(o.emomTime),l=Number(o.numSets),g=t.get("sets"),m=g.length>0?A({},g.at(0).value):{id:U(),type:"standard",targetReps:8,targetRest:60};delete m.id,g.clear();for(let x=0;x<l;x++)g.push(this.workoutFormService.createSetFormGroup(m,!1));t.patchValue({supersetId:U(),supersetOrder:0,supersetType:"emom",emomTimeSeconds:s,type:"superset"})})}isEmomExerciseByIndex(t){let e=this.exercisesFormArray.at(t);return this.isEmom(e)}isEmomExercise(t){let e=this.getExerciseIndexByControl(t),i=this.exercisesFormArray.at(e),r=this.isEmom(i);return t.get("supersetType")?.value==="emom"||r}isStandardSupersetExercise(t){return t.get("supersetType")?.value==="standard"}addRoundToSuperset(t,e){if(e.stopPropagation(),this.isViewMode)return;let i=t.get("supersetId")?.value;if(!i)return;this.exercisesFormArray.controls.forEach(o=>{let s=o;if(s.get("supersetId")?.value===i){let l=this.workoutFormService.getSetsFormArray(s),g=this.createSyncedSet(l,o),m=this._getCorrectRestForSupersetExercise(s);g.get("targetRest")?.setValue(m,{emitEvent:!1}),l.push(g)}}),this.toastService.success("Round added to superset.",2e3);let r=this.getExerciseIndexByControl(t);this.handleAnimationForNewSet(r)}removeRoundFromSuperset(t,e){if(e.stopPropagation(),this.isViewMode)return;let i=t.get("supersetId")?.value;i&&(this.exercisesFormArray.controls.forEach(r=>{let o=r;if(o.get("supersetId")?.value===i){let s=this.workoutFormService.getSetsFormArray(o);s.length>1&&s.removeAt(s.length-1)}}),this.toastService.info("Round removed from superset.",2e3))}isEmom(t){return t.get("supersetType")?.value==="emom"}checkIfWeightIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetWeight,"weight");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfRepsIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetReps,"reps");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfDistanceIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetDistance,"distance");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfDurationIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetDuration,"duration");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfRestIsVisible(t){if(!t)return!1;let e=i=>this.workoutUtilsService.isTargetVisible(i?.targetRest,"rest");if(typeof t.get=="function"){let i=typeof t.getRawValue=="function"?t.getRawValue():t.value;return i&&Array.isArray(i.sets)?i.sets.some(e):e(i)}return t.sets&&Array.isArray(t.sets)?t.sets.some(e):e(t)}checkIfNotesIsVisible(t){return t?typeof t.get=="function"?typeof t.getRawValue=="function"&&t.getRawValue()&&t.getRawValue().sets?t.getRawValue().sets.some(e=>!!e.notes):!!t.get("notes")?.value:!!t.notes:!1}getGridColsForViewExercise(t){let e=this.isEmom(t),i=1,r=t.get("sets");if(r&&r.length>0){let l=this.getIndexOfExercise(t),g=this.getVisibleColumnsForExercise(l);g.reps&&i++,g.weight&&i++,g.distance&&i++,g.duration&&i++,g.rest&&i++,this.checkIfNotesIsVisible(t)&&i++}let o;switch(i){case 1:o="grid-cols-1";break;case 2:o="grid-cols-2";break;case 3:o="grid-cols-3";break;case 4:o="grid-cols-4";break;case 5:o="grid-cols-5";break;case 6:o="grid-cols-6";break;case 7:o="grid-cols-7";break;default:o="grid-cols-2"}return`grid ${o}`}activeExerciseActionMenu=R(null);isExerciseActionMenuVisible(t){return this.activeExerciseActionMenu()===t}toggleExerciseActionMenu(t,e){e.stopPropagation(),this.activeExerciseActionMenu.update(i=>i===t?null:t)}closeExerciseActionMenu(){this.activeExerciseActionMenu.set(null)}fabMenuItems=[];refreshFabMenuItems(){let t=this.isRoutineMode?!!this.currentRoutineId:!!this.isNewMode,e={label:"fab.start",actionKey:"start",iconName:"play",cssClass:"bg-blue-400 focus:ring-blue-600",isPremium:!1};if(this.isEditableMode()){if(this.fabMenuItems=[{label:"fab.add_exercise",actionKey:"add_exercise",iconName:"plus-circle",cssClass:"bg-green-500 focus:ring-green-400",isPremium:!1},{label:this.mode==="routineBuilder"?"fab.save_routine":this.isNewMode?"fab.save_log":"fab.save_log_changes",actionKey:"save_routine",iconName:"save",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1}],this.canRestore()&&this.fabMenuItems.unshift({label:"fab.restore",actionKey:"restore",iconName:"restore",cssClass:"bg-red-500 focus:ring-red-400"}),this.canRedo()){let r=this.nextRedoAction;this.fabMenuItems.unshift({label:this.translate.instant("fab.redo")+(r?` (${r})`:""),actionKey:"redo",iconName:"redo",cssClass:"bg-blue-500 focus:ring-blue-400"})}if(this.canUndo()){let r=this.nextUndoAction;this.fabMenuItems.unshift({label:this.translate.instant("fab.undo")+(r?` (${r})`:""),actionKey:"undo",iconName:"undo",cssClass:"bg-yellow-500 focus:ring-yellow-400"})}this.subscriptionService.canAccess("workout_generator")&&this.fabMenuItems.unshift({label:"fab.generate",actionKey:"generate_workout",iconName:"magic-wand",cssClass:"bg-purple-500 focus:ring-purple-400",isPremium:!0});let i=this.liveFormAsRoutine()?.id||"";i&&this.workoutService.getRoutineById(i).pipe(we(1)).subscribe(r=>{r&&this.fabMenuItems.push(e)})}else this.fabMenuItems=[{label:"fab.start",actionKey:"start",iconName:"play",cssClass:"bg-blue-400 focus:ring-blue-600",isPremium:!1},{label:"fab.edit",actionKey:"edit",iconName:"edit",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1}]}onFabAction(t){switch(t){case"add_exercise":this.openExerciseSelectionModal();break;case"save_routine":this.onSubmit();break;case"start":this.startCurrentWorkout();break;case"edit":let e=this.liveFormAsRoutine()?.id;if(!e)return;this.checkEditRoutine(e);break;case"undo":this.undoLastChange();break;case"redo":this.redoLastChange();break;case"restore":this.restoreOriginal();break;case"generate_workout":this.openWorkoutGenerator();break;case"regenerate_workout":this.regenerateWorkout();break}}regenerateWorkout(){return L(this,null,function*(){let t=this.lastGenerationOptions();t?yield this.handleWorkoutGeneration(t):yield this.handleWorkoutGeneration("quick")})}resetTemplateAndStardWizard(){this.showCreationWizard()}isSwitchExerciseModalOpen=R(!1);exerciseToSwitchIndex=R(null);isShowingSimilarInSwitchModal=R(!1);exercisesForSwitchModal=R([]);handleExerciseActionMenuItemClick(t,e,i){switch(t.actionKey){case"ungroup":this.ungroupSuperset(e);break;case"make_emom":this.convertToSingleExerciseEmom(i);break;case"switchExercise":this.openSwitchExerciseModal(e);break;case"fill_latest":this.fillWithLatestPerformanceData(e);break;case"toggle_notes":this.toggleExerciseNotes(e);break;case"remove":this.removeExercise(e);break}this.closeExerciseActionMenu()}getExerciseActionMenuItems(t){let e=[],i=!!t.get("supersetId")?.value,r=this.getExerciseIndexByControl(t),o=this.isFirstInSuperset(r);return i?o&&e.push({label:this.translate.instant("actionButtons.ungroup"),buttonClass:"bg-purple-500 text-white hover:bg-purple-700",actionKey:"ungroup",iconName:"ungroup"}):(e.push({label:this.translate.instant("workoutBuilder.exercise.remove"),buttonClass:"bg-red-500 text-white hover:bg-red-700",actionKey:"remove",iconName:"trash"}),e.push({label:this.translate.instant("workoutBuilder.exercise.fillWithLast"),buttonClass:"bg-green-500 text-white hover:bg-green-700 text-left",actionKey:"fill_latest",iconName:"task"}),e.push({label:this.translate.instant("workoutBuilder.exercise.toggleNotes"),buttonClass:"bg-yellow-500 text-gray-500 hover:bg-yellow-700 rounded-full focus:outline-none flex items-center p-2 transition-colors",actionKey:"toggle_notes",iconName:"clipboard-list"}),e.push({label:"Make EMOM",buttonClass:"bg-teal-500 text-white hover:bg-teal-700",actionKey:"make_emom",iconName:"clock"}),e.push({label:"Switch Exercise",buttonClass:"bg-blue-500 text-white hover:bg-blue-700",actionKey:"switchExercise",iconName:"change"})),e}openSwitchExerciseModal(t,e){e?.stopPropagation(),this.exerciseToSwitchIndex.set(t),this.exercisesForSwitchModal.set(this.availableExercises),this.isShowingSimilarInSwitchModal.set(!1),this.modalSearchTerm.set(""),this.isSwitchExerciseModalOpen.set(!0)}closeSwitchExerciseModal(){this.isSwitchExerciseModalOpen.set(!1),this.exerciseToSwitchIndex.set(null)}findAndShowSimilarExercises(){return L(this,null,function*(){let t=this.exerciseToSwitchIndex();if(t===null)return;let i=this.exercisesFormArray.at(t).get("exerciseId")?.value,r=this.availableExercises.find(o=>o.id===i);if(!r){this.toastService.error("Could not find the base exercise to search for similar ones.");return}try{let o=yield he(this.exerciseService.getSimilarExercises(r,12));o.length===0&&this.toastService.info("No similar exercises found."),this.exercisesForSwitchModal.set(o),this.isShowingSimilarInSwitchModal.set(!0)}catch{this.toastService.error("Failed to load similar exercises.")}})}onBackToSearchFromSimilar(){this.exercisesForSwitchModal.set(this.availableExercises),this.isShowingSimilarInSwitchModal.set(!1),this.modalSearchTerm.set("")}handleExerciseSwitch(t){let e=this.exerciseToSwitchIndex();if(e===null)return;let i=this.exercisesFormArray.at(e),r=i.get("exerciseName")?.value;i.patchValue({exerciseId:t.id,exerciseName:t.name}),this.toastService.success(`Switched '${r}' to '${t.name}'.`),this.closeSwitchExerciseModal()}expandAllSets(){this.isViewMode&&(this.expandedSetPath.set(null),this.isAllExpandedInViewMode.set(!0))}collapseAllSets(){this.isViewMode&&(this.expandedSetPath.set(null),this.isAllExpandedInViewMode.set(!1))}removeLastSet(t,e){return L(this,null,function*(){if(e.stopPropagation(),this.isViewMode)return;let i=this.workoutFormService.getSetsFormArray(t);if(i.length===0)return;let r=this.getExerciseIndexByControl(t),o=i.length-1;yield this.removeSet(t,r,o,e)})}fillWithLatestPerformanceData(t,e){return L(this,null,function*(){if(this.isViewMode){this.toastService.info("Cannot modify data in view mode.",3e3);return}e?.stopPropagation(),this.expandExerciseCardIfNeeded(t);let i=this.exercisesFormArray.at(t);if(!i){console.error(`Exercise control at index ${t} not found.`);return}let r=i.get("exerciseId")?.value;if(!r){this.toastService.warning("Please select an exercise first.",3e3);return}this.spinnerService.show("Loading last performance...");try{let o=yield he(this.trackingService.getLastPerformanceForExercise(r));if(!o||o.sets.length===0){this.toastService.info("No recent performance data found for this exercise.",3e3);return}this.workoutFormService.getSetsFormArray(i).controls.forEach((l,g)=>{let m=o.sets[g];if(m){let x={},v=m.weightLogged!=null?this.unitService.convertWeight(Zt(m.weightLogged),this.unitService.currentWeightUnit(),"kg"):null;this.mode==="manualLogEntry"?(x.repsLogged=m.repsLogged,x.weightLogged=v,x.durationLogged=m.durationLogged,x.distanceLogged=m.distanceLogged,x.tempoLogged=m.tempoLogged):(x.targetReps=m.repsLogged,x.targetWeight=v,x.targetDuration=m.durationLogged,x.targetDistance=m.distanceLogged,x.targetTempo=m.tempoLogged),l.patchValue(x)}}),this.builderForm.markAsDirty(),this.toastService.success("Sets pre-filled with your last performance data.",3e3,"Success")}catch(o){console.error("Failed to load performance data:",o),this.toastService.error("Could not load performance data.",0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}})}getSetDistanceDisplay(t){function e(i){return i!=null}if(!t||!t.value||!t.value.sets||t.value.sets.length===0)return"";if(this.mode==="manualLogEntry"){let i=t.getRawValue();if(!i.sets||i.sets.length===0)return"";let r=[];for(let o of i.sets){let s=o?.distanceLogged;if(s==null)continue;let l=this.workoutUtilsService.getDistanceValue(s);typeof l=="number"&&l>0&&(s.type==="exact"?r.push(String(s.value)):s.type==="range"&&r.push(`${s.min}-${s.max}`))}return r.length>0?r.join("-"):""}else return this.workoutFormService.getSetsFormArray(t).controls.map(s=>this.getSetDisplayValue(s,"distance")).filter(s=>s&&s!=="-").join(", ")}cardColors=["#7f1d1d","#86198f","#4a044e","#1e1b4b","#1e3a8a","#064e3b","#14532d","#b91c1c","#c026d3","#701a75","#312e81","#2563eb","#047857","#15803d","#f97316","#ca8a04","#4d7c0f","#0f766e","#0369a1","#1d4ed8","#5b21b6"];openColorPicker(){return L(this,null,function*(){let t=this.liveFormAsRoutine();if(!t)return;let e=this.cardColors.map(r=>({text:"",role:"confirm",data:r,cssClass:"color-swatch",styles:{"background-color":r,width:"40px",height:"40px","border-radius":"50%",border:"2px solid white","box-shadow":"0 2px 4px rgba(0,0,0,0.2)"}}));e.push({text:"Clear Color",role:"confirm",data:"clear",cssClass:"bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 mt-4 col-span-5",icon:"trash"});let i=yield this.alertService.showConfirmationDialog(`Select a Color for "${t.name}"`,"",e,{customButtonDivCssClass:"grid grid-cols-5 gap-3 justify-center"});if(i&&i.data){i.data==="clear"?delete t.cardColor:t.cardColor=i.data;let r=yield this.workoutService.updateRoutine(t);this.toastService.success(`Color updated for "${t.name}"`)}})}getCardValueTextColor(){return"text-gray-700 dark:text-gray-200"}getCardTitleTextColor(){if(!this.liveFormAsRoutine()||this.liveFormAsRoutine()===void 0)return"";let t=this.liveFormAsRoutine();return t===void 0?"":t.cardColor?t.cardColor?"text-white":"":"text-gray-600 dark:text-gray-200"}previousGoalValue=null;getUniformSetValues(t){let e=this.workoutFormService.getSetsFormArray(t);if(!e||e.length===0)return null;let i=this.getIndexOfExercise(t),r=this.getVisibleColumnsForExercise(i),o=Object.keys(r).filter(v=>r[v]);if(o.length===0)return null;let s=e.at(0),l={};o.forEach(v=>{let k=this.getFormControlName(v),T=s.get(k);l[v]=T?this.workoutUtilsService.formatMetricTarget(T.value,v):"-"});let g=new Set(o);for(let v=1;v<e.length;v++){let k=e.at(v);for(let T of Array.from(g)){let B=this.getFormControlName(T),M=k.get(B);(M?this.workoutUtilsService.formatMetricTarget(M.value,T):"-")!==l[T]&&g.delete(T)}if(g.size===0)break}let m={},x=!1;for(let v of g){let k=l[v];k&&k!=="-"&&(m[v]=k,x=!0)}return x?m:null}getFieldsForSet(t,e){let i=this.liveFormAsRoutine();return i?this.workoutUtilsService.getFieldsForSet(i,t,e):this.workoutUtilsService.defaultHiddenFields()}promptRemoveField(t,e){return L(this,null,function*(){let i=this.liveFormAsRoutine();if(!i)return;let r=this.mode==="manualLogEntry",o=yield this.workoutUtilsService.promptRemoveField(i,t,e,r);if(o){let s=o.exercises[t].sets[e],l=this.workoutFormService.getSetsFormArray(this.exercisesFormArray.at(t)),g=this.workoutFormService.createSetFormGroup(s,this.mode==="manualLogEntry");l.setControl(e,g)}})}promptAddField(t,e){return L(this,null,function*(){let i=this.liveFormAsRoutine();if(!i)return;let r=this.mode==="manualLogEntry",o=yield this.workoutUtilsService.promptAddField(i,t,e,r);if(o){let s=o.exercises[t].sets[e],l=this.workoutFormService.getSetsFormArray(this.exercisesFormArray.at(t)),g=this.workoutFormService.createSetFormGroup(s,this.mode==="manualLogEntry");l.setControl(e,g)}})}getVisibleColumnsForExercise(t){let e=this.liveFormAsRoutine();if(!e)return{};let i=this.mode==="manualLogEntry";return this.workoutUtilsService.getVisibleExerciseColumns(e,t,i)}getGridClassForExercise(t){let e=this.getVisibleColumnsForExercise(t),i=2;return e.reps&&i++,e.weight&&i++,e.distance&&i++,e.duration&&i++,e.rest&&i++,this.isEmomExerciseByIndex(t)||i+1,`grid-cols-${Math.max(2,i)}`}toggleExerciseNotes(t,e){e?.stopPropagation(),this.expandedExerciseNotes.update(i=>i===t?null:t),this.expandExerciseCardIfNeeded(t),setTimeout(()=>{document.getElementById(`exerciseNotes-${t}`)?.focus()},300)}expandExerciseCardIfNeeded(t){(!this.expandedExercisePath()||this.expandedExercisePath()?.exerciseIndex!==t)&&this.expandExerciseCard(t)}getCollapsedSetRowClass(t,e){let i=this.getVisibleColumnsForExercise(t),r=2;i.reps&&r++,i.weight&&r++,i.distance&&r++,i.duration&&r++,i.rest&&r++;let o=`grid-cols-${Math.max(2,r)}`,s=this.exercisesFormArray.at(t),g=this.workoutFormService.getSetsFormArray(s).at(e);if(!(g instanceof pe))return`grid ${o} bg-white dark:bg-gray-800`;let m=g.get("type")?.value,x="bg-white dark:bg-gray-800";return m==="standard"?x="bg-gray-50 dark:bg-gray-700/50":m==="warmup"&&(x="bg-blue-50 dark:bg-blue-900/40"),`grid ${o} ${x}`}undoLastChange(){if(!this.canUndo())return;this.isUndoingOrRedoing=!0,this.historyIndex--;let t=this.history[this.historyIndex];this.restoreFormState(t.state),this.toastService.info(this.translate.instant("workoutBuilder.toasts.undoSuccessful")),this.updateHistorySignals(),this.refreshFabMenuItems(),this.audioService.playSound("magic")}redoLastChange(){if(!this.canRedo())return;this.isUndoingOrRedoing=!0,this.historyIndex++;let t=this.history[this.historyIndex];this.restoreFormState(t.state),this.toastService.info(this.translate.instant("workoutBuilder.toasts.redoSuccessful")),this.updateHistorySignals(),this.refreshFabMenuItems()}restoreOriginal(){return L(this,null,function*(){if(!this.canRestore()||!this.originalStateSnapshot)return;let t=yield this.alertService.showConfirm("Restore Original","Are you sure you want to discard all changes and restore the routine to its original state?","Restore");t&&t.data&&(this.isUndoingOrRedoing=!0,this.restoreFormState(this.originalStateSnapshot),this.history=[JSON.parse(JSON.stringify(this.originalStateSnapshot))],this.historyIndex=0,this.toastService.success("Routine has been restored to its original state."),this.updateHistorySignals(),this.canRestore.set(!1)),this.refreshFabMenuItems()})}restoreFormState(t){if(!t)return;this.exercisesFormArray.clear({emitEvent:!1}),(t.exercises||[]).forEach(i=>{let r=this.workoutFormService.createExerciseFormGroup(i,!0,this.mode==="manualLogEntry");this.exercisesFormArray.push(r,{emitEvent:!1})}),this.builderForm.patchValue(t)}history=[];historyIndex=-1;MAX_HISTORY_SIZE=20;isUndoingOrRedoing=!1;canUndo=R(!1);canRedo=R(!1);canRestore=R(!1);originalStateSnapshot=null;updateHistorySignals(){this.canUndo.set(this.historyIndex>0),this.canRedo.set(this.historyIndex<this.history.length-1)}handleWorkoutGeneration(t){return L(this,null,function*(){this.isGeneratorModalOpen.set(!1),this.spinnerService.show("Generating your workout...");let e=null;try{if(t==="quick"?(this.lastGenerationOptions.set(null),e=yield this.workoutGeneratorService.generateQuickWorkout()):e=yield this.workoutGeneratorService.generateWorkout(t),!e){this.errorMessage.set("Could not generate a workout with the selected options. Please try different criteria."),this.isGeneratedRoutine.set(!1),this.lastGenerationOptions.set(null);return}t!=="quick"?this.lastGenerationOptions.set(t):this.lastGenerationOptions.set(null),this.patchFormWithRoutineData(e),this.builderForm.markAsDirty(),this.isGeneratedRoutine.set(!0),this.toastService.success("Workout generated successfully!")}catch(i){this.errorMessage.set(i.message||"An unknown error occurred during workout generation.")}finally{this.spinnerService.hide(),this.refreshFabMenuItems()}})}openWorkoutGenerator(){this.isGeneratorModalOpen.set(!0)}isPartOfExpandedSuperset(t){let i=this.exercisesFormArray.at(t)?.get("supersetId")?.value;if(!i)return!1;let r=this.exercisesFormArray.controls.findIndex(s=>s.get("supersetId")?.value===i&&s.get("supersetOrder")?.value===0);return this.expandedExercisePath()?.exerciseIndex===r}baseExercise(){let t=this.exercisesFormArray.length>0?this.exercisesFormArray.at(0).get("exerciseId")?.value:void 0;return this.availableExercises.find(e=>e.id===t)}isBodyweight=ve(()=>this.baseExercise()?.category==="bodyweightCalisthenics");isCardio=ve(()=>this.baseExercise()?.category==="cardio");expandedSetAllPanel=R(null);repsToSetForAll=R(null);weightToSetForAll=R(null);durationToSetForAll=R(null);distanceToSetForAll=R(null);restToSetForAll=R(null);tempoToSetForAll=R(null);toggleSetAllPanel(t,e){e.stopPropagation(),this.expandedSetAllPanel.update(i=>i===t?null:t)}repsStep=1;weightStep=.1;durationStep=5;distanceStep=.1;restStep=5;applyToAllSets(t){let e=this.exercisesFormArray.at(t),i=this.workoutFormService.getSetsFormArray(e),r={},o=[];function s(k,T,B=!1){if(k==null)return null;let M=Number(k);return isNaN(M)?null:(M=Math.abs(M),B?Math.round(M*100)/100:Math.round(M/T)*T)}let l=s(this.repsToSetForAll(),this.repsStep);if(l!==null){let k=this.mode==="manualLogEntry"?"repsLogged":"targetReps";r[k]=Tt(l),o.push("reps")}let g=s(this.weightToSetForAll(),this.weightStep,!0);if(g!==null){let k=this.mode==="manualLogEntry"?"weightLogged":"targetWeight";r[k]=ye(g),o.push("weight")}let m=s(this.durationToSetForAll(),this.durationStep);if(m!==null){let k=this.mode==="manualLogEntry"?"durationLogged":"targetDuration";r[k]=Oe(m),o.push("duration")}let x=s(this.distanceToSetForAll(),this.distanceStep);if(x!==null){let k=this.mode==="manualLogEntry"?"distanceLogged":"targetDistance";r[k]=Ge(x),o.push("distance")}let v=s(this.restToSetForAll(),this.restStep);if(v!==null){let k=this.mode==="manualLogEntry"?"restLogged":"targetRest";r[k]=ie(v),o.push("rest")}if(this.tempoToSetForAll()!==null&&this.tempoToSetForAll().trim()!==""&&(r.targetTempo=this.tempoToSetForAll(),o.push("tempo")),Object.keys(r).length===0){this.toastService.info("No values entered to apply.");return}i.controls.forEach(k=>{let T=k,B=T.get("fieldOrder")?.value?[...T.get("fieldOrder")?.value]:[],M=!1;o.forEach(P=>{let le=this.getFormControlName(P);if(le&&!T.get(le)&&(T.addControl(le,this.fb.control(null)),this.isRoutineMode&&["reps","weight","duration","distance","rest"].includes(P))){let z=P.charAt(0).toUpperCase()+P.slice(1);T.addControl(`target${z}Min`,this.fb.control(null)),T.addControl(`target${z}Max`,this.fb.control(null))}B.includes(P)||(B.push(P),M=!0)}),M&&T.get("fieldOrder")?.patchValue(B),T.patchValue(r)}),this.repsToSetForAll.set(null),this.weightToSetForAll.set(null),this.durationToSetForAll.set(null),this.distanceToSetForAll.set(null),this.restToSetForAll.set(null),this.tempoToSetForAll.set(null),this.expandedSetAllPanel.set(null),this.toastService.success(`Applied values to all ${i.length} sets/rounds.`)}_getCorrectRestForSupersetExercise(t){if(!(t instanceof pe))return 0;let e=t.get("supersetType")?.value,i=t.get("supersetId")?.value;if(e==="emom"||!i)return 0;if(e==="standard"){let r=this.getExerciseIndexByControl(t);if(this.isLastInSuperset(r))return 60}return 0}isDraggingEnabled(t){return this.isEditableMode()&&!this.shouldShowExpandedExercise(t)&&!this.isSuperSet(t)}metricEnum=Kt;repsTargetTypeEnum=Bi;restTargetTypeEnum=Jr;weightTargetTypeEnum=$r;durationTargetTypeEnum=Kr;distanceTargetTypeEnum=Yr;isGhostFieldVisible(t,e){return!!(this.isEditableMode()&&!this.isSuperSet(e)&&t&&t.length!==void 0&&(t.length<=1||t.length>2&&t.length%2==1))}intervalId=null;onShortPressIncrement(t,e){this.incrementValue(t,e)}onLongPressIncrement(t,e){this.isLongPressing=!0,this.intervalId=setInterval(()=>this.incrementValue(t,e),200)}onShortPressDecrement(t,e){this.decrementValue(t,e)}onLongPressDecrement(t,e){this.isLongPressing=!0,this.intervalId=setInterval(()=>this.decrementValue(t,e),200)}onPressRelease(){this.isLongPressing=!1,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}incrementValue(t,e){let i=this.appSettingsService.getSettings(),r=e==="weight",o=e==="duration"||e==="rest",s=r?i.weightStep||.5:1,l=this.getFormControlName(e),g=t.get(l);if(!g)return;let m=g.value;if(m&&typeof m=="object"&&m.type)switch(m.type){case"exact":case"min_plus":let v=m.seconds!==void 0?"seconds":"value";g.patchValue(N(A({},m),{[v]:Math.max(0,(m[v]||0)+s)}));break;case"range":o?g.patchValue(N(A({},m),{minSeconds:m.minSeconds!=null?Math.max(0,m.minSeconds+s):m.minSeconds,maxSeconds:m.maxSeconds!=null?Math.max(0,m.maxSeconds+s):m.maxSeconds})):g.patchValue(N(A({},m),{min:m.min!=null?Math.max(0,m.min+s):m.min,max:m.max!=null?Math.max(0,m.max+s):m.max}));break;case"percentage_1rm":g.patchValue(N(A({},m),{percentage:Math.min(100,(m.percentage||0)+s)}));break;default:break}else{let v=m?.toString()||"0",k=o?this.parseTimeToSeconds(v)||0:parseFloat(v)||0,T=parseFloat((k+s).toFixed(2));g.patchValue(T)}t.markAsDirty();let x=t.get("id")?.value;x&&!this.isLongPressing&&this.triggerAnimation(x)}decrementValue(t,e){let i=this.appSettingsService.getSettings(),r=e==="weight",o=e==="duration"||e==="rest",s=r?i.weightStep||.5:1,l=this.getFormControlName(e),g=t.get(l);if(!g)return;let m=g.value;if(m&&typeof m=="object"&&m.type)switch(m.type){case"exact":case"min_plus":let v=m.seconds!==void 0?"seconds":"value";g.patchValue(N(A({},m),{[v]:Math.max(1,(m[v]||0)-s)}));break;case"range":o?g.patchValue(N(A({},m),{minSeconds:m.minSeconds!=null?Math.max(1,m.minSeconds-s):m.minSeconds,maxSeconds:m.maxSeconds!=null?Math.max(1,m.maxSeconds-s):m.maxSeconds})):g.patchValue(N(A({},m),{min:m.min!=null?Math.max(1,m.min-s):m.min,max:m.max!=null?Math.max(1,m.max-s):m.max}));break;case"percentage_1rm":g.patchValue(N(A({},m),{percentage:Math.max(1,(m.percentage||0)-s)}));break;default:break}else{let v=m?.toString()||"0",k=o?this.parseTimeToSeconds(v)||0:parseFloat(v)||0,T=Math.max(0,parseFloat((k-s).toFixed(2)));g.patchValue(T)}t.markAsDirty();let x=t.get("id")?.value;x&&!this.isLongPressing&&this.triggerAnimation(x)}getFormControlName(t){let e=this.mode==="manualLogEntry";switch(t){case"reps":return e?"repsLogged":"targetReps";case"weight":return e?"weightLogged":"targetWeight";case"distance":return e?"distanceLogged":"targetDistance";case"duration":return e?"durationLogged":"targetDuration";case"rest":return e?"restLogged":"targetRest";case"tempo":return"targetTempo";default:return""}}getSetMetricDisplayValue(t,e){if(!(t instanceof pe))return"-";let i=this.getFormControlName(e),r=t.get(i);if(!r||r.value==null)return"-";let o=this.mode==="manualLogEntry";return this.workoutUtilsService.formatMetricTarget(r.value,e,o)}parseTimeToSeconds(t){if(!t)return 0;let e=t.toString().split(":").map(i=>parseInt(i,10)||0);return e.length===2?e[0]*60+e[1]:e[0]}getExerciseSetsLength(t){let e=this.exercisesFormArray.at(t);if(!e)return 0;let i=this.workoutFormService.getSetsFormArray(e);return i?i.length:0}updateTargetField(t,e,i,r){let o=t.get(e),s=o?.value;if(!o||!s)return;let l=r.target.value;if(l=l.replace(/[^0-9.]/g,""),l===""||isNaN(Number(l)))return;let g=Number(l);if(s.type==="range"){let m=N(A({},s),{[i]:g});o.patchValue(m)}else if(i==="value"&&(s.type==="exact"||s.type==="min_plus")){let m=N(A({},s),{value:g});o.patchValue(m)}t.markAsDirty()}incrementExactReps(t,e){let i=t.get("targetReps"),r=i?.value;if(!(!i||r?.type!=="exact"&&r?.type!=="min_plus")){if(r.type==="exact"){let o=Math.max(0,r.value+e),s=N(A({},r),{value:o});i.patchValue(s),t.markAsDirty()}else if(r.type==="min_plus"){let o=Math.max(0,r.value+e),s=N(A({},r),{value:o});i.patchValue(s),t.markAsDirty()}}}isAnimatingSet=R(null);animationTimeout=null;triggerAnimation(t){this.animationTimeout&&clearTimeout(this.animationTimeout),this.isAnimatingSet.set(t),this.animationTimeout=setTimeout(()=>{this.isAnimatingSet.set(null),this.animationTimeout=null},200)}newlyAddedSets=new Map;getMetricDisplayValue(t,e){let i=t.get(this.getTargetControlName(e))?.value,r=t.get(this.getLoggedControlName(e))?.value,o=this.isRoutineMode?i:r;return this.workoutUtilsService.formatMetricTarget(o,e)||"-"}getTargetControlName(t){switch(t){case"reps":return"targetReps";case"weight":return"targetWeight";case"duration":return"targetDuration";case"distance":return"targetDistance";case"rest":return"targetRest";default:return""}}getLoggedControlName(t){switch(t){case"reps":return"repsLogged";case"weight":return"weightLogged";case"duration":return"durationLogged";case"distance":return"distanceLogged";case"rest":return"restLogged";default:return""}}getMetricLabel(t){return"metrics."+Object.keys(Kt)[t]}BuilderMode=io;isLongPressing=!1;allAvailableMetrics=["reps","weight","distance","duration","rest"];isMetricActiveForAllSets(t,e){let i=this.exercisesFormArray.at(t);return this.workoutFormService.getSetsFormArray(i).controls.every(o=>(o.get("fieldOrder")?.value||[]).includes(e))}toggleMetricForAllSets(t,e){let i=this.exercisesFormArray.at(t),r=this.workoutFormService.getSetsFormArray(i),o=!this.isMetricActiveForAllSets(t,e);r.controls.forEach(s=>{let l=s.get("fieldOrder")?.value||[];if(o){if(!l.includes(e)){l=[...l,e],s.get("fieldOrder")?.setValue(l);let g=this.getTargetControlName(e),m=this.getLoggedControlName(e),x=s;if(x.contains(g)&&!x.get(g)?.value)switch(e){case"rest":x.get(g)?.setValue(ie(60));break;case"weight":x.get(g)?.setValue(ye(10));break;case"reps":x.get(g)?.setValue(Tt(8));break;case"distance":x.get(g)?.setValue(Ge(2));break;case"duration":x.get(g)?.setValue(Oe(45));break}if(x.contains(m)&&!x.get(m)?.value)switch(e){case"rest":x.get(m)?.setValue(ie(60));break;case"weight":x.get(m)?.setValue(ye(10));break;case"reps":x.get(m)?.setValue(Tt(8));break;case"distance":x.get(m)?.setValue(Ge(2));break;case"duration":x.get(m)?.setValue(Oe(45));break}}}else if(l.includes(e)){l=l.filter(v=>v!==e),s.get("fieldOrder")?.setValue(l);let g=this.getTargetControlName(e),m=this.getLoggedControlName(e),x=s;x.contains(g)&&x.get(g)?.setValue(null),x.contains(m)&&x.get(m)?.setValue(null)}}),o?this.toastService.success(this.translate.instant("workoutBuilder.set.metricAdded",{metric:this.translate.instant("metrics."+e)}),2e3):this.toastService.info(this.translate.instant("workoutBuilder.set.metricRemoved",{metric:this.translate.instant("metrics."+e)}),2e3)}setMetricsForAllSets(t,e){let i=this.exercisesFormArray.at(t);this.workoutFormService.getSetsFormArray(i).controls.forEach(o=>{o.get("fieldOrder")?.setValue([...e])})}getExactInputValue(t,e){let i=t.get(this.getFormControlName(e))?.value;return i?e==="duration"||e==="rest"?i.seconds??null:i.value??null:null}onExactInputChange(t,e,i){let r=i.target,o=r.value===""?null:Number(r.value);(o===null||isNaN(o)||o<1)&&(o=1,r.value="1");let s=t.get(this.getFormControlName(e)),l=s?.value;l&&(e==="duration"||e==="rest"?s.patchValue(N(A({},l),{seconds:o})):s.patchValue(N(A({},l),{value:o})),t.markAsDirty())}focusedInput={};onInputFocus(t,e){this.focusedInput[t+"-"+e]=!0}onInputBlur(t,e){this.focusedInput[t+"-"+e]=!1}isInputFocused(t,e){return!!this.focusedInput[t+"-"+e]}focusInput(t,e){setTimeout(()=>{let i=document.querySelector(`input[data-set-id="${t}"][data-field="${e}"]`);i&&i.focus()})}lastTouchY=null;onInputWheel(t,e,i){i.preventDefault(),i.deltaY<0?this.incrementValue(t,e):i.deltaY>0&&this.decrementValue(t,e)}onInputTouchStart(t){t.touches.length===1&&(this.lastTouchY=t.touches[0].clientY)}onInputTouchMove(t,e,i){if(i.preventDefault(),i.touches.length===1&&this.lastTouchY!==null){let r=i.touches[0].clientY,o=r-this.lastTouchY;Math.abs(o)>20&&(o<0?this.decrementValue(t,e):this.incrementValue(t,e),this.lastTouchY=r)}}selectInputText(t){setTimeout(()=>t.select(),0)}getSubmitButtonLabel(){return this.mode==="routineBuilder"?this.translate.instant("workoutBuilder.routineBuilder.saveButton"):this.mode==="customProgramEntryBuilder"?this.translate.instant("workoutBuilder.routineBuilder.saveCustomRoutineButton"):this.mode==="newFromLog"?this.translate.instant("workoutBuilder.routineBuilder.saveButton"):this.isNewMode?this.translate.instant("workoutBuilder.logEntry.logButton"):this.translate.instant("workoutBuilder.logEntry.saveLogButton")}showCreationWizard(){return L(this,null,function*(){let t=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.wizard.templateOrBlankTitle"),this.translate.instant("workoutBuilder.wizard.templateOrBlankMsg"),[{name:"routineTemplate",type:"radio",label:this.translate.instant("workoutBuilder.wizard.templateOrBlankLabel"),value:"blank",options:[{label:"Blank (Custom)",value:"blank"},{label:"3x3",value:"3x3"},{label:"5x5",value:"5x5"},{label:"Push/Pull/Legs",value:"ppl"},{label:"5/3/1",value:"531"}],required:!0}],this.translate.instant("alertService.buttons.ok"));if(!t||!t.routineTemplate)return;let e=String(t.routineTemplate);if(e!=="blank"){yield this.createRoutineFromTemplate(e);return}this.exercisesFormArray.clear();let i=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.routineBuilder.nameLabel"),this.translate.instant("workoutBuilder.routineBuilder.nameWizardMsg"),[{name:"routineName",type:"text",label:this.translate.instant("workoutBuilder.routineBuilder.nameLabel"),placeholder:this.translate.instant("workoutBuilder.routineBuilder.namePlaceholder"),required:!0,autofocus:!0}],this.translate.instant("alertService.buttons.ok"));if(!i||!i.routineName)return;let r=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.routineBuilder.goalLabel"),this.translate.instant("workoutBuilder.routineBuilder.goalWizardMsg"),[{name:"routineGoal",type:"select",label:this.translate.instant("workoutBuilder.routineBuilder.goalLabel"),value:"hypertrophy",options:this.routineGoals.map(o=>({label:this.translate.instant(o.label),value:o.value})),required:!0}],this.translate.instant("alertService.buttons.ok"));!r||!r.routineGoal||this.builderForm.patchValue({name:i.routineName,goal:r.routineGoal})})}createRoutineFromTemplate(t){return L(this,null,function*(){let e=this.workoutService.generateRoutineFromTemplate(t,this.availableExercises),i;if(e.length===1)i=e[0];else{let r=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.wizard.pickRoutineTitle"),this.translate.instant("workoutBuilder.wizard.pickRoutineMsg"),[{name:"routinePick",type:"select",label:this.translate.instant("workoutBuilder.wizard.pickRoutineLabel"),value:e[0].id,options:e.map(o=>({label:o.name,value:o.id})),required:!0}],this.translate.instant("alertService.buttons.ok"));if(!r||!r.routinePick)return;i=e.find(o=>o.id===r.routinePick)||e[0]}this.patchFormWithRoutineData(i),this.toastService.success(this.translate.instant("workoutBuilder.wizard.templateCreated"),3e3)})}getActionDescription(t,e){if(e.exercises.length>t.exercises.length)return"Added Exercise";if(e.exercises.length<t.exercises.length)return"Removed Exercise";let i=t.exercises.some(o=>o.supersetId);return e.exercises.some(o=>o.supersetId)&&!i?"Created Superset":"Edited Routine"}get nextUndoAction(){return this.historyIndex>0&&this.history[this.historyIndex]?.action||null}get nextRedoAction(){return this.historyIndex<this.history.length-1&&this.history[this.historyIndex+1]?.action||null}getSectionBadgeInfo(t){let e=t.get("section")?.value;return e?this.getSectionColorAndLabel(e):null}getSectionColorAndLabel(t){switch(t){case"WarmUp":return{label:"Warm Up",color:"#f59e0b"};case"MainLift":return{label:"Main Lift",color:"#ef4444"};case"Cardio":return{label:"Cardio",color:"#3b82f6"};case"Finisher":return{label:"Finisher",color:"#a855f7"};case"CoolDown":return{label:"Cool Down",color:"#10b981"};default:return{label:t,color:"#6b7280"}}}openSectionSelectionModal(){return L(this,null,function*(){if(this.isViewMode)return;let t=this.selectedExerciseIndicesForMultipleRemoval().sort((r,o)=>r-o);if(t.length===0)return;let e=Object.values(ir).map(r=>({label:r==="None"?"None (Remove from Section)":this.getSectionColorAndLabel(r).label,value:r})),i=yield this.alertService.showPromptDialog("Assign to Section","Select a section for the selected exercises:",[{name:"sectionType",type:"select",label:"Section",value:"none",options:e,required:!0}],"Assign");if(i&&i.sectionType){let r=i.sectionType==="none"?null:i.sectionType;t.forEach(o=>{let s=this.exercisesFormArray.at(o);s.contains("section")?s.patchValue({section:r}):s.addControl("section",this.fb.control(r)),s.markAsDirty()}),this.toastService.success(`Assigned ${t.length} exercises to ${r||"general list"}.`),this.selectedExerciseIndicesForMultipleRemoval.set([]),this.selectedExerciseIndicesForSuperset.set([])}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=De({type:n,selectors:[["app-workout-builder"]],viewQuery:function(e,i){if(e&1&&(Re(vs,5),Re(ys,5),Re(bs,5),Re(ws,5)),e&2){let r;Be(r=Pe())&&(i.myExerciseInput=r.first),Be(r=Pe())&&(i.setRepsInputs=r),Be(r=Pe())&&(i.expandedSetElements=r),Be(r=Pe())&&(i.expandedExerciseCard=r)}},inputs:{context:"context",initialRoutine:"initialRoutine",mode:"mode"},outputs:{routineConfirmed:"routineConfirmed",modalClose:"modalClose"},features:[Ve([Er])],decls:32,vars:39,consts:[["tempoInputTemplate",""],["incrementerInputTemplate",""],["metricInputTemplate",""],["notPerformedYet",""],["expandedExerciseCard",""],["superSetControlPanel_Info",""],["detailedSetView",""],["uniformValues",""],["noNotes",""],["allSetEditingPanel",""],["setElement",""],["expandedSetElement",""],["superSetControlPanel_rounds",""],["exerciseActionMenuContainer",""],["inputElem",""],["class","my-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-xl dark:bg-red-900/30 dark:border-red-600 dark:text-red-300",4,"ngIf"],[1,"container","mx-auto",3,"ngClass"],[1,"flex","items-center","justify-between","p-2"],[1,"flex","justify-between","items-center"],[1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],["name","back"],[1,"w-10","h-10"],[1,"flex","items-center","space-x-2","flex-shrink-0"],[4,"ngIf"],[1,"space-y-6","mb-6","p-1","rounded-xl","shadow-xl","overflow-hidden","min-h-screen",3,"formGroup"],[1,"space-y-2","p-2","rounded-xl","shadow-sm","dark:shadow-none","text-gray-700","dark:text-gray-200"],["class","p-4 bg-blue-50 dark:bg-blue-900/30 rounded-xl text-center",4,"ngIf"],["class","py-2 px-1 flex-col gap-2 flex items-center sticky bottom-0",4,"ngIf"],["itemIconName","plus-circle","itemIconClass","text-primary dark:text-primary-light",3,"searchTermChange","exercisesSelected","createCustomClicked","close","isOpen","searchTerm","isMultiSelect","title","exercises","customPB"],["itemIconName","change","itemIconClass","text-green-500",3,"searchTermChange","exerciseSelected","findSimilarClicked","backToSearchClicked","close","isOpen","searchTerm","title","exercises","searchPlaceholder","showSimilarButton","isShowingSimilarView","customPB"],[3,"isOpen","modalTitle","isOpenChange",4,"ngIf"],[3,"forceFullScreen","isOpen","modalTitle","isOpenChange",4,"ngIf"],[3,"actionClicked","actions","checkForPausedSession","scrollToBottomDisabled","scrollToTopDisabled"],[3,"close","generate","isOpen","customPB"],[1,"hidden","p-2.5"],[1,"my-4","p-3","bg-red-100","border","border-red-400","text-red-700","rounded-xl","dark:bg-red-900/30","dark:border-red-600","dark:text-red-300"],["class","relative",4,"ngIf"],[1,"relative"],["appBumpClick","",1,"text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-full","focus:outline-none","flex","items-center",3,"click"],["name","menu-action",1,"h-10","w-10"],["displayMode","dropdown",3,"gridClass","items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","gridClass","items","isVisible"],["class","text-gray-700 dark:text-gray-200",4,"ngIf"],["class","mt-2",4,"ngIf"],[4,"ngIf","ngIfElse"],["class","text-m text-gray-500 dark:text-gray-300",4,"ngIf"],[1,"block","text-xl","font-black","text-gray-700","dark:text-gray-200"],[1,"text-gray-700","dark:text-gray-200"],["for","routineName",1,"block","text-m","font-medium"],["type","text","id","routineName","formControlName","name",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-600","dark:border-gray-500",3,"placeholder","ngClass"],["class","text-red-500 dark:text-red-400 text-xs mt-1",4,"ngIf"],[1,"text-red-500","dark:text-red-400","text-xs","mt-1"],[1,"mt-1","block","w-full","shadow-sm","dark:shadow-none","text-gray-700","dark:text-gray-200",3,"innerHTML"],["for","description",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],[1,"block","text-m","text-gray-700","dark:text-gray-300"],[1,"font-medium"],["for","goal",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","goal","formControlName","goal",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","primaryCategory",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["id","primaryCategory","formControlName","primaryCategory",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","text-gray-700","dark:text-gray-200"],["for","secondaryCategory",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["type","text","id","secondaryCategory","formControlName","secondaryCategory",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","text-gray-700","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],[1,"mt-2"],[1,"flex","items-center","gap-2","flex-wrap"],[1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["class","bg-gray-200 text-gray-700 dark:bg-gray-600 text-gray-700 dark:text-gray-200 text-xs font-semibold px-2 py-1 rounded-full",4,"ngFor","ngForOf"],[1,"bg-gray-200","text-gray-700","dark:bg-gray-600","text-gray-700","dark:text-gray-200","text-xs","font-semibold","px-2","py-1","rounded-full"],["for","tags",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-200"],["type","text","id","tags","formControlName","tags",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","text-gray-700","dark:text-gray-200",3,"placeholder"],[1,"text-m","text-gray-500","dark:text-gray-300"],["class","text-sm text-gray-500 dark:text-gray-300 flex gap-1",4,"ngIf"],[1,"text-sm","text-gray-500","dark:text-gray-300","flex","gap-1"],[1,"text-sm","text-gray-500","dark:text-gray-300","italic","flex","gap-1","mb-2"],["class","flex items-center justify-between py-2",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","workoutDate",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","date","id","workoutDate","formControlName","workoutDate",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngClass"],["for","startTime",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","time","id","startTime","formControlName","startTime",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngClass"],["for","endTime",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","time","id","endTime","formControlName","endTime",1,"mt-1","block","w-full","p-2","border","rounded-xl","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"change","ngClass"],["for","logWorkoutName",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","logWorkoutName","formControlName","name",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],["for","routineIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","routineIdForLog","formControlName","routineIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["for","programIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","programIdForLog","formControlName","programIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["for","overallNotesLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","overallNotesLog","formControlName","overallNotesLog","rows","2",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],[1,"flex","items-center","justify-between","py-2"],[1,"text-2xl","font-bold","text-gray-800","dark:text-gray-200"],["for","iterationIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["class","text-xs text-red-500 dark:text-primary-light",4,"ngIf"],["id","iterationIdForLog","formControlName","iterationIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"text-xs","text-red-500","dark:text-primary-light"],["for","scheduledDayIdForLog",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","scheduledDayIdForLog","formControlName","scheduledDayIdForLog",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["cdkDropList","","formArrayName","exercises","class","exercise-list-container",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],["class","text-center text-gray-500 dark:text-gray-400 border border-dashed dark:border-gray-700 rounded-xl mt-4",4,"ngIf"],["class","text-center py-4 text-gray-500 dark:text-gray-400",4,"ngIf"],["cdkDropList","","formArrayName","exercises",1,"exercise-list-container",3,"cdkDropListDropped","cdkDropListData","cdkDropListDisabled"],[4,"ngFor","ngForOf"],["appClickOutside","",1,"relative","group","exercise-card-wrapper",3,"clickOutside","ngClass"],["class","absolute left-1/2 -translate-x-1/2 z-20 flex space-x-2","style","top: -1.8rem;",4,"ngIf"],["cdkDrag","","appLongPressDrag","","longPressClass","is-long-pressing",1,"transition-all",3,"click","cdkDragDisabled","dragHandleSelector","longPressEnabled","longPressDelay","cdkDragData","cdkDragStartDelay","formGroupName","title"],["class","absolute -right-2 top-2 z-20 transform translate-x-1 -translate-y-5",4,"ngIf"],["class","flex flex-col items-end space-y-2 flex-shrink-0 w-full sm:w-auto",4,"ngIf"],[1,"exercise-item-content"],["class","px-2 text-xl font-medium mt-0.5",3,"ngClass",4,"ngIf"],[1,"flex","items-center","space-x-1","pt-1","px-1"],["data-drag-handle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 flex item-center cursor-move rounded-xl",3,"title",4,"ngIf"],["type","checkbox","class","h-6 w-6 text-orange-600 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-orange-500 flex-shrink-0 disabled:opacity-50",3,"title","id","checked","change",4,"ngIf"],["class","flex-grow min-w-0 py-2 px-0",4,"ngIf"],["class","p-2",4,"ngIf"],["class","flex items-center justify-center py-2",4,"ngIf"],[1,"absolute","top-1","right-1","z-20",3,"ngClass"],["class","flex items-center space-x-1",4,"ngIf"],[1,"absolute","left-1/2","-translate-x-1/2","z-20","flex","space-x-2",2,"top","-1.8rem"],["type","button","class","bg-red-600 hover:bg-red-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button","class","bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px] flex items-center justify-center",3,"click",4,"ngIf"],["type","button","class","bg-green-600 hover:bg-green-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button","class","bg-violet-600 hover:bg-violet-700 text-white text-xs font-semibold py-1.5 px-3 rounded-lg shadow-lg min-w-[100px]",3,"click",4,"ngIf"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],["type","button",1,"bg-indigo-600","hover:bg-indigo-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]","flex","items-center","justify-center",3,"click"],["name","bookmark",1,"h-4","w-4","mr-1"],["type","button",1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],["type","button",1,"bg-violet-600","hover:bg-violet-700","text-white","text-xs","font-semibold","py-1.5","px-3","rounded-lg","shadow-lg","min-w-[100px]",3,"click"],[1,"absolute","-right-2","top-2","z-20","transform","translate-x-1","-translate-y-5"],[1,"text-[10px]","uppercase","font-black","px-2","py-0.5","rounded-md","text-white","shadow-sm",3,"ngStyle"],[1,"flex","flex-col","items-end","space-y-2","flex-shrink-0","w-full","sm:w-auto"],[1,"p-2","bg-gray-100","dark:bg-gray-800","rounded-lg","shadow-sm","w-full"],[1,"flex","items-center","gap-x-2"],[1,"text-sm","font-semibold","text-gray-700","dark:text-gray-300"],[1,"text-lg","text-gray-900","dark:text-white"],[1,"flex","items-center","justify-start"],[1,"text-sm","ml-1",3,"ngClass"],["appBumpClick","","type","button",1,"flex","items-center","ml-2","text-xs","font-semibold","text-white","hover:underline","bg-blue-300","hover:bg-blue-500","rounded-xl","p-1",3,"click"],["name","change",1,"h-5","w-5","mr-1"],["class","col-span-2 flex items-center gap-x-2",4,"ngIf"],[1,"col-span-2","flex","items-center","gap-x-2"],[1,"text-sm","font-semibold","text-gray-700","dark:text-gray-300","flex-shrink-0",3,"for"],["type","number","formControlName","emomTimeSeconds","min","10",1,"w-full","p-1","mt-1","text-m","border-gray-300","dark:border-gray-500","rounded-xl","focus:ring-primary","dark:bg-gray-600","dark:text-gray-200","text-right",3,"id"],[1,"px-2","text-xl","font-medium","mt-0.5",3,"ngClass"],["data-drag-handle","",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","flex","item-center","cursor-move","rounded-xl",3,"title"],["name","reorder"],["type","checkbox",1,"h-6","w-6","text-orange-600","border-gray-300","dark:border-gray-600","rounded-xl","focus:ring-orange-500","flex-shrink-0","disabled:opacity-50",3,"change","title","id","checked"],[1,"flex-grow","min-w-0","py-2","px-0"],["class","flex items-center text-s text-gray-500 dark:text-gray-400 mt-0.5 gap-4 pl-2",4,"ngIf"],[1,"flex","items-center","text-s","text-gray-500","dark:text-gray-400","mt-0.5","gap-4","pl-2"],[1,"min-w-0"],[1,"flex"],[1,"font-semibold","text-gray-800","dark:text-gray-100","text-wrap","text-lg","max-exercise-length",3,"title"],["name","info","class","h-4 w-4 text-gray-400 dark:text-gray-300 cursor-help","width","20","height","20","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",3,"click",4,"ngIf"],[1,"text-xl","text-gray-500","dark:text-gray-400","truncate"],["name","info","width","20","height","20","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"h-4","w-4","text-gray-400","dark:text-gray-300","cursor-help",3,"click"],[1,"max-w-[250px]","sm:max-w-full","text-wrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"ml-1"],["class","mx-2",4,"ngIf"],[1,"mx-2"],["class","mx-1",4,"ngIf"],["class","inline-flex items-center",4,"ngIf"],[1,"mx-1"],[1,"inline-flex","items-center"],["name","duration",1,"h-4","w-4","mr-1"],["name","rest",1,"h-4","w-4","mr-1"],[1,"p-2"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","pb-2","pt-1","px-1","sm:pt-0","rounded-xl","bg-gray-100","dark:bg-gray-800",3,"click","ngClass"],[1,"flex-grow"],["class","text-xs font-mono block mb-1",3,"ngClass",4,"ngIf"],[1,"flex","items-center"],["alt","Exercise Icon",1,"object-contain","mr-3","flex-shrink-0",3,"src","ngClass"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-100","max-exercise-length"],["class","gap-x-2 gap-y-2 px-2 py-2 bg-white rounded-xl rounded-t-none dark:bg-gray-800 text-gray-900 dark:text-white ",3,"ngClass",4,"ngIf"],["class","space-y-1","id","expandedExerciseSetsContainer",4,"ngIf"],[1,"text-xs","font-mono","block","mb-1",3,"ngClass"],[1,"block","text-s","font-medium","text-gray-600","dark:text-gray-400","mb-0.5",3,"for"],["formControlName","notes","rows","1","appAutoGrow","",1,"mt-0.5","mb-2","block","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"id","readonly"],[1,"gap-x-2","gap-y-2","px-2","py-2","bg-white","rounded-xl","rounded-t-none","dark:bg-gray-800","text-gray-900","dark:text-white",3,"ngClass"],[1,"font-bold","text-xs","uppercase","text-gray-500","dark:text-gray-400","text-center"],["class","font-bold text-xs uppercase text-gray-500 dark:text-gray-400 text-center",4,"ngIf"],[1,"font-medium","flex","items-center","justify-center"],["class","flex items-center justify-center",4,"ngIf"],["class","col-span-full h-px bg-gray-200 dark:bg-gray-700",4,"ngIf"],[1,"flex","items-center","justify-center"],[1,"cursor-pointer",3,"click"],["name","clipboard-list",1,"h-8","w-8","text-gray-500","dark:text-white"],[1,"col-span-full","h-px","bg-gray-200","dark:bg-gray-700"],["id","expandedExerciseSetsContainer",1,"space-y-1"],[1,"flex-col","py-2","px-1","flex","gap-y-2"],["class","px-2 pt-2",4,"ngIf"],["formArrayName","sets",1,"space-y-1.5"],[4,"ngLet"],[3,"formGroupName","add-set-animated",4,"ngFor","ngForOf"],[1,"px-2","pt-2"],["appBumpClick","",1,"w-full","flex","justify-between","items-center","p-2","text-sm","font-semibold","text-gray-600","dark:text-gray-300","bg-gray-200","dark:bg-gray-700/60","rounded-xl","hover:bg-gray-300","dark:hover:bg-gray-700",3,"click"],["name","chevron-down",1,"h-5","w-5","transition-transform","duration-200"],[1,"overflow-hidden","transition-all","duration-300","ease-in-out"],[1,"flex","flex-wrap","gap-2","my-3","justify-center"],[1,"p-4","border","border-t-0","border-gray-200","dark:border-gray-700","rounded-b-xl","bg-white","dark:bg-gray-800"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-xs","font-medium","text-gray-500","dark:text-gray-200"],["type","number","min","1",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],["type","number","min","0",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],["type","number","min","0.1",1,"mt-1","w-full","p-1.5","text-sm","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200",3,"ngModelChange","ngModel","ngModelOptions","step"],[1,"mt-4","text-right"],["appBumpClick","",1,"px-4","py-2","bg-primary","text-white","text-sm","font-semibold","rounded-xl","shadow-sm","hover:bg-primary-dark","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-3","py-1","rounded-full","border","font-semibold","text-xs","transition",3,"click","ngClass"],[1,"flex","items-center","gap-x-3","py-1","px-2","text-xs","font-medium","text-gray-500","dark:text-gray-400","border-b","dark:border-gray-600",3,"ngClass"],[1,"flex-shrink-0","w-8","text-center"],[1,"flex-grow","min-w-0"],[1,"flex","items-center","justify-start","gap-x-4"],["class","w-16 text-center",4,"ngIf"],["class","w-20 text-center truncate",4,"ngIf"],["class","w-24 text-center",4,"ngIf"],[1,"flex-shrink-0","w-6"],[1,"w-16","text-center"],[1,"w-20","text-center","truncate"],[1,"w-24","text-center"],[3,"formGroupName"],["class","p-1 rounded-xl shadow-inner space-y-2 border-gray-400 ring-1 dark:ring-gray-500 z-10",3,"ngClass",4,"ngIf"],[1,"flex","items-center","gap-x-3","py-1.5","px-2","rounded-xl","hover:bg-gray-100","dark:hover:bg-gray-800/60","cursor-pointer","border","dark:border-gray-700","dark:text-white",3,"click","ngClass"],[1,"flex-shrink-0","w-8","text-s","text-center","font-medium"],["class","w-16 text-s text-center truncate",4,"ngIf"],["class","w-20 text-s text-center truncate",4,"ngIf"],["class","w-24 text-s text-center truncate",4,"ngIf"],[1,"flex-shrink-0"],["appBumpClick","","type","button",1,"flex","items-center","text-red-500","hover:text-red-600","dark:text-red-400","dark:hover:text-red-300","p-0.5","rounded-full","hover:bg-red-100","dark:hover:bg-red-900/30",3,"click","title"],["name","cancel",1,"h-4","w-4"],[1,"w-16","text-s","text-center","truncate"],[1,"w-20","text-s","text-center","truncate"],[1,"w-24","text-s","text-center","truncate"],[1,"p-1","rounded-xl","shadow-inner","space-y-2","border-gray-400","ring-1","dark:ring-gray-500","z-10",3,"ngClass"],[3,"click","ngClass"],[1,"flex","items-center","justify-end"],["class","flex w-fit items-center justify-center gap-2 bg-gray-200 dark:bg-gray-900/70 p-2 rounded-full",4,"ngIf"],["class","flex w-fit items-center justify-center gap-2 bg-gray-200 dark:bg-gray-900/70 py-1 px-2 rounded-full",4,"ngIf"],[1,"grid","grid-cols-2","sm:grid-cols-3","gap-x-3","gap-y-2","items-end"],[1,"col-span-full","sm:col-span-1"],[1,"block","text-s","font-medium","text-gray-600","dark:text-gray-400",3,"for"],["formControlName","type",1,"mt-0.5","w-full","p-1.5","text-m","border-gray-300","dark:border-gray-500","rounded-xl","dark:bg-gray-600","dark:text-gray-200","disabled:opacity-70","disabled:cursor-not-allowed",3,"id","disabled"],[1,"flex","w-fit","items-center","justify-center","gap-2","bg-gray-200","dark:bg-gray-900/70","p-2","rounded-full"],[1,"flex","w-fit","items-center","justify-center","gap-2","bg-gray-200","dark:bg-gray-900/70","py-1","px-2","rounded-full"],[1,"flex","items-center","justify-between","text-s","font-medium","text-gray-600","dark:text-gray-400"],["appBumpClick","",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click"],["name","minus",1,"h-5","w-5"],["appBumpClick","","class","p-1.5 rounded-full bg-blue-500 dark:bg-blue-500/80 hover:bg-blue-500 text-white disabled:opacity-50 flex items-center",3,"click",4,"ngIf"],["appBumpClick","",1,"p-1.5","rounded-full","bg-blue-500","dark:bg-blue-500/80","hover:bg-blue-500","text-white","disabled:opacity-50","flex","items-center",3,"click"],["name","plus",1,"h-5","w-5"],["class","flex items-end justify-center h-full",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","items-end","justify-center","h-full"],["appBumpClick","",1,"flex","items-center","justify-center","w-full","p-2","h-16","border-2","border-dashed","border-gray-300","dark:border-gray-600","rounded-xl","text-gray-400","hover:bg-gray-200/50","dark:hover:bg-gray-700/50","transition-colors",3,"click"],["name","plus-circle",1,"h-6","w-6"],[1,"flex","items-center","justify-center","py-2"],[1,"flex","w-fit","items-center","justify-center","gap-2","bg-gray-200","dark:bg-gray-900/70","py-1","px-2","rounded-full","shadow-md"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click","aria-label"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-green-500","dark:bg-green-500/80","hover:bg-green-500","text-white","flex","items-center",3,"click","aria-label"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-red-500","dark:bg-red-500/80","hover:bg-red-500","text-white","disabled:opacity-50","flex","items-center",3,"click","disabled","aria-label"],["name","minus",1,"h-6","w-6"],["appBumpClick","","type","button",1,"p-1.5","rounded-full","bg-green-500","dark:bg-green-500/80","hover:bg-green-500","text-white","disabled:opacity-50","flex","items-center",3,"click","aria-label"],["name","plus",1,"h-6","w-6"],[1,"flex","items-center","space-x-1"],["displayMode","dropdown",3,"items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","items","isVisible"],[1,"text-center","text-gray-500","dark:text-gray-400","border","border-dashed","dark:border-gray-700","rounded-xl","mt-4"],[1,"mb-2"],["appBumpClick","","type","button",1,"bg-green-500","hover:bg-green-600","text-white","text-m","font-medium","py-2","px-3","rounded-xl",3,"click"],[1,"text-center","py-4","text-gray-500","dark:text-gray-400"],[1,"p-4","bg-blue-50","dark:bg-blue-900/30","rounded-xl","text-center"],[1,"text-m","text-blue-700","dark:text-blue-300"],[1,"py-2","px-1","flex-col","gap-2","flex","items-center","sticky","bottom-0"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-primary","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-dark","disabled:opacity-50","min-w-[220px]",3,"click","disabled"],["name","save",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-green-600","hover:bg-green-800","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-800","disabled:opacity-50","min-w-[220px]",3,"click"],["name","plus-circle",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-yellow-600","hover:bg-yellow-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-yellow-500","min-w-[220px]",3,"click"],["name","restore",1,"h-6","w-6","mr-1"],["appBumpClick","","type","button",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-xl","shadow-sm","text-sm","font-medium","text-white","bg-purple-600","hover:bg-purple-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-purple-500","min-w-[220px]",3,"click"],["name","random",1,"h-6","w-6","mr-1"],[3,"formGroup"],[1,"flex","items-center","justify-between","text-s","font-medium","text-gray-600","dark:text-gray-400",3,"for"],["type","text","formControlName","targetTempo","class","mt-0.5 input_number_class",3,"id","placeholder","readonly",4,"ngIf"],["type","text","formControlName","targetTempo",1,"mt-0.5","input_number_class",3,"placeholder","readonly"],["type","text","formControlName","targetTempo",1,"mt-0.5","input_number_class",3,"id","placeholder","readonly"],[1,"flex","items-stretch","w-full","shadow-sm","p-0.5","bg-gray-200","dark:bg-gray-700","rounded-xl"],["appBumpClick","","type","button","appPress","",1,"flex","items-center","px-3","py-5","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200","hover:bg-gray-300","dark:hover:bg-gray-600","rounded-l-xl","border-y","border-l","border-gray-200","dark:border-gray-700","transition-colors",3,"shortPress","longPress","pressRelease"],["name","minus",1,"h-6","w-6","pointer-events-none"],[1,"relative","w-full","flex-grow","rounded-xl","my-1","h-14"],[1,"absolute","inset-0","flex","items-center","justify-center","text-center","text-lg","font-bold","text-black","dark:text-gray-200","border-y","border-transparent","z-10","cursor-text","select-none",3,"click"],["type","number",1,"absolute","inset-0","w-full","h-full","px-1.5","py-2","text-center","text-lg","font-bold","bg-transparent","dark:bg-gray-800","rounded-xl","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","no-arrows","z-20",3,"input","focus","blur","wheel","touchstart","touchmove","value","readonly","ngClass"],["appBumpClick","","type","button","appPress","",1,"flex","items-center","px-3","py-5","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200","hover:bg-gray-300","dark:hover:bg-gray-600","rounded-r-xl","border-y","border-r","border-gray-200","dark:border-gray-700","transition-colors",3,"shortPress","longPress","pressRelease"],["name","plus",1,"h-6","w-6","pointer-events-none"],["type","button",1,"text-xs","text-blue-600","hover:text-blue-800","dark:text-blue-400","dark:hover:text-blue-300","font-semibold","p-0.5","rounded",3,"click"],["class","w-full px-2 py-5 text-center text-lg font-bold bg-gray-50 dark:bg-gray-800 border border-2 border-gray-200 dark:border-gray-700 text-black dark:text-gray-200 focus:ring-2 focus:ring-primary dark:focus:ring-primary-light focus:outline-none z-10 relative rounded-xl",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"flex","items-center","w-full","justify-center","bg-gray-200","dark:bg-gray-700","p-0.5","rounded-xl"],["type","number","placeholder","Min","min","0",1,"w-full","px-2","py-4","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border-y","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl","no-arrows","h-16",3,"input","readonly","value"],[1,"input_number_class_separator"],["type","number","placeholder","Max","min","0",1,"w-full","px-2","py-4","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border-y","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl","no-arrows","h-16",3,"input","readonly","value"],[1,"w-full","px-2","py-5","text-center","text-lg","font-bold","bg-gray-50","dark:bg-gray-800","border","border-2","border-gray-200","dark:border-gray-700","text-black","dark:text-gray-200","focus:ring-2","focus:ring-primary","dark:focus:ring-primary-light","focus:outline-none","z-10","relative","rounded-xl"],["type","text",1,"mt-0.5","input_number_class",3,"formControlName","readonly"],[3,"isOpenChange","isOpen","modalTitle"],[1,"flex","flex-col","p-4","text-left","text-gray-700","dark:text-gray-200"],["name","","id","",1,"font-semibold","pb-2","dark:border-gray-600","dark:bg-gray-800",3,"disabled"],[1,"flex","justify-center"],["appBumpClick","",1,"w-fit","px-4","py-2","bg-primary","text-white","rounded-xl","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-primary-light","flex","items-center",3,"click"],["name","done",1,"h-6","w-6","mr-1"],[3,"isOpenChange","forceFullScreen","isOpen","modalTitle"],[3,"id","isModal"]],template:function(e,i){if(e&1){let r=D();w(0,Os,2,1,"div",15),u(1,"div",16)(2,"header",17)(3,"div",18)(4,"button",19),I("click",function(){return y(r),b(i.handleCancel())}),F(5,"app-icon",20),d(),F(6,"div",21),d(),u(7,"div",22),w(8,Gs,2,1,"div",23),d()(),u(9,"form",24)(10,"section",25),w(11,ca,20,16,"ng-container",23)(12,Ia,52,51,"ng-container",23),d(),w(13,ud,4,3,"section",23)(14,pd,4,3,"section",26)(15,_d,8,7,"div",27),d()(),w(16,vd,7,7,"ng-template",null,0,xe)(18,yd,11,10,"ng-template",null,1,xe)(20,Pd,22,20,"ng-template",null,2,xe),u(22,"app-exercise-selection-modal",28),_(23,"translate"),Y("searchTermChange",function(s){return y(r),Z(i.modalSearchTerm,s)||(i.modalSearchTerm=s),b(s)}),I("exercisesSelected",function(s){return y(r),b(i.selectExercisesFromLibrary(s))})("createCustomClicked",function(){return y(r),b(i.handleTrulyCustomExerciseEntry())})("close",function(){return y(r),b(i.closeExerciseSelectionModal())}),d(),u(24,"app-exercise-selection-modal",29),_(25,"translate"),_(26,"translate"),Y("searchTermChange",function(s){return y(r),Z(i.modalSearchTerm,s)||(i.modalSearchTerm=s),b(s)}),I("exerciseSelected",function(s){return y(r),b(i.handleExerciseSwitch(s))})("findSimilarClicked",function(){return y(r),b(i.findAndShowSimilarExercises())})("backToSearchClicked",function(){return y(r),b(i.onBackToSearchFromSimilar())})("close",function(){return y(r),b(i.closeSwitchExerciseModal())}),d(),w(27,Ad,10,9,"app-modal",30)(28,Vd,2,5,"app-modal",31),u(29,"app-fab-menu",32),I("actionClicked",function(s){return y(r),b(i.onFabAction(s))}),d(),u(30,"app-generate-workout-modal",33),I("close",function(){return y(r),b(i.isGeneratorModalOpen.set(!1))})("generate",function(s){return y(r),b(i.handleWorkoutGeneration(s))}),d(),F(31,"div",34)}if(e&2){let r,o;p("ngIf",i.errorMessage()),a(),p("ngClass",te(37,Ss,i.context==="modal")),a(7),p("ngIf",i.liveFormAsRoutine()),a(),p("formGroup",i.builderForm),a(2),p("ngIf",i.isRoutineMode),a(),p("ngIf",i.mode===i.BuilderMode.manualLogEntry),a(),p("ngIf",i.mode===i.BuilderMode.manualLogEntry||((r=i.builderForm.get("goal"))==null?null:r.value)!==i.metricEnum.rest),a(),p("ngIf",((o=i.builderForm.get("goal"))==null?null:o.value)===i.metricEnum.rest),a(),p("ngIf",!i.isViewMode),a(7),p("isOpen",i.isExerciseModalOpen),K("searchTerm",i.modalSearchTerm),p("isMultiSelect",!0)("title",f(23,31,"workoutBuilder.modal.addTitle"))("exercises",i.availableExercises)("customPB",i.context==="modal"?"pb-32":""),a(2),p("isOpen",i.isSwitchExerciseModalOpen()),K("searchTerm",i.modalSearchTerm),p("title",f(25,33,i.isShowingSimilarInSwitchModal()?"workoutBuilder.modal.similarTitle":"workoutBuilder.modal.switchTitle"))("exercises",i.exercisesForSwitchModal())("searchPlaceholder",f(26,35,"workoutBuilder.modal.searchPlaceholder"))("showSimilarButton",!0)("isShowingSimilarView",i.isShowingSimilarInSwitchModal())("customPB",i.context==="modal"?"pb-32":""),a(3),p("ngIf",i.notesModalsData()),a(),p("ngIf",i.exerciseDetailsId),a(),p("actions",i.fabMenuItems)("checkForPausedSession",!1)("scrollToBottomDisabled",!0)("scrollToTopDisabled",!0),a(),p("isOpen",i.isGeneratorModalOpen())("customPB",i.context==="modal"?"pb-32":"")}},dependencies:[lt,nt,ot,st,Cr,Sr,yr,br,wr,qr,Br,pt,mt,dt,Pr,$t,ct,Rr,Nr,Vr,Wr,Lr,Or,gt,ut,Yn,Zn,Kn,fi,xi,pn,_n,gn,fn,ht,hi,hn,xt,vi,zr,yi,ri,zt,at,dn,ft],styles:[".exercise-list-container[_ngcontent-%COMP%]{min-height:60px}.exercise-item[_ngcontent-%COMP%]{transition:transform .2s ease-out,box-shadow .2s ease-out}[_nghost-%COMP%]     .is-long-pressing{box-shadow:0 5px 15px #00000040;z-index:1000;box-shadow:inset 0 0 0 2px #e0460d,0 5px 15px #00000040;border-radius:5px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.4;background:#ccc;border:dotted 2px #999;min-height:100px;transition:transform .25s cubic-bezier(0,0,.2,1);display:block;margin-bottom:.5rem}.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;border-radius:.5rem;background-color:var(--card-background-color, white)}body.dark[_ngcontent-%COMP%]   .cdk-drag-preview[_ngcontent-%COMP%]{background-color:var(--dark-card-background-color, #1f2937)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .exercise-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{cursor:grab;padding:.25rem;color:#9ca3af;position:relative;top:.25rem;right:.25rem}.cdk-drag-handle[_ngcontent-%COMP%]:hover{color:#4b5563}.dark[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]{color:#6b7280}.dark[_ngcontent-%COMP%]   .cdk-drag-handle[_ngcontent-%COMP%]:hover{color:#d1d5db}@media (min-width: 640px){.cdk-drag-handle[_ngcontent-%COMP%]{position:static}}.superset-spacing[_ngcontent-%COMP%]{margin-top:0!important}.max-exercise-length[_ngcontent-%COMP%]{max-width:250px}@media (min-width: 768px){.max-exercise-length[_ngcontent-%COMP%]{max-width:100%}}.input_number_class[_ngcontent-%COMP%]{position:relative;z-index:10;height:4rem;width:100%;border-radius:.75rem;border-top-width:1px;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1));padding:.375rem;text-align:center;font-weight:700;--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(224 70 13 / var(--tw-ring-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.7}.input_number_class[_ngcontent-%COMP%]:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.input_number_class[_ngcontent-%COMP%]:focus:is(.dark *){--tw-ring-opacity: 1;--tw-ring-color: rgb(232 108 63 / var(--tw-ring-opacity, 1))}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:center;border-radius:.75rem;--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1));padding:.125rem}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]::-webkit-outer-spin-button, .wrapper_ranged_input_number_class[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]{-moz-appearance:textfield}.wrapper_ranged_input_number_class[_ngcontent-%COMP%]:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.input_number_class_separator[_ngcontent-%COMP%]{margin-left:.25rem;margin-right:.25rem;font-weight:700;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.input_number_class_separator[_ngcontent-%COMP%]:is(.dark *){--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#2c3240;border-radius:12px;position:relative;overflow:hidden}.numeric-stepper-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent!important;color:transparent;caret-color:#fff;border:none!important;box-shadow:none!important;outline:none!important;position:relative;z-index:2;width:100%;height:100%;text-align:center;font-size:1.5em;font-weight:700}.numeric-stepper-container[_ngcontent-%COMP%]   .input-number-container[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{position:absolute;z-index:1;left:0;right:0;text-align:center;color:#fff;pointer-events:none}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;border-top-width:1px;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1));padding:1.25rem .75rem;--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1));transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.numeric-stepper-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.no-arrows[_ngcontent-%COMP%]::-webkit-outer-spin-button, .no-arrows[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.no-arrows[_ngcontent-%COMP%]{-moz-appearance:textfield}"],data:{animation:[Ri("valueAnimation",[Ut(":increment",[Qe({transform:"translateY(-100%)",opacity:0}),Ht("200ms ease-out",Qe({transform:"translateY(0)",opacity:1}))]),Ut(":decrement",[Qe({transform:"translateY(100%)",opacity:0}),Ht("200ms ease-out",Qe({transform:"translateY(0)",opacity:1}))])]),Ri("exerciseExit",[Ut(":leave",[Qe({opacity:1,transform:"translateX(0) scale(1)"}),Ht("350ms cubic-bezier(.36,1.01,.32,1)",Qe({opacity:0,transform:"translateX(80px) scale(0.8)"}))])])]}})};export{bi as a,wi as b,gi as c,Qc as d,Kn as e,Zn as f,Jc as g,Yn as h,hi as i,vi as j,_i as k,ir as l,io as m,to as n};

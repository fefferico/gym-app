import{a as ne}from"./chunk-25DVL3GZ.js";import{a as te}from"./chunk-JOKQ7L6V.js";import{g as re,h as E}from"./chunk-JPLB7QDS.js";import{a as ie}from"./chunk-ES6JVGLJ.js";import{$b as P,Aa as r,Ba as h,Bb as z,Cb as b,G as D,Ga as f,Ha as I,N as m,Oa as U,Ob as w,R as y,S as v,Sa as n,Ta as V,Tb as Q,Ua as x,Ub as X,Va as F,Vb as ee,W as T,a as L,b as O,bb as M,ea as p,eb as S,fb as j,gb as G,hb as W,ib as $,lb as H,ma as k,p as R,ra as A,tb as Y,ub as K,vb as J,ya as u,yb as Z,z as C,za as t,zb as q}from"./chunk-ZEVK4WSW.js";var ae=(c,e)=>({"bg-primary hover:bg-primary-dark text-white border-primary dark:border-primary":c,"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700":e}),_=class c{workoutService=m(ee);trackingService=m(P);storageService=m(X);unitsService=m(E);alertService=m(Q);spinnerService=m(te);themeService=m(ne);BACKUP_VERSION=1;BACKUP_KEY="fitTrackPro_backup";currentUnit=this.unitsService.currentUnit;constructor(){window.scrollTo(0,0)}selectUnit(e){this.unitsService.setUnitPreference(e)}exportData(){this.spinnerService.show("Exporting data...");let e={version:this.BACKUP_VERSION,timestamp:new Date().toISOString(),routines:this.workoutService.getDataForBackup(),workoutLogs:this.trackingService.getLogsForBackup(),personalBests:this.trackingService.getPBsForBackup()},i=JSON.stringify(e,null,2),o=new Blob([i],{type:"application/json"}),l=URL.createObjectURL(o),a=document.createElement("a"),s=re(new Date,"yyyyMMdd_HHmmss");a.download=`FitTrackPro_backup_${s}.json`,a.href=l,a.click(),URL.revokeObjectURL(l),console.log("Data export initiated."),this.spinnerService.hide()}importData(e){let i=e.target,o=i.files?.[0];if(!o){console.log("No file selected for import.");return}if(o.type!=="application/json"){alert("Invalid file type. Please select a JSON file."),i.value="";return}console.log(`Importing file: ${o.name}`);let l=new FileReader;l.onload=a=>{try{let s=a.target?.result,d=JSON.parse(s);if(typeof d!="object"||d===null){alert("Invalid backup file format. Expected an object."),i.value="";return}if(d.version!==this.BACKUP_VERSION){alert(`Invalid backup file version. Expected ${this.BACKUP_VERSION}, got ${d.version}. Please use a compatible backup file.`),i.value="";return}if(!d.routines||!d.workoutLogs||!d.personalBests){alert("Invalid backup file content. Missing essential data sections (routines, workoutLogs, personalBests)."),i.value="";return}this.alertService.showConfirm("WARNING","Importing data will OVERWRITE your current workout logs, routines, and personal bests. Are you sure you want to proceed?").then(g=>{g&&g.data?(this.workoutService.replaceData(d.routines),this.trackingService.replaceLogs(d.workoutLogs),this.trackingService.replacePBs(d.personalBests),console.log("Data import successful."),this.alertService.showAlert("Info","Data imported successfully!")):(console.log("Data import cancelled by user."),alert("Data import cancelled."))})}catch(s){console.error("Error processing imported file:",s),alert("Error processing backup file. Please ensure it is a valid JSON file.")}finally{i.value=""}},l.onerror=a=>{console.error("File reading error:",a),alert("Error reading file."),i.value=""},l.readAsText(o)}clearAllAppData(){this.alertService.showConfirm("WARNING","This will delete ALL your workout data (routines, logs, PBs). This cannot be undone. Are you sure?").then(e=>{e&&e.data&&(this.trackingService.clearAllWorkoutLogs_DEV_ONLY&&this.trackingService.clearAllWorkoutLogs_DEV_ONLY(),this.trackingService.clearAllPersonalBests_DEV_ONLY&&this.trackingService.clearAllPersonalBests_DEV_ONLY(),this.workoutService.clearAllRoutines_DEV_ONLY&&this.workoutService.clearAllRoutines_DEV_ONLY(),console.log("All application data cleared."),this.alertService.showConfirm("Info","All workout data has been cleared."))})}static \u0275fac=function(i){return new(i||c)};static \u0275cmp=k({type:c,selectors:[["app-profile-settings"]],decls:63,vars:10,consts:[[1,"container","mx-auto","p-4"],[1,"mb-6","pb-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[1,"space-y-8"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-4"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["type","file","accept","application/json",1,"block","w-full","text-sm","text-gray-700","dark:text-gray-300","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-gray-200","file:text-gray-700","hover:file:bg-gray-300","dark:file:bg-gray-700","dark:file:text-gray-200","dark:hover:file:bg-gray-600",3,"change"],[1,"pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-sm","font-medium","text-red-600","dark:text-red-400","mb-2"],[1,"px-4","py-2","bg-red-500","hover:bg-red-600","text-white","font-semibold","rounded-md","shadow-sm","transition-colors",3,"click"],["routerLink","/profile/personal-bests",1,"px-4","py-2","bg-primary","hover:bg-primary-dark","text-white","font-semibold","rounded-md","shadow-sm","transition-colors","inline-flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-4","h-4","ml-2"],["fill-rule","evenodd","d","M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd"],[1,"flex","space-x-4"],[1,"px-4","py-2","border","rounded-md","transition-colors",3,"click","ngClass"],[1,"flex","items-center","justify-between"],[1,"text-md","font-medium","text-gray-700","dark:text-gray-300"],[1,"text-sm","text-gray-500","dark:text-gray-400"],["for","theme-toggle",1,"inline-flex","items-center","cursor-pointer"],[1,"sr-only"],["type","checkbox","id","theme-toggle",1,"sr-only","peer",3,"change","checked"],[1,"relative","w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","dark:peer-focus:ring-blue-800","rounded-full","peer","dark:bg-gray-700","peer-checked:after:translate-x-full","rtl:peer-checked:after:-translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:start-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","dark:border-gray-600","peer-checked:bg-primary","dark:peer-checked:bg-primary-dark"],[1,"ms-3","text-sm","font-medium","text-gray-900","dark:text-gray-300"]],template:function(i,o){i&1&&(t(0,"div",0)(1,"header",1)(2,"h1",2),n(3,"Profile & Settings"),r()(),t(4,"div",3)(5,"section",4)(6,"h2",5),n(7,"Data Management"),r(),t(8,"div",6)(9,"div")(10,"p",7),n(11,"Backup your data to a JSON file."),r(),t(12,"button",8),f("click",function(){return o.exportData()}),n(13," Export Data "),r()(),t(14,"div")(15,"p",7),n(16,"Restore your data from a JSON backup file."),r(),t(17,"input",9),f("change",function(a){return o.importData(a)}),r()(),t(18,"div",10)(19,"h3",11),n(20,"Reset / Clear Data"),r(),t(21,"p",12),n(22,"WARNING: This action will delete all your saved data."),r(),t(23,"button",13),f("click",function(){return o.clearAllAppData()}),n(24," Clear All Data "),r()()()(),t(25,"section",4)(26,"h2",5),n(27,"Your Achievements"),r(),t(28,"div")(29,"p",7),n(30,"View all your tracked Personal Bests."),r(),t(31,"a",14),n(32," View Personal Bests "),y(),t(33,"svg",15),h(34,"path",16),r()()()(),v(),t(35,"section",4)(36,"h2",5),n(37,"General Settings"),r(),t(38,"div",6)(39,"div")(40,"p",7),n(41,"Weight Units"),r(),t(42,"div",17)(43,"button",18),f("click",function(){return o.selectUnit("kg")}),n(44," kg "),r(),t(45,"button",18),f("click",function(){return o.selectUnit("lbs")}),n(46," lbs "),r()()()()(),t(47,"section",4)(48,"h2",5),n(49,"Appearance"),r(),t(50,"div",19)(51,"div")(52,"h3",20),n(53,"Dark Mode"),r(),t(54,"p",21),n(55,"Toggle between light and dark themes."),r()(),t(56,"label",22)(57,"span",23),n(58,"Toggle Dark Mode"),r(),t(59,"input",24),f("change",function(){return o.themeService.toggleTheme()}),r(),h(60,"div",25),t(61,"span",26),n(62),r()()()()()()),i&2&&(p(43),u("ngClass",M(4,ae,o.currentUnit()==="kg",o.currentUnit()!=="kg")),p(2),u("ngClass",M(7,ae,o.currentUnit()==="lbs",o.currentUnit()!=="lbs")),p(14),u("checked",o.themeService.isDarkTheme()),p(3),x(" ",o.themeService.isDarkTheme()?"On":"Off"," "))},dependencies:[b,Y,w],encapsulation:2})};function ce(c,e){if(c&1&&(t(0,"tr")(1,"td",14),n(2),t(3,"span",15),n(4),S(5,"titlecase"),r()(),t(6,"td",16),n(7),r(),t(8,"td",17),n(9),r(),t(10,"td",18),n(11),S(12,"date"),r(),t(13,"td",19),n(14),S(15,"slice"),r()()),c&2){let i=e.$implicit,o=I(2);p(2),x(" ",i.exerciseName," "),p(2),x("(",j(5,7,i.primaryMuscleGroup),")"),p(3),x("",i.pbType," "),p(2),x(" ",o.formatPbValue(i)),p(2),V(G(12,9,i.timestamp,"mediumDate")),p(3),F("",W(15,12,i.notes,0,50),"",i&&i.notes&&i.notes.length>50?"...":"")}}function de(c,e){if(c&1&&(t(0,"div")(1,"div",8)(2,"table",9)(3,"thead",10)(4,"tr")(5,"th",11),n(6," Exercise"),r(),t(7,"th",11),n(8," PB Type"),r(),t(9,"th",11),n(10," Best"),r(),t(11,"th",11),n(12," Date"),r(),t(13,"th",11),n(14," Notes"),r()()(),t(15,"tbody",12),A(16,ce,16,16,"tr",13),r()()()()),c&2){let i=I();p(16),u("ngForOf",i.displayPersonalBests())}}function pe(c,e){c&1&&(t(0,"div",20),y(),t(1,"svg",21),h(2,"path",22),r(),v(),t(3,"h2",23),n(4,"No Personal Bests Yet!"),r(),t(5,"p",24),n(6,"Keep logging your workouts to track your progress and achievements here."),r()())}var B=class c{trackingService=m(P);exerciseService=m(ie);unitsService=m(E);allPersonalBests=T({});allExercises=T([]);displayPersonalBests=H(()=>{let e=this.allPersonalBests(),i=this.allExercises();if(Object.keys(e).length===0||i.length===0)return[];let o=new Map(i.map(a=>[a.id,a])),l=[];for(let a in e)if(e.hasOwnProperty(a)){let s=o.get(a),d=e[a];s&&d.forEach(g=>{l.push(O(L({},g),{exerciseName:s.name,exerciseCategory:s.category,primaryMuscleGroup:s.primaryMuscleGroup}))})}return l.sort((a,s)=>{let d=a.exerciseName.localeCompare(s.exerciseName);if(d!==0)return d;let g=this.getPbTypeSortOrder(a.pbType),N=this.getPbTypeSortOrder(s.pbType);return g!==N?g-N:a.weightUsed!==void 0&&s.weightUsed!==void 0?(s.weightUsed??0)-(a.weightUsed??0):a.repsAchieved!==void 0&&s.repsAchieved!==void 0&&a.pbType.includes("Max Reps")&&s.pbType.includes("Max Reps")?s.repsAchieved-a.repsAchieved:a.durationPerformed!==void 0&&s.durationPerformed!==void 0&&a.pbType.includes("Max Duration")&&s.pbType.includes("Max Duration")?(s.durationPerformed??0)-(a.durationPerformed??0):a.pbType.localeCompare(s.pbType)})});constructor(){}ngOnInit(){R([this.trackingService.personalBests$.pipe(D(e=>console.log("Loaded PBs for PBs Page:",Object.keys(e).length)),C(1)),this.exerciseService.getExercises().pipe(D(e=>console.log("Loaded Exercises for PBs Page:",e.length)),C(1))]).subscribe(([e,i])=>{this.allPersonalBests.set(e),this.allExercises.set(i)})}getPbTypeSortOrder(e){return e.includes("1RM (Actual)")?0:e.includes("1RM (Estimated)")?1:e.includes("3RM (Actual)")?2:e.includes("5RM (Actual)")?3:e.includes("Heaviest Lifted")?4:e.includes("Max Reps (Bodyweight)")?5:e.includes("Max Duration")?6:100}formatPbValue(e){let i="";return e.weightUsed!==void 0&&e.weightUsed!==null?(i+=`${e.weightUsed}kg`,e.repsAchieved>0&&!(e.pbType.includes("RM (Actual)")&&e.repsAchieved===parseInt(e.pbType,10))&&(i+=` x ${e.repsAchieved}`)):e.repsAchieved>0&&e.pbType.includes("Max Reps")?i=`${e.repsAchieved} reps`:e.durationPerformed&&e.durationPerformed>0&&e.pbType.includes("Max Duration")&&(i=`${e.durationPerformed}s`),i||"N/A"}static \u0275fac=function(i){return new(i||c)};static \u0275cmp=k({type:c,selectors:[["app-personal-bests"]],decls:13,vars:2,consts:[["noPBs",""],[1,"container","mx-auto","p-4"],[1,"mb-6","flex","justify-between","items-center"],["routerLink","/profile",1,"text-primary","dark:text-primary-light","hover:underline","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","mr-1"],["fill-rule","evenodd","d","M17 10a.75.75 0 0 1-.75.75H5.612l4.158 3.96a.75.75 0 1 1-1.04 1.08l-5.5-5.25a.75.75 0 0 1 0-1.08l5.5-5.25a.75.75 0 1 1 1.04 1.08L5.612 9.25H16.25A.75.75 0 0 1 17 10Z","clip-rule","evenodd"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[4,"ngIf","ngIfElse"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-md","overflow-hidden","mb-6"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-750"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900","dark:text-gray-100"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-300"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-semibold","text-primary","dark:text-primary-light"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","text-sm","text-gray-500","dark:text-gray-400","italic"],[1,"text-center","py-10","bg-white","dark:bg-gray-800","rounded-lg","shadow-md"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-16","h-16","mx-auto","text-gray-400","dark:text-gray-500","mb-4"],["stroke-linecap","round","stroke-linejoin","round","d","M15.983 4.202A1.043 1.043 0 0 1 16.5 4.5c.376 0 .703.246.875.588.081.162.1.344.073.526A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.457-16.184c.027-.182.045-.364.073-.526.172-.342.5-.588.875-.588a1.043 1.043 0 0 1 .517.298V1.5a.75.75 0 0 0-1.5 0v.38a8.05 8.05 0 0 0-4.772 4.192.75.75 0 0 0 .954.954 8.05 8.05 0 0 0 4.192-4.772h.38a1.5 1.5 0 0 0 1.5-1.5ZM12 18.75a6.75 6.75 0 1 0 0-13.5 6.75 6.75 0 0 0 0 13.5Z"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-gray-500","dark:text-gray-400"]],template:function(i,o){if(i&1&&(t(0,"div",1)(1,"div",2)(2,"a",3),y(),t(3,"svg",4),h(4,"path",5),r(),n(5," Back to Profile "),r(),v(),t(6,"h1",6),n(7,"Personal Bests"),r(),t(8,"div"),n(9," FILTERS "),r()(),A(10,de,17,1,"div",7)(11,pe,7,0,"ng-template",null,0,$),r()),i&2){let l=U(12);p(10),u("ngIf",o.displayPersonalBests().length>0)("ngIfElse",l)}},dependencies:[b,K,J,z,Z,q,w],encapsulation:2})};var Ke=[{path:"",component:_,title:"Profile & Settings"},{path:"personal-bests",component:B,title:"Personal Bests"}];export{Ke as PROFILE_SETTINGS_ROUTES};

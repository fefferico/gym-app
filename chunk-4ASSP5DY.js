import{$ as q,Ac as w,Hb as Z,Ja as o,Ka as p,La as f,Lb as tt,Ma as g,Mb as et,Na as C,Nb as nt,O as u,Oa as v,Ob as it,Pb as ot,Qa as T,R as Y,Ra as S,Sa as s,T as k,U as E,X as W,Yb as at,_ as I,_b as $,ab as O,ba as Q,bb as H,da as G,db as N,fa as B,fd as rt,gd as lt,ia as J,ic as st,ja as a,jd as ct,kd as dt,ld as mt,md as pt,ra as U,sc as b,tb as V,tc as d,ub as L,wa as c,wc as l,xa as D,yc as m,za as X,zc as h}from"./chunk-4EC3NBNE.js";import{g as j}from"./chunk-GAL4ENT6.js";function vt(n,e){n&1&&g(0,"div",17)}function ht(n,e){if(n&1&&(C(0),g(1,"app-icon",21),v()),n&2){let t=s(2).$implicit,i=s(3);a(),O(t.iconClass||"w-5 h-5 mr-2"),o("name",i.getIconNameForComponent(t))}}function yt(n,e){if(n&1&&g(0,"span",23),n&2){let t=e.ngIf,i=s(3).$implicit;o("innerHTML",t,B)("ngClass",(i.iconClass||"w-5 h-5 mr-2")+" flex-shrink-0")}}function xt(n,e){if(n&1&&(C(0),c(1,yt,1,2,"span",22),v()),n&2){let t=s(2).$implicit,i=s(3);a(),o("ngIf",i.getIconHtml(t))}}function bt(n,e){if(n&1){let t=T();p(0,"button",18),S("click",function(r){k(t);let _=s().$implicit,y=s(3);return E(y.onItemClicked(r,_))}),c(1,ht,2,3,"ng-container",19)(2,xt,2,1,"ng-container",19),p(3,"span",20),H(4),V(5,"translate"),f()()}if(n&2){let t=s().$implicit,i=s(3);o("ngClass",i.defaultDropdownButtonClass+" "+t.buttonClass),a(),o("ngIf",i.isComplexIcon(t)),a(),o("ngIf",!i.isComplexIcon(t)),a(2),N(" ",t.label?L(5,4,t.label):""," ")}}function wt(n,e){if(n&1&&(C(0),c(1,vt,1,0,"div",15)(2,bt,6,6,"button",16),v()),n&2){let t=e.$implicit;a(),o("ngIf",t.isDivider),a(),o("ngIf",!t.isDivider)}}function Mt(n,e){if(n&1&&(p(0,"div",10),g(1,"div",11),p(2,"div",12)(3,"div",13),c(4,wt,3,2,"ng-container",14),f()()()),n&2){let t=s(2);o("ngClass",t.alignmentClass()),a(),o("ngClass",t.caretClass()),a(2),o("@listAnimation",t.animationState())("ngClass",t.gridClass||"flex flex-col gap-1"),a(),o("ngForOf",t.items)}}function It(n,e){if(n&1&&(p(0,"div"),c(1,Mt,5,5,"div",9),f()),n&2){let t=s();a(),o("ngIf",t.shouldRenderInDom)}}function St(n,e){n&1&&g(0,"div")}function At(n,e){if(n&1&&(C(0),g(1,"app-icon",29),v()),n&2){let t=s(2).$implicit,i=s(3);a(),O(t.iconClass||"w-6 h-6"),o("name",i.getIconNameForComponent(t))}}function kt(n,e){if(n&1&&g(0,"span",23),n&2){let t=e.ngIf,i=s(3).$implicit;o("innerHTML",t,B)("ngClass",i.iconClass||"w-6 h-6")}}function Et(n,e){if(n&1&&(C(0),c(1,kt,1,2,"span",22),v()),n&2){let t=s(2).$implicit,i=s(3);a(),o("ngIf",i.getIconHtml(t))}}function Bt(n,e){if(n&1&&(p(0,"span",30),H(1),V(2,"translate"),f()),n&2){let t=s(2).$implicit;a(),N(" ",t.label?L(2,1,t.label):""," ")}}function Dt(n,e){if(n&1){let t=T();p(0,"button",27),S("click",function(r){k(t);let _=s().$implicit,y=s(3);return E(y.onItemClicked(r,_))}),c(1,At,2,3,"ng-container",19)(2,Et,2,1,"ng-container",19)(3,Bt,3,3,"span",28),f()}if(n&2){let t=s().$implicit,i=s(3);o("title",t.label)("ngClass",i.defaultCompactButtonClass+" "+t.buttonClass),a(),o("ngIf",i.isComplexIcon(t)),a(),o("ngIf",!i.isComplexIcon(t)),a(),o("ngIf",i.showLabelInCompact(t))}}function Tt(n,e){if(n&1&&(C(0),c(1,Dt,4,5,"button",26),v()),n&2){let t=e.$implicit;a(),o("ngIf",!t.isDivider)}}function Ot(n,e){if(n&1&&(p(0,"div",25),c(1,Tt,2,1,"ng-container",14),f()),n&2){let t=s(2);o("@compactBar",void 0)("ngClass",t.compactBarClass+t.gridClass),a(),o("ngForOf",t.items)}}function Ht(n,e){if(n&1&&(p(0,"div"),c(1,Ot,2,3,"div",24),f()),n&2){let t=s();a(),o("ngIf",t.isVisible)}}var Nt=b("modalOverlay",[m(":enter",[l({opacity:0}),d("200ms ease-out",l({opacity:1}))]),m(":leave",[d("150ms ease-in",l({opacity:0}))])]),Vt=b("modalContent",[m(":enter",[l({transform:"translateY(100%)"}),d("200ms ease-out",l({transform:"translateY(0)"}))]),m(":leave",[d("150ms ease-in",l({transform:"translateY(100%)"}))])]),Lt=b("listAnimation",[m("void => open",[h(".action-item, .menu-divider",[l({opacity:0,transform:"translateY(-15px)"})],{optional:!0}),h(".action-item, .menu-divider",w("30ms",[d("180ms ease-out",l({opacity:1,transform:"translateY(0)"}))]),{optional:!0})]),m("void => from-bottom",[h(".action-item, .menu-divider",[l({opacity:0,transform:"translateY(15px)"})],{optional:!0}),h(".action-item, .menu-divider",w("30ms",[d("180ms ease-out",l({opacity:1,transform:"translateY(0)"}))]),{optional:!0})]),m("open => void",[h(".action-item, .menu-divider",w("-30ms",[d("150ms ease-in",l({opacity:0,transform:"translateY(-15px)"}))]),{optional:!0})]),m("from-bottom => void",[h(".action-item, .menu-divider",w("-30ms",[d("150ms ease-in",l({opacity:0,transform:"translateY(15px)"}))]),{optional:!0})])]),$t=b("compactBar",[m(":enter",[l({opacity:0}),d("200ms ease-out",l({opacity:1}))]),m(":leave",[d("150ms ease-in",l({opacity:0}))])]),ut=class n{sanitizer=u(st);elRef=u(Q);platformId=u(G);cdr=u(Z);injector=u(W);iconRegistry=u(rt);alertService=u(pt);translateService=u(ct);menuState=I("closed");animationState=I("void");isClosing=!1;items=[];displayMode="dropdown";modalTitle="Actions";borderColor="";defaultBorderColor="border-gray-300 dark:border-gray-600";customBorderWidth="border-4";defaultBorderWidth="border-3";_isVisible=!1;set isVisible(e){e!==this._isVisible&&(this._isVisible=e,e?(this.isClosing=!1,this.displayMode==="modal"?setTimeout(()=>this.presentAsAlert(),0):this.displayMode==="dropdown"&&Y(this.injector,()=>{X(()=>{this.calculateDropdownPosition(),this.cdr.detectChanges()})}),document.addEventListener("keydown",this._boundOnEnterKey)):this.displayMode==="dropdown"&&!this.isClosing?this.startClosingAnimation():document.removeEventListener("keydown",this._boundOnEnterKey))}get isVisible(){return this._isVisible}get shouldRenderInDom(){return this._isVisible||this.isClosing}alignmentClass=I("origin-top-right right-0");defaultDropdownButtonClass="flex items-center w-full rounded-md px-3 py-2 text-sm font-medium text-black dark:text-white hover:text-white";compactBarClass="flex gap-2 grid grid-cols-2 justify-center items-center z-20 rounded-b-lg p-2";defaultCompactButtonClass="flex items-center w-full rounded-md px-3 py-2 text-sm font-medium text-black dark:text-white hover:text-white";gridClass="";customButtonDivCssClass="grid grid-cols-2";itemClick=new D;closeMenu=new D;_boundOnEnterKey=this.handleEnterKey.bind(this);ngOnChanges(e){if(e.isVisible){let t=e.isVisible.currentValue;t&&this.displayMode==="modal"&&setTimeout(()=>this.presentAsAlert(),0),t&&this.displayMode!=="modal"?document.addEventListener("keydown",this._boundOnEnterKey):document.removeEventListener("keydown",this._boundOnEnterKey)}}startClosingAnimation(){this.isClosing=!0,this.animationState.set("void"),this.cdr.detectChanges(),setTimeout(()=>{this.isClosing=!1,document.removeEventListener("keydown",this._boundOnEnterKey),this.cdr.detectChanges()},200)}calculateDropdownPosition(){if(!$(this.platformId))return;let e=this.elRef.nativeElement.querySelector(".dropdown-panel"),t=this.elRef.nativeElement.parentElement;if(!e||!t)return;let i=t.getBoundingClientRect(),r=e.offsetWidth,_=e.offsetHeight,y=window.innerWidth,Rt=window.innerHeight,gt=getComputedStyle(document.documentElement),R=parseInt(gt.getPropertyValue("--main-nav-height"),10)||0,_t=i.left+r<=y,ft=i.right-r>=0,x="";if(ft)x="right-0 origin-top-right";else if(_t)x="left-0 origin-top-left";else{let A=y-i.left,z=i.right;x=A>=z?"left-0 origin-top-left":"right-0 origin-top-right"}let M="top-full mt-2";this.animationState.set("open");let K=8,Ct=window.innerHeight-i.bottom-R,F=_+K<=Ct,P=i.top-_-K>=0;if(!F&&P)M="bottom-full mb-2",this.animationState.set("from-bottom");else if(!F&&!P){let A=window.innerHeight-i.bottom-R;i.top>A&&(M="bottom-full mb-2",this.animationState.set("from-bottom"))}this.borderColor?this.alignmentClass.set(`${x} ${M} ${this.customBorderWidth} ${this.borderColor}`):this.alignmentClass.set(`${x} ${M} ${this.defaultBorderWidth} ${this.defaultBorderColor}`)}ngOnDestroy(){document.removeEventListener("keydown",this._boundOnEnterKey)}defaultActionModalCssClass="justify-start";presentAsAlert(){return j(this,null,function*(){let e=$(this.platformId)&&!("ontouchstart"in window||navigator.maxTouchPoints>0),t=this.items.filter(r=>!r.isDivider).map(r=>({text:r.label?this.translateService.instant(r.label):"",role:r.actionKey||"",icon:r.iconName,iconClass:r.iconClass,cssClass:`${r.buttonClass||""}`,overrideCssClass:r.overrideCssButtonClass?r.overrideCssButtonClass.replace("justify-center",this.defaultActionModalCssClass):"",data:r.data,autofocus:!!e})),i=yield this.alertService.present({header:this.modalTitle,buttons:t,backdropDismiss:!0,customButtonDivCssClass:this.customButtonDivCssClass?this.customButtonDivCssClass:"grid grid-cols-2"});i&&i.role!=="backdrop"&&i.role!=="cancel"&&this.itemClick.emit({actionKey:i.role,data:i.data}),this.closeMenu.emit()})}onDocumentClick(e){this.displayMode==="dropdown"&&this.isVisible&&!this.elRef.nativeElement.contains(e.target)&&this.closeMenu.emit()}handleEnterKey(e){if(e.key==="Enter"){e.preventDefault();let t=this.items.find(i=>!i.isDivider);t&&this.onItemClicked({stopPropagation:()=>{}},t)}}onItemClicked(e,t){e.stopPropagation(),t.isDivider||(navigator.vibrate&&navigator.vibrate(50),this.itemClick.emit({actionKey:t.actionKey??"",data:t.data}),this.displayMode==="dropdown"&&this.closeMenu.emit())}getIconHtml(e){let t=null;return typeof e.iconName=="string"?t=this.iconRegistry.getIconString(e.iconName):e.iconSvg&&(t=e.iconSvg),t?this.sanitizer.bypassSecurityTrustHtml(t):null}showLabelInCompact(e){return!!e.label}isComplexIcon(e){return typeof e.iconName=="object"&&e.iconName!==null}getIconNameForComponent(e){return e.iconName}caretClass(){let e=this.alignmentClass();return e.includes("bottom-full")?e.includes("right-0")?"bottom-[-6px] right-2":"bottom-[-6px] left-2":e.includes("right-0")?"top-[-6px] right-2":"top-[-6px] left-2"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=U({type:n,selectors:[["app-action-menu"]],hostBindings:function(t,i){t&1&&S("click",function(_){return i.onDocumentClick(_)},J)},inputs:{items:"items",displayMode:"displayMode",modalTitle:"modalTitle",borderColor:"borderColor",isVisible:"isVisible",compactBarClass:"compactBarClass",gridClass:"gridClass",customButtonDivCssClass:"customButtonDivCssClass"},outputs:{itemClick:"itemClick",closeMenu:"closeMenu"},features:[q],decls:11,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"hidden","dark:hover:text-gray-100"],[1,"hidden","scale-120"],[1,"hidden","scale-125"],[1,"hidden","scale-110"],[1,"hidden","border-3"],[1,"hidden","border-4"],[1,"hidden","border-5"],["class","dropdown-panel absolute mt-2 w-max max-w-[90vw] rounded-lg shadow-lg bg-gray-100 dark:bg-gray-800 ring-1 ring-black ring-opacity-5 z-[60] border flex flex-col max-h-[80vh]",3,"ngClass",4,"ngIf"],[1,"dropdown-panel","absolute","mt-2","w-max","max-w-[90vw]","rounded-lg","shadow-lg","bg-gray-100","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","z-[60]","border","flex","flex-col","max-h-[80vh]",3,"ngClass"],[1,"dropdown-caret","absolute","w-6","h-6","bg-gray-100","dark:bg-gray-800","rotate-45","z-[-1]","rounded-md",3,"ngClass"],[1,"overflow-y-hidden","p-2","custom-scrollbar"],[1,"grid","gap-2",3,"ngClass"],[4,"ngFor","ngForOf"],["class","menu-divider w-full h-px my-1 bg-gray-200 dark:bg-gray-600 col-span-full",4,"ngIf"],["type","button","class","action-item transition-colors duration-150 ease-in-out",3,"ngClass","click",4,"ngIf"],[1,"menu-divider","w-full","h-px","my-1","bg-gray-200","dark:bg-gray-600","col-span-full"],["type","button",1,"action-item","transition-colors","duration-150","ease-in-out",3,"click","ngClass"],[4,"ngIf"],[1,"whitespace-normal","text-left","flex-grow"],[1,"flex-shrink-0",3,"name"],[3,"innerHTML","ngClass",4,"ngIf"],[3,"innerHTML","ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["type","button","class","transition-colors duration-150 ease-in-out",3,"title","ngClass","click",4,"ngIf"],["type","button",1,"transition-colors","duration-150","ease-in-out",3,"click","title","ngClass"],["class","truncate ml-2",4,"ngIf"],[3,"name"],[1,"truncate","ml-2"]],template:function(t,i){t&1&&(C(0,0),c(1,It,2,1,"div",1)(2,St,1,0,"div",1)(3,Ht,2,1,"div",1),v(),g(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)),t&2&&(o("ngSwitch",i.displayMode),a(),o("ngSwitchCase","dropdown"),a(),o("ngSwitchCase","modal"),a(),o("ngSwitchCase","compact"))},dependencies:[at,tt,et,nt,it,ot,lt,mt,dt],encapsulation:2,data:{animation:[$t,Nt,Vt,Lt]},changeDetection:0})};export{ut as a};

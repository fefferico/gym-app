import{a as G}from"./chunk-VEUUSCDY.js";import{a as q}from"./chunk-M3MD7EIL.js";import{a as z}from"./chunk-A56PHXV6.js";import{Bc as K,Bd as R,Cb as d,Cd as j,Da as y,Db as m,Dd as H,Eb as h,Ed as $,Gb as B,I as w,K as D,Na as v,Oa as i,Pa as a,Q as x,Qa as p,V as u,W as f,Wb as M,Xa as L,Xb as T,Ya as b,Za as c,aa as _,cc as V,eb as E,ec as N,hc as P,ib as r,jb as s,kb as A,lb as C,na as o,ya as S,yd as F,zc as O}from"./chunk-RAZEFHXM.js";import{g as k}from"./chunk-GAL4ENT6.js";function U(n,e){if(n&1){let t=L();i(0,"app-action-menu",26),b("itemClick",function(g){u(t);let I=c(2);return f(I.handleActionMenuItemClick(g))})("closeMenu",function(){u(t);let g=c(2);return f(g.onCloseActionMenu())}),a()}if(n&2){let t=c().ngIf,l=c();v("items",l.getLogDropdownActionItems(t))("isVisible",l.areActionsVisible(t.id))}}function W(n,e){if(n&1&&(i(0,"p",27),r(1),d(2,"date"),d(3,"date"),a()),n&2){let t=c().ngIf;o(),C(" ",h(2,2,t.startTime,"shortTime")," - ",h(3,5,t.endTime,"shortTime")," ")}}function X(n,e){if(n&1&&(i(0,"div",17),p(1,"app-icon",28),i(2,"div",19),r(3),d(4,"translate"),a(),i(5,"div",20),r(6),d(7,"titlecase"),a()()),n&2){let t=c().ngIf,l=c();o(3),s(m(4,3,"activityLogDetails.location")),o(3),C("",m(7,5,t.locationName)," ",t.locationId?"["+l.getLocationById(t.locationId)+"]":"")}}function Y(n,e){if(n&1&&(i(0,"li",34),p(1,"app-icon",35),i(2,"span"),r(3),a()()),n&2){let t=e.$implicit;o(3),s(t)}}function Z(n,e){if(n&1&&(i(0,"div",29)(1,"h3",30),p(2,"app-icon",31),r(3),d(4,"translate"),a(),i(5,"ul",32),y(6,Y,4,1,"li",33),a()()),n&2){let t=c().ngIf;o(3),A(" ",m(4,2,"activityLogDetails.peopleInvolved")," "),o(3),v("ngForOf",t.people)}}function tt(n,e){if(n&1&&(i(0,"div",29)(1,"h3",36),r(2),d(3,"translate"),a(),i(4,"p",37),r(5),a()()),n&2){let t=c().ngIf;o(2),s(m(3,2,"activityLogDetails.notes")),o(3),s(t.notes)}}function et(n,e){if(n&1){let t=L();i(0,"div",2)(1,"header",3)(2,"button",4),b("click",function(){u(t);let g=c();return f(g.goBack())}),p(3,"app-icon",5),a(),i(4,"div",6)(5,"div",7)(6,"button",8),b("click",function(g){let I=u(t).ngIf,Q=c();return f(Q.toggleActions(I.id,g))}),p(7,"app-icon",9),a(),y(8,U,1,2,"app-action-menu",10),a()()(),i(9,"div",11)(10,"div",12)(11,"h1",13),r(12),a(),i(13,"p",14),r(14),d(15,"date"),a(),y(16,W,4,8,"p",15),a(),i(17,"div",16)(18,"div",17),p(19,"app-icon",18),i(20,"div",19),r(21),d(22,"translate"),a(),i(23,"div",20),r(24),a()(),i(25,"div",17),p(26,"app-icon",21),i(27,"div",19),r(28),d(29,"translate"),a(),i(30,"div",20),r(31),a()(),y(32,X,8,7,"div",22),i(33,"div",17),p(34,"app-icon",23),i(35,"div",19),r(36),d(37,"translate"),a(),i(38,"div",20),r(39),a()(),i(40,"div",17),p(41,"app-icon",24),i(42,"div",19),r(43),d(44,"translate"),a(),i(45,"div",20),r(46),a()()(),y(47,Z,7,4,"div",25)(48,tt,6,4,"div",25),a()()}if(n&2){let t=e.ngIf,l=c();o(8),v("ngIf",l.areActionsVisible(t.id)),o(4),s(t.activityName),o(2),s(h(15,15,t.startTime,"fullDate")),o(2),v("ngIf",t.endTime),o(5),s(m(22,18,"activityLogDetails.duration")),o(3),A("",t.durationMinutes," min"),o(4),s(m(29,20,"activityLogDetails.intensity")),o(3),s(t.intensity),o(),v("ngIf",t.locationName),o(4),s(m(37,22,"activityLogDetails.distance")),o(3),s(t.distanceKm?t.distanceKm+" km":"N.A."),o(4),s(m(44,24,"activityLogDetails.calories")),o(3),s(t.caloriesBurned?t.caloriesBurned+" kcal":"N.A."),o(),v("ngIf",t.people==null?null:t.people.length),o(),v("ngIf",t.notes)}}function it(n,e){n&1&&(i(0,"div",38)(1,"p",39),r(2),d(3,"translate"),a()()),n&2&&(o(2),s(m(3,1,"activityLogDetails.loading")))}var J=class n{route=x(O);router=x(K);activityService=x(z);alertService=x($);translate=x(R);locationService=x(G);activityLog=_(null);baseActivity=_(null);activeLogIdActions=_(null);ngOnInit(){this.route.paramMap.pipe(w(e=>{let t=e.get("id");return t?this.activityService.getActivityLogById(t):[null]}),D(e=>{if(e){this.activityLog.set(e);let t=this.activityService.getActivityById(e.activityId);t&&this.baseActivity.set(t)}else this.activityLog.set(null),this.baseActivity.set(null)})).subscribe()}goBack(){this.router.navigate(["/history"])}editLog(e){this.router.navigate(["/activities/log/edit",e])}deleteLog(e){return k(this,null,function*(){let t=yield this.alertService.showConfirmationDialog(this.translate.instant("activityLogDetails.alerts.deleteTitle"),this.translate.instant("activityLogDetails.alerts.deleteMessage",{name:e.activityName}),[{text:this.translate.instant("activityLogDetails.alerts.cancel"),role:"cancel",data:!1},{text:this.translate.instant("activityLogDetails.alerts.deleteButton"),role:"confirm",data:!0,cssClass:"bg-red-500"}]);t&&t.data&&(this.activityService.deleteActivityLog(e.id),this.router.navigate(["/history"]))})}toggleActions(e,t){t.stopPropagation(),this.activeLogIdActions.update(l=>l===e?null:e)}areActionsVisible(e){return this.activeLogIdActions()===e}onCloseActionMenu(){this.activeLogIdActions.set(null)}getLogDropdownActionItems(e){return[{label:this.translate.instant("activityLogDetails.actions.edit"),actionKey:"edit",iconSvg:"asdasd",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:"w-full "+"rounded text-left px-4 py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-primary flex items-center text-sm hover:text-white dark:hover:text-gray-100",data:{log:e}},{isDivider:!0},{label:this.translate.instant("activityLogDetails.actions.delete"),actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:"w-full "+"rounded text-left px-4 py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-red-600 flex items-center text-sm hover:text-white",data:{log:e}}]}handleActionMenuItemClick(e){let t=e.data?.log;if(t){switch(e.actionKey){case"edit":this.editLog(t.id);break;case"delete":this.deleteLog(t);break}this.activeLogIdActions.set(null)}}getActivityLocations(){return this.activityService.getActivityLocations()}getLocationById(e){return this.locationService.getHydratedLocationByLocationId(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=S({type:n,selectors:[["app-activity-log-details"]],decls:3,vars:2,consts:[["loading",""],["class","container mx-auto max-w-2xl p-2 sm:p-4",4,"ngIf","ngIfElse"],[1,"container","mx-auto","max-w-2xl","p-2","sm:p-4"],[1,"flex","items-center","justify-between","p-2","mb-4"],[1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],["name","back",1,"w-6","h-6"],[1,"flex","items-center","space-x-2","flex-shrink-0"],[1,"relative"],[1,"text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-full","focus:outline-none","flex","items-center",3,"click"],["name","menu-action",1,"h-10","w-10"],["displayMode","dropdown",3,"items","isVisible","itemClick","closeMenu",4,"ngIf"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md","space-y-4"],[1,"border-b","border-gray-200","dark:border-gray-700","pb-4"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[1,"text-gray-500","dark:text-gray-400","mt-1"],["class","text-gray-600 dark:text-gray-300 font-semibold text-lg mt-2",4,"ngIf"],[1,"grid","grid-cols-2","sm:grid-cols-4","gap-4","text-center","pt-4"],[1,"p-4","bg-gray-50","dark:bg-gray-700/50","rounded-lg"],["name","clock",1,"w-8","h-8","mx-auto","text-primary","mb-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"text-2xl","font-semibold","text-black","dark:text-gray-200"],["name","flame",1,"w-8","h-8","mx-auto","text-primary","mb-2"],["class","p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",4,"ngIf"],["name","distance",1,"w-8","h-8","mx-auto","text-primary","mb-2"],["name","calories",1,"w-8","h-8","mx-auto","text-primary","mb-2"],["class","pt-4 border-t border-gray-200 dark:border-gray-700",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","items","isVisible"],[1,"text-gray-600","dark:text-gray-300","font-semibold","text-lg","mt-2"],["name","map",1,"w-8","h-8","mx-auto","text-primary","mb-2"],[1,"pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","mb-2","flex","items-center","text-black","dark:text-gray-200"],["name","users",1,"w-5","h-5","mr-2","text-primary"],[1,"flex","flex-wrap","gap-2"],["class","bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full text-gray-500 text-black dark:text-gray-200 text-sm flex items-center",4,"ngFor","ngForOf"],[1,"bg-gray-100","dark:bg-gray-700","px-3","py-1","rounded-full","text-gray-500","text-black","dark:text-gray-200","text-sm","flex","items-center"],["name","profile",1,"w-5","h-5","rounded-full","mr-2"],[1,"text-lg","font-semibold","mb-2"],[1,"text-gray-700","dark:text-gray-300","whitespace-pre-wrap"],[1,"text-center","p-20"],[1,"text-xl","text-gray-600","dark:text-gray-400"]],template:function(t,l){if(t&1&&y(0,et,49,26,"div",1)(1,it,4,3,"ng-template",null,0,B),t&2){let g=E(2);v("ngIf",l.activityLog())("ngIfElse",g)}},dependencies:[P,M,T,F,q,H,V,N,j],styles:["[_nghost-%COMP%]{display:block}"]})};export{J as ActivityLogDetailsComponent};

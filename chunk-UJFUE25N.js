import{c as ne,d as Vt,e as Wt,f as At,h as Ot,i as Rt,k as Gt,n as $t,p as Ht,q as zt}from"./chunk-WFYUSXNQ.js";import"./chunk-WYM5WGTQ.js";import"./chunk-DULDXDO5.js";import"./chunk-VEUUSCDY.js";import{a as pe}from"./chunk-NUQXH6WE.js";import{a as re}from"./chunk-EAXOAEA2.js";import"./chunk-JZ7Z2VF5.js";import"./chunk-Y3I4T7J3.js";import{a as Mt}from"./chunk-M3MD7EIL.js";import"./chunk-7DXBPLEQ.js";import"./chunk-A56PHXV6.js";import{b as Nt}from"./chunk-2OLJ5PV4.js";import{a as Dt}from"./chunk-PYCA7SFF.js";import{a as Ft}from"./chunk-VEASBVPN.js";import"./chunk-GG6QRTVP.js";import{a as Lt}from"./chunk-RPIKC5GL.js";import"./chunk-DLXLOYW4.js";import"./chunk-G2HBCY6X.js";import{C as ue,I as wt,J as Ct,R as ie,Y as St,Z as Tt,_ as U,ea as Bt,k as xt,la as It,m as vt,ma as Et,na as Pt,o as ft,t as me,w as bt,z as kt}from"./chunk-DKF37G4Q.js";import{A as z,Ba as be,Bc as je,Bd as gt,C as he,Cb as p,Cc as Ue,Cd as _t,Da as x,Db as _,Dd as ht,Eb as j,Ed as yt,Gb as K,Ha as se,I as ae,Ia as le,Ja as de,K as oe,Kb as L,Na as c,Oa as l,Pa as s,Q as D,Qa as v,Qb as Ne,Ua as F,V as b,Va as M,Vb as Ve,Vc as A,W as k,Wa as ce,Wb as We,Wc as qe,X as ee,Xa as E,Xb as Ae,Xc as Ke,Y as ye,Ya as C,Yc as G,Za as m,Zc as Ye,_c as Qe,aa as V,ac as Oe,bb as ke,bd as Ze,cb as we,cc as Re,cd as Je,db as Ce,eb as q,ec as Le,ed as Xe,fb as Se,gb as Te,ha as xe,hc as Ge,hd as et,i as J,ib as y,id as tt,ja as ve,jb as B,jc as $e,jd as rt,kb as w,kd as it,l as X,lb as N,ld as nt,mb as Be,md as at,na as a,nb as Ie,nd as ot,ob as Ee,pb as Pe,qb as De,rd as st,sb as Fe,tb as Me,tc as He,td as lt,ud as dt,vb as R,vd as ct,wb as $,wd as mt,xb as te,ya as fe,yd as ut,z as _e,zc as ze,zd as pt}from"./chunk-RAZEFHXM.js";import{a as Q,b as Z,g as W}from"./chunk-GAL4ENT6.js";var Y=class i{transform(t,e=!1){if(t==null)return"";let r=Number(t);return e?`Day ${r}`:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r]||`Day ${r}`}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=be({name:"dayOfWeek",type:i,pure:!0})};var Jt=i=>({"highlight-no-routine":i}),jt=(i,t)=>({"text-primary dark:text-primary-light font-semibold":i,"text-gray-700 dark:text-gray-300":t}),Xt=(i,t)=>({"border-red-500 dark:border-red-400":i,"border-gray-300 dark:border-gray-500":t}),er=(i,t)=>({"bg-primary text-white focus:ring-primary-dark":i,"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 focus:ring-gray-400":t}),qt=i=>({"mt-1":i}),ge=i=>({"border-0 border-b-2 border-gray-300 dark:border-gray-500":i}),tr=i=>({"ring-2 ring-offset-1 ring-red-500 dark:ring-red-400":i}),rr=(i,t,e)=>({"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 placeholder-red-400":i,"rounded-r-md":t,"highlight-no-routine":e}),ir=(i,t,e)=>({"border-blue-300 dark:border-blue-500 bg-blue-400 dark:bg-blue-500 hover:bg-blue-600 dark:hover:bg-blue-400":i,"border-green-500 dark:border-green-400 bg-green-400 dark:bg-green-700 dark:text-green-100 hover:bg-green-600 dark:hover:bg-green-600":t,"border-red-500 dark:border-red-400 bg-red-400 dark:bg-red-600 dark:text-red-200 hover:bg-red-600 dark:hover:bg-red-500":e}),Kt=i=>({bounce:i}),Yt=(i,t)=>({ex:i,exIndex:t}),nr=(i,t)=>({"rounded-r-md":i,"highlight-no-routine":t}),ar=(i,t,e)=>({"border-blue-300 dark:border-blue-500 bg-blue-50 dark:bg-blue-500 text-white hover:bg-blue-100 dark:hover:bg-blue-400":i,"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-700 text-green-700 dark:text-green-100 hover:bg-green-100 dark:hover:bg-green-600":t,"border-red-500 dark:border-red-400 bg-red-100 dark:bg-red-600 text-red-700 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-500":e});function or(i,t){if(i&1){let e=E();l(0,"app-action-menu",44),C("itemClick",function(n){b(e);let o=m(2);return k(o.handleActionMenuItemClick(n))})("closeMenu",function(){b(e);let n=m(2);return k(n.onCloseActionMenu())}),s()}if(i&2){let e=m().ngIf,r=m();c("items",r.getProgramDropdownActionItems(e.id,"dropdown"))("isVisible",r.areActionsVisible(e.id))}}function sr(i,t){if(i&1){let e=E();l(0,"div",39)(1,"div",40)(2,"button",41),C("click",function(n){let o=b(e).ngIf,d=m();return k(d.toggleActions(o.id,n))}),v(3,"app-icon",42),s(),x(4,or,1,2,"app-action-menu",43),s()()}if(i&2){let e=t.ngIf,r=m();a(4),c("ngIf",r.areActionsVisible(e.id))}}function lr(i,t){if(i&1&&(l(0,"div")(1,"label",45),y(2),s()()),i&2){let e,r=m();a(2),B((e=r.programForm.get("name"))==null?null:e.value)}}function dr(i,t){i&1&&(l(0,"div")(1,"div",46),ee(),l(2,"svg",47),v(3,"path",48),s(),ye(),l(4,"span",49),y(5),p(6,"translate"),s()()()),i&2&&(a(5),B(_(6,1,"programBuilder.active")))}function cr(i,t){if(i&1&&(l(0,"div",52)(1,"div",53)(2,"h3",54),y(3),p(4,"translate"),s(),l(5,"span",55),y(6),s()(),l(7,"div",56),v(8,"div",57),s()()),i&2){let e,r=t.ngIf,n=m(2);a(3),w(" ",_(4,5,((e=n.currentProgram())==null?null:e.programType)==="linear"?"programBuilder.progress.overallWorkout":"programBuilder.progress.currentWeeklyCycle")," "),a(3),N(" ",r.completedCount," / ",r.totalCount," "),a(2),Se("width",r.percentage,"%")}}function mr(i,t){if(i&1&&(l(0,"div",50),x(1,cr,9,7,"div",51),s()),i&2){let e=m();a(),c("ngIf",e.programProgress())}}function ur(i,t){if(i&1&&(v(0,"div",61),p(1,"translate"),p(2,"translate")),i&2){let e=t.$implicit;c("ngClass",e.isCompleted?"bg-primary":"bg-gray-200 dark:bg-gray-700")("title",e.name+(e.isCompleted?_(1,2,"programBuilder.progress.weekCompleted"):_(2,4,"programBuilder.progress.weekIncomplete")))}}function pr(i,t){if(i&1&&(l(0,"div",52)(1,"h3",54),y(2),p(3,"translate"),s(),l(4,"div",59),x(5,ur,3,6,"div",60),s()()),i&2){let e=t.ngIf;a(2),w("",_(3,2,"programBuilder.progress.overallWeeks")," "),a(3),c("ngForOf",e)}}function gr(i,t){if(i&1&&v(0,"div",64),i&2){let e=t.$implicit;c("ngClass",e.isCompleted?"bg-green-500":"bg-gray-200 dark:bg-gray-700")}}function _r(i,t){if(i&1&&(l(0,"div",52)(1,"div",53)(2,"h3",54),y(3),p(4,"translate"),l(5,"span",62),y(6),s()(),l(7,"span",55),y(8),p(9,"translate"),s()(),l(10,"div",59),x(11,gr,1,1,"div",63),s()()),i&2){let e=t.ngIf;a(3),w(" ",_(4,6,"programBuilder.progress.currentWeek")," "),a(3),w("(",e.weekName,")"),a(2),Be(" ",e.completedCount," / ",e.totalCount," ",_(9,8,"programBuilder.progress.workouts")," "),a(3),c("ngForOf",e.segments)}}function hr(i,t){if(i&1&&(l(0,"div",58),x(1,pr,6,4,"div",51)(2,_r,12,10,"div",51),s()),i&2){let e=m();a(),c("ngIf",e.overallWeekProgress()),a(),c("ngIf",e.currentWeekProgress())}}function yr(i,t){i&1&&(l(0,"span"),y(1),p(2,"translate"),s()),i&2&&(a(),B(_(2,1,"programBuilder.form.nameRequired")))}function xr(i,t){if(i&1&&(l(0,"div",68),x(1,yr,3,3,"span",16),s()),i&2){let e,r=m(2);a(),c("ngIf",(e=r.programForm.get("name"))==null||e.errors==null?null:e.errors.required)}}function vr(i,t){if(i&1&&(l(0,"div")(1,"label",65),y(2),p(3,"translate"),s(),v(4,"input",66),p(5,"translate"),x(6,xr,2,1,"div",67),s()),i&2){let e,r,n=m();a(2),w("",_(3,4,"programBuilder.form.nameLabel"),"*"),a(2),c("placeholder",_(5,6,"programBuilder.form.namePlaceholder"))("ngClass",$(8,Xt,((e=n.programForm.get("name"))==null?null:e.invalid)&&((e=n.programForm.get("name"))==null?null:e.touched),!((e=n.programForm.get("name"))!=null&&e.invalid&&((e=n.programForm.get("name"))!=null&&e.touched)))),a(2),c("ngIf",((r=n.programForm.get("name"))==null?null:r.invalid)&&(((r=n.programForm.get("name"))==null?null:r.dirty)||((r=n.programForm.get("name"))==null?null:r.touched)))}}function fr(i,t){if(i&1&&(l(0,"div"),v(1,"p",69),s()),i&2){let e=m();a(),c("innerHTML",e.sanitizedDescription,ve)}}function br(i,t){i&1&&(l(0,"div")(1,"label",70),y(2),p(3,"translate"),s(),v(4,"textarea",71),p(5,"translate"),s()),i&2&&(a(2),B(_(3,2,"programBuilder.form.descriptionLabel")),a(2),c("placeholder",_(5,4,"programBuilder.form.descriptionPlaceholder")))}function kr(i,t){if(i&1){let e=E();l(0,"button",76),C("click",function(){let n=b(e).$implicit,o=m(2);return k(o.toggleGoal(n))}),y(1),p(2,"titlecase"),s()}if(i&2){let e=t.$implicit,r=m(2);c("disabled",r.isViewMode)("ngClass",$(5,er,e&&e.value!==void 0&&r.selectedGoals().includes(e.value),e&&e.value!==void 0&&!r.selectedGoals().includes(e.value))),a(),w(" ",_(2,3,e.label)," ")}}function wr(i,t){if(i&1&&(l(0,"div",72)(1,"label",73),y(2),p(3,"translate"),s(),l(4,"div",74),x(5,kr,3,8,"button",75),s()()),i&2){let e=m();a(2),B(_(3,2,"programBuilder.form.goalsLabel")),a(3),c("ngForOf",e.programGoals)}}function Cr(i,t){i&1&&(l(0,"div")(1,"label",77),y(2),p(3,"translate"),s(),v(4,"input",78),s()),i&2&&(a(2),B(_(3,1,"programBuilder.form.startDateLabel")))}function Sr(i,t){i&1&&(l(0,"div",79)(1,"label",25),v(2,"input",80),l(3,"span",81),y(4),p(5,"translate"),s()(),l(6,"p",82),y(7),p(8,"translate"),s()()),i&2&&(a(4),B(_(5,2,"programBuilder.form.repeatWeeks")),a(3),w(" ",_(8,4,"programBuilder.form.repeatWeeksHint")," "))}function Tr(i,t){if(i&1&&(l(0,"div")(1,"label",83),y(2),p(3,"translate"),l(4,"span",84),v(5,"app-icon",85),s()(),v(6,"input",86),p(7,"translate"),l(8,"p",82),y(9),p(10,"translate"),s()()),i&2){let e=m();a(2),w(" ",_(3,4,"programBuilder.form.cycleLengthLabel")," "),a(3),c("appTooltip",e.infoTooltipString),a(),c("placeholder",_(7,6,"programBuilder.form.cycleLengthPlaceholder")),a(3),w(" ",_(10,8,"programBuilder.form.cycleLengthHint")," ")}}function Br(i,t){i&1&&(l(0,"p",87),y(1),p(2,"translate"),s()),i&2&&(a(),w(" ",_(2,1,"programBuilder.form.editWarning")," "))}function Ir(i,t){i&1&&(l(0,"div")(1,"label",88),y(2),p(3,"translate"),s(),v(4,"textarea",89),s()),i&2&&(a(2),B(_(3,1,"programBuilder.form.notesLabel")))}function Er(i,t){i&1&&(l(0,"div",109),v(1,"app-icon",110),s())}function Pr(i,t){if(i&1){let e=E();l(0,"button",111),C("click",function(n){b(e);let o=m().index,d=m(4);return k(d.removeScheduledDay(o,void 0,n))}),v(1,"app-icon",112),s()}}function Dr(i,t){if(i&1&&(l(0,"option",122),y(1),s()),i&2){let e=t.$implicit;c("value",e.value),a(),w(" ",e.label," ")}}function Fr(i,t){i&1&&(l(0,"div",68),y(1),p(2,"translate"),s()),i&2&&(a(),w(" ",_(2,1,"programBuilder.schedule.dayRequired")," "))}function Mr(i,t){if(i&1){let e=E();l(0,"button",123),C("shortPress",function(){b(e);let n=m(2).index,o=m(4);return k(o.openRoutineSelectionModal(n))}),v(1,"app-icon",124),l(2,"span",84),y(3),p(4,"translate"),s()()}if(i&2){let e,r,n=m(2).index,o=m(4);c("ngClass",te(4,ir,!((e=o.getScheduleDayControl(n).get("routineId"))!=null&&e.value)&&!((e=o.getScheduleDayControl(n).get("routineId"))!=null&&e.invalid&&((e=o.getScheduleDayControl(n).get("routineId"))!=null&&e.touched||o.submitted)),(e=o.getScheduleDayControl(n).get("routineId"))==null?null:e.value,((e=o.getScheduleDayControl(n).get("routineId"))==null?null:e.invalid)&&(((e=o.getScheduleDayControl(n).get("routineId"))==null?null:e.touched)||o.submitted))),a(3),w(" ",_(4,2,(r=o.getScheduleDayControl(n).get("routineId"))!=null&&r.value?"programBuilder.schedule.change":"programBuilder.schedule.select")," ")}}function Nr(i,t){if(i&1){let e=E();l(0,"button",125),C("click",function(){b(e);let n=m(2).index,o=m(4);return k(o.openCustomWorkoutModal(n))}),v(1,"app-icon",126),l(2,"span",84),y(3),p(4,"translate"),s()()}i&2&&(a(3),B(_(4,1,"trainingPrograms.adHocRoutine")))}function Vr(i,t){if(i&1){let e=E();l(0,"button",127),C("click",function(){let n;b(e);let o=m(2),d=o.$implicit,u=o.index,g=m(4);return k(g.editCustomRoutine((n=d.get("routineId"))==null?null:n.value,u))}),v(1,"app-icon",128),y(2),p(3,"translate"),s()}i&2&&(a(2),w(" ",_(3,1,"common.edit")," "))}function Wr(i,t){i&1&&(l(0,"div",68),y(1),p(2,"translate"),s()),i&2&&(a(),w(" ",_(2,1,"programBuilder.schedule.routineRequired")," "))}function Ar(i,t){if(i&1&&(l(0,"div",129)(1,"label",106),y(2),p(3,"translate"),s(),v(4,"input",130),p(5,"translate"),s()),i&2){let e=m(2).index;a(),c("for","timeOfDay-"+e),a(),B(_(3,4,"programBuilder.schedule.timeLabel")),a(2),c("id","timeOfDay-"+e)("placeholder",_(5,6,"programBuilder.schedule.timePlaceholder"))}}function Or(i,t){if(i&1&&(l(0,"div",129)(1,"label",106),y(2),p(3,"translate"),s(),v(4,"textarea",131),s()),i&2){let e=m(2).index;a(),c("for","dayNotes-"+e),a(),B(_(3,3,"programBuilder.schedule.notesLabel")),a(2),c("id","dayNotes-"+e)}}function Rr(i,t){i&1&&ce(0)}function Lr(i,t){if(i&1&&(F(0),x(1,Rr,1,0,"ng-container",136),M()),i&2){let e=t.$implicit,r=t.index;m(8);let n=q(53);a(),c("ngTemplateOutlet",n)("ngTemplateOutletContext",$(2,Yt,e,r))}}function Gr(i,t){if(i&1&&(l(0,"ul"),x(1,Lr,2,5,"ng-container",135),s()),i&2){let e,r=m(3).$implicit,n=m(4);a(),c("ngForOf",n.getExercisesForDay((e=r.get("routineId"))==null?null:e.value))}}function $r(i,t){if(i&1){let e=E();l(0,"div")(1,"div",132)(2,"button",133),C("click",function(){let n;b(e);let o=m(2).$implicit,d=m(4);return k(d.toggleExerciseList((n=o.get("id"))==null?null:n.value))}),v(3,"app-icon",134),y(4),p(5,"translate"),s(),x(6,Gr,2,1,"ul",16),s()()}if(i&2){let e,r,n,o,d=m(2).$implicit,u=m(4);a(),c("id","exercise-list-"+((e=d.get("id"))==null?null:e.value))("ngClass",R(7,Kt,u.bouncedExerciseListId===((r=d.get("id"))==null?null:r.value))),a(2),c("name",u.expandedExerciseLists[(n=d.get("id"))==null?null:n.value]?"chevron-down":"chevron-right"),a(),w(" ",_(5,5,"exerciseList.title")," "),a(2),c("ngIf",u.expandedExerciseLists[(o=d.get("id"))==null?null:o.value])}}function Hr(i,t){if(i&1&&(l(0,"div")(1,"div",113)(2,"div")(3,"label",106),y(4),p(5,"translate"),p(6,"translate"),s(),l(7,"select",114),x(8,Dr,2,2,"option",115),s(),x(9,Fr,3,3,"div",67),s(),l(10,"div")(11,"label",106),y(12),p(13,"translate"),s(),l(14,"div",116),v(15,"input",117),p(16,"translate"),p(17,"translate"),x(18,Mr,5,8,"button",118)(19,Nr,5,3,"button",119)(20,Vr,4,3,"button",120),s(),x(21,Wr,3,3,"div",67),s(),x(22,Ar,6,8,"div",121)(23,Or,5,5,"div",121),s(),x(24,$r,7,9,"div",16),s()),i&2){let e,r,n,o,d,u,g,h,f,T=m(),P=T.$implicit,S=T.index,I=m(4);a(3),c("for","dayOfWeek-"+S),a(),w(" ",I.f.cycleLength.value>0&&I.f.cycleLength.value!==7?_(5,18,"programBuilder.schedule.cycleDayLabel"):_(6,20,"programBuilder.schedule.dayOfWeekLabel")," "),a(3),c("id","dayOfWeek-"+S),a(),c("ngForOf",I.dayOptionsPerIndex[S]),a(),c("ngIf",((e=I.getScheduleDayControl(S).get("dayOfWeek"))==null?null:e.invalid)&&((e=I.getScheduleDayControl(S).get("dayOfWeek"))==null?null:e.touched)),a(2),c("for","routineName-"+S),a(),w("",_(13,22,"programBuilder.schedule.routineLabel"),"*"),a(2),c("ngClass",R(28,tr,((r=I.getScheduleDayControl(S).get("routineId"))==null?null:r.invalid)&&(((r=I.getScheduleDayControl(S).get("routineId"))==null?null:r.touched)||I.submitted))),a(),c("id","routineName-"+S)("value",((n=I.getScheduleDayControl(S).get("routineName"))==null?null:n.value)||((n=I.getScheduleDayControl(S).get("routineId"))!=null&&n.value?_(16,24,"programBuilder.schedule.loadingRoutine"):_(17,26,"programBuilder.schedule.noRoutine")))("ngClass",te(30,rr,((o=I.getScheduleDayControl(S).get("routineId"))==null?null:o.invalid)&&(((o=I.getScheduleDayControl(S).get("routineId"))==null?null:o.touched)||I.submitted),I.isViewMode,!I.getScheduleDayControl(S)||!((o=I.getScheduleDayControl(S).get("routineId"))!=null&&o.value))),a(3),c("ngIf",!I.isViewMode),a(),c("ngIf",!I.isViewMode),a(),c("ngIf",I.isCustomRoutine((d=P.get("routineId"))==null?null:d.value)&&!I.isViewMode),a(),c("ngIf",((u=I.getScheduleDayControl(S).get("routineId"))==null?null:u.invalid)&&(((u=I.getScheduleDayControl(S).get("routineId"))==null?null:u.touched)||I.submitted)),a(),c("ngIf",((g=I.programForm.get("timeOfDay"))==null?null:g.value)||I.isEditableMode()),a(),c("ngIf",((h=I.programForm.get("notes"))==null?null:h.value)||I.isEditableMode()),a(),c("ngIf",(f=P.get("routineId"))==null?null:f.value)}}function zr(i,t){if(i&1){let e=E();l(0,"div",137)(1,"span",138),C("click",function(){let n;b(e);let o=m().$implicit,d=m(4);return k(d.toggleDayExpansion((n=o.get("id"))==null?null:n.value))}),y(2),p(3,"translate"),p(4,"translate"),s()()}if(i&2){let e,r=m().$implicit;a(2),N(" ",_(3,2,"programBuilder.schedule.routineLabel"),": ",((e=r.get("routineName"))==null?null:e.value)||_(4,4,"programBuilder.schedule.noRoutine"))}}function jr(i,t){if(i&1){let e=E();l(0,"div",97)(1,"div",98),C("click",function(n){let o,d=b(e).$implicit;return m(4).toggleDayExpansion((o=d.get("id"))==null?null:o.value),k(n.stopPropagation())}),l(2,"div",99),x(3,Er,2,0,"div",100),l(4,"button",101),v(5,"app-icon",102),s()(),x(6,Pr,2,0,"button",103),s(),l(7,"div",104)(8,"h4",105)(9,"label",106),y(10),p(11,"translate"),s(),v(12,"input",107),p(13,"translate"),s()(),x(14,Hr,25,34,"div",16)(15,zr,5,6,"div",108),s()}if(i&2){let e,r,n,o,d=t.$implicit,u=t.index,g=m(4);c("id","day-expanded-"+((e=d.get("id"))==null?null:e.value))("formGroupName",u)("cdkDragDisabled",g.isViewMode),a(3),c("ngIf",!g.isViewMode),a(2),c("name",g.isDayExpanded((r=d.get("id"))==null?null:r.value)?"chevron-down":"chevron-right"),a(),c("ngIf",!g.isViewMode),a(),c("ngClass",R(18,qt,g.isEditableMode())),a(2),c("for","dayName-cycled-"+u),a(),B(_(11,14,"programBuilder.schedule.dayNameLabel")),a(2),c("id","dayName-cycled-"+u)("placeholder",_(13,16,"programBuilder.schedule.dayNamePlaceholder"))("ngClass",R(20,ge,!g.isViewMode)),a(2),c("ngIf",g.isDayExpanded((n=d.get("id"))==null?null:n.value)),a(),c("ngIf",!g.isDayExpanded((o=d.get("id"))==null?null:o.value))}}function Ur(i,t){if(i&1){let e=E();l(0,"div",95),C("cdkDropListDropped",function(n){b(e);let o=m(3);return k(o.onScheduleDrop(n))}),x(1,jr,16,22,"div",96),s()}if(i&2){let e=m(3);c("cdkDropListData",e.scheduleFormGroups),a(),c("ngForOf",e.scheduleFormArray.controls)}}function qr(i,t){if(i&1){let e=E();l(0,"button",141),C("click",function(){b(e);let n=m(4);return k(n.addScheduledDay())}),y(1),p(2,"translate"),s()}i&2&&(a(),w(" ",_(2,1,"programBuilder.schedule.addFirstDay")," "))}function Kr(i,t){if(i&1&&(l(0,"div",139)(1,"p"),y(2),p(3,"translate"),s(),x(4,qr,3,3,"button",140),s()),i&2){let e=m(3);a(2),B(_(3,2,"programBuilder.schedule.noDays")),a(2),c("ngIf",!e.isViewMode)}}function Yr(i,t){if(i&1){let e=E();l(0,"button",144),C("shortPress",function(){b(e);let n=m(4);return k(n.addScheduledDay())}),v(1,"app-icon",145),l(2,"span",84),y(3),p(4,"translate"),s()()}i&2&&(a(3),B(_(4,1,"programBuilder.schedule.addDay")))}function Qr(i,t){if(i&1&&(l(0,"div",142),x(1,Yr,5,3,"button",143),s()),i&2){let e=m(3);a(),c("ngIf",!e.isViewMode)}}function Zr(i,t){if(i&1&&(l(0,"section",15)(1,"div",91)(2,"h2",92),y(3),p(4,"translate"),s()(),x(5,Ur,2,2,"div",93)(6,Kr,5,4,"div",94)(7,Qr,2,1,"ng-template",null,1,K),s()),i&2){let e=q(8),r=m(2);a(3),B(_(4,4,"programBuilder.schedule.title")),a(2),c("ngIf",r.scheduleFormArray.length>0),a(),c("ngIf",r.scheduleFormArray.length===0)("ngIfElse",e)}}function Jr(i,t){i&1&&(l(0,"div",159),ee(),l(1,"svg",160),v(2,"path",161),s()())}function Xr(i,t){if(i&1){let e=E();l(0,"button",162),C("shortPress",function(n){b(e);let o=m().index;return m(3).removeWeek(o,n),k(n.stopPropagation())}),v(1,"app-icon",163),s()}}function ei(i,t){i&1&&(l(0,"div",109),v(1,"app-icon",110),s())}function ti(i,t){if(i&1){let e=E();l(0,"button",169),C("click",function(n){b(e);let o=m().index,d=m(2).index,u=m(3);return k(u.removeScheduledDay(o,d,n))}),v(1,"app-icon",112),s()}}function ri(i,t){if(i&1&&(l(0,"option",122),y(1),s()),i&2){let e=t.$implicit;c("value",e.value),a(),w(" ",e.label," ")}}function ii(i,t){if(i&1){let e=E();l(0,"button",175),C("shortPress",function(){b(e);let n=m(2).index,o=m(2).index,d=m(3);return k(d.openRoutineSelectionModal(o,n))}),v(1,"app-icon",176),y(2),p(3,"translate"),s()}if(i&2){let e,r,n=m(2).index,o=m(2).index,d=m(3);c("ngClass",te(4,ar,!((e=d.getWeekScheduleDayControl(o,n).get("routineName"))!=null&&e.value)&&!((e=d.getWeekScheduleDayControl(o,n).get("routineName"))!=null&&e.invalid&&((e=d.getWeekScheduleDayControl(o,n).get("routineName"))!=null&&e.touched||d.submitted)),(e=d.getWeekScheduleDayControl(o,n).get("routineName"))==null?null:e.value,((e=d.getWeekScheduleDayControl(o,n).get("routineName"))==null?null:e.invalid)&&(((e=d.getWeekScheduleDayControl(o,n).get("routineName"))==null?null:e.touched)||d.submitted))),a(2),w(" ",_(3,2,(r=d.getWeekScheduleDayControl(o,n).get("routineName"))!=null&&r.value?"programBuilder.schedule.change":"programBuilder.schedule.select")," ")}}function ni(i,t){if(i&1){let e=E();l(0,"button",125),C("click",function(){b(e);let n=m(2).index,o=m(2).index,d=m(3);return k(d.openCustomWorkoutModal(n,o))}),v(1,"app-icon",126),l(2,"span",84),y(3),p(4,"translate"),s()()}i&2&&(a(3),B(_(4,1,"trainingPrograms.adHocRoutine")))}function ai(i,t){if(i&1){let e=E();l(0,"button",127),C("click",function(){let n;b(e);let o=m(2),d=o.$implicit,u=o.index,g=m(2).index,h=m(3);return k(h.editCustomRoutine((n=d.get("routineId"))==null?null:n.value,u,g))}),v(1,"app-icon",128),y(2),p(3,"translate"),s()}i&2&&(a(2),w(" ",_(3,1,"common.edit")," "))}function oi(i,t){i&1&&ce(0)}function si(i,t){if(i&1&&(F(0),x(1,oi,1,0,"ng-container",136),M()),i&2){let e=t.$implicit,r=t.index;m(9);let n=q(53);a(),c("ngTemplateOutlet",n)("ngTemplateOutletContext",$(2,Yt,e,r))}}function li(i,t){if(i&1&&(l(0,"ul"),x(1,si,2,5,"ng-container",135),s()),i&2){let e,r=m(3).$implicit,n=m(5);a(),c("ngForOf",n.getExercisesForDay((e=r.get("routineId"))==null?null:e.value))}}function di(i,t){if(i&1){let e=E();l(0,"div",null,3)(2,"div",132)(3,"button",133),C("click",function(){let n;b(e);let o=m(2).$implicit,d=m(5);return k(d.toggleExerciseList((n=o.get("id"))==null?null:n.value))}),v(4,"app-icon",134),y(5),p(6,"translate"),s(),x(7,li,2,1,"ul",16),s()()}if(i&2){let e,r,n,o,d=m(2).$implicit,u=m(5);a(2),c("id","exercise-list-"+((e=d.get("id"))==null?null:e.value))("ngClass",R(7,Kt,u.bouncedExerciseListId===((r=d.get("id"))==null?null:r.value))),a(2),c("name",u.expandedExerciseLists[(n=d.get("id"))==null?null:n.value]?"chevron-down":"chevron-right"),a(),w(" ",_(6,5,"exerciseList.title")," "),a(2),c("ngIf",u.expandedExerciseLists[(o=d.get("id"))==null?null:o.value])}}function ci(i,t){if(i&1&&(l(0,"div")(1,"div",113)(2,"div")(3,"label",106),y(4),p(5,"translate"),s(),l(6,"select",170),x(7,ri,2,2,"option",115),s()(),l(8,"div")(9,"label",106),y(10),p(11,"translate"),s(),l(12,"div",171),v(13,"input",172),p(14,"translate"),x(15,ii,4,8,"button",173)(16,ni,5,3,"button",119)(17,ai,4,3,"button",120),s()(),l(18,"div",129)(19,"label",106),y(20),p(21,"translate"),s(),v(22,"textarea",174),s()(),x(23,di,8,9,"div",16),s()),i&2){let e,r,n,o,d,u=m(),g=u.$implicit,h=u.index,f=m(2).index,T=m(3);a(3),c("for","dayOfWeek-"+f+"-"+h),a(),B(_(5,16,"programBuilder.schedule.dayOfWeekLabel")),a(2),c("id","dayOfWeek-"+f+"-"+h),a(),c("ngForOf",T.getCurrentDayOptionsForWeek(f,(e=g.get("dayOfWeek"))==null?null:e.value)),a(2),c("for","routineName-"+f+"-"+h),a(),w("",_(11,18,"programBuilder.schedule.routineLabel"),"*"),a(3),c("id","routineName-"+f+"-"+h)("value",((r=T.getWeekScheduleDayControl(f,h).get("routineName"))==null?null:r.value)||_(14,20,"programBuilder.schedule.noRoutine"))("ngClass",$(24,nr,T.isViewMode,!T.getWeekScheduleDayControl(f,h)||!((n=T.getWeekScheduleDayControl(f,h).get("routineId"))!=null&&n.value))),a(2),c("ngIf",!T.isViewMode),a(),c("ngIf",!T.isViewMode),a(),c("ngIf",T.isCustomRoutine((o=g.get("routineId"))==null?null:o.value)&&!T.isViewMode),a(2),c("for","dayNotes-"+f+"-"+h),a(),B(_(21,22,"programBuilder.schedule.notesLabel")),a(2),c("id","dayNotes-"+f+"-"+h),a(),c("ngIf",(d=g.get("routineId"))==null?null:d.value)}}function mi(i,t){if(i&1){let e=E();l(0,"div",137)(1,"span",138),C("click",function(){let n;b(e);let o=m().$implicit,d=m(5);return k(d.toggleDayExpansion((n=o.get("id"))==null?null:n.value))}),y(2),p(3,"translate"),p(4,"translate"),s()()}if(i&2){let e,r=m().$implicit;a(2),N(" ",_(3,2,"programBuilder.schedule.routineLabel"),": ",((e=r.get("routineName"))==null?null:e.value)||_(4,4,"programBuilder.schedule.noRoutine"))}}function ui(i,t){if(i&1){let e=E();l(0,"div",167)(1,"div",98),C("click",function(n){let o,d=b(e).$implicit;return m(5).toggleDayExpansion((o=d.get("id"))==null?null:o.value),k(n.stopPropagation())}),l(2,"div",99),x(3,ei,2,0,"div",100),l(4,"button",101),v(5,"app-icon",102),s()(),x(6,ti,2,0,"button",168),s(),l(7,"div",104)(8,"h4",105)(9,"label",106),y(10),p(11,"translate"),s(),v(12,"input",107),p(13,"translate"),s()(),x(14,ci,24,27,"div",16)(15,mi,5,6,"div",108),s()}if(i&2){let e,r,n,o,d=t.$implicit,u=t.index,g=m(5);c("formGroupName",u)("cdkDragDisabled",g.isViewMode)("id","day-expanded-"+((e=d.get("id"))==null?null:e.value)),a(3),c("ngIf",!g.isViewMode),a(2),c("name",g.isDayExpanded((r=d.get("id"))==null?null:r.value)?"chevron-down":"chevron-right"),a(),c("ngIf",!g.isViewMode),a(),c("ngClass",R(18,qt,g.isEditableMode())),a(2),c("for","dayName-"+u),a(),B(_(11,14,"programBuilder.schedule.dayNameLabel")),a(2),c("id","dayName-"+u)("placeholder",_(13,16,"programBuilder.schedule.dayNamePlaceholder"))("ngClass",R(20,ge,!g.isViewMode)),a(2),c("ngIf",g.isDayExpanded((n=d.get("id"))==null?null:n.value)),a(),c("ngIf",!g.isDayExpanded((o=d.get("id"))==null?null:o.value))}}function pi(i,t){if(i&1){let e=E();l(0,"button",144),C("shortPress",function(){b(e);let n=m(3).index,o=m(3);return k(o.addScheduledDay(n))}),v(1,"app-icon",145),l(2,"span",84),y(3),p(4,"translate"),s()()}i&2&&(a(3),B(_(4,1,"programBuilder.weeks.addDayToWeek")))}function gi(i,t){if(i&1&&(l(0,"div",177),x(1,pi,5,3,"button",143),s()),i&2){let e=m(5);a(),c("ngIf",!e.isViewMode)}}function _i(i,t){i&1&&(l(0,"div",178),y(1),p(2,"translate"),s()),i&2&&(a(),w("",_(2,1,"programBuilder.weeks.emptyWeek")," "))}function hi(i,t){if(i&1){let e=E();l(0,"div")(1,"div",95),C("cdkDropListDropped",function(n){b(e);let o=m().index,d=m(3);return k(d.onDayDropInWeek(n,o))}),x(2,ui,16,22,"div",164),s(),x(3,gi,2,1,"div",165)(4,_i,3,3,"div",166),s()}if(i&2){let e=m().index,r=m(3);a(),c("cdkDropListData",r.getWeekScheduleGroups(e)),a(),c("ngForOf",r.getWeekScheduleGroups(e)),a(),c("ngIf",r.getWeekScheduleGroups(e).length<7),a(),c("ngIf",r.getWeekScheduleGroups(e).length===0)}}function yi(i,t){if(i&1&&(l(0,"li",183)(1,"span",62),y(2),s(),l(3,"span",184),y(4),p(5,"translate"),p(6,"translate"),s()()),i&2){let e,r=t.$implicit,n=m(5);a(2),w(" ",n.getDayDisplayName(r)," "),a(2),N("",_(5,3,"programBuilder.schedule.routineLabel"),": ",((e=r.get("routineName"))==null?null:e.value)||_(6,5,"programBuilder.schedule.noRoutine"))}}function xi(i,t){i&1&&(l(0,"li",185),y(1),p(2,"translate"),s()),i&2&&(a(),w(" ",_(2,1,"programBuilder.weeks.emptyWeek")," "))}function vi(i,t){if(i&1){let e=E();l(0,"div",179),C("click",function(n){let o;b(e);let d=m().$implicit,u=m(3);return k(u.toggleWeek((o=d.get("id"))==null?null:o.value,n))}),l(1,"ul",180),x(2,yi,7,7,"li",181)(3,xi,3,3,"li",182),s()()}if(i&2){let e=m().index,r=m(3);a(2),c("ngForOf",r.getWeekScheduleGroups(e)),a(),c("ngIf",r.getWeekScheduleGroups(e).length===0)}}function fi(i,t){if(i&1){let e=E();l(0,"div",148)(1,"div",149),C("click",function(n){let o,d=b(e).$implicit,u=m(3);return k(u.toggleWeek((o=d.get("id"))==null?null:o.value,n))}),l(2,"div",150),x(3,Jr,3,0,"div",151),l(4,"button",152),C("click",function(n){let o,d=b(e).$implicit;return m(3).toggleWeek((o=d.get("id"))==null?null:o.value,n),k(n.stopPropagation())}),v(5,"app-icon",153),s()(),l(6,"div",154)(7,"label",155),y(8,"Week Name"),s(),v(9,"input",156),p(10,"translate"),s(),x(11,Xr,2,0,"button",157),s(),x(12,hi,5,4,"div",16)(13,vi,4,2,"div",158),s()}if(i&2){let e,r,n,o=t.$implicit,d=t.index,u=m(3);c("formGroupName",d)("cdkDragDisabled",u.isViewMode)("id","week-header-"+d),a(),c("id",Fe("week-header-",d)),a(2),c("ngIf",!u.isViewMode),a(2),c("name",u.isWeekExpanded((e=o.get("id"))==null?null:e.value)?"chevron-down":"chevron-right"),a(2),c("for","weekName-"+d),a(2),c("id","weekName-"+d)("placeholder",_(10,14,"programBuilder.weeks.weekNamePlaceholder"))("ngClass",R(16,ge,!u.isViewMode)),a(2),c("ngIf",!u.isViewMode),a(),c("ngIf",u.isWeekExpanded((r=o.get("id"))==null?null:r.value)),a(),c("ngIf",!u.isWeekExpanded((n=o.get("id"))==null?null:n.value))}}function bi(i,t){if(i&1){let e=E();l(0,"button",141),C("click",function(){b(e);let n=m(4);return k(n.addWeek())}),y(1),p(2,"translate"),s()}i&2&&(a(),w(" ",_(2,1,"programBuilder.weeks.addFirstWeek")," "))}function ki(i,t){if(i&1&&(l(0,"div",139)(1,"p"),y(2),p(3,"translate"),s(),x(4,bi,3,3,"button",140),s()),i&2){let e=m(3);a(2),B(_(3,2,"programBuilder.weeks.noWeeks")),a(2),c("ngIf",!e.isViewMode)}}function wi(i,t){if(i&1){let e=E();l(0,"button",187),C("shortPress",function(){b(e);let n=m(4);return k(n.addWeek())}),v(1,"app-icon",188),y(2),p(3,"translate"),s()}i&2&&(a(2),w("",_(3,1,"programBuilder.weeks.addWeek")," "))}function Ci(i,t){if(i&1&&(l(0,"div",142),x(1,wi,4,3,"button",186),s()),i&2){let e=m(3);a(),c("ngIf",!e.isViewMode)}}function Si(i,t){if(i&1){let e=E();l(0,"section",15)(1,"div",91)(2,"h2",92),y(3),p(4,"translate"),s()(),l(5,"div",146),C("cdkDropListDropped",function(n){b(e);let o=m(2);return k(o.onWeekDrop(n))}),x(6,fi,14,18,"div",147),s(),x(7,ki,5,4,"div",94)(8,Ci,2,1,"ng-template",null,2,K),s()}if(i&2){let e=q(9),r=m(2);a(3),B(_(4,4,"programBuilder.weeks.title")),a(3),c("ngForOf",r.weeksFormArray.controls),a(),c("ngIf",r.weeksFormArray.length===0)("ngIfElse",e)}}function Ti(i,t){if(i&1&&(F(0),x(1,Zr,9,6,"section",90)(2,Si,10,6,"section",90),M()),i&2){let e,r,n=m();a(),c("ngIf",((e=n.programForm.get("programType"))==null?null:e.value)==="cycled"),a(),c("ngIf",((r=n.programForm.get("programType"))==null?null:r.value)==="linear")}}function Bi(i,t){i&1&&v(0,"app-icon",195)}function Ii(i,t){i&1&&v(0,"app-icon",196)}function Ei(i,t){if(i&1){let e=E();l(0,"div",189)(1,"button",190),C("shortPress",function(){b(e);let n=m();return k(n.navigateToPrograms())}),v(2,"app-icon",191),y(3),p(4,"translate"),s(),l(5,"button",192),C("shortPress",function(){b(e);let n=m();return k(n.onSubmit())}),x(6,Bi,1,0,"app-icon",193)(7,Ii,1,0,"app-icon",194),l(8,"span",84),y(9),p(10,"translate"),s()()()}if(i&2){let e=m();a(3),w(" ",_(4,5,"programBuilder.actions.cancel")," "),a(2),c("disabled",e.programForm.invalid),a(),c("ngIf",e.isNewMode),a(),c("ngIf",!e.isNewMode),a(2),w(" ",_(10,7,e.isNewMode?"programBuilder.actions.createProgram":"programBuilder.actions.saveChanges")," ")}}function Pi(i,t){if(i&1&&(y(0),p(1,"translate"),l(2,"span",62),y(3),p(4,"translate"),p(5,"translate"),s()),i&2){let e=m(3);w(" ",_(1,5,"programBuilder.modal.selectingFor"),": "),a(3),Ie(" ",_(4,7,"programBuilder.modal.week")," ",e.targetIndicesForRoutine.weekIndex+1,", ",_(5,9,"programBuilder.modal.day")," ",e.targetIndicesForRoutine.dayIndex+1," ")}}function Di(i,t){if(i&1&&(y(0),p(1,"translate"),l(2,"span",62),y(3),p(4,"translate"),s()),i&2){let e=m(3);w(" ",_(1,3,"programBuilder.modal.selectingFor"),": "),a(3),N(" ",_(4,5,"programBuilder.modal.day")," ",e.targetIndicesForRoutine.dayIndex+1," ")}}function Fi(i,t){if(i&1&&le(0,Pi,6,11)(1,Di,5,7),i&2){let e=m(2);de(e.targetIndicesForRoutine.weekIndex!==void 0?0:1)}}function Mi(i,t){if(i&1&&(l(0,"div",214)(1,"div",215)(2,"div",216),y(3),p(4,"translate"),s(),l(5,"li",217)(6,"div",218)(7,"span",219),y(8),s(),l(9,"span",220),y(10),p(11,"translate"),p(12,"titlecase"),s()(),v(13,"app-icon",221),s()()()),i&2){let e=t.ngIf;a(3),w(" ",_(4,5,"programBuilder.modal.currentSelectedRoutine")," "),a(2),se("aria-disabled",!0),a(3),B(e.name),a(2),N(" ",_(12,9,_(11,7,"workoutBuilder.goals."+e.goal))," - ",e.workoutExercises.length," exercises ")}}function Ni(i,t){if(i&1){let e=E();l(0,"li",223),C("click",function(){b(e);let n=m().$implicit,o=m(2);return k(o.selectRoutineForDay(n))}),l(1,"div",218)(2,"span",219),y(3),s(),l(4,"span",220),y(5),p(6,"translate"),p(7,"titlecase"),s()(),ee(),l(8,"svg",224),v(9,"path",225),s()()}if(i&2){let e=m().$implicit,r=m(2);Te("opacity-50",r.chosenRoutineForModal&&e.id===r.chosenRoutineForModal.id)("cursor-not-allowed",r.chosenRoutineForModal&&e.id===r.chosenRoutineForModal.id),se("aria-disabled",r.chosenRoutineForModal&&e.id===r.chosenRoutineForModal.id),a(3),B(e.name),a(2),N(" ",_(7,10,_(6,8,"workoutBuilder.goals."+e.goal))," - ",e.workoutExercises.length," exercises ")}}function Vi(i,t){if(i&1&&(F(0),x(1,Ni,10,12,"li",222),M()),i&2){let e=t.$implicit,r=m(2);a(),c("ngIf",!r.chosenRoutineForModal||e.id!==r.chosenRoutineForModal.id)}}function Wi(i,t){i&1&&(l(0,"li",226),y(1),p(2,"translate"),s()),i&2&&(a(),B(_(2,1,"programBuilder.modal.noMatches")))}function Ai(i,t){i&1&&(l(0,"li",226),y(1),p(2,"translate"),s()),i&2&&(a(),B(_(2,1,"programBuilder.modal.noRoutines")))}function Oi(i,t){if(i&1){let e=E();l(0,"div",197,4),C("click",function(){b(e);let n=m();return k(n.closeRoutineSelectionModal())}),l(2,"div",198),C("click",function(n){return b(e),k(n.stopPropagation())}),l(3,"div",199)(4,"div",200)(5,"div",201)(6,"div",202)(7,"h3",203),y(8),p(9,"translate"),s(),l(10,"button",204),C("click",function(){b(e);let n=m();return k(n.closeRoutineSelectionModal())}),v(11,"app-icon",205),s()(),l(12,"div",206),le(13,Fi,2,1),s(),l(14,"div",207)(15,"input",208),p(16,"translate"),C("ngModelChange",function(n){b(e);let o=m();return k(o.modalSearchTerm.set(n))}),s()(),l(17,"div",209)(18,"ul",52),x(19,Mi,14,11,"div",210)(20,Vi,2,1,"ng-container",135)(21,Wi,3,3,"li",211)(22,Ai,3,3,"li",211),s()()()()(),l(23,"div",212)(24,"button",213),C("click",function(){b(e);let n=m();return k(n.closeRoutineSelectionModal())}),y(25),p(26,"translate"),s()()()()}if(i&2){let e=m();a(8),B(_(9,9,"programBuilder.modal.selectRoutineTitle")),a(5),de(e.targetIndicesForRoutine?13:-1),a(2),c("placeholder",_(16,11,"programBuilder.modal.searchPlaceholder"))("ngModel",e.modalSearchTerm()),a(4),c("ngIf",e.chosenRoutineForModal),a(),c("ngForOf",e.filteredAvailableRoutines()),a(),c("ngIf",e.filteredAvailableRoutines().length===0&&e.availableRoutines.length>0),a(),c("ngIf",e.availableRoutines.length===0),a(3),w(" ",_(26,13,"programBuilder.actions.cancel")," ")}}function Ri(i,t){if(i&1){let e=E();F(0),l(1,"td",243),y(2),p(3,"date"),s(),l(4,"td",243),y(5),p(6,"date"),s(),l(7,"td",243),y(8),p(9,"translate"),p(10,"titlecase"),s(),l(11,"td",243),y(12),p(13,"date"),s(),l(14,"td",244)(15,"div",245)(16,"button",246),p(17,"translate"),C("click",function(){b(e);let n=m().$implicit,o=m(3);return k(o.editHistoryEntry(n))}),v(18,"app-icon",247),s(),l(19,"button",248),p(20,"translate"),C("click",function(){b(e);let n=m().$implicit,o=m(3);return k(o.removeProgramHistoryEntry(n.id))}),v(21,"app-icon",249),s()()(),M()}if(i&2){let e=m().$implicit;a(2),B(e.startDate&&e.startDate!=="-"?j(3,6,e.startDate,"dd/MM/yy"):"-"),a(3),B(e.endDate&&e.endDate!=="-"?j(6,9,e.endDate,"dd/MM/yy"):"-"),a(3),B(_(10,14,_(9,12,"programBuilder.history."+e.status))),a(4),B(e.date&&e.date!=="-"?j(13,16,e.date,"dd/MM/yy HH:mm"):"-"),a(4),c("title",_(17,19,"programBuilder.modal.editEntry")),a(3),c("title",_(20,21,"programBuilder.modal.deleteEntry"))}}function Li(i,t){if(i&1&&(l(0,"option",122),y(1),p(2,"titlecase"),s()),i&2){let e=t.$implicit;c("value",e),a(),B(_(2,2,e))}}function Gi(i,t){if(i&1){let e=E();F(0),l(1,"td",250),v(2,"input",251),s(),l(3,"td",250),v(4,"input",252),s(),l(5,"td",250)(6,"select",253),C("change",function(){let n;b(e);let o=m(4);return k(((n=o.historyEditForm.get("status"))==null?null:n.value)==="active"?o.forceEndDateToNull():o.enableEndDate())}),x(7,Li,3,4,"option",115),s()(),l(8,"td",254),y(9),p(10,"translate"),s(),l(11,"td",255)(12,"div",256)(13,"button",257),p(14,"translate"),v(15,"app-icon",258),s(),l(16,"button",246),p(17,"translate"),C("click",function(){b(e);let n=m(4);return k(n.cancelEditHistoryEntry())}),v(18,"app-icon",259),s()()(),M()}if(i&2){let e=m(4);a(7),c("ngForOf",e.statusOptions),a(2),w("",_(10,5,"programBuilder.modal.editing"),"... "),a(4),c("disabled",e.historyEditForm.invalid)("title",_(14,7,"programBuilder.modal.saveChanges")),a(3),c("title",_(17,9,"programBuilder.modal.cancelEdit"))}}function $i(i,t){if(i&1&&(l(0,"tr"),x(1,Ri,22,23,"ng-container",16)(2,Gi,19,11,"ng-container",16),s()),i&2){let e=t.$implicit,r=m(3);a(),c("ngIf",r.editingHistoryEntryId()!==e.id),a(),c("ngIf",r.editingHistoryEntryId()===e.id)}}function Hi(i,t){if(i&1){let e=E();l(0,"div")(1,"div",262)(2,"div",263),y(3),p(4,"translate"),s(),l(5,"div",264),y(6),p(7,"translate"),p(8,"titlecase"),s(),l(9,"div",263),y(10),p(11,"translate"),s(),l(12,"div",265),y(13),p(14,"date"),s(),l(15,"div",263),y(16),p(17,"translate"),s(),l(18,"div",265),y(19),p(20,"date"),s(),l(21,"div",263),y(22),p(23,"translate"),s(),l(24,"div",266),y(25),p(26,"date"),s()(),l(27,"div",267)(28,"button",268),C("click",function(){b(e);let n=m().$implicit,o=m(3);return k(o.editHistoryEntry(n))}),v(29,"app-icon",269),y(30),p(31,"translate"),s(),l(32,"button",270),C("click",function(){b(e);let n=m().$implicit,o=m(3);return k(o.removeProgramHistoryEntry(n.id))}),v(33,"app-icon",271),y(34),p(35,"translate"),s()()()}if(i&2){let e=m().$implicit;a(3),B(_(4,10,"programBuilder.modal.historyTable.status")),a(3),w("",_(8,14,_(7,12,"programBuilder.history."+e.status))," "),a(4),w("",_(11,16,"programBuilder.modal.historyTable.start")," "),a(3),B(e.startDate&&e.startDate!=="-"?j(14,18,e.startDate,"MMM d, yyyy"):"-"),a(3),B(_(17,21,"programBuilder.modal.historyTable.end")),a(3),B(e.endDate&&e.endDate!=="-"?j(20,23,e.endDate,"MMM d, yyyy"):"-"),a(3),B(_(23,26,"programBuilder.modal.historyTable.logged")),a(3),B(e.date&&e.date!=="-"?j(26,28,e.date,"MMM d, yyyy HH:mm"):"-"),a(5),w(" ",_(31,31,"common.edit")," "),a(4),w(" ",_(35,33,"common.delete")," ")}}function zi(i,t){if(i&1&&(l(0,"option",122),y(1),p(2,"titlecase"),s()),i&2){let e=t.$implicit;c("value",e),a(),B(_(2,2,e))}}function ji(i,t){if(i&1){let e=E();l(0,"div",272)(1,"div")(2,"label",273),y(3),p(4,"translate"),s(),l(5,"select",274),C("change",function(){let n;b(e);let o=m(4);return k(((n=o.historyEditForm.get("status"))==null?null:n.value)==="active"?o.forceEndDateToNull():o.enableEndDate())}),x(6,zi,3,4,"option",115),s()(),l(7,"div")(8,"label",273),y(9),p(10,"translate"),s(),v(11,"input",275),s(),l(12,"div")(13,"label",273),y(14),p(15,"translate"),s(),v(16,"input",276),s(),l(17,"div",267)(18,"button",277),C("click",function(){b(e);let n=m(4);return k(n.cancelEditHistoryEntry())}),y(19),p(20,"translate"),s(),l(21,"button",278),v(22,"app-icon",279),y(23),p(24,"translate"),s()()()}if(i&2){let e=m(4);a(3),B(_(4,7,"programBuilder.modal.historyTable.status")),a(3),c("ngForOf",e.statusOptions),a(3),B(_(10,9,"programBuilder.modal.historyTable.start")),a(5),B(_(15,11,"programBuilder.modal.historyTable.end")),a(5),w(" ",_(20,13,"programBuilder.actions.cancel")," "),a(2),c("disabled",e.historyEditForm.invalid),a(2),w(" ",_(24,15,"programBuilder.actions.saveChanges")," ")}}function Ui(i,t){if(i&1&&(l(0,"div",260),x(1,Hi,36,35,"div",16)(2,ji,25,17,"div",261),s()),i&2){let e=t.$implicit,r=m(3);a(),c("ngIf",r.editingHistoryEntryId()!==e.id),a(),c("ngIf",r.editingHistoryEntryId()===e.id)}}function qi(i,t){if(i&1){let e=E();l(0,"div")(1,"form",236),C("ngSubmit",function(){b(e);let n=m(2);return k(n.saveHistoryEntry())}),l(2,"table",237)(3,"thead")(4,"tr")(5,"th",238),y(6),p(7,"translate"),s(),l(8,"th",238),y(9),p(10,"translate"),s(),l(11,"th",238),y(12),p(13,"translate"),s(),l(14,"th",238),y(15),p(16,"translate"),s(),l(17,"th",239),y(18),p(19,"translate"),s()()(),l(20,"tbody",240),x(21,$i,3,2,"tr",135),s()(),l(22,"div",241),x(23,Ui,3,2,"div",242),s()()()}if(i&2){let e,r,n=m(2);a(),c("formGroup",n.historyEditForm),a(5),w(" ",_(7,8,"programBuilder.modal.historyTable.start")),a(3),w(" ",_(10,10,"programBuilder.modal.historyTable.end")),a(3),w(" ",_(13,12,"programBuilder.modal.historyTable.status")),a(3),w(" ",_(16,14,"programBuilder.modal.historyTable.logged")),a(3),w(" ",_(19,16,"programBuilder.modal.historyTable.actions")),a(3),c("ngForOf",(e=n.currentProgram())==null?null:e.history),a(2),c("ngForOf",(r=n.currentProgram())==null?null:r.history)}}function Ki(i,t){i&1&&(l(0,"div",280),y(1),p(2,"translate"),s()),i&2&&(a(),w(" ",_(2,1,"programBuilder.modal.noHistory")," "))}function Yi(i,t){if(i&1){let e=E();l(0,"div",227)(1,"div",228),C("click",function(n){return b(e),k(n.stopPropagation())}),l(2,"div",229)(3,"h2",230),y(4),p(5,"translate"),s(),l(6,"button",231),C("click",function(){b(e);let n=m();return k(n.closeProgramHistoryModal())}),v(7,"app-icon",205),s()(),l(8,"div",232),x(9,qi,24,18,"div",233)(10,Ki,3,3,"ng-template",null,5,K),s(),l(12,"div",234)(13,"button",235),C("click",function(){b(e);let n=m();return k(n.closeProgramHistoryModal())}),v(14,"app-icon",191),y(15),p(16,"translate"),s()()()()}if(i&2){let e,r=q(11),n=m();a(4),B(_(5,4,"programBuilder.modal.historyTitle")),a(5),c("ngIf",(e=n.currentProgram())==null||e.history==null?null:e.history.length)("ngIfElse",r),a(6),w(" ",_(16,6,"programBuilder.modal.close")," ")}}function Qi(i,t){if(i&1){let e=E();l(0,"div",281)(1,"div",282)(2,"div",283)(3,"h2",284),y(4),p(5,"translate"),s(),l(6,"button",285),C("click",function(){b(e);let n=m();return k(n.closeCustomWorkoutModal())}),v(7,"app-icon",286),s()(),l(8,"div",287)(9,"app-workout-builder",288),C("routineConfirmed",function(n){b(e);let o=m();return k(o.handleCustomRoutineConfirmed(n))})("modalClose",function(){b(e);let n=m();return k(n.closeCustomWorkoutModal())}),s()()()()}if(i&2){let e=m();a(4),w(" ",_(5,4,"trainingPrograms.addCustomRoutine")," "),a(5),c("context","modal")("mode",e.builderMode.customProgramEntryBuilder)("initialRoutine",e.customRoutineToEdit)}}function Zi(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().ngIf;a(),N("",e.reps," ",_(2,2,"metrics.reps"))}}function Ji(i,t){if(i&1&&(F(0),y(1),M()),i&2){let e=m().ngIf,r=m(2);a(),N("@ ",e.weight," ",r.unitsService.getWeightUnitSuffix())}}function Xi(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().ngIf;a(),N("",e.duration," ",_(2,2,"metrics.duration"))}}function en(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().ngIf;a(),N("",e.distance," ",_(2,2,"metrics.distance"))}}function tn(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().ngIf;a(),N(" | ",_(2,2,"metrics.rest"),": ",e.rest,"s")}}function rn(i,t){if(i&1&&(l(0,"div",295)(1,"strong"),y(2),s(),y(3),p(4,"translate"),x(5,Zi,3,4,"ng-container",16)(6,Ji,2,2,"ng-container",16)(7,Xi,3,4,"ng-container",16)(8,en,3,4,"ng-container",16)(9,tn,3,4,"ng-container",16),s()),i&2){let e=t.ngIf,r=m().ex,n=m();a(2),B(n.getExerciseSetCountDisplay(r)),a(),w(" ",_(4,7,"programBuilder.exercise.of")," "),a(2),c("ngIf",e.reps),a(),c("ngIf",e.weight),a(),c("ngIf",e.duration),a(),c("ngIf",e.distance),a(),c("ngIf",e.rest)}}function nn(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().$implicit,r=m(3);a(),N(" ",r.workoutUtilService.getRepsValue(e.targetReps)," ",_(2,2,"metrics.reps")," ")}}function an(i,t){if(i&1&&(F(0),y(1),M()),i&2){let e=m().$implicit,r=m(3);a(),N(" @ ",r.workoutUtilService.getWeightValue(e.targetWeight)," ",r.unitsService.getWeightUnitSuffix()," ")}}function on(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().$implicit,r=m(3);a(),N(" ",r.workoutUtilService.getDurationValue(e.targetDuration)," ",_(2,2,"metrics.duration")," ")}}function sn(i,t){if(i&1&&(F(0),y(1),p(2,"translate"),M()),i&2){let e=m().$implicit,r=m(3);a(),N(" ",r.workoutUtilService.getDistanceValue(e.targetDistance)," ",_(2,2,"metrics.distance")," ")}}function ln(i,t){if(i&1&&(F(0),l(1,"span",298),y(2),p(3,"translate"),s(),M()),i&2){let e=m().$implicit,r=m(3);a(2),N("| ",_(3,2,"metrics.rest"),": ",r.workoutUtilService.getRestValue(e.targetRest),"s")}}function dn(i,t){if(i&1&&(F(0),l(1,"span",297),y(2),x(3,nn,3,4,"ng-container",16)(4,an,2,2,"ng-container",16)(5,on,3,4,"ng-container",16)(6,sn,3,4,"ng-container",16)(7,ln,4,4,"ng-container",16),s(),M()),i&2){let e=t.$implicit,r=t.index,n=m(3);a(2),w(" Set #",r+1,": "),a(),c("ngIf",n.targetExists(e.targetReps)),a(),c("ngIf",n.targetExists(e.targetWeight)),a(),c("ngIf",n.targetExists(e.targetDuration)),a(),c("ngIf",n.targetExists(e.targetDistance)),a(),c("ngIf",n.targetExists(e.targetRest))}}function cn(i,t){if(i&1&&(l(0,"div",296),x(1,dn,8,6,"ng-container",135),s()),i&2){let e=m().ex;a(),c("ngForOf",e.sets)}}function mn(i,t){if(i&1&&(l(0,"li",289)(1,"div",290)(2,"div",291)(3,"span",292),y(4),s(),y(5),s(),x(6,rn,10,9,"div",293)(7,cn,2,1,"div",294),s()()),i&2){let e=t.ex,r=t.exIndex,n=m();a(4),w("#",r+1),a(),w(" ",e.exerciseName," "),a(),c("ngIf",n.getUniformExerciseSetValues(e)),a(),c("ngIf",!n.getUniformExerciseSetValues(e))}}var Ut=class i{shatterables;dayOfWeekPipe=D(Y);metricEnum=xt;fb=D(lt);router=D(je);route=D(ze);trainingProgramService=D(Pt);workoutService=D(Et);exerciseService=D(It);spinnerService=D(Ft);alertService=D(yt);toastService=D(pt);cdr=D(Ne);trackingService=D(Bt);translate=D(gt);workoutFormService=D(Gt);workoutUtilService=D(Lt);unitsService=D(Ct);appSettingsService=D(wt);programForm;submitted=!1;isEditMode=!1;isNewMode=!1;isViewMode=!1;isEditableMode=L(()=>this.isEditMode||this.isNewMode);currentProgramId=null;currentProgram=V(null);isCurrentProgramActive=V(!1);routeSub;sanitizer=D(He);sanitizedDescription="";exerciseInfoTooltipString=this.translate.instant("workoutBuilder.exerciseInfoTooltip");infoTooltipString=this.translate.instant("programBuilder.form.cycleLengthHint");isRoutineModalOpen=V(!1);availableRoutines=[];modalSearchTerm=V("");targetScheduleIndexForRoutine=null;targetIndicesForRoutine=null;routineModalDayContext=null;dayOfWeekOptions=[{value:1,label:this.translate.instant("dates.days.monday")},{value:2,label:this.translate.instant("dates.days.tuesday")},{value:3,label:this.translate.instant("dates.days.wednesday")},{value:4,label:this.translate.instant("dates.days.thursday")},{value:5,label:this.translate.instant("dates.days.friday")},{value:6,label:this.translate.instant("dates.days.saturday")},{value:0,label:this.translate.instant("dates.days.sunday")}].sort((t,e)=>t.value===0?1:e.value===0?-1:t.value-e.value);cycleLengthSignal=V(null);cycleDayOptions=L(()=>{let t=this.cycleLengthSignal();return t&&t>0?Array.from({length:t},(e,r)=>({value:r+1,label:`Day ${r+1}`})):[]});dayOptionsPerIndex={};setupDayOptionsWatcher(){this.programForm.get("cycleLength")?.valueChanges.subscribe(()=>this.updateDayOptionsPerIndex()),this.scheduleFormArray.valueChanges.subscribe(()=>this.updateDayOptionsPerIndex()),this.updateDayOptionsPerIndex()}updateDayOptionsPerIndex(){this.dayOptionsPerIndex={},this.scheduleFormArray.controls.forEach((t,e)=>{this.dayOptionsPerIndex[e]=this.getCurrentDayOptions(t.get("dayOfWeek")?.value)})}getCurrentDayOptions(t){let e=this.programForm.get("programType")?.value,r=Number(this.programForm.get("cycleLength")?.value);if(e==="cycled"&&r&&r>0){let o=new Set(this.scheduleFormArray.controls.map(d=>d.get("dayOfWeek")?.value));return t!=null&&o.delete(t),r===7?this.dayOfWeekOptions.filter(d=>!o.has(d.value)):Array.from({length:r},(d,u)=>({value:u+1,label:`Day ${u+1}`})).filter(d=>!o.has(d.value))}let n=new Set(this.scheduleFormArray.controls.map(o=>o.get("dayOfWeek")?.value));return t!=null&&n.delete(t),this.dayOfWeekOptions.filter(o=>!n.has(o.value))}getCurrentDayOptionsForWeek(t,e){let r=this.getWeekScheduleGroups(t),n=new Set(r.map(o=>o.get("dayOfWeek")?.value));return e!=null&&n.delete(e),this.dayOfWeekOptions.filter(o=>!n.has(o.value))}currentDayOptions=L(()=>{let t=this.programForm.get("programType")?.value,e=this.cycleLengthSignal();if(t==="linear")return this.dayOfWeekOptions;if(e&&e>0){let n=new Set(this.scheduleFormArray.controls.map(o=>o.get("dayOfWeek")?.value));return Array.from({length:e},(o,d)=>({value:d+1,label:`Day ${d+1}`})).filter(o=>!n.has(o.value))}let r=new Set(this.scheduleFormArray.controls.map(n=>n.get("dayOfWeek")?.value));return this.dayOfWeekOptions.filter(n=>!r.has(n.value))});filteredAvailableRoutines=L(()=>{let t=this.modalSearchTerm().toLowerCase(),e=Array.from(this.temporaryCustomRoutines.values()),r=[...this.availableRoutines,...e.filter(o=>!this.availableRoutines.some(d=>d.id===o.id))];return(t?r.filter(o=>o.name.toLowerCase().includes(t)):r).sort((o,d)=>o.name.localeCompare(d.name))});selectedGoals=V([]);programGoals=[{value:"hypertrophy",label:this.translate.instant("workoutBuilder.goals.hypertrophy")},{value:"strength",label:this.translate.instant("workoutBuilder.goals.strength")},{value:"tabata",label:this.translate.instant("workoutBuilder.goals.tabata")},{value:"muscularEndurance",label:this.translate.instant("workoutBuilder.goals.muscularEndurance")},{value:"cardiovascular Endurance",label:this.translate.instant("workoutBuilder.goals.cardiovascularEndurance")},{value:"fatLossBodyComposition",label:this.translate.instant("workoutBuilder.goals.fatLoss")},{value:"mobilityFlexibility",label:this.translate.instant("workoutBuilder.goals.mobility")},{value:"powerExplosiveness",label:this.translate.instant("workoutBuilder.goals.power")},{value:"speedAgility",label:this.translate.instant("workoutBuilder.goals.speed")},{value:"balanceCoordination",label:this.translate.instant("workoutBuilder.goals.balance")},{value:"skillAcquisition",label:this.translate.instant("workoutBuilder.goals.skill")},{value:"rehabilitationInjuryPrevention",label:this.translate.instant("workoutBuilder.goals.rehabilitation")},{value:"mentalHealthStressRelief",label:this.translate.instant("workoutBuilder.goals.mentalHealth")},{value:"generalHealthLongevity",label:this.translate.instant("workoutBuilder.goals.generalHealth")},{value:"sportSpecificPerformance",label:this.translate.instant("workoutBuilder.goals.sportSpecific")},{value:"maintenance",label:this.translate.instant("workoutBuilder.goals.maintenance")},{value:"rest",label:this.translate.instant("workoutBuilder.goals.rest")},{value:"custom",label:this.translate.instant("workoutBuilder.goals.custom")}];historyEditForm;editingHistoryEntryId=V(null);statusOptions=["active","completed","archived","cancelled"];expandedWeekIds=V(new Set);expandedDayIds=V(new Set);constructor(){this.programForm=this.fb.group({name:["",G.required],programType:[null,G.required],goals:[""],description:[""],programNotes:[""],startDate:[null],cycleLength:[null,[G.min(1)]],iterationId:[null],isRepeating:[!1],schedule:this.fb.array([]),weeks:this.fb.array([])}),this.historyEditForm=this.fb.group({id:[null],startDate:[null],endDate:[""],status:["",G.required]}),this.refreshFabMenuItems()}platformId=D(xe);programProgress=L(()=>{let t=this.currentProgram(),e=this.allWorkoutLogs();if(!t||!t.isActive||!t.startDate)return{completedCount:0,totalCount:0,percentage:0};let r=0,n=0,o=U(t.startDate);if(t.programType==="linear"&&t.weeks?.length){n=t.weeks.reduce((h,f)=>h+f.schedule.length,0);let u=e.filter(h=>h.programId===t.id&&U(h.date)>=o&&t.iterationId===h.iterationId);r=new Set(u.map(h=>`${h.date}-${h.routineId}`)).size}else if(t.programType==="cycled"&&t.schedule.length>0){let u=t.cycleLength||7;n=t.schedule.length;let g=ie(new Date,o);if(g>=0){let h=Math.floor(g/u),f=re(o,h*u),T=e.filter(S=>{let I=U(S.date);return S.programId===t.id&&I>=f});r=new Set(T.map(S=>`${S.date}-${S.routineId}`)).size}}if(n===0)return{completedCount:0,totalCount:0,percentage:0};r=Math.min(r,n);let d=Math.round(r/n*100);return{completedCount:r,totalCount:n,percentage:d}});overallWeekProgress=L(()=>{let t=this.currentProgram(),e=this.allWorkoutLogs();if(t?.programType!=="linear"||!t.isActive||!t.startDate||!t.weeks?.length)return[];let r=U(t.startDate),n=new Set(e.filter(o=>o.programId===t.id&&t.iterationId===o.iterationId).map(o=>`${o.date}-${o.routineId}`));return t.weeks.map(o=>{let d=o.schedule.every(u=>{let g=(o.weekNumber-1)*7+(u.dayOfWeek-Tt(r)+7)%7,h=re(r,g),f=St(h,"yyyy-MM-dd");return n.has(`${f}-${u.routineId}`)});return{weekNumber:o.weekNumber,name:o.name,isCompleted:d}})});currentWeekProgress=L(()=>{let t=this.currentProgram(),e=this.allWorkoutLogs();if(t?.programType!=="linear"||!t.isActive||!t.startDate||!t.weeks?.length)return null;let r=new Date,n=U(t.startDate);if(r<n)return null;let o=ie(r,n),d=Math.floor(o/7),u=t.weeks[d];if(!u)return null;let g=u.schedule.length;if(g===0)return null;let h=re(n,d*7),f=e.filter(I=>{if(I.programId!==t.id)return!1;let H=U(I.date),O=ie(H,h);return O>=0&&O<7&&t.iterationId===I.iterationId}),T=new Set(f.map(I=>I.routineId)),P=0,S=u.schedule.map(I=>{let H=T.has(I.routineId);return H&&P++,{isCompleted:H}});return{weekName:u.name,completedCount:P,totalCount:g,segments:S}});allWorkoutLogs=V([]);workoutLogsSubscription;ngOnInit(){$e(this.platformId)&&window.scrollTo(0,0),this.loadAvailableRoutines(),this.loadAvailableExercises(),this.setupDayOptionsWatcher(),this.workoutLogsSubscription=this.trackingService.workoutLogs$.subscribe(t=>this.allWorkoutLogs.set(t)),this.routeSub=this.route.params.pipe(oe(()=>{this.route.data.pipe(z(1)).subscribe(t=>{let e=t.mode;this.isNewMode=e==="new",this.isViewMode=e==="view",this.isEditMode=e==="edit"})}),ae(t=>{let e=t.programId;return this.submitted=!1,this.isNewMode?(this.showCreationWizard(),J(null)):e?this.trainingProgramService.getProgramById(e):J(null)}),oe(t=>{t&&(this.currentProgram.set(t),this.currentProgramId=t.id,this.patchFormWithProgramData(t),this.isCurrentProgramActive.set(t.isActive??!1)),this.updateFormEnabledState(),this.refreshFabMenuItems()})).subscribe(),this.programForm.get("programType")?.valueChanges.subscribe(t=>{this.handleProgramTypeChange(t)}),this.programForm.get("cycleLength")?.valueChanges.subscribe(t=>{let e=parseInt(t,10);this.cycleLengthSignal.set(isNaN(e)?null:e),!isNaN(e)&&e>0&&this.scheduleFormArray.controls.forEach(r=>{let n=r.get("dayOfWeek");n&&n.value>e&&n.setValue(1)})})}skipAutoAddWeek=!1;handleProgramTypeChange(t){let e=this.programForm.get("isRepeating");t==="linear"?(this.scheduleFormArray.clear(),this.programForm.get("cycleLength")?.setValue(null),this.programForm.get("cycleLength")?.disable(),e?.enable(),this.weeksFormArray.length===0&&!this.isViewMode&&!this.skipAutoAddWeek&&this.addWeek()):(this.weeksFormArray.clear(),this.programForm.get("cycleLength")?.enable(),e?.setValue(!1),e?.disable()),this.refreshFabMenuItems()}get scheduleFormArray(){return this.programForm.get("schedule")}get weeksFormArray(){return this.programForm.get("weeks")}getWeekScheduleGroups(t){return this.weeksFormArray.at(t).get("schedule").controls}createWeekGroup(t){let e=this.fb.group({id:[t?.id||A()],weekNumber:[t?.weekNumber??this.weeksFormArray.length+1],name:[t?.name??`${this.translate.instant("programBuilder.weeks.weekLabel")}${this.weeksFormArray.length+1}`,G.required],schedule:this.fb.array([])});return t?.schedule?.forEach(r=>{e.get("schedule").push(this.createScheduledDayGroup(r))}),e}addWeek(){let t=this.createWeekGroup();this.weeksFormArray.push(t),this.expandedWeekIds.update(e=>{let r=new Set(e);return r.add(t.get("id")?.value),r}),setTimeout(()=>{let e=this.weeksFormArray.controls.findIndex(r=>r.get("id")?.value===t.get("id")?.value);e!=null&&this.scrollToWeek(e)},50)}removeWeek(t,e){return W(this,null,function*(){e.stopPropagation();let r=yield this.alertService.showConfirmationDialog(this.translate.instant("programBuilder.weeks.confirmRemoveTitle"),this.translate.instant("programBuilder.weeks.confirmRemoveMsg"),[{text:this.translate.instant("common.cancel"),role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:this.translate.instant("common.delete"),role:"confirm",cssClass:"bg-red-600 hover:bg-red-700",icon:"trash"}]);if(!r||r.role!=="confirm")return;let n=this.weeksFormArray.at(t).get("id")?.value,o=this.shatterables.find(d=>d.el.nativeElement.id==="week-header-"+t||d.el.nativeElement.id==="week-header-"+n);o?(o.shatter(),setTimeout(()=>{this.weeksFormArray.removeAt(t)},150)):this.weeksFormArray.removeAt(t)})}loadAvailableRoutines(){this.workoutService.routines$.pipe(z(1)).subscribe(t=>{this.availableRoutines=t.sort((e,r)=>e.name.localeCompare(r.name))})}patchFormWithProgramData(t){let e=t.programType||"cycled";this.programForm.patchValue({name:t.name,description:t.description?this.updateSanitizedDescription(t.description):"",programNotes:t.programNotes,startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:null,cycleLength:t.cycleLength??null,iterationId:t.iterationId??null,programType:t.programType||"cycled",isRepeating:t.isRepeating??!1}),this.cycleLengthSignal.set(t.cycleLength??null);let r=new Set,n=new Set;if(e==="linear"&&t.weeks?(this.weeksFormArray.clear(),t.weeks.forEach(o=>{let d=this.createWeekGroup(o);this.weeksFormArray.push(d),r.add(d.value.id),d.get("schedule").controls.forEach(u=>{n.add(u.value.id)})})):(this.scheduleFormArray.clear(),t.schedule.forEach(o=>{let d=this.createScheduledDayGroup(o);this.scheduleFormArray.push(d),n.add(d.value.id)})),this.handleProgramTypeChange(e),this.updateFormEnabledState(),t.goals?.length){let o=new Set(t.goals.filter(d=>d!=null));this.programGoals.filter(d=>d.value!=null&&o.has(d.value)).forEach(d=>{this.toggleGoal(d)})}this.expandedWeekIds.set(new Set),this.expandedDayIds.set(new Set)}createScheduledDayGroup(t){let e=this.currentDayOptions()[0]?.value??1,r=t?.dayOfWeek??e,n=this.programForm.get("programType")?.value,o=this.programForm.get("cycleLength")?.value,d=n==="cycled"&&o>0,u="";d?u=`${this.translate.instant("programBuilder.schedule.dayNameLabel")} ${r+1}`:u=this.dayOfWeekOptions.find(h=>h.value===r)?.label||"";let g=this.fb.group({id:[t?.id||A()],dayOfWeek:[r,G.required],dayName:[t?.dayName||u,G.required],routineId:[t?.routineId??"",G.required],routineName:[t?.routineName??""],notes:[t?.notes??""],timeOfDay:[t?.timeOfDay??""],programId:[t?.programId??this.currentProgramId],isUnscheduled:[t?.isUnscheduled||!1]});return this.isEditableMode()&&n==="cycled"&&g.get("dayOfWeek")?.valueChanges.pipe(_e(400),he()).subscribe(h=>{let f=g.get("dayName")?.value,T=this.currentDayOptions().find(S=>S.value===h),P=T?T.label:`Day ${h}`;f!==P&&this.toastService.info(this.translate.instant("programBuilder.toasts.dayNameHint",{currentName:f,expectedName:P}),6e3,this.translate.instant("programBuilder.toasts.checkDayName"),!1)}),g}addScheduledDay(t){if(this.isViewMode)return;let e=parseInt(this.programForm.get("cycleLength")?.value,10),r=!e||e===7,n=this.programForm.get("programType")?.value,o=null;if(n==="linear"&&t!==void 0){let u=this.weeksFormArray.at(t).get("schedule");if(u.length>=7){this.toastService.info(this.translate.instant("programBuilder.toasts.allDaysScheduled"),3e3);return}let g=new Set(u.controls.map(T=>T.get("dayOfWeek")?.value)),h=[1,2,3,4,5,6,0],f=1;for(let T of h)if(!g.has(T)){f=T;break}o=this.createScheduledDayGroup({dayOfWeek:f}),u.push(o)}else if(r){if(this.scheduleFormArray.length>=7){this.toastService.info(this.translate.instant("programBuilder.toasts.allDaysScheduled"),3e3);return}let u=new Set(this.scheduleFormArray.controls.map(f=>f.get("dayOfWeek")?.value)),g=[1,2,3,4,5,6,0],h=1;for(let f of g)if(!u.has(f)){h=f;break}o=this.createScheduledDayGroup({dayOfWeek:h}),this.scheduleFormArray.push(o)}else{if(this.scheduleFormArray.length>=e){this.toastService.info(this.translate.instant("programBuilder.toasts.cycleAddAllDays",{count:e}),3e3);return}let u=new Set(this.scheduleFormArray.controls.map(h=>h.get("dayOfWeek")?.value)),g=1;for(let h=1;h<=e;h++)if(!u.has(h)){g=h;break}o=this.createScheduledDayGroup({dayOfWeek:g}),this.scheduleFormArray.push(o)}o&&this.expandedDayIds.update(u=>{let g=new Set(u);return g.add(o.get("id")?.value),g});let d=o?.get("id")?.value;setTimeout(()=>{this.scrollToDayHeader(d)},50)}removeScheduledDay(t,e,r){return W(this,null,function*(){if(this.isViewMode)return;r&&r.stopPropagation();let n=yield this.alertService.showConfirmationDialog(this.translate.instant("trainingPrograms.weeks.confirmRemoveDayTitle"),this.translate.instant("trainingPrograms.weeks.confirmRemoveDayMsg"),[{text:this.translate.instant("common.cancel"),role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:this.translate.instant("common.delete"),role:"confirm",cssClass:"bg-red-600 hover:bg-red-700",icon:"trash"}]);if(!n||n.role!=="confirm")return;let o=this.programForm.get("programType")?.value,d;if(o==="linear"&&e!==void 0){let u=this.weeksFormArray.at(e).get("schedule");u.length>1&&(t>0?d=u.at(t-1).get("id")?.value:u.length>1&&(d=u.at(1).get("id")?.value));let g=u.at(t).get("id")?.value,h=this.shatterables.find(f=>f.el.nativeElement.id==="day-expanded-"+g);h?(h.shatter(),setTimeout(()=>{u.removeAt(t)},150)):u.removeAt(t)}else{this.scheduleFormArray.length>1&&(t>0?d=this.scheduleFormArray.at(t-1).get("id")?.value:this.scheduleFormArray.length>1&&(d=this.scheduleFormArray.at(1).get("id")?.value));let u=this.scheduleFormArray.at(t).get("id")?.value,g=this.shatterables.find(h=>h.el.nativeElement.id==="day-expanded-"+u);g?(g.shatter(),setTimeout(()=>{this.scheduleFormArray.removeAt(t)},150)):this.scheduleFormArray.removeAt(t)}d&&setTimeout(()=>{this.scrollToDayHeader(d)},100)})}get scheduleFormGroups(){return this.scheduleFormArray.controls}onScheduleDrop(t){this.isViewMode||(ne(this.scheduleFormArray.controls,t.previousIndex,t.currentIndex),this.scheduleFormArray.updateValueAndValidity())}openRoutineSelectionModal(t,e){this.isViewMode||(e!==void 0?this.targetIndicesForRoutine={weekIndex:t,dayIndex:e}:this.targetIndicesForRoutine={dayIndex:t},this.modalSearchTerm.set(""),this.isRoutineModalOpen.set(!0),document.body.classList.add("modal-open"))}closeRoutineSelectionModal(){this.isRoutineModalOpen.set(!1),this.targetScheduleIndexForRoutine=null,document.body.classList.remove("modal-open")}selectRoutineForDay(t){if(this.targetIndicesForRoutine){let e,{weekIndex:r,dayIndex:n}=this.targetIndicesForRoutine;r!==void 0?e=this.getWeekScheduleDayControl(r,n):e=this.scheduleFormArray.at(n),e?.patchValue({routineId:t.id,routineName:t.name}),this.triggerBounceOnExerciseList(e.get("id")?.value)}this.closeRoutineSelectionModal()}updateFormEnabledState(){this.isViewMode?this.programForm.disable():this.programForm.enable()}enableEditModeFromView(){this.isViewMode&&this.currentProgramId&&this.router.navigate(["/training-programs/edit",this.currentProgramId])}onSubmit(){return W(this,null,function*(){if(this.submitted=!0,this.isViewMode)return;let t=this.programForm.getRawValue(),e=t.name,r=this.currentProgram();if(this.isEditMode&&r&&this.hasLoggedWorkoutsForCurrentIteration()&&this.hasCriticalChanges(r)&&!(yield this.warnAboutCriticalChangesWithLogs(r,t)))return;for(let[u,g]of this.temporaryCustomRoutines.entries())g.name.includes(`[${this.translate.instant("programBuilder.program")}:`)||(g.name=`${g.name} [${this.translate.instant("programBuilder.program")}: ${e}]`),this.scheduleFormArray.controls.forEach(h=>{h.get("routineId")?.value===g.id&&h.patchValue({routineName:g.name,dayName:g.name})}),this.weeksFormArray.controls.forEach(h=>{h.get("schedule").controls.forEach(T=>{T.get("routineId")?.value===g.id&&T.patchValue({routineName:g.name,dayName:g.name})})});let n=[];for(let[u,g]of this.temporaryCustomRoutines.entries()){g.isHidden=!1;let h=this.availableRoutines.find(T=>T.id===g.id),f;h?f=this.workoutService.updateRoutine(g):f=this.workoutService.addRoutine(g),f instanceof Promise&&n.push(f)}if(n.length>0)try{yield Promise.all(n),this.toastService.success(this.translate.instant("programBuilder.toasts.customRoutinesSave",{count:n.length}),2e3,this.translate.instant("programBuilder.toasts.success"))}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.saveError"),0,this.translate.instant("programBuilder.toasts.validationError"));return}if(t.programType==="linear"){if(!t.weeks||t.weeks.length===0){this.toastService.error(this.translate.instant("programBuilder.toasts.linearNoWeeks"),0,this.translate.instant("programBuilder.toasts.validationError"));return}if(t.weeks.some(g=>!g.schedule||g.schedule.length===0)){this.toastService.error(this.translate.instant("programBuilder.toasts.linearEmptyWeeks"),0,this.translate.instant("programBuilder.toasts.validationError"));return}}else if(t.programType==="cycled"&&(!t.schedule||t.schedule.length===0)){this.toastService.error(this.translate.instant("programBuilder.toasts.cycledNoDays"),0,this.translate.instant("programBuilder.toasts.validationError"));return}if(this.programForm.invalid){this.programForm.markAllAsTouched(),this.toastService.error(this.translate.instant("programBuilder.toasts.formInvalid"),0,this.translate.instant("programBuilder.toasts.validationError"));return}let o=this.currentProgramId||A(),d={id:o,name:t.name,programType:t.programType,goals:this.selectedGoals(),description:t.description,programNotes:t.programNotes,startDate:t.startDate||null,iterationId:t.iterationId||null,cycleLength:t.programType==="cycled"&&t.cycleLength||null,isRepeating:t.programType==="linear"?t.isRepeating:!1,schedule:t.schedule.map(u=>({id:u.id||A(),dayOfWeek:Number(u.dayOfWeek),dayName:u.dayName||"",routineId:u.routineId,routineName:u.routineName,programId:o,notes:u.notes,timeOfDay:u.timeOfDay,isUnscheduled:u.isUnscheduled||!1,iterationId:t.iterationId||null})),weeks:t.programType==="linear"?t.weeks.map((u,g)=>Z(Q({},u),{schedule:u.schedule.map(h=>({id:h.id||A(),dayOfWeek:Number(h.dayOfWeek),dayName:h.dayName||"",routineId:h.routineId,weekNumber:g+1,routineName:h.routineName,programId:o,notes:h.notes,timeOfDay:h.timeOfDay,isUnscheduled:h.isUnscheduled||!1,iterationId:t.iterationId||null}))})):[],isActive:this.currentProgram()?.isActive??!1};try{if(this.spinnerService.show(this.translate.instant("programBuilder.toasts.savingProgram")),this.isNewMode){let u=yield this.trainingProgramService.addProgram(d);this.isNewMode=!1,this.isEditMode=!0,this.currentProgramId=u.id,this.toastService.success(this.translate.instant("programBuilder.toasts.created",{name:u.name}),3e3,this.translate.instant("programBuilder.toasts.createdTitle")),this.currentProgram.set(u),this.router.navigate([`/training-programs/edit/${this.currentProgram()?.id}`])}else if(this.isEditMode&&this.currentProgramId){let u=yield X(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(z(1)));d.isActive=u?.isActive??!1,yield this.trainingProgramService.updateProgram(d),this.toastService.success(this.translate.instant("programBuilder.toasts.saved"),0,this.translate.instant("programBuilder.toasts.saveSuccess"),!1),this.currentProgram.set(u)}}catch(u){console.error("Error saving program:",u),this.toastService.error(this.translate.instant("programBuilder.toasts.saveError",{error:u}),0,this.translate.instant("programBuilder.toasts.saveErrorTitle"))}finally{this.spinnerService.hide()}})}deleteProgram(){return W(this,null,function*(){if(!this.currentProgramId){this.toastService.error(this.translate.instant("programBuilder.toasts.deleteError"),0,this.translate.instant("programBuilder.toasts.deleteErrorTitle"));return}try{this.spinnerService.show(this.translate.instant("programBuilder.alerts.deleting")),(yield this.trainingProgramService.deleteProgram(this.currentProgramId))&&(this.router.url.includes("/training-programs/new")||this.router.url.includes(`/training-programs/edit/${this.currentProgramId}`)||this.router.url.includes(`/training-programs/view/${this.currentProgramId}`))&&this.router.navigate(["/training-programs"])}catch(t){console.error("Error during program deletion process in component:",t),this.toastService.error(this.translate.instant("programBuilder.toasts.deleteUnexpectedError"),0,this.translate.instant("programBuilder.toasts.deleteErrorTitle"))}finally{this.spinnerService.hide()}})}ngOnDestroy(){this.routeSub&&this.routeSub.unsubscribe(),this.workoutLogsSubscription?.unsubscribe()}get f(){return this.programForm.controls}getScheduleDayControl(t){return this.scheduleFormArray.at(t)}getWeekScheduleDayControl(t,e){return this.weeksFormArray.at(t).get("schedule").at(e)}completeProgram(){return W(this,null,function*(){if(this.currentProgramId&&this.isCurrentProgramActive())try{let t=yield this.alertService.showConfirmationDialog(this.translate.instant("programBuilder.alerts.finishTitle"),this.translate.instant("programBuilder.alerts.finishMessage"),[{text:this.translate.instant("cancel"),role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:this.translate.instant("programBuilder.alerts.finishButton"),role:"confirm",cssClass:"bg-primary hover:bg-primary-dark",icon:"done"}]);if(!t||t.role!=="confirm")return;this.spinnerService.show(this.translate.instant("programBuilder.alerts.completing")),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"completed")}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.completeFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}})}toggleProgramStatus(){return W(this,null,function*(){if(this.currentProgramId){if(this.isCurrentProgramActive()){let t=yield this.alertService.showConfirmationDialog(this.translate.instant("programBuilder.alerts.activeTitle"),this.translate.instant("programBuilder.alerts.activeMessage"),[{text:this.translate.instant("trainingPrograms.alerts.deactivate"),role:"deactivate",data:"deactivate",icon:"deactivate"},{text:this.translate.instant("trainingPrograms.alerts.complete"),role:"complete",data:"complete",icon:"goal",cssClass:"bg-green-500 hover:bg-green-600"},{text:this.translate.instant("common.cancel"),role:"cancel",data:"cancel",icon:"cancel"}]);if(!t||!t.data||t.data==="cancel"){this.spinnerService.hide();return}if(t.data==="complete"){try{this.spinnerService.show(this.translate.instant("trainingPrograms.alerts.completing")),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"completed"),this.toastService.success(this.translate.instant("programBuilder.toasts.completeSuccess"))}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.completeFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}return}else try{this.spinnerService.show(this.translate.instant("trainingPrograms.alerts.deactivating")),yield this.trainingProgramService.deactivateProgram(this.currentProgramId,"cancelled"),this.toastService.success(this.translate.instant("trainingPrograms.alerts.deactivateSuccess"))}catch{this.toastService.error(this.translate.instant("trainingPrograms.toasts.deactivateFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}return}try{this.spinnerService.show(this.translate.instant("trainingPrograms.alerts.settingActive")),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"active"),this.toastService.success(this.translate.instant("trainingPrograms.alerts.activateSuccess"))}catch{this.toastService.error(this.translate.instant("trainingPrograms.toasts.activateFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}}})}toggleProgramHistory(){let t=this.currentProgram()!==null&&this.currentProgram()!==void 0?this.currentProgram():null;if(!t||!t.history||t&&t.history&&t.history.length===0){this.toastService.info(this.translate.instant("programBuilder.toasts.noHistory"),3e3);return}this.isProgramHistoryModalOpen.set(!0)}isProgramHistoryModalOpen=V(!1);closeProgramHistoryModal(){this.isProgramHistoryModalOpen.set(!1),this.editingHistoryEntryId.set(null)}updateSanitizedDescription(t){this.sanitizedDescription=this.sanitizer.bypassSecurityTrustHtml(t)}toggleGoal(t){this.selectedGoals.update(e=>{let r=new Set(e);return t!==void 0&&t.value!==void 0&&(r.has(t.value)?r.delete(t.value):r.add(t.value)),Array.from(r)})}getProgramDropdownActionItems(t,e){let r="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-primary flex items-center text-sm hover:text-white dark:hover:text-gray-100 dark:hover:text-white",n="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-red-600 flex items-center text-sm hover:text-gray-100 hover:animate-pulse",o="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-green-600 flex items-center text-sm hover:text-gray-100",d="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-500 flex items-center text-sm hover:text-gray-100",u=this.currentProgram,g={label:"trainingPrograms.actions.edit",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+r,data:{programId:t}},h={label:"trainingPrograms.actions.activate",actionKey:"activate",iconName:"activate",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+o,data:{programId:t}},f={label:"trainingPrograms.actions.history",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+r,data:{programId:t}},T={label:"trainingPrograms.actions.finish",actionKey:"finish",iconName:"goal",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+r,data:{programId:t}},P={label:"trainingPrograms.actions.deactivate",actionKey:"deactivate",iconName:"deactivate",iconClass:"w-7 h-7 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+d,data:{programId:t}},S=[];return this.currentProgram()?.isActive?(S.push(T),S.push(P)):S.push(h),S.push(f),this.isViewMode&&S.push(g),S.push({isDivider:!0}),S.push({label:"trainingPrograms.actions.delete",actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+n,data:{programId:t}}),S}handleActionMenuItemClick(t,e){if(t.data?.programId)switch(t.actionKey){case"activate":this.toggleProgramStatus();break;case"deactivate":this.toggleProgramStatus();break;case"finish":this.completeProgram();break;case"history":this.toggleProgramHistory();break;case"edit":this.enableEditModeFromView();break;case"delete":this.deleteProgram();break}}activeProgramIdActions=V(null);toggleActions(t,e){e.stopPropagation(),this.activeProgramIdActions.update(r=>r===t?null:t)}areActionsVisible(t){return this.activeProgramIdActions()===t}onCloseActionMenu(){this.activeProgramIdActions.set(null)}navigateToPrograms(){this.router.navigate(["/training-programs"])}removeProgramHistoryEntry(t){return W(this,null,function*(){if(!this.currentProgramId||!t){this.toastService.error(this.translate.instant("programBuilder.toasts.missingIds"),0,this.translate.instant("common.error"));return}let e=yield this.alertService.showConfirmationDialog(this.translate.instant("programBuilder.toasts.confirmHistoryRemoveTitle"),this.translate.instant("programBuilder.toasts.confirmHistoryRemoveMsg"),[{text:this.translate.instant("common.cancel"),role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:this.translate.instant("common.delete"),role:"confirm",cssClass:"bg-red-600 hover:bg-red-700",icon:"trash"}]);if(!(!e||e.role!=="confirm"))try{this.spinnerService.show(this.translate.instant("programBuilder.toasts.historyRemoving")),yield this.trainingProgramService.removeProgramHistoryEntry(this.currentProgramId,t),this.toastService.success(this.translate.instant("programBuilder.toasts.historyRemoved"),0,this.translate.instant("common.success"));let r=yield X(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(z(1)));this.currentProgram.set(r),r&&this.patchFormWithProgramData(r)}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.historyRemoveFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide(),this.postHistoryUpdateChecks()}})}postHistoryUpdateChecks(){this.isCurrentProgramActive.set(this.currentProgram()?.isActive??!1),this.refreshFabMenuItems(),this.currentProgram()?.isActive&&(this.currentProgram()?.iterationId&&this.programForm.patchValue({iterationId:this.currentProgram()?.iterationId??null},{emitEvent:!1}),this.currentProgram()?.startDate&&this.programForm.patchValue({startDate:this.currentProgram()?.startDate??null},{emitEvent:!1}),this.programForm.updateValueAndValidity())}editHistoryEntry(t){this.editingHistoryEntryId.set(t.id),this.historyEditForm.patchValue({id:t.id,startDate:t.startDate&&t.startDate!=="-"?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate&&t.endDate!=="-"?new Date(t.endDate).toISOString().split("T")[0]:"",status:t.status})}cancelEditHistoryEntry(){this.editingHistoryEntryId.set(null)}saveHistoryEntry(){return W(this,null,function*(){if(this.historyEditForm.invalid){this.toastService.error(this.translate.instant("programBuilder.toasts.invalidFields"),0,this.translate.instant("common.validationError"));return}if(!this.currentProgramId)return;let t=this.historyEditForm.getRawValue(),e=Z(Q({},t),{programId:this.currentProgramId,endDate:t.endDate||"-",date:new Date().toISOString()});try{this.spinnerService.show(this.translate.instant("programBuilder.toasts.updatingHistory")),yield this.trainingProgramService.updateProgramHistory(this.currentProgramId,e);let r=yield X(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(z(1)));this.currentProgram.set(r),this.editingHistoryEntryId.set(null)}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.historySaveFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide(),this.postHistoryUpdateChecks()}})}forceEndDateToNull(){this.historyEditForm.get("endDate")?.setValue(null),this.historyEditForm.get("endDate")?.disable()}enableEndDate(){this.historyEditForm.get("endDate")?.enable()}onWeekDrop(t){this.isViewMode||(ne(this.weeksFormArray.controls,t.previousIndex,t.currentIndex),this.weeksFormArray.controls.forEach((e,r)=>{e.get("weekNumber")?.setValue(r+1);let n=e.get("name"),o=n?.value;if(o){let d=o.match(/(\d+)/);if(d){let u=parseInt(d[1],10),g=t.previousIndex===r?t.currentIndex:t.previousIndex;if(u===g+1){let h=o.replace(/(\d+)/,`${r+1}`);n?.setValue(h)}}}}),this.weeksFormArray.updateValueAndValidity())}onDayDropInWeek(t,e){if(this.isViewMode)return;let r=this.weeksFormArray.at(e).get("schedule");ne(r.controls,t.previousIndex,t.currentIndex),r.updateValueAndValidity()}toggleWeek(t,e){if(e){let n=e.target;if(["INPUT","TEXTAREA","SELECT"].includes(n.tagName))return}this.expandedWeekIds.update(n=>{let o=new Set(n),d=this.weeksFormArray.controls.findIndex(g=>g.get("id")?.value===t),u=d!==-1?this.getWeekScheduleGroups(d):[];return o.has(t)?(this.expandedDayIds.update(g=>{let h=new Set(g);return u.forEach(f=>{h.delete(f.get("id")?.value)}),h}),o.delete(t)):(this.expandedDayIds.update(g=>{let h=new Set(g);return u.forEach(f=>{h.add(f.get("id")?.value)}),h}),o.add(t)),o});let r=this.weeksFormArray.controls.findIndex(n=>n.get("id")?.value===t);r!=null&&this.scrollToWeek(r)}isWeekExpanded(t){return this.expandedWeekIds().has(t)}toggleDayExpansion(t){this.expandedDayIds.update(e=>{let r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r}),this.scrollToDayHeader(t)}isDayExpanded(t){return this.expandedDayIds().has(t)}isExerciseModalOpen=V(!1);exerciseModalTarget=null;selectedExercisesForModal=[];isCustomWorkoutModalOpen=V(!1);customRoutineToEdit=null;customWorkoutModalTarget=null;temporaryCustomRoutines=new Map;openExerciseSelectionModal(t,e){this.exerciseModalTarget={weekIndex:e,dayIndex:t},this.selectedExercisesForModal=[],this.isExerciseModalOpen.set(!0)}closeExerciseSelectionModal(){this.isExerciseModalOpen.set(!1),this.exerciseModalTarget=null,this.selectedExercisesForModal=[]}builderMode=Ht;openCustomWorkoutModal(t,e){this.customRoutineToEdit=null,this.customWorkoutModalTarget={weekIndex:e,dayIndex:t},this.isCustomWorkoutModalOpen.set(!0)}closeCustomWorkoutModal(){this.isCustomWorkoutModalOpen.set(!1),this.customWorkoutModalTarget=null}handleCustomRoutineConfirmed(t){if(!this.customWorkoutModalTarget)return;let{weekIndex:e,dayIndex:r}=this.customWorkoutModalTarget,n=e!==void 0?`${e}-${r}`:`${r}`;this.temporaryCustomRoutines.set(n,t),this.updateRoutineNameInSchedule(t);let o;e!==void 0?o=this.getWeekScheduleDayControl(e,r):o=this.scheduleFormArray.at(r),o&&(o.patchValue({routineId:t.id,routineName:t.name}),this.triggerBounceOnExerciseList(o.get("id")?.value)),this.customRoutines.find(d=>d.id===t.id)||this.customRoutines.push(t),this.toastService.success(this.translate.instant("programBuilder.toasts.customRoutineCreated",{name:t.name}),3e3,this.translate.instant("common.success")),this.closeCustomWorkoutModal()}selectExercisesForDay(t){return W(this,null,function*(){if(!this.exerciseModalTarget)return;let{weekIndex:e,dayIndex:r}=this.exerciseModalTarget,n;if(e!==void 0?n=this.getWeekScheduleDayControl(e,r):n=this.scheduleFormArray.at(r),!n)return;let o=n.get("routineId")?.value,d=o&&this.isCustomRoutine(o)?this.availableRoutines.find(g=>g.id===o):void 0,u=t.map(g=>{let h=this.isExerciseCardioOnly(g.id),f=[];h?f=["duration","distance","rest"]:f=["reps","weight","rest"];let T={id:this.workoutService.generateExerciseSetId(),type:"standard",fieldOrder:f,targetReps:h?void 0:ft(8),targetWeight:h?void 0:me(10),targetRest:ue(60),targetDuration:h?bt(60):void 0,targetDistance:h?kt(1):void 0,targetTempo:void 0,notes:void 0};return{id:this.workoutService.generateWorkoutExerciseId(),exerciseId:g.id,exerciseName:g.name,sets:[T],type:"standard",supersetId:null,supersetOrder:null}});if(d)d.workoutExercises.push(...u);else{let g={id:"custom-"+A(),name:"Custom Day",workoutExercises:u,isHidden:!0};this.customRoutines.push(g),this.availableRoutines.push(g),n.patchValue({routineId:g.id,routineName:g.name})}this.closeExerciseSelectionModal()})}isCustomRoutine(t){return Array.from(this.temporaryCustomRoutines.values()).some(e=>e.id===t)}editCustomRoutine(t,e,r){let n=Array.from(this.temporaryCustomRoutines.values()).find(o=>o.id===t);n&&(this.customWorkoutModalTarget={weekIndex:r,dayIndex:e},this.customRoutineToEdit=n,this.isCustomWorkoutModalOpen.set(!0))}getExercisesForDay(t){return(this.availableRoutines.find(r=>r.id===t)||Array.from(this.temporaryCustomRoutines.values()).find(r=>r.id===t))?.workoutExercises||[]}customRoutines=[];availableExercises=[];modalExerciseSearchTerm=V("");filteredAvailableExercises=L(()=>{let t=this.modalExerciseSearchTerm().toLowerCase();return t?(t=this.exerciseService.normalizeExerciseNameForSearch(t),this.availableExercises.filter(e=>e.name.toLowerCase().includes(t)||e.categories&&e.categories.map(r=>r.toString().toLowerCase()).join(", ").includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.primaryMuscleGroup&&e.primaryMuscleGroup.toLowerCase().includes(t))):this.availableExercises});isExerciseCardioOnly(t){if(!t)return!1;let e=this.availableExercises.find(r=>r.id===t);return e&&e.categories?e.categories.find(r=>r==="cardio")!==void 0:!1}generateFakeRoutineForSelectedExercises(t){let e=t.map(r=>({id:this.workoutService.generateWorkoutExerciseId(),exerciseId:r.id,exerciseName:r.name,sets:[],type:"standard",supersetId:null,supersetOrder:null}));return{id:"custom-"+A(),name:"Fake Routine",workoutExercises:e}}handleTrulyCustomExerciseEntry(t=!1){return W(this,null,function*(){let e=[{name:"exerciseName",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName"),value:"",attributes:{required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseName")},{name:"numSets",type:"number",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets"),value:"3",attributes:{min:"1",required:!0},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseSets")},{name:"equipmentNeeded",type:"text",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseEquipment")},{name:"description",type:"textarea",placeholder:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription"),value:"",attributes:{required:!1},label:this.translate.instant("workoutBuilder.exercise.newCustomExerciseDescription")}];t&&this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));let r=yield this.alertService.showPromptDialog(this.translate.instant("workoutBuilder.exercise.newCustomExerciseTitle"),this.translate.instant("workoutBuilder.exercise.newCustomExerciseMsg"),e,this.translate.instant("workoutBuilder.exercise.newCustomExerciseBtn"));if(r&&r.exerciseName){let n=String(r.exerciseName).trim(),o=String(r.description).trim(),d=r.numSets?parseInt(String(r.numSets),10):3;if(!n||d<=0){this.toastService.error(this.translate.instant("newCustomExerciseInvalidInput"),0,this.translate.instant("common.error"));return}let u=Array.from({length:d},()=>({id:`custom-adhoc-set-${A()}`,fieldOrder:["reps","weight","rest"],targetReps:vt(8),targetWeight:me(10),targetDuration:void 0,targetRest:ue(60),type:"standard",notes:""})),h={id:`custom-adhoc-ex-${n.trim().toLowerCase().replace(/\s+/g,"-")}-${A()}`,name:n,description:o,categories:["custom"],muscleGroups:[],primaryMuscleGroup:void 0,imageUrls:[]};this.closeExerciseSelectionModal(),this.exerciseService.addExercise(h);let f={id:this.workoutService.generateWorkoutExerciseId(),exerciseId:h.id,exerciseName:h.name,sets:u,supersetId:null,supersetOrder:null},T=this.workoutFormService.createExerciseFormGroup(f,!0,!1)}else{if(!r)return;this.handleTrulyCustomExerciseEntry(!0);return}})}loadAvailableExercises(){this.exerciseService.getExercises().pipe(z(1),ae(t=>!t||t.length===0?J([]):this.exerciseService.getTranslatedExerciseList(t))).subscribe(t=>{this.availableExercises=t,this.updateRoutineExerciseNames()})}updateRoutineNameInSchedule(t){this.scheduleFormArray.controls.forEach(e=>{e.get("routineId")?.value===t.id&&e.patchValue({routineName:t.name})}),this.weeksFormArray.controls.forEach(e=>{e.get("schedule").controls.forEach(n=>{n.get("routineId")?.value===t.id&&n.patchValue({routineName:t.name})})})}expandedExerciseLists={};toggleExerciseList(t){this.expandedExerciseLists[t]=!this.expandedExerciseLists[t],setTimeout(()=>{this.expandedExerciseLists[t]?this.scrollToExerciseList(t):this.scrollToDayHeader(t)},100)}scrollToWeek(t){let e=document.getElementById(`week-header-${t}`);if(e){let r=e.getBoundingClientRect().top+window.scrollY-40;window.scrollTo({top:r,behavior:"smooth"})}}scrollToDayHeader(t){let e=document.getElementById(`day-expanded-${t}`);if(e){let r=e.getBoundingClientRect().top+window.scrollY-60;window.scrollTo({top:r,behavior:"smooth"})}}scrollToExerciseList(t){let e=document.getElementById(`exercise-list-${t}`);if(e){let r=e.getBoundingClientRect().top+window.scrollY-40;window.scrollTo({top:r,behavior:"smooth"})}}updateRoutineExerciseNames(){this.availableRoutines.forEach(t=>{t.workoutExercises.forEach(e=>{let r=this.availableExercises.find(n=>n.id===e.exerciseId);r&&(e.exerciseName=r.name)})}),Array.from(this.temporaryCustomRoutines.values()).forEach(t=>{t.workoutExercises.forEach(e=>{let r=this.availableExercises.find(n=>n.id===e.exerciseId);r&&(e.exerciseName=r.name)})})}targetExists(t){return t!=null}showCreationWizard(){return W(this,null,function*(){let t=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.wizard.templateOrBlankTitle"),this.translate.instant("programBuilder.wizard.templateOrBlankMsg"),[{name:"routineTemplate",type:"radio",label:this.translate.instant("programBuilder.wizard.templateOrBlankLabel"),value:"blank",options:[{label:this.translate.instant("common.blank"),value:"blank"},{label:"3x3",value:"3x3"},{label:"5x5",value:"5x5"},{label:"Push/Pull/Legs",value:"ppl"},{label:"5/3/1",value:"531"}],required:!0}],this.translate.instant("alertService.buttons.ok"));if(!t||!t.routineTemplate)return;let e=String(t.routineTemplate);if(e!=="blank"){yield this.createProgramFromTemplate(e);return}let r=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.form.nameLabel"),this.translate.instant("programBuilder.form.nameWizardMsg"),[{name:"programName",type:"text",label:this.translate.instant("programBuilder.form.nameLabel"),placeholder:this.translate.instant("programBuilder.form.namePlaceholder"),required:!0,autofocus:!0}],this.translate.instant("alertService.buttons.ok"));if(!r||!r.programName)return;let n=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.form.structureLabel"),this.translate.instant("programBuilder.form.structureWizardMsg"),[{name:"programType",type:"radio",label:this.translate.instant("programBuilder.form.structureLabel"),value:"cycled",options:[{label:this.translate.instant("programBuilder.form.repeatingCycle"),value:"cycled"},{label:this.translate.instant("programBuilder.form.weekByWeek"),value:"linear"}],required:!0}],this.translate.instant("alertService.buttons.ok"));if(!n||!n.programType)return;let o=n.programType,d=7,u=1,g=[];if(o==="cycled"){let h=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.form.cycleLengthLabel"),this.translate.instant("programBuilder.form.cycleLengthWizardMsg"),[{name:"cycleLength",type:"number",label:this.translate.instant("programBuilder.form.cycleLengthLabel"),placeholder:"7",value:7,min:1,required:!0,attributes:{min:1}}],this.translate.instant("alertService.buttons.ok"));if(!h||!h.cycleLength)return;d=Number(h.cycleLength)}else{let h=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.weeks.numWeeksLabel"),this.translate.instant("programBuilder.weeks.numWeeksWizardMsg"),[{name:"numWeeks",type:"number",label:this.translate.instant("programBuilder.weeks.numWeeksLabel"),placeholder:"4",value:4,min:1,required:!0,attributes:{min:1}}],this.translate.instant("alertService.buttons.ok"));if(!h||!h.numWeeks)return;u=Number(h.numWeeks);let f=[{label:this.translate.instant("dates.days.monday"),value:1},{label:this.translate.instant("dates.days.tuesday"),value:2},{label:this.translate.instant("dates.days.wednesday"),value:3},{label:this.translate.instant("dates.days.thursday"),value:4},{label:this.translate.instant("dates.days.friday"),value:5},{label:this.translate.instant("dates.days.saturday"),value:6},{label:this.translate.instant("dates.days.sunday"),value:0}],T=[1,3,5];for(let P=0;P<u;P++){let S=f.map(O=>({label:O.label,name:"day-"+O.value,type:"checkbox",value:T.includes(O.value)?1:0})),I=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.weeks.daysInWeekLabel",{week:P+1}),this.translate.instant("programBuilder.weeks.daysInWeekWizardMsg",{week:P+1}),S,this.translate.instant("alertService.buttons.ok"));if(!I||this.areAllPropertiesFalsy(I))return;let H=Object.entries(I).filter(([O,Qt])=>O.startsWith("day-")&&Qt).map(([O])=>Number(O.replace("day-","")));if(H.length===0)return;g.push(H)}}if(this.programForm.patchValue({name:r.programName,programType:o,cycleLength:o==="cycled"?d:null}),o==="cycled"){this.scheduleFormArray.clear();for(let h=1;h<=d;h++)this.scheduleFormArray.push(this.createScheduledDayGroup({dayOfWeek:h}))}else{this.weeksFormArray.clear();for(let h=0;h<u;h++){let f=this.createWeekGroup({weekNumber:h+1}),T=f.get("schedule"),P=[1,2,3,4,5,6,0];g[h].slice().sort((S,I)=>P.indexOf(S)-P.indexOf(I)).forEach(S=>{T.push(this.createScheduledDayGroup({dayOfWeek:S}))}),this.weeksFormArray.push(f)}}})}createProgramFromTemplate(t){return W(this,null,function*(){this.skipAutoAddWeek=!0,this.weeksFormArray.clear();let e=this.workoutService.generateRoutineFromTemplate(t,this.availableExercises);if(this.programForm.patchValue({name:this.getTemplateProgramName(t),programType:"linear",cycleLength:null}),t==="3x3"||t==="5x5"){let r=[1,3,5],n=this.createWeekGroup({weekNumber:1,name:`${this.getTemplateProgramName(t)} - ${this.translate.instant("programBuilder.weeks.weekLabel")} 1`}),o=n.get("schedule");[0,1,0].forEach((g,h)=>{this.assignRoutineToDay(o,e,r[h],g,t,!0,["A","B"][g])}),this.weeksFormArray.push(n);let d=this.createWeekGroup({weekNumber:2,name:`${this.getTemplateProgramName(t)} - ${this.translate.instant("programBuilder.weeks.weekLabel")} 2`}),u=d.get("schedule");[1,0,1].forEach((g,h)=>{this.assignRoutineToDay(u,e,r[h],g,t,!0,["A","B"][g])}),this.weeksFormArray.push(d)}else{let r=this.createWeekGroup({weekNumber:1}),n=r.get("schedule");t==="ppl"?[1,3,5].forEach((o,d)=>{this.assignRoutineToDay(n,e,o,d,t)}):t==="531"?[1,3,5,0].forEach((o,d)=>{this.assignRoutineToDay(n,e,o,d,t)}):[1,3,5].forEach((o,d)=>{this.assignRoutineToDay(n,e,o,d,t)}),this.weeksFormArray.push(r)}setTimeout(()=>this.scrollToWeek(0),200),this.toastService.success(this.translate.instant("programBuilder.wizard.templateCreated"),3e3),this.skipAutoAddWeek=!1})}getTemplateProgramName(t){switch(t){case"3x3":return"3x3 Strength";case"5x5":return"5x5 Strength";case"ppl":return"Push/Pull/Legs";case"531":return"5/3/1";default:return"Custom Program"}}getProgramType(){return this.programForm?.get("programType")?.value}getProgramName(){return this.programForm?.get("name")?.value}bouncedExerciseListId=null;triggerBounceOnExerciseList(t){this.bouncedExerciseListId=t,setTimeout(()=>{this.bouncedExerciseListId===t&&(this.bouncedExerciseListId=null)},700)}areAllPropertiesFalsy(t){return Object.values(t).every(e=>!e)}assignRoutineToDay(t,e,r,n,o,d=!1,u=""){let g=e[n%e.length];if(!g){let S=`No routine found for index ${n} in template ${o}`;console.warn(S),this.toastService.warning(S,4e3,"Template Warning");return}let h=this.createScheduledDayGroup({dayOfWeek:r}),f=this.dayOfWeekOptions.find(S=>S.value===r)?.label||"",T;d&&u?T=`${this.getTemplateProgramName(o)} ${this.translate.instant("trainingPrograms.calendar.day")} ${u}`:T=g.name+" "+this.translate.instant("trainingPrograms.calendar.day")+" "+f,h.patchValue({routineId:g.id,routineName:T,dayName:T}),t.push(h);let P=`${this.weeksFormArray.length}-${n}`;this.temporaryCustomRoutines.set(P,e[n%e.length])}get chosenRoutineForModal(){if(this.targetIndicesForRoutine){let{weekIndex:t,dayIndex:e}=this.targetIndicesForRoutine,r;return t!==void 0?r=this.getWeekScheduleDayControl(t,e).get("routineId")?.value:r=this.scheduleFormArray.at(e).get("routineId")?.value,this.availableRoutines.find(n=>n.id===r)||null}return null}getUniformExerciseSetValues(t){if(!t?.sets||t.sets.length===0)return null;let e=["targetReps","targetWeight","targetDuration","targetDistance","targetRest"],r={},n=t.sets[0];for(let o of e){let d=n[o];if(!this.targetExists(d))continue;let u=!0;for(let g=1;g<t.sets.length;g++){let h=t.sets[g][o],f=JSON.stringify(d),T=JSON.stringify(h);if(f!==T){u=!1;break}}if(u){if(o==="targetReps"){let g=this.workoutUtilService.repsTargetAsString(d);g&&(r.reps=g)}else if(o==="targetWeight"){let g=this.workoutUtilService.weightTargetAsString(d);g&&(r.weight=g)}else if(o==="targetDuration"){let g=this.workoutUtilService.durationTargetAsString(d);g&&(r.duration=g)}else if(o==="targetDistance"){let g=this.workoutUtilService.distanceTargetAsString(d);g&&(r.distance=g)}else if(o==="targetRest"){let g=this.workoutUtilService.restTargetAsString(d);g&&(r.rest=g)}}}return Object.keys(r).length>0?r:null}getExerciseSetCountDisplay(t){if(!t?.sets)return"";let e=t.sets.length;return e===1?this.translate.instant("programBuilder.exercise.set"):`${e} ${this.translate.instant("programBuilder.exercise.sets")}`}fabMenuItems=[];refreshFabMenuItems(){let t=!!this.isNewMode,e=this.getProgramType(),r={label:e==="linear"?"fab.add_week":"fab.add_day",actionKey:e==="linear"?"add_week":"add_day",iconName:"plus-circle",cssClass:e==="linear"?"bg-green-500 focus:ring-green-400":"bg-blue-500 focus:ring-blue-400",isPremium:!1};this.isEditMode||this.isNewMode?(this.fabMenuItems=[r,{label:this.isNewMode?"programBuilder.actions.createProgram":"programBuilder.actions.saveChanges",actionKey:"save_program",iconName:"save",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1}],this.fabMenuItems.unshift({label:"workoutBuilder.buttons.resetTemplateButton",actionKey:"template_wizard",iconName:"restore",cssClass:"bg-amber-500 focus:ring-amber-400"})):(this.fabMenuItems=[{label:"fab.edit",actionKey:"edit",iconName:"edit",cssClass:"bg-primary focus:ring-primary-light",isPremium:!1}],this.isCurrentProgramActive()||this.fabMenuItems.unshift({label:"trainingPrograms.actions.activate",actionKey:"activate",iconName:"activate",cssClass:"bg-emerald-500 focus:ring-emerald-400"}),this.isCurrentProgramActive()&&this.fabMenuItems.unshift({label:"trainingPrograms.actions.deactivate",actionKey:"deactivate",iconName:"deactivate",cssClass:"bg-emerald-500 focus:ring-emerald-400"})),this.fabMenuItems.unshift({label:"trainingPrograms.actions.delete",actionKey:"delete",iconName:"trash",cssClass:"bg-red-600 focus:ring-red-500"}),this.fabMenuItems.unshift({label:"trainingPrograms.actions.history",actionKey:"history",iconName:"clock",cssClass:"bg-gray-700 focus:ring-gray-600"})}onFabAction(t){switch(t){case"add_day":this.addScheduledDay();break;case"add_week":this.addWeek();break;case"save_program":this.onSubmit();break;case"template_wizard":this.showCreationWizard();break;case"edit":this.enableEditModeFromView();break;case"activate":this.toggleProgramStatus();break;case"deactivate":this.toggleProgramStatus();break;case"history":this.toggleProgramHistory();break;case"delete":this.deleteProgram();break}}getDayOfWeekTranslationKey(t){return t==null?"days.unknown":`days.${this.dayOfWeekPipe.transform(t,!1)}`}getDayDisplayName(t){let e=t.get("dayOfWeek")?.value,r=t.get("dayName")?.value;if(!e)return r||"";let n=this.dayOfWeekPipe.transform(e,!1),o=this.translate.instant(`dates.days.${n.toLowerCase()}`);return r?`${o}: ${r}`:o}hasLoggedWorkoutsForCurrentIteration(){let t=this.currentProgram();return t?.iterationId?this.allWorkoutLogs().some(r=>r.programId===t.id&&r.iterationId===t.iterationId):!1}hasCriticalChanges(t){let e=this.programForm.getRawValue();if(t.programType!==e.programType||t.programType==="cycled"&&t.cycleLength!==e.cycleLength)return!0;if(t.programType==="cycled"){if(t.schedule?.length!==e.schedule?.length)return!0}else if(t.programType==="linear"){if(t.weeks?.length!==e.weeks?.length)return!0;for(let r=0;r<Math.min(t.weeks?.length||0,e.weeks?.length||0);r++)if(t.weeks[r].schedule.length!==e.weeks[r].schedule.length)return!0}return!1}warnAboutCriticalChangesWithLogs(t,e){return W(this,null,function*(){let r=yield this.alertService.showConfirmationDialog(this.translate.instant("programBuilder.alerts.criticalChangeTitle"),this.translate.instant("programBuilder.alerts.criticalChangeMessage"),[{text:this.translate.instant("programBuilder.alerts.criticalChangeCancel"),role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:this.translate.instant("programBuilder.alerts.criticalChangeCreate"),role:"create_new",cssClass:"bg-blue-600 hover:bg-blue-700",icon:"plus"},{text:this.translate.instant("programBuilder.alerts.criticalChangeConfirm"),role:"confirm",cssClass:"bg-red-600 hover:bg-red-700",icon:"warning"}]);return r?r.role==="create_new"?(this.toastService.info(this.translate.instant("programBuilder.toasts.creatingDuplicate"),3e3),yield this.createDuplicateProgram(t,e),!1):r.role==="confirm":!1})}createDuplicateProgram(t,e){return W(this,null,function*(){let r=yield this.alertService.showPromptDialog(this.translate.instant("programBuilder.alerts.duplicateNameTitle"),this.translate.instant("programBuilder.alerts.duplicateNameMessage",{name:t.name}),[{name:"duplicateName",type:"text",label:this.translate.instant("programBuilder.form.nameLabel"),value:`${e.name} (Copy)`,required:!0,autofocus:!0}],this.translate.instant("alertService.buttons.ok"));if(!(!r||!r.duplicateName))try{this.spinnerService.show(this.translate.instant("programBuilder.toasts.creatingDuplicate"));let n=A(),o={id:n,name:String(r.duplicateName),programType:e.programType,goals:this.selectedGoals(),description:e.description,programNotes:e.programNotes,startDate:e.startDate||null,iterationId:"",cycleLength:e.programType==="cycled"&&e.cycleLength||null,isRepeating:e.programType==="linear"?e.isRepeating:!1,isActive:!1,history:[],schedule:e.schedule.map(u=>({id:A(),dayOfWeek:Number(u.dayOfWeek),dayName:u.dayName||"",routineId:u.routineId,routineName:u.routineName,programId:n,notes:u.notes,timeOfDay:u.timeOfDay,isUnscheduled:u.isUnscheduled||!1,iterationId:""})),weeks:e.programType==="linear"?e.weeks.map((u,g)=>Z(Q({},u),{id:A(),schedule:u.schedule.map(h=>({id:A(),dayOfWeek:Number(h.dayOfWeek),dayName:h.dayName||"",routineId:h.routineId,routineName:h.routineName,programId:n,notes:h.notes,timeOfDay:h.timeOfDay,isUnscheduled:h.isUnscheduled||!1,iterationId:""}))})):[]},d=yield this.trainingProgramService.addProgram(o);this.toastService.success(this.translate.instant("programBuilder.toasts.duplicateCreated",{name:d.name}),3e3,this.translate.instant("common.success")),setTimeout(()=>{this.router.navigate(["/training-programs/edit",d.id])},100)}catch{this.toastService.error(this.translate.instant("programBuilder.toasts.duplicateFailed"),0,this.translate.instant("common.error"))}finally{this.spinnerService.hide()}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=fe({type:i,selectors:[["app-training-program-builder"]],viewQuery:function(e,r){if(e&1&&ke(pe,5),e&2){let n;we(n=Ce())&&(r.shatterables=n)}},features:[Me([Y])],decls:55,vars:55,consts:[["exerciseSetDisplay",""],["addDayToSchedule",""],["addWeekButton",""],["customRoutine",""],["routineModalChosen",""],["noHistory",""],[1,"container","mx-auto"],[1,"flex","items-center","justify-between","p-2"],[1,"flex","justify-between","items-center"],[1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","-ml-1",3,"routerLink"],["name","back",1,"w-6","h-6"],[1,"w-10","h-10"],[1,"flex","items-center","space-x-2","flex-shrink-0"],["class","",4,"ngIf"],[1,"space-y-6","mb-6",3,"formGroup"],[1,"space-y-4","p-2","rounded-md"],[4,"ngIf"],["class","pt-2",4,"ngIf"],["class","pt-4 space-y-4",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"md:col-span-2"],[1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"p-2","bg-gray-100","dark:bg-gray-700","rounded-md",3,"ngClass"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","radio","formControlName","programType","value","cycled",1,"form-radio","h-4","w-4","text-primary","focus:ring-primary-dark","dark:bg-gray-600","dark:border-gray-500"],[3,"ngClass"],["type","radio","formControlName","programType","value","linear",1,"form-radio","h-4","w-4","text-primary","focus:ring-primary-dark","dark:bg-gray-600","dark:border-gray-500"],["class","mt-3 pl-6",4,"ngIf"],["for","iterationId",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","iterationId","formControlName","iterationId","placeholder","",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["class","mt-1 text-xs text-red dark:text-primary-light",4,"ngIf"],["class","pt-6 px-2 flex justify-center space-x-3",4,"ngIf"],["class","fixed inset-0 bg-gray-700 bg-opacity-75 transition-opacity overflow-y-auto h-full w-full z-[70] flex items-center justify-center p-4 overflow-hidden",3,"click",4,"ngIf"],["class","fixed inset-0 bg-gray-700 bg-opacity-75 z-[80] flex items-center justify-center p-4 backdrop-blur-sm",4,"ngIf"],["itemIconName","plus-circle","itemIconClass","text-primary dark:text-primary-light",3,"searchTermChange","exercisesSelected","createCustomClicked","close","isOpen","searchTerm","isMultiSelect","title","exercises"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/70",4,"ngIf"],[3,"actionClicked","actions","checkForPausedSession","scrollToBottomDisabled","scrollToTopDisabled"],[1,""],[1,"relative"],[1,"text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-full","focus:outline-none","flex","items-center",3,"click"],["name","menu-action",1,"h-10","w-10"],["displayMode","dropdown",3,"items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","items","isVisible"],[1,"block","text-xl","font-black","text-gray-700","dark:text-gray-300"],[1,"flex","max-w-[100px]","px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors","duration-200","ease-in-out","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-green-800","bg-green-600","text-white","hover:bg-green-300","dark:bg-green-600","dark:hover:bg-green-500","focus:ring-green-400"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","ml-1"],["fill-rule","evenodd","d","M16.403 12.652a3 3 0 000-5.304 3 3 0 00-3.75-3.751 3 3 0 00-5.305 0 3 3 0 00-3.751 3.75 3 3 0 000 5.305 3 3 0 003.75 3.751 3 3 0 005.305 0 3 3 0 003.751-3.75Zm-2.546-4.46a.75.75 0 00-1.214-.883l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5Z","clip-rule","evenodd"],[1,"text-2xs","sm:text-xs","font-semibold","px-1.5","sm:px-2.5","py-0.5"],[1,"pt-2"],["class","space-y-1",4,"ngIf"],[1,"space-y-1"],[1,"flex","justify-between","items-baseline"],[1,"text-sm","font-medium","text-gray-600","dark:text-gray-300"],[1,"text-sm","font-semibold","text-primary","dark:text-primary-light"],[1,"w-full","bg-gray-200","dark:bg-gray-700","rounded-full","h-4","relative","flex","items-center"],[1,"bg-primary","h-2.5","my-1","mx-1","absolute","rounded-full","transition-all","duration-500","ease-out"],[1,"pt-4","space-y-4"],[1,"flex","w-full","h-4","rounded-md","overflow-hidden","border","border-gray-300","dark:border-gray-600"],["class","flex-1 border-r border-gray-300 dark:border-gray-600 last:border-r-0 transition-colors duration-300",3,"ngClass","title",4,"ngFor","ngForOf"],[1,"flex-1","border-r","border-gray-300","dark:border-gray-600","last:border-r-0","transition-colors","duration-300",3,"ngClass","title"],[1,"font-semibold"],["class","flex-1 border-r border-gray-300 dark:border-gray-600 last:border-r-0 transition-colors duration-300",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex-1","border-r","border-gray-300","dark:border-gray-600","last:border-r-0","transition-colors","duration-300",3,"ngClass"],["for","programName",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","programName","formControlName","name",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"placeholder","ngClass"],["class","text-red-500 dark:text-red-400 text-xs mt-1",4,"ngIf"],[1,"text-red-500","dark:text-red-400","text-xs","mt-1"],[1,"mt-1","block","w-full","dark:text-gray-200",3,"innerHTML"],["for","description",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","dark:bg-gray-600","dark:text-gray-200",3,"placeholder"],[1,"mt-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"flex","flex-wrap","gap-2"],["type","button","class","px-3 py-1.5 text-xs font-semibold rounded-full transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800",3,"disabled","ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors","duration-200","ease-in-out","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-gray-800",3,"click","disabled","ngClass"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","date","id","startDate","formControlName","startDate",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],[1,"mt-3","pl-6"],["type","checkbox","formControlName","isRepeating",1,"form-checkbox","h-4","w-4","rounded","text-primary","focus:ring-primary-dark","dark:bg-gray-600","dark:border-gray-500"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"mt-1","text-xs","text-gray-500","dark:text-gray-400"],["for","cycleLength",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","flex","items-center"],[1,"ml-1"],["name","info",1,"h-4","w-4","text-gray-400","dark:text-gray-500","cursor-help",3,"appTooltip"],["type","text","inputmode","decimal","pattern","[0-9]*","numbersOnly","","id","cycleLength","formControlName","cycleLength","min","1",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]",3,"placeholder"],[1,"mt-1","text-xs","text-red","dark:text-primary-light"],["for","programNotes",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","programNotes","formControlName","programNotes","rows","3",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],["class","space-y-4 p-2 rounded-md",4,"ngIf"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300"],["cdkDropList","","formArrayName","schedule","class","space-y-4",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],["class","text-center py-6 text-gray-500 dark:text-gray-400 border border-dashed dark:border-gray-700 rounded-md",4,"ngIf","ngIfElse"],["cdkDropList","","formArrayName","schedule",1,"space-y-4",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","","appShatterable","","class","scheduled-day-card p-3 border rounded-md shadow-sm bg-gray-50 dark:bg-gray-600/70 dark:border-gray-600 relative",3,"id","formGroupName","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","","appShatterable","",1,"scheduled-day-card","p-3","border","rounded-md","shadow-sm","bg-gray-50","dark:bg-gray-600/70","dark:border-gray-600","relative",3,"id","formGroupName","cdkDragDisabled"],[1,"flex","justify-between","items-start","cursor-pointer",3,"click"],[1,"flex","items-center","flex-shrink-0"],["cdkDragHandle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 cursor-grab","title","Drag to reorder day",4,"ngIf"],["type","button",1,"p-1","-ml-1","rounded-full","hover:bg-gray-200","dark:hover:bg-gray-500","focus:outline-none","inline-flex"],[1,"w-5","h-5","text-gray-500","dark:text-gray-400",3,"name"],["type","button","title","Remove DAY","class","flex p-2 items-center hover:text-red-700 dark:hover:text-red-300 rounded-full hover:bg-red-100 dark:hover:bg-red-900/30 disabled:opacity-50 bg-red-500 text-white text-sm font-medium",3,"click",4,"ngIf"],[1,"flex","justify-between","items-center","mb-2",3,"ngClass"],[1,"text-md","font-medium","text-gray-800","dark:text-gray-100"],[1,"block","text-xs","font-medium","text-gray-700","dark:text-gray-300",3,"for"],["type","text","formControlName","dayName",1,"text-lg","font-bold","bg-transparent","focus:ring-0","focus:border-primary","dark:text-gray-100","p-1","w-full",3,"id","placeholder","ngClass"],["class","mt-2 text-sm",4,"ngIf"],["cdkDragHandle","","title","Drag to reorder day",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","cursor-grab"],["name","drag"],["type","button","title","Remove DAY",1,"flex","p-2","items-center","hover:text-red-700","dark:hover:text-red-300","rounded-full","hover:bg-red-100","dark:hover:bg-red-900/30","disabled:opacity-50","bg-red-500","text-white","text-sm","font-medium",3,"click"],["name","cancel",1,"h-5","w-5"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3","dark:text-gray-300"],["formControlName","dayOfWeek",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500","dark:text-gray-300",3,"id"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-1","flex","rounded-md","shadow-sm",3,"ngClass"],["type","text","readonly","",1,"flex-1","min-w-0","block","w-full","px-3","py-2","text-sm","rounded-none","rounded-l-md","border-gray-300","dark:border-gray-200","dark:bg-gray-400","cursor-default","focus:outline-none","focus:ring-0","focus:border-gray-300","dark:text-gray-800","font-medium",3,"id","value","ngClass"],["type","button","appPress","","class","inline-flex items-center px-3 py-2 border border-l-0 rounded-r-md text-sm font-medium transition-colors duration-150 text-white ",3,"ngClass","shortPress",4,"ngIf"],["type","button","class","ml-1 inline-flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors duration-150 bg-purple-50 dark:bg-purple-700 text-purple-700 dark:text-purple-100 hover:bg-purple-100 dark:hover:bg-purple-600",3,"click",4,"ngIf"],["type","button","class","ml-2 px-2 py-1 rounded bg-yellow-100 text-yellow-700 text-xs font-medium hover:bg-yellow-200",3,"click",4,"ngIf"],["class","sm:col-span-2",4,"ngIf"],[3,"value"],["type","button","appPress","",1,"inline-flex","items-center","px-3","py-2","border","border-l-0","rounded-r-md","text-sm","font-medium","transition-colors","duration-150","text-white",3,"shortPress","ngClass"],["name","change",1,"h-4","w-4"],["type","button",1,"ml-1","inline-flex","items-center","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors","duration-150","bg-purple-50","dark:bg-purple-700","text-purple-700","dark:text-purple-100","hover:bg-purple-100","dark:hover:bg-purple-600",3,"click"],["name","plus-circle",1,"h-4","w-4"],["type","button",1,"ml-2","px-2","py-1","rounded","bg-yellow-100","text-yellow-700","text-xs","font-medium","hover:bg-yellow-200",3,"click"],["name","edit",1,"h-4","w-4","mr-1"],[1,"sm:col-span-2"],["type","text","formControlName","timeOfDay",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500",3,"id","placeholder"],["formControlName","notes","rows","2",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500",3,"id"],[1,"mt-2","text-sm","bg-gray-100","dark:bg-gray-700","p-2","rounded-md","text-gray-800","dark:text-gray-200",3,"id","ngClass"],["type","button",1,"flex","items-center","gap-2","font-semibold","text-primary","hover:underline","mb-2","bg-primary-dark","text-white","rounded-md","py-1","px-2",3,"click"],[1,"w-4","h-4",3,"name"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-2","text-sm"],[1,"font-medium","text-gray-800","dark:text-gray-200","cursor-pointer","flex","w-full",3,"click"],[1,"text-center","py-6","text-gray-500","dark:text-gray-400","border","border-dashed","dark:border-gray-700","rounded-md"],["type","button","class","mt-2 text-sm text-primary hover:underline",3,"click",4,"ngIf"],["type","button",1,"mt-2","text-sm","text-primary","hover:underline",3,"click"],[1,"flex","justify-center","mt-2"],["type","button","appPress","","class","flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-1.5 px-3 rounded-md shadow-sm",3,"shortPress",4,"ngIf"],["type","button","appPress","",1,"flex","items-center","justify-center","bg-blue-500","hover:bg-blue-600","text-white","text-sm","font-medium","py-1.5","px-3","rounded-md","shadow-sm",3,"shortPress"],["name","create",1,"h-4","w-4"],["cdkDropList","","formArrayName","weeks",1,"space-y-6","mt-4",3,"cdkDropListDropped"],["cdkDrag","","appShatterable","","class","py-4 px-2 border-2 border-dashed dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800/50 relative",3,"formGroupName","cdkDragDisabled","id",4,"ngFor","ngForOf"],["cdkDrag","","appShatterable","",1,"py-4","px-2","border-2","border-dashed","dark:border-gray-600","rounded-lg","bg-gray-50","dark:bg-gray-800/50","relative",3,"formGroupName","cdkDragDisabled","id"],[1,"flex","justify-between","items-center","mb-3",3,"click","id"],[1,"flex","items-center"],["cdkDragHandle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 cursor-move","title","Drag to reorder week",4,"ngIf"],["type","button",1,"p-1","rounded-full","hover:bg-gray-200","dark:hover:bg-gray-600","focus:outline-none","inline-flex",3,"click"],[1,"w-6","h-6","text-gray-500","dark:text-gray-400",3,"name"],[1,"flex-grow","mx-2"],[1,"sr-only",3,"for"],["type","text","formControlName","name",1,"text-lg","font-bold","bg-transparent","focus:ring-0","focus:border-primary","dark:text-gray-100","p-1","w-full","sm:w-1/2",3,"id","placeholder","ngClass"],["type","button","appPress","","title","Remove WEEK","class","flex items-center p-1 hover:text-red-700 dark:hover:text-red-300 rounded-md hover:bg-red-100 dark:hover:bg-red-900/30 disabled:opacity-50 bg-red-500 text-white",3,"shortPress",4,"ngIf"],["class","mt-2 pl-4 border-l-2 border-gray-200 dark:border-gray-600 cursor-pointer",3,"click",4,"ngIf"],["cdkDragHandle","","title","Drag to reorder week",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","cursor-move"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-6","h-6"],["d","M10 4h4v4h-4zM4 10h4v4H4zM10 10h4v4h-4zM16 10h4v4h-4zM10 16h4v4h-4z"],["type","button","appPress","","title","Remove WEEK",1,"flex","items-center","p-1","hover:text-red-700","dark:hover:text-red-300","rounded-md","hover:bg-red-100","dark:hover:bg-red-900/30","disabled:opacity-50","bg-red-500","text-white",3,"shortPress"],["name","trash",1,"h-6","w-6"],["cdkDrag","","appShatterable","","class","scheduled-day-card p-3 border rounded-md shadow-sm bg-white dark:bg-gray-600/70 dark:border-gray-600 relative",3,"formGroupName","cdkDragDisabled","id",4,"ngFor","ngForOf"],["class","text-center mt-4 flex items-center justify-center",4,"ngIf"],["class","text-center text-sm text-gray-500 dark:text-gray-400 py-4",4,"ngIf"],["cdkDrag","","appShatterable","",1,"scheduled-day-card","p-3","border","rounded-md","shadow-sm","bg-white","dark:bg-gray-600/70","dark:border-gray-600","relative",3,"formGroupName","cdkDragDisabled","id"],["type","button","title","Remove DAY","class","flex p-2 items-center hover:text-red-700 dark:hover:text-red-300 rounded-full hover:bg-red-100 dark:hover:bg-red-900/30 disabled:opacity-50 bg-red-500 text-white",3,"click",4,"ngIf"],["type","button","title","Remove DAY",1,"flex","p-2","items-center","hover:text-red-700","dark:hover:text-red-300","rounded-full","hover:bg-red-100","dark:hover:bg-red-900/30","disabled:opacity-50","bg-red-500","text-white",3,"click"],["formControlName","dayOfWeek",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-500",3,"id"],[1,"mt-1","flex","rounded-md","shadow-sm"],["type","text","readonly","",1,"flex-1","block","w-full","px-3","py-2","text-sm","rounded-l-md","dark:bg-gray-400","cursor-default","dark:text-gray-800","font-medium",3,"id","value","ngClass"],["type","button","appPress","","class","inline-flex items-center px-3 py-2 border border-l-0 rounded-r-md text-sm transition-colors duration-150 border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-700 text-green-700 dark:text-green-100 hover:bg-green-100 dark:hover:bg-green-600 font-medium ",3,"ngClass","shortPress",4,"ngIf"],["formControlName","notes","rows","2",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-500",3,"id"],["type","button","appPress","",1,"inline-flex","items-center","px-3","py-2","border","border-l-0","rounded-r-md","text-sm","transition-colors","duration-150","border-green-500","dark:border-green-400","bg-green-50","dark:bg-green-700","text-green-700","dark:text-green-100","hover:bg-green-100","dark:hover:bg-green-600","font-medium",3,"shortPress","ngClass"],["name","change",1,"h-5","w-5","mr-1"],[1,"text-center","mt-4","flex","items-center","justify-center"],[1,"text-center","text-sm","text-gray-500","dark:text-gray-400","py-4"],[1,"mt-2","pl-4","border-l-2","border-gray-200","dark:border-gray-600","cursor-pointer",3,"click"],[1,"list-none","space-y-1"],["class","text-sm text-gray-600 dark:text-gray-300",4,"ngFor","ngForOf"],["class","text-sm text-gray-500 italic",4,"ngIf"],[1,"text-sm","text-gray-600","dark:text-gray-300"],[1,"italic","ml-2"],[1,"text-sm","text-gray-500","italic"],["type","button","appPress","","class","flex items-center justify-center bg-green-500 hover:bg-green-600 text-white text-sm font-medium py-1.5 px-3 rounded-md shadow-sm",3,"shortPress",4,"ngIf"],["type","button","appPress","",1,"flex","items-center","justify-center","bg-green-500","hover:bg-green-600","text-white","text-sm","font-medium","py-1.5","px-3","rounded-md","shadow-sm",3,"shortPress"],["name","create",1,"h-7","w-7","mr-1"],[1,"pt-6","px-2","flex","justify-center","space-x-3"],["appPress","",1,"flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","dark:text-gray-200","hover:bg-gray-50","dark:hover:bg-gray-700",3,"shortPress"],["name","cancel",1,"h-5","w-5","mr-1"],["type","submit","appPress","",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-primary","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-dark","disabled:opacity-50",3,"shortPress","disabled"],["name","create","class","h-5 w-5",4,"ngIf"],["name","save","class","h-5 w-5",4,"ngIf"],["name","create",1,"h-5","w-5"],["name","save",1,"h-5","w-5"],[1,"fixed","inset-0","bg-gray-700","bg-opacity-75","transition-opacity","overflow-y-auto","h-full","w-full","z-[70]","flex","items-center","justify-center","p-4","overflow-hidden",3,"click"],[1,"relative","transform","overflow-hidden","rounded-md","bg-white","dark:bg-gray-700","text-left","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-2xl",3,"click"],[1,"bg-white","dark:bg-gray-600","px-4","pt-5","pb-4","sm:p-6","sm:pb-4","backdrop-blur-sm"],[1,"sm:flex","sm:items-start","w-full"],[1,"mt-3","text-center","sm:mt-0","sm:text-left","w-full"],[1,"flex","justify-between","items-center","pb-3"],["id","modal-title",1,"text-xl","font-semibold","leading-6","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","focus:outline-none",3,"click"],["name","cancel",1,"h-6","w-6"],[1,"mb-2","px-1","text-xs","text-gray-600","dark:text-gray-300","font-medium"],[1,"my-4"],["type","text",1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:text-gray-200",3,"ngModelChange","placeholder","ngModel"],[1,"mt-2","max-h-80","overflow-y-auto","pr-2","custom-scrollbar"],["class","sticky top-0 z-10 bg-white dark:bg-gray-600 pb-2",4,"ngIf"],["class","text-gray-500 dark:text-gray-400 text-center p-4",4,"ngIf"],[1,"bg-gray-50","dark:bg-gray-600","px-4","py-3","sm:flex","sm:flex-row-reverse","sm:px-6"],["type","button",1,"mt-3","inline-flex","w-full","justify-center","rounded-md","bg-white","dark:bg-gray-700","px-3","py-2","text-sm","font-semibold","text-gray-900","dark:text-gray-200","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-500","hover:bg-gray-50","dark:hover:bg-gray-500","sm:mt-0","sm:w-auto",3,"click"],[1,"sticky","top-0","z-10","bg-white","dark:bg-gray-600","pb-2"],[1,"mb-2"],[1,"text-xs","font-semibold","text-gray-500","dark:text-gray-300","mb-1"],[1,"p-3","bg-primary/40","dark:bg-primary/40","rounded-md","flex","justify-between","items-center","opacity-90","cursor-not-allowed"],[1,"text-left"],[1,"font-medium","text-gray-800","dark:text-gray-200"],[1,"block","text-xs","text-gray-500","dark:text-gray-400"],["name","check",1,"w-5","h-5","text-primary","dark:text-primary-light"],["class","p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer transition-colors flex justify-between items-center",3,"opacity-50","cursor-not-allowed","click",4,"ngIf"],[1,"p-3","hover:bg-gray-100","dark:hover:bg-gray-700","rounded-md","cursor-pointer","transition-colors","flex","justify-between","items-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","text-primary","dark:text-primary-light"],["fill-rule","evenodd","d","M8.22 5.22a.75.75 0 011.06 0l4.25 4.25a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 010-1.06Z","clip-rule","evenodd"],[1,"text-gray-500","dark:text-gray-400","text-center","p-4"],[1,"fixed","inset-0","bg-gray-700","bg-opacity-75","z-[80]","flex","items-center","justify-center","p-4","backdrop-blur-sm"],[1,"relative","bg-white","dark:bg-gray-800","rounded-md","shadow-xl","w-full","max-w-3xl","h-full","max-h-[90vh]","flex","flex-col",3,"click"],[1,"flex","justify-between","items-center","px-4","py-3","border-b","dark:border-gray-700","flex-shrink-0"],[1,"text-lg","font-bold","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300",3,"click"],[1,"p-4","overflow-y-auto","flex-grow"],[4,"ngIf","ngIfElse"],[1,"px-4","py-3","border-t","dark:border-gray-700","flex","justify-end","flex-shrink-0"],["type","button",1,"px-4","py-2","rounded-md","bg-primary","text-white","hover:bg-primary-dark","flex","items-center",3,"click"],[3,"ngSubmit","formGroup"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700","hidden","sm:table"],[1,"px-4","py-2","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"px-4","py-2","text-center","text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],[1,"space-y-4","sm:hidden"],["class","p-3 border rounded-md dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",4,"ngFor","ngForOf"],[1,"px-4","py-3","text-sm","text-gray-700","dark:text-gray-200"],[1,"px-4","py-3"],[1,"flex","items-center","space-x-2","justify-center"],["type","button",1,"p-1.5","text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-md","flex","items-center",3,"click","title"],["name","edit",1,"w-8","h-8"],["type","button",1,"p-1.5","text-red-500","dark:text-red-400","hover:bg-red-100","dark:hover:bg-red-900/50","rounded-md",3,"click","title"],["name","trash",1,"w-8","h-8"],[1,"px-2","py-2"],["type","date","formControlName","startDate",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],["type","date","formControlName","endDate",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],["formControlName","status",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300",3,"change"],[1,"px-4","py-2","text-sm","text-gray-500","dark:text-gray-400","italic"],[1,"px-4","py-2"],[1,"flex","items-center","space-x-2"],["type","submit",1,"p-1.5","text-green-600","dark:text-green-400","hover:bg-green-100","dark:hover:bg-green-900/50","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled","title"],["name","save",1,"w-8","h-8"],["name","cancel",1,"w-8","h-8"],[1,"p-3","border","rounded-md","dark:border-gray-700","bg-gray-50","dark:bg-gray-700/50"],["class","space-y-3",4,"ngIf"],[1,"grid","grid-cols-2","gap-x-3","gap-y-2"],[1,"text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"font-semibold","dark:text-gray-100"],[1,"dark:text-gray-300"],[1,"dark:text-gray-300","text-xs"],[1,"flex","justify-end","items-center","space-x-2","mt-3","pt-3","border-t","dark:border-gray-600"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-gray-600","dark:text-gray-300","hover:bg-gray-200","dark:hover:bg-gray-600",3,"click"],["name","edit",1,"w-8","h-8","mr-1"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-red-600","dark:text-red-400","hover:bg-red-100","dark:hover:bg-red-900/50",3,"click"],["name","trash",1,"w-8","h-8","mr-1"],[1,"space-y-3"],[1,"block","text-xs","font-medium","text-gray-500","dark:text-gray-400","mb-1"],["formControlName","status",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"change"],["type","date","formControlName","startDate",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200","dark:[color-scheme:dark]"],["type","date","formControlName","endDate",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200","dark:[color-scheme:dark]"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-gray-600","dark:text-gray-300","bg-gray-200","hover:bg-gray-300","dark:bg-gray-600","dark:hover:bg-gray-500",3,"click"],["type","submit",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-white","bg-green-600","hover:bg-green-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","save",1,"w-8","h-8","mr-1"],[1,"text-center","text-gray-500","dark:text-gray-400","py-6"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","dark:bg-black/70"],[1,"w-full","h-full","max-w-none","max-h-none","bg-white","dark:bg-gray-900","rounded-none","shadow-none","flex","flex-col"],[1,"flex","items-center","justify-between","p-4","border-b","dark:border-gray-700","bg-white","dark:bg-gray-900","z-10"],[1,"text-xl","font-semibold","text-gray-900","dark:text-gray-100"],[1,"text-gray-500","hover:text-gray-700","dark:text-gray-400","dark:hover:text-gray-200",3,"click"],["name","close",1,"h-6","w-6"],[1,"flex-1","overflow-y-auto"],[3,"routineConfirmed","modalClose","context","mode","initialRoutine"],[1,"mb-2","flex","items-start","gap-2"],[1,"flex-1"],[1,"font-semibold","text-gray-800","dark:text-gray-100","flex","items-center","gap-2"],[1,"text-xs","font-bold","bg-gray-200","dark:bg-gray-700","rounded","px-2","py-0.5"],["class","text-sm text-gray-600 dark:text-gray-300 mt-2 inline-block px-3 py-1.5 rounded bg-blue-100 dark:bg-blue-900/40 border border-blue-300 dark:border-blue-700",4,"ngIf"],["class","text-sm text-gray-600 dark:text-gray-300 mt-1 flex flex-wrap gap-2",4,"ngIf"],[1,"text-sm","text-gray-600","dark:text-gray-300","mt-2","inline-block","px-3","py-1.5","rounded","bg-blue-100","dark:bg-blue-900/40","border","border-blue-300","dark:border-blue-700"],[1,"text-sm","text-gray-600","dark:text-gray-300","mt-1","flex","flex-wrap","gap-2"],[1,"inline-block","px-2","py-0.5","rounded","bg-gray-200","dark:bg-gray-700","mr-1","mb-1"],[1,"ml-1","text-gray-400"]],template:function(e,r){if(e&1){let n=E();l(0,"div",6)(1,"header",7)(2,"div",8)(3,"button",9),v(4,"app-icon",10),s(),v(5,"div",11),s(),l(6,"div",12),x(7,sr,5,1,"div",13),s()(),l(8,"form",14)(9,"section",15),x(10,lr,3,1,"div",16)(11,dr,7,3,"div",16)(12,mr,2,1,"div",17)(13,hr,3,2,"div",18)(14,vr,7,11,"div",16)(15,fr,2,1,"div",16)(16,br,6,6,"div",16)(17,wr,6,4,"div",19),l(18,"div",20),x(19,Cr,5,3,"div",16),l(20,"div",21)(21,"label",22),y(22),p(23,"translate"),s(),l(24,"div",23)(25,"div",24)(26,"label",25),v(27,"input",26),l(28,"span",27),y(29),p(30,"translate"),s()(),l(31,"label",25),v(32,"input",28),l(33,"span",27),y(34),p(35,"translate"),s()()(),x(36,Sr,9,6,"div",29),s()(),x(37,Tr,11,10,"div",16),l(38,"div")(39,"label",30),y(40),p(41,"translate"),s(),v(42,"input",31),x(43,Br,3,3,"p",32),s()(),x(44,Ir,5,3,"div",16),s(),x(45,Ti,3,2,"ng-container",16)(46,Ei,11,9,"div",33),s(),x(47,Oi,27,15,"div",34)(48,Yi,17,8,"div",35),s(),l(49,"app-exercise-selection-modal",36),p(50,"translate"),De("searchTermChange",function(d){return b(n),Pe(r.modalExerciseSearchTerm,d)||(r.modalExerciseSearchTerm=d),k(d)}),C("exercisesSelected",function(d){return b(n),k(r.selectExercisesForDay(d))})("createCustomClicked",function(){return b(n),k(r.handleTrulyCustomExerciseEntry())})("close",function(){return b(n),k(r.closeExerciseSelectionModal())}),s(),x(51,Qi,10,6,"div",37)(52,mn,8,4,"ng-template",null,0,K),l(54,"app-fab-menu",38),C("actionClicked",function(d){return b(n),k(r.onFabAction(d))}),s()}if(e&2){let n,o,d,u,g,h,f,T,P,S,I;a(3),c("routerLink","/training-programs"),a(4),c("ngIf",r.currentProgram()),a(),c("formGroup",r.programForm),a(2),c("ngIf",r.isViewMode),a(),c("ngIf",(n=r.currentProgram())==null?null:n.isActive),a(),c("ngIf",r.isViewMode&&((o=r.currentProgram())==null?null:o.isActive)),a(),c("ngIf",r.isViewMode&&((d=r.currentProgram())==null?null:d.programType)==="linear"&&((d=r.currentProgram())==null?null:d.isActive)),a(),c("ngIf",r.isEditableMode()),a(),c("ngIf",r.isViewMode),a(),c("ngIf",r.isEditableMode()),a(),c("ngIf",r.isViewMode&&((u=r.currentProgram())==null?null:u.goals)||r.isEditableMode()),a(2),c("ngIf",((g=r.programForm.get("startDate"))==null?null:g.value)||r.isEditableMode()),a(3),w("",_(23,37,"programBuilder.form.structureLabel"),"*"),a(2),c("ngClass",R(47,Jt,!r.getProgramType())),a(4),c("ngClass",$(49,jt,((h=r.programForm.get("programType"))==null?null:h.value)==="cycled",((h=r.programForm.get("programType"))==null?null:h.value)!=="cycled")),a(),B(_(30,39,"programBuilder.form.repeatingCycle")),a(4),c("ngClass",$(52,jt,((f=r.programForm.get("programType"))==null?null:f.value)==="linear",((f=r.programForm.get("programType"))==null?null:f.value)!=="linear")),a(),B(_(35,41,"programBuilder.form.weekByWeek")),a(2),c("ngIf",((T=r.programForm.get("programType"))==null?null:T.value)==="linear"),a(),c("ngIf",(((P=r.programForm.get("cycleLength"))==null?null:P.value)||r.isEditableMode())&&((P=r.programForm.get("programType"))==null?null:P.value)==="cycled"),a(3),B(_(41,43,"programBuilder.form.iterationLabel")),a(3),c("ngIf",r.isEditableMode()),a(),c("ngIf",((S=r.programForm.get("programNotes"))==null?null:S.value)||r.isEditableMode()),a(),c("ngIf",(I=r.programForm.get("programType"))==null?null:I.value),a(),c("ngIf",!r.isViewMode),a(),c("ngIf",r.isRoutineModalOpen()),a(),c("ngIf",r.isProgramHistoryModalOpen()),a(),c("isOpen",r.isExerciseModalOpen()),Ee("searchTerm",r.modalExerciseSearchTerm),c("isMultiSelect",!0)("title",_(50,45,"workoutBuilder.modal.addTitle"))("exercises",r.availableExercises),a(2),c("ngIf",r.isCustomWorkoutModalOpen()),a(3),c("actions",r.fabMenuItems)("checkForPausedSession",!1)("scrollToBottomDisabled",!0)("scrollToTopDisabled",!0)}},dependencies:[Ge,Ve,We,Ae,Oe,ct,Je,at,ot,Ke,qe,nt,Xe,Ye,Qe,st,et,it,tt,rt,Ue,Ot,At,Wt,Vt,dt,Ze,Mt,mt,Dt,ut,ht,Rt,zt,pe,$t,Nt,Re,Le,_t],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:.5rem;box-shadow:0 5px 5px -3px #0000001a,0 8px 10px 1px #00000012,0 3px 14px 2px #0000000f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2;border:2px dashed #9ca3af;background-color:#f3f4f6;transition:transform .25s cubic-bezier(0,0,.2,1);border-radius:.5rem}.dark[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{border-color:#4b5563;background-color:#374151}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.scheduled-day-card.cdk-drop-list-dragging[_ngcontent-%COMP%]   .scheduled-day-card[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#9ca3af;border-radius:3px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.dark[_ngcontent-%COMP%]   .custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563}.dark[_ngcontent-%COMP%]   .custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.highlight-no-routine[_ngcontent-%COMP%]{color:#fff;font-weight:700;background-color:#e34d4d}@keyframes _ngcontent-%COMP%_bounce{0%{transform:scale(1)}20%{transform:scale(1.1)}40%{transform:scale(.95)}60%{transform:scale(1.05)}80%{transform:scale(.98)}to{transform:scale(1)}}.bounce[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce .6s}body.modal-open[_ngcontent-%COMP%]{overflow:hidden}"]})};export{Ut as TrainingProgramBuilderComponent};

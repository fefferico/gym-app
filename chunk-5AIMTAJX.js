import{$ as Y,Fb as X,Ja as o,Jb as Z,Ka as d,Kb as tt,La as _,Lb as et,Ma as g,Mb as nt,Na as f,Nb as it,O as u,Oa as C,Qa as B,R as P,Ra as I,Sa as a,T as k,U as E,Wb as ot,X as z,Yb as at,_ as M,ab as H,ba as j,bb as O,cb as N,da as W,dd as rt,ed as lt,fa as D,gc as st,ia as q,id as ct,ja as s,jd as mt,kd as dt,qc as x,ra as Q,rb as J,rc as c,sb as U,uc as r,wa as l,wc as m,xa as T,xc as h,yc as b,za as G}from"./chunk-LWKZRPHK.js";import{g as F}from"./chunk-GAL4ENT6.js";function Ct(n,e){n&1&&g(0,"div",13)}function vt(n,e){if(n&1&&(f(0),g(1,"app-icon",17),C()),n&2){let t=a(2).$implicit,i=a(3);s(),H(t.iconClass||"w-5 h-5 mr-2"),o("name",i.getIconNameForComponent(t))}}function ht(n,e){if(n&1&&g(0,"span",19),n&2){let t=e.ngIf,i=a(3).$implicit;o("innerHTML",t,D)("ngClass",(i.iconClass||"w-5 h-5 mr-2")+" flex-shrink-0")}}function yt(n,e){if(n&1&&(f(0),l(1,ht,1,2,"span",18),C()),n&2){let t=a(2).$implicit,i=a(3);s(),o("ngIf",i.getIconHtml(t))}}function xt(n,e){if(n&1){let t=B();d(0,"button",14),I("click",function(v){k(t);let p=a().$implicit,y=a(3);return E(y.onItemClicked(v,p))}),l(1,vt,2,3,"ng-container",15)(2,yt,2,1,"ng-container",15),d(3,"span",16),O(4),J(5,"translate"),_()()}if(n&2){let t=a().$implicit,i=a(3);o("ngClass",i.defaultDropdownButtonClass+" "+t.buttonClass),s(),o("ngIf",i.isComplexIcon(t)),s(),o("ngIf",!i.isComplexIcon(t)),s(2),N(t.label?U(5,4,t.label):"")}}function bt(n,e){if(n&1&&(f(0),l(1,Ct,1,0,"div",11)(2,xt,6,6,"button",12),C()),n&2){let t=e.$implicit;s(),o("ngIf",t.isDivider),s(),o("ngIf",!t.isDivider)}}function wt(n,e){if(n&1&&(d(0,"div",7)(1,"div",8)(2,"div",9),l(3,bt,3,2,"ng-container",10),_()()()),n&2){let t=a(2);o("ngClass",t.alignmentClass()),s(2),o("@listAnimation",t.animationState())("ngClass",t.gridClass||"flex flex-col gap-1"),s(),o("ngForOf",t.items)}}function Mt(n,e){if(n&1&&(d(0,"div"),l(1,wt,4,4,"div",6),_()),n&2){let t=a();s(),o("ngIf",t.isVisible)}}function It(n,e){n&1&&g(0,"div")}function At(n,e){if(n&1&&(f(0),g(1,"app-icon",25),C()),n&2){let t=a(2).$implicit,i=a(3);s(),H(t.iconClass||"w-6 h-6"),o("name",i.getIconNameForComponent(t))}}function St(n,e){if(n&1&&g(0,"span",19),n&2){let t=e.ngIf,i=a(3).$implicit;o("innerHTML",t,D)("ngClass",i.iconClass||"w-6 h-6")}}function kt(n,e){if(n&1&&(f(0),l(1,St,1,2,"span",18),C()),n&2){let t=a(2).$implicit,i=a(3);s(),o("ngIf",i.getIconHtml(t))}}function Et(n,e){if(n&1&&(d(0,"span",26),O(1),_()),n&2){let t=a(2).$implicit;s(),N(t.label)}}function Dt(n,e){if(n&1){let t=B();d(0,"button",23),I("click",function(v){k(t);let p=a().$implicit,y=a(3);return E(y.onItemClicked(v,p))}),l(1,At,2,3,"ng-container",15)(2,kt,2,1,"ng-container",15)(3,Et,2,1,"span",24),_()}if(n&2){let t=a().$implicit,i=a(3);o("title",t.label)("ngClass",i.defaultCompactButtonClass+" "+t.buttonClass),s(),o("ngIf",i.isComplexIcon(t)),s(),o("ngIf",!i.isComplexIcon(t)),s(),o("ngIf",i.showLabelInCompact(t))}}function Tt(n,e){if(n&1&&(f(0),l(1,Dt,4,5,"button",22),C()),n&2){let t=e.$implicit;s(),o("ngIf",!t.isDivider)}}function Bt(n,e){if(n&1&&(d(0,"div",21),l(1,Tt,2,1,"ng-container",10),_()),n&2){let t=a(2);o("@compactBar",void 0)("ngClass",t.compactBarClass+t.gridClass),s(),o("ngForOf",t.items)}}function Ht(n,e){if(n&1&&(d(0,"div"),l(1,Bt,2,3,"div",20),_()),n&2){let t=a();s(),o("ngIf",t.isVisible)}}var Ot=x("modalOverlay",[m(":enter",[r({opacity:0}),c("200ms ease-out",r({opacity:1}))]),m(":leave",[c("150ms ease-in",r({opacity:0}))])]),Nt=x("modalContent",[m(":enter",[r({transform:"translateY(100%)"}),c("200ms ease-out",r({transform:"translateY(0)"}))]),m(":leave",[c("150ms ease-in",r({transform:"translateY(100%)"}))])]),Vt=x("listAnimation",[m(":enter",[h(".action-item, .menu-divider",[r({opacity:0,transform:"translateY(-15px)"})],{optional:!0}),h(".action-item, .menu-divider",b("30ms",[c("180ms ease-out",r({opacity:1,transform:"translateY(0)"}))]),{optional:!0})]),m("void => from-bottom",[h(".action-item, .menu-divider",[r({opacity:0,transform:"translateY(15px)"})],{optional:!0}),h(".action-item, .menu-divider",b("30ms",[c("180ms ease-out",r({opacity:1,transform:"translateY(0)"}))]),{optional:!0})]),m("open => void",[h(".action-item, .menu-divider",b("-30ms",[c("150ms ease-in",r({opacity:0,transform:"translateY(-15px)"}))]),{optional:!0})]),m("from-bottom => void",[h(".action-item, .menu-divider",b("-30ms",[c("150ms ease-in",r({opacity:0,transform:"translateY(15px)"}))]),{optional:!0})])]),Lt=x("compactBar",[m(":enter",[r({opacity:0}),c("200ms ease-out",r({opacity:1}))]),m(":leave",[c("150ms ease-in",r({opacity:0}))])]),pt=class n{sanitizer=u(st);elRef=u(j);platformId=u(W);cdr=u(X);injector=u(z);iconRegistry=u(rt);alertService=u(dt);menuState=M("closed");animationState=M("default");items=[];displayMode="dropdown";modalTitle="Actions";_isVisible=!1;set isVisible(e){e!==this._isVisible&&(this._isVisible=e,e?(this.displayMode==="modal"?setTimeout(()=>this.presentAsAlert(),0):this.displayMode==="dropdown"&&P(this.injector,()=>{G(()=>{this.calculateDropdownPosition(),this.cdr.detectChanges()})}),document.addEventListener("keydown",this._boundOnEnterKey)):document.removeEventListener("keydown",this._boundOnEnterKey))}get isVisible(){return this._isVisible}alignmentClass=M("origin-top-right right-0");defaultDropdownButtonClass="flex items-center w-full rounded-md px-3 py-2 text-sm font-medium text-black dark:text-white hover:text-white";compactBarClass="flex gap-2 grid grid-cols-2 justify-center items-center z-20 rounded-b-lg p-2";defaultCompactButtonClass="flex items-center w-full rounded-md px-3 py-2 text-sm font-medium text-black dark:text-white hover:text-white";gridClass="";customButtonDivCssClass="grid grid-cols-2";itemClick=new T;closeMenu=new T;_boundOnEnterKey=this.handleEnterKey.bind(this);ngOnChanges(e){if(e.isVisible){let t=e.isVisible.currentValue;t&&this.displayMode==="modal"&&setTimeout(()=>this.presentAsAlert(),0),t&&this.displayMode!=="modal"?document.addEventListener("keydown",this._boundOnEnterKey):document.removeEventListener("keydown",this._boundOnEnterKey)}}calculateDropdownPosition(){if(!at(this.platformId))return;let e=this.elRef.nativeElement.querySelector(".dropdown-panel"),t=this.elRef.nativeElement.parentElement;if(!e||!t)return;let i=t.getBoundingClientRect(),v=e.offsetWidth,p=e.offsetHeight,y=window.innerWidth,$t=window.innerHeight,ut=getComputedStyle(document.documentElement),V=parseInt(ut.getPropertyValue("--main-nav-height"),10)||0,_t=i.left+v<=y,gt=i.right-v>=0,w="";if(gt)w="right-0 origin-top-right";else if(_t)w="left-0 origin-top-left";else{let S=y-i.left,K=i.right;w=S>=K?"left-0 origin-top-left":"right-0 origin-top-right"}let A="top-full mt-2";this.animationState.set("default");let L=8,ft=window.innerHeight-i.bottom-V,$=p+L<=ft,R=i.top-p-L>=0;if(!$&&R)A="bottom-full mb-2",this.animationState.set("from-bottom");else if(!$&&!R){let S=window.innerHeight-i.bottom-V;i.top>S&&(A="bottom-full mb-2",this.animationState.set("from-bottom"))}this.alignmentClass.set(`${w} ${A}`)}ngOnDestroy(){document.removeEventListener("keydown",this._boundOnEnterKey)}presentAsAlert(){return F(this,null,function*(){let e=this.items.filter(i=>!i.isDivider).map(i=>({text:i.label||"",role:i.actionKey||"",icon:i.iconName,iconClass:i.iconClass,cssClass:`${i.buttonClass||""}`,overrideCssClass:i.overrideCssButtonClass?i.overrideCssButtonClass:"",data:i.data})),t=yield this.alertService.present({header:this.modalTitle,buttons:e,backdropDismiss:!0,customButtonDivCssClass:this.customButtonDivCssClass?this.customButtonDivCssClass:"grid grid-cols-2"});t&&t.role!=="backdrop"&&t.role!=="cancel"&&this.itemClick.emit({actionKey:t.role,data:t.data}),this.closeMenu.emit()})}onDocumentClick(e){this.displayMode==="dropdown"&&this.isVisible&&!this.elRef.nativeElement.contains(e.target)&&this.closeMenu.emit()}handleEnterKey(e){if(e.key==="Enter"){e.preventDefault();let t=this.items.find(i=>!i.isDivider);t&&this.onItemClicked({stopPropagation:()=>{}},t)}}onItemClicked(e,t){e.stopPropagation(),t.isDivider||(navigator.vibrate&&navigator.vibrate(50),this.itemClick.emit({actionKey:t.actionKey??"",data:t.data}),this.displayMode==="dropdown"&&this.closeMenu.emit())}getIconHtml(e){let t=null;return typeof e.iconName=="string"?t=this.iconRegistry.getIconString(e.iconName):e.iconSvg&&(t=e.iconSvg),t?this.sanitizer.bypassSecurityTrustHtml(t):null}showLabelInCompact(e){return!!e.label}isComplexIcon(e){return typeof e.iconName=="object"&&e.iconName!==null}getIconNameForComponent(e){return e.iconName}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-action-menu"]],hostBindings:function(t,i){t&1&&I("click",function(p){return i.onDocumentClick(p)},q)},inputs:{items:"items",displayMode:"displayMode",modalTitle:"modalTitle",isVisible:"isVisible",compactBarClass:"compactBarClass",gridClass:"gridClass",customButtonDivCssClass:"customButtonDivCssClass"},outputs:{itemClick:"itemClick",closeMenu:"closeMenu"},features:[Y],decls:8,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"hidden","dark:hover:text-gray-100"],[1,"hidden","scale-120"],[1,"hidden","scale-125"],[1,"hidden","scale-110"],["class","dropdown-panel absolute mt-2 w-max max-w-[90vw] rounded-lg shadow-lg bg-gray-100 dark:bg-gray-800 ring-1 ring-black ring-opacity-5 z-[60] border border-gray-300 dark:border-gray-600 flex flex-col max-h-[80vh] overflow-hidden",3,"ngClass",4,"ngIf"],[1,"dropdown-panel","absolute","mt-2","w-max","max-w-[90vw]","rounded-lg","shadow-lg","bg-gray-100","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","z-[60]","border","border-gray-300","dark:border-gray-600","flex","flex-col","max-h-[80vh]","overflow-hidden",3,"ngClass"],[1,"overflow-y-auto","p-2","custom-scrollbar"],[1,"grid","gap-2",3,"ngClass"],[4,"ngFor","ngForOf"],["class","menu-divider w-full h-px my-1 bg-gray-200 dark:bg-gray-600 col-span-full",4,"ngIf"],["type","button","class","action-item transition-colors duration-150 ease-in-out",3,"ngClass","click",4,"ngIf"],[1,"menu-divider","w-full","h-px","my-1","bg-gray-200","dark:bg-gray-600","col-span-full"],["type","button",1,"action-item","transition-colors","duration-150","ease-in-out",3,"click","ngClass"],[4,"ngIf"],[1,"whitespace-normal","text-left","flex-grow"],[1,"flex-shrink-0",3,"name"],[3,"innerHTML","ngClass",4,"ngIf"],[3,"innerHTML","ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["type","button","class","transition-colors duration-150 ease-in-out",3,"title","ngClass","click",4,"ngIf"],["type","button",1,"transition-colors","duration-150","ease-in-out",3,"click","title","ngClass"],["class","truncate ml-2",4,"ngIf"],[3,"name"],[1,"truncate","ml-2"]],template:function(t,i){t&1&&(f(0,0),l(1,Mt,2,1,"div",1)(2,It,1,0,"div",1)(3,Ht,2,1,"div",1),C(),g(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)),t&2&&(o("ngSwitch",i.displayMode),s(),o("ngSwitchCase","dropdown"),s(),o("ngSwitchCase","modal"),s(),o("ngSwitchCase","compact"))},dependencies:[ot,Z,tt,et,nt,it,lt,mt,ct],encapsulation:2,data:{animation:[Lt,Ot,Nt,Vt]},changeDetection:0})};export{pt as a};

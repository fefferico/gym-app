import{e as K,f as tt,g as rt,h as it,i as nt}from"./chunk-L7IV3OYY.js";import{a as q}from"./chunk-4WBBE4K3.js";import{a as et}from"./chunk-Z6O4RZT6.js";import{a as Qe}from"./chunk-B5HIVGFK.js";import{a as Xe}from"./chunk-OSQVHM7R.js";import"./chunk-4PTIEP3X.js";import{c as Ue,l as U,o as Ke,p as Ye,q as O,s as Ze,t as Je}from"./chunk-JISLHD6Q.js";import{$ as D,Ac as Ne,B as G,Bc as Be,Cc as Oe,Dc as Le,Eb as ge,Fc as We,Ga as d,H as re,Ha as a,Ia as n,Ic as Ge,J as ie,Ja as u,Jb as pe,Jc as Re,Kb as ye,Kc as He,Lb as _e,Lc as $e,Na as X,Nc as je,Oa as ee,Oc as ze,Q as T,Qa as b,Qc as qe,Ra as v,Rb as ve,Sa as c,Tb as fe,U as y,V as _,W as F,Wb as he,X as ne,Xb as xe,Za as se,_a as me,bb as m,cb as P,cc as be,db as E,eb as $,ec as ke,ga as oe,gc as we,hc as Ce,ia as ae,k as Q,kc as L,ma as l,mb as j,mc as Se,nb as z,nc as A,o as H,ob as ce,oc as Pe,pc as Te,rb as C,sb as B,sc as De,tb as M,tc as Ee,ua as le,uc as Ie,vb as ue,vc as Fe,xa as de,xc as Me,yb as V,yc as Ve,za as g,zc as Ae}from"./chunk-OVAULOJF.js";import{a as Z,b as J,g as N}from"./chunk-GAL4ENT6.js";var Y=class r{transform(t,e=!1){if(t==null)return"";let i=Number(t);return e?`Day ${i}`:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][i]||`Day ${i}`}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=de({name:"dayOfWeek",type:r,pure:!0})};var dt=(r,t)=>({"border-red-500 dark:border-red-400":r,"border-gray-300 dark:border-gray-500":t}),st=(r,t)=>({"bg-primary text-white focus:ring-primary-dark":r,"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 focus:ring-gray-400":t}),at=r=>({"mt-5":r}),mt=r=>({"ring-2 ring-offset-1 ring-red-500 dark:ring-red-400":r}),ct=(r,t)=>({"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 placeholder-red-400":r,"rounded-r-md":t}),ut=(r,t,e)=>({"border-blue-300 dark:border-blue-500 bg-blue-50 dark:bg-blue-500 text-white hover:bg-blue-100 dark:hover:bg-blue-400":r,"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-700 text-green-700 dark:text-green-100 hover:bg-green-100 dark:hover:bg-green-600":t,"border-red-500 dark:border-red-400 bg-red-100 dark:bg-red-600 text-red-700 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-500":e});function gt(r,t){if(r&1){let e=b();a(0,"app-action-menu",28),v("itemClick",function(o){y(e);let s=c(2);return _(s.handleActionMenuItemClick(o))})("closeMenu",function(){y(e);let o=c(2);return _(o.onCloseActionMenu())}),n()}if(r&2){let e=c().ngIf,i=c();d("items",i.getProgramDropdownActionItems(e.id,"dropdown"))("isVisible",i.areActionsVisible(e.id))}}function pt(r,t){if(r&1){let e=b();a(0,"div",23)(1,"div",24)(2,"button",25),v("click",function(o){let s=y(e).ngIf,p=c();return _(p.toggleActions(s.id,o))}),u(3,"app-icon",26),n(),g(4,gt,1,2,"app-action-menu",27),n()()}if(r&2){let e=t.ngIf,i=c();l(4),d("ngIf",i.areActionsVisible(e.id))}}function yt(r,t){if(r&1&&(a(0,"div")(1,"label",29),m(2),n()()),r&2){let e,i=c();l(2),P((e=i.programForm.get("name"))==null?null:e.value)}}function _t(r,t){r&1&&(a(0,"div")(1,"div",30),F(),a(2,"svg",31),u(3,"path",32),n(),ne(),a(4,"span",33),m(5,"Active"),n()()())}function vt(r,t){if(r&1&&(a(0,"div",36)(1,"div",37)(2,"h3",38),m(3),n(),a(4,"span",39),m(5),n()(),a(6,"div",40),u(7,"div",41),n()()),r&2){let e=t.ngIf,i=c(2);l(3),E(" ",(i.currentProgram==null?null:i.currentProgram.programType)==="linear"?"Overall Workout Progress":"Current Cycle Progress"," "),l(2),$(" ",e.completedCount," / ",e.totalCount," "),l(2),me("width",e.percentage,"%")}}function ft(r,t){if(r&1&&(a(0,"div",34),g(1,vt,8,5,"div",35),n()),r&2){let e=c();l(),d("ngIf",e.programProgress())}}function ht(r,t){if(r&1&&u(0,"div",45),r&2){let e=t.$implicit;d("ngClass",e.isCompleted?"bg-primary":"bg-gray-200 dark:bg-gray-700")("title",e.name+(e.isCompleted?" - Completed":" - Incomplete"))}}function xt(r,t){if(r&1&&(a(0,"div",36)(1,"h3",38),m(2,"Overall Progress (Weeks Completed) "),n(),a(3,"div",43),g(4,ht,1,2,"div",44),n()()),r&2){let e=t.ngIf;l(4),d("ngForOf",e)}}function bt(r,t){if(r&1&&u(0,"div",48),r&2){let e=t.$implicit;d("ngClass",e.isCompleted?"bg-green-500":"bg-gray-200 dark:bg-gray-700")}}function kt(r,t){if(r&1&&(a(0,"div",36)(1,"div",37)(2,"h3",38),m(3," Current Week Progress "),a(4,"span",46),m(5),n()(),a(6,"span",39),m(7),n()(),a(8,"div",43),g(9,bt,1,1,"div",47),n()()),r&2){let e=t.ngIf;l(5),E("(",e.weekName,")"),l(2),$(" ",e.completedCount," / ",e.totalCount," Workouts "),l(2),d("ngForOf",e.segments)}}function wt(r,t){if(r&1&&(a(0,"div",42),g(1,xt,5,1,"div",35)(2,kt,10,4,"div",35),n()),r&2){let e=c();l(),d("ngIf",e.overallWeekProgress()),l(),d("ngIf",e.currentWeekProgress())}}function Ct(r,t){r&1&&(a(0,"span"),m(1,"Program name is required"),n())}function St(r,t){if(r&1&&(a(0,"div",52),g(1,Ct,2,0,"span",11),n()),r&2){let e,i=c(2);l(),d("ngIf",(e=i.programForm.get("name"))==null||e.errors==null?null:e.errors.required)}}function Pt(r,t){if(r&1&&(a(0,"div")(1,"label",49),m(2,"Program Name"),n(),u(3,"input",50),g(4,St,2,1,"div",51),n()),r&2){let e,i,o=c();l(3),d("ngClass",z(2,dt,((e=o.programForm.get("name"))==null?null:e.invalid)&&((e=o.programForm.get("name"))==null?null:e.touched),!((e=o.programForm.get("name"))!=null&&e.invalid&&((e=o.programForm.get("name"))!=null&&e.touched)))),l(),d("ngIf",((i=o.programForm.get("name"))==null?null:i.invalid)&&(((i=o.programForm.get("name"))==null?null:i.dirty)||((i=o.programForm.get("name"))==null?null:i.touched)))}}function Tt(r,t){if(r&1&&(a(0,"div"),u(1,"p",53),n()),r&2){let e=c();l(),d("innerHTML",e.sanitizedDescription,ae)}}function Dt(r,t){r&1&&(a(0,"div")(1,"label",54),m(2,"Description (Optional)"),n(),u(3,"textarea",55),n())}function Et(r,t){if(r&1){let e=b();a(0,"button",60),v("click",function(){let o=y(e).$implicit,s=c(2);return _(s.toggleGoal(o))}),m(1),C(2,"titlecase"),n()}if(r&2){let e=t.$implicit,i=c(2);d("disabled",i.isViewMode)("ngClass",z(5,st,e&&e.value!==void 0&&i.selectedGoals().includes(e.value),e&&e.value!==void 0&&!i.selectedGoals().includes(e.value))),l(),E(" ",B(2,3,e.label)," ")}}function It(r,t){if(r&1&&(a(0,"div",56)(1,"label",57),m(2,"Goals"),n(),a(3,"div",58),g(4,Et,3,8,"button",59),n()()),r&2){let e=c();l(4),d("ngForOf",e.programGoals)}}function Ft(r,t){r&1&&(a(0,"div")(1,"label",61),m(2,"Start Date"),n(),u(3,"input",62),n())}function Mt(r,t){r&1&&(a(0,"div",63)(1,"label",64),m(2,"Program Structure"),n(),a(3,"div",65)(4,"label",66),u(5,"input",67),a(6,"span",68),m(7,"Repeating Cycle"),n()(),a(8,"label",66),u(9,"input",69),a(10,"span",68),m(11,"Week-by-Week Progression"),n()()()())}function Vt(r,t){if(r&1&&(a(0,"div")(1,"label",70),m(2," Cycle Length (Days) "),a(3,"span",71),u(4,"app-icon",72),n()(),u(5,"input",73),a(6,"p",74),m(7," Total days in the cycle, including rest. Leave blank for a standard week. "),n()()),r&2){let e=c();l(4),d("appTooltip",e.infoTooltipString)}}function At(r,t){r&1&&(a(0,"div")(1,"label",75),m(2,"General Program Notes (Optional)"),n(),u(3,"textarea",76),n())}function Nt(r,t){if(r&1){let e=b();a(0,"button",82),v("shortPress",function(){y(e);let o=c(2);return _(o.addScheduledDay())}),u(1,"app-icon",83),a(2,"span",71),m(3,"ADD DAY TO SCHEDULE"),n()()}}function Bt(r,t){r&1&&(a(0,"div",99),F(),a(1,"svg",100),u(2,"path",101),n()())}function Ot(r,t){if(r&1){let e=b();a(0,"button",102),v("shortPress",function(){y(e);let o=c().index,s=c(3);return _(s.removeScheduledDay(o))}),F(),a(1,"svg",103),u(2,"path",104),n(),m(3," REMOVE DAY "),n()}}function Lt(r,t){if(r&1&&(a(0,"option",105),m(1),n()),r&2){let e=t.$implicit;d("value",e.value),l(),P(e.label)}}function Wt(r,t){r&1&&(a(0,"div",52),m(1," Day is required. "),n())}function Gt(r,t){if(r&1){let e=b();a(0,"button",106),v("shortPress",function(){y(e);let o=c().index,s=c(3);return _(s.openRoutineSelectionModal(o))}),u(1,"app-icon",107),a(2,"span",71),m(3),n()()}if(r&2){let e,i,o=c().index,s=c(3);d("ngClass",ce(2,ut,!((e=s.getScheduleDayControl(o).get("routineId"))!=null&&e.value)&&!((e=s.getScheduleDayControl(o).get("routineId"))!=null&&e.invalid&&((e=s.getScheduleDayControl(o).get("routineId"))!=null&&e.touched||s.submitted)),(e=s.getScheduleDayControl(o).get("routineId"))==null?null:e.value,((e=s.getScheduleDayControl(o).get("routineId"))==null?null:e.invalid)&&(((e=s.getScheduleDayControl(o).get("routineId"))==null?null:e.touched)||s.submitted))),l(3),E(" ",(i=s.getScheduleDayControl(o).get("routineId"))!=null&&i.value?"CHANGE":"SELECT"," ")}}function Rt(r,t){r&1&&(a(0,"div",52),m(1," Routine selection is required. "),n())}function Ht(r,t){if(r&1&&(a(0,"div",108)(1,"label",92),m(2,"Time (Optional)"),n(),u(3,"input",109),n()),r&2){let e=c().index;l(),d("for","timeOfDay-"+e),l(2),d("id","timeOfDay-"+e)}}function $t(r,t){if(r&1&&(a(0,"div",108)(1,"label",92),m(2,"Notes for this Day (Optional)"),n(),u(3,"textarea",110),n()),r&2){let e=c().index;l(),d("for","dayNotes-"+e),l(2),d("id","dayNotes-"+e)}}function jt(r,t){if(r&1&&(a(0,"div",86),g(1,Bt,3,0,"div",87),a(2,"div",88)(3,"h4",89),m(4),C(5,"dayOfWeek"),n(),g(6,Ot,4,0,"button",90),n(),a(7,"div",91)(8,"div")(9,"label",92),m(10),n(),a(11,"select",93),g(12,Lt,2,2,"option",94),n(),g(13,Wt,2,0,"div",51),n(),a(14,"div")(15,"label",92),m(16,"Routine"),n(),a(17,"div",95),u(18,"input",96),g(19,Gt,4,6,"button",97),n(),g(20,Rt,2,0,"div",51),n(),g(21,Ht,4,2,"div",98)(22,$t,4,2,"div",98),n()()),r&2){let e,i,o,s,p,f,k,w,x=t.index,h=c(3);d("formGroupName",x)("cdkDragDisabled",h.isViewMode),l(),d("ngIf",!h.isViewMode),l(),d("ngClass",j(23,at,h.isEditableMode())),l(2),E(" ",M(5,20,(e=h.getScheduleDayControl(x).get("dayOfWeek"))==null?null:e.value,h.f.cycleLength.value>0)||"Scheduled Day "+(x+1)," "),l(2),d("ngIf",!h.isViewMode),l(3),d("for","dayOfWeek-"+x),l(),E(" ",h.f.cycleLength.value>0?"Cycle Day Number":"Day of Week"," "),l(),d("id","dayOfWeek-"+x),l(),d("ngForOf",h.currentDayOptions()),l(),d("ngIf",((i=h.getScheduleDayControl(x).get("dayOfWeek"))==null?null:i.invalid)&&((i=h.getScheduleDayControl(x).get("dayOfWeek"))==null?null:i.touched)),l(2),d("for","routineName-"+x),l(2),d("ngClass",j(25,mt,((o=h.getScheduleDayControl(x).get("routineId"))==null?null:o.invalid)&&(((o=h.getScheduleDayControl(x).get("routineId"))==null?null:o.touched)||h.submitted))),l(),d("id","routineName-"+x)("value",((s=h.getScheduleDayControl(x).get("routineName"))==null?null:s.value)||((s=h.getScheduleDayControl(x).get("routineId"))!=null&&s.value?"Loading routine...":"No Routine Selected"))("ngClass",z(27,ct,((p=h.getScheduleDayControl(x).get("routineId"))==null?null:p.invalid)&&(((p=h.getScheduleDayControl(x).get("routineId"))==null?null:p.touched)||h.submitted),h.isViewMode)),l(),d("ngIf",!h.isViewMode),l(),d("ngIf",((f=h.getScheduleDayControl(x).get("routineId"))==null?null:f.invalid)&&(((f=h.getScheduleDayControl(x).get("routineId"))==null?null:f.touched)||h.submitted)),l(),d("ngIf",((k=h.programForm.get("timeOfDay"))==null?null:k.value)||h.isEditableMode()),l(),d("ngIf",((w=h.programForm.get("notes"))==null?null:w.value)||h.isEditableMode())}}function zt(r,t){if(r&1){let e=b();a(0,"div",84),v("cdkDropListDropped",function(o){y(e);let s=c(2);return _(s.onScheduleDrop(o))}),g(1,jt,23,30,"div",85),n()}if(r&2){let e=c(2);d("cdkDropListData",e.scheduleFormGroups),l(),d("ngForOf",e.scheduleFormArray.controls)}}function qt(r,t){if(r&1){let e=b();a(0,"button",113),v("click",function(){y(e);let o=c(3);return _(o.addScheduledDay())}),m(1," Add the first scheduled day "),n()}}function Ut(r,t){if(r&1&&(a(0,"div",111)(1,"p"),m(2,"No days scheduled for this program yet"),n(),g(3,qt,2,0,"button",112),n()),r&2){let e=c(2);l(3),d("ngIf",!e.isViewMode)}}function Kt(r,t){if(r&1&&(a(0,"section")(1,"div",77)(2,"h2",78),m(3,"Schedule"),n(),g(4,Nt,4,0,"button",79),n(),g(5,zt,2,2,"div",80)(6,Ut,4,1,"div",81),n()),r&2){let e=c();l(4),d("ngIf",!e.isViewMode),l(),d("ngIf",e.scheduleFormArray.length>0),l(),d("ngIf",e.scheduleFormArray.length===0)}}function Yt(r,t){if(r&1){let e=b();a(0,"button",117),v("shortPress",function(){y(e);let o=c(2);return _(o.addWeek())}),u(1,"app-icon",83),a(2,"span",71),m(3,"ADD WEEK"),n()()}}function Zt(r,t){r&1&&(a(0,"div",127),F(),a(1,"svg",128),u(2,"path",129),n()())}function Jt(r,t){if(r&1){let e=b();a(0,"button",102),v("shortPress",function(){y(e);let o=c().index,s=c(2);return _(s.removeWeek(o))}),F(),a(1,"svg",103),u(2,"path",104),n(),m(3," REMOVE WEEK "),n()}}function Qt(r,t){r&1&&(a(0,"div",137),F(),a(1,"svg",100),u(2,"path",101),n()())}function Xt(r,t){if(r&1){let e=b();a(0,"button",102),v("shortPress",function(){y(e);let o=c().index,s=c().index,p=c(2);return _(p.removeScheduledDay(o,s))}),F(),a(1,"svg",103),u(2,"path",104),n(),m(3," REMOVE DAY "),n()}}function er(r,t){if(r&1&&(a(0,"option",105),m(1),n()),r&2){let e=t.$implicit;d("value",e.value),l(),P(e.label)}}function tr(r,t){if(r&1){let e=b();a(0,"button",138),v("shortPress",function(){y(e);let o=c().index,s=c().index,p=c(2);return _(p.openRoutineSelectionModal(s,o))}),m(1," SELECT "),n()}}function rr(r,t){if(r&1&&(a(0,"div",130),g(1,Qt,3,0,"div",131),a(2,"div",88)(3,"h4",89),m(4),C(5,"dayOfWeek"),n(),g(6,Xt,4,0,"button",90),n(),a(7,"div",91)(8,"div")(9,"label",92),m(10,"Day of Week"),n(),a(11,"select",132),g(12,er,2,2,"option",94),n()(),a(13,"div")(14,"label",92),m(15,"Routine"),n(),a(16,"div",133),u(17,"input",134),g(18,tr,2,0,"button",135),n()(),a(19,"div",108)(20,"label",92),m(21,"Notes (Optional)"),n(),u(22,"textarea",136),n()()()),r&2){let e,i,o=t.index,s=c().index,p=c(2);d("formGroupName",o)("cdkDragDisabled",p.isViewMode),l(),d("ngIf",!p.isViewMode),l(),d("ngClass",j(18,at,p.isEditableMode())),l(2),E(" ",M(5,15,(e=p.getWeekScheduleDayControl(s,o).get("dayOfWeek"))==null?null:e.value,!1)||"Scheduled Day "+(o+1)," "),l(2),d("ngIf",!p.isViewMode),l(3),d("for","dayOfWeek-"+s+"-"+o),l(2),d("id","dayOfWeek-"+s+"-"+o),l(),d("ngForOf",p.dayOfWeekOptions),l(2),d("for","routineName-"+s+"-"+o),l(3),d("id","routineName-"+s+"-"+o)("value",((i=p.getWeekScheduleDayControl(s,o).get("routineName"))==null?null:i.value)||"No Routine"),l(),d("ngIf",!p.isViewMode),l(2),d("for","dayNotes-"+s+"-"+o),l(2),d("id","dayNotes-"+s+"-"+o)}}function ir(r,t){if(r&1){let e=b();a(0,"button",82),v("shortPress",function(){y(e);let o=c(2).index,s=c(2);return _(s.addScheduledDay(o))}),u(1,"app-icon",83),a(2,"span",71),m(3,"ADD DAY TO WEEK"),n()()}}function nr(r,t){if(r&1&&(a(0,"div",139),g(1,ir,4,0,"button",79),n()),r&2){let e=c(3);l(),d("ngIf",!e.isViewMode)}}function or(r,t){r&1&&(a(0,"div",140),m(1,"This week is empty."),n())}function ar(r,t){if(r&1){let e=b();a(0,"div",118)(1,"div",119),g(2,Zt,3,0,"div",120),a(3,"div",121)(4,"label",122),m(5,"Week Name"),n(),u(6,"input",123),n(),g(7,Jt,4,0,"button",90),n(),a(8,"div",84),v("cdkDropListDropped",function(o){let s=y(e).index,p=c(2);return _(p.onDayDropInWeek(o,s))}),g(9,rr,23,20,"div",124),n(),g(10,nr,2,1,"div",125)(11,or,2,0,"div",126),n()}if(r&2){let e=t.index,i=c(2);d("formGroupName",e)("cdkDragDisabled",i.isViewMode),l(2),d("ngIf",!i.isViewMode),l(2),d("for","weekName-"+e),l(2),d("id","weekName-"+e),l(),d("ngIf",!i.isViewMode),l(),d("cdkDropListData",i.getWeekScheduleGroups(e)),l(),d("ngForOf",i.getWeekScheduleGroups(e)),l(),d("ngIf",i.getWeekScheduleGroups(e).length<7),l(),d("ngIf",i.getWeekScheduleGroups(e).length===0)}}function lr(r,t){if(r&1){let e=b();a(0,"button",113),v("click",function(){y(e);let o=c(3);return _(o.addWeek())}),m(1," Add the first week "),n()}}function dr(r,t){if(r&1&&(a(0,"div",111)(1,"p"),m(2,"No weeks created for this program yet."),n(),g(3,lr,2,0,"button",112),n()),r&2){let e=c(2);l(3),d("ngIf",!e.isViewMode)}}function sr(r,t){if(r&1){let e=b();a(0,"section")(1,"div",77)(2,"h2",78),m(3,"Weekly Schedule"),n(),g(4,Yt,4,0,"button",114),n(),a(5,"div",115),v("cdkDropListDropped",function(o){y(e);let s=c();return _(s.onWeekDrop(o))}),g(6,ar,12,10,"div",116),n(),g(7,dr,4,1,"div",81),n()}if(r&2){let e=c();l(4),d("ngIf",!e.isViewMode),l(2),d("ngForOf",e.weeksFormArray.controls),l(),d("ngIf",e.weeksFormArray.length===0)}}function mr(r,t){r&1&&u(0,"app-icon",147)}function cr(r,t){r&1&&u(0,"app-icon",148)}function ur(r,t){if(r&1){let e=b();a(0,"div",141)(1,"button",142),v("shortPress",function(){y(e);let o=c();return _(o.navigateToPrograms())}),u(2,"app-icon",143),m(3," CANCEL "),n(),a(4,"button",144),v("shortPress",function(){y(e);let o=c();return _(o.onSubmit())}),g(5,mr,1,0,"app-icon",145)(6,cr,1,0,"app-icon",146),a(7,"span",71),m(8),n()()()}if(r&2){let e=c();l(4),d("disabled",e.programForm.invalid),l(),d("ngIf",e.isNewMode),l(),d("ngIf",!e.isNewMode),l(2),E(" ",e.isNewMode?"CREATE PROGRAM":"SAVE CHANGES"," ")}}function gr(r,t){if(r&1){let e=b();a(0,"li",165),v("click",function(){let o=y(e).$implicit,s=c(2);return _(s.selectRoutineForDay(o))}),a(1,"div",166)(2,"span",167),m(3),n(),a(4,"span",168),m(5),C(6,"titlecase"),n()(),F(),a(7,"svg",169),u(8,"path",170),n()()}if(r&2){let e=t.$implicit;l(3),P(e.name),l(2),$("",B(6,3,e.goal)," - ",e.exercises.length," exercises")}}function pr(r,t){r&1&&(a(0,"li",171),m(1,"No routines match your search"),n())}function yr(r,t){r&1&&(a(0,"li",171),m(1,"No routines available to select. Create some routines first!"),n())}function _r(r,t){if(r&1){let e=b();a(0,"div",149),v("click",function(){y(e);let o=c();return _(o.closeRoutineSelectionModal())}),a(1,"div",150),v("click",function(o){return y(e),_(o.stopPropagation())}),a(2,"div",151)(3,"div",152)(4,"div",153)(5,"div",154)(6,"h3",155),m(7,"Select a Routine"),n(),a(8,"button",156),v("click",function(){y(e);let o=c();return _(o.closeRoutineSelectionModal())}),u(9,"app-icon",157),n()(),a(10,"div",158)(11,"input",159),v("ngModelChange",function(o){y(e);let s=c();return _(s.modalSearchTerm.set(o))}),n()(),a(12,"div",160)(13,"ul",36),g(14,gr,9,5,"li",161)(15,pr,2,0,"li",162)(16,yr,2,0,"li",162),n()()()()(),a(17,"div",163)(18,"button",164),v("click",function(){y(e);let o=c();return _(o.closeRoutineSelectionModal())}),m(19," Cancel "),n()()()()}if(r&2){let e=c();l(11),d("ngModel",e.modalSearchTerm()),l(3),d("ngForOf",e.filteredAvailableRoutines()),l(),d("ngIf",e.filteredAvailableRoutines().length===0&&e.availableRoutines.length>0),l(),d("ngIf",e.availableRoutines.length===0)}}function vr(r,t){if(r&1){let e=b();X(0),a(1,"td",190),m(2),C(3,"date"),n(),a(4,"td",190),m(5),C(6,"date"),n(),a(7,"td",190),m(8),C(9,"titlecase"),n(),a(10,"td",190),m(11),C(12,"date"),n(),a(13,"td",191)(14,"div",192)(15,"button",193),v("click",function(){y(e);let o=c().$implicit,s=c(3);return _(s.editHistoryEntry(o))}),u(16,"app-icon",194),n(),a(17,"button",195),v("click",function(){y(e);let o=c().$implicit,s=c(3);return _(s.removeProgramHistoryEntry(o.id))}),u(18,"app-icon",196),n()()(),ee()}if(r&2){let e=c().$implicit;l(2),P(e.startDate&&e.startDate!=="-"?M(3,4,e.startDate,"dd/MM/yy"):"-"),l(3),P(e.endDate&&e.endDate!=="-"?M(6,7,e.endDate,"dd/MM/yy"):"-"),l(3),P(B(9,10,e.status)),l(3),P(e.date&&e.date!=="-"?M(12,12,e.date,"dd/MM/yy HH:mm"):"-")}}function fr(r,t){if(r&1&&(a(0,"option",105),m(1),C(2,"titlecase"),n()),r&2){let e=t.$implicit;d("value",e),l(),P(B(2,2,e))}}function hr(r,t){if(r&1){let e=b();X(0),a(1,"td",197),u(2,"input",198),n(),a(3,"td",197),u(4,"input",199),n(),a(5,"td",197)(6,"select",200),v("change",function(){let o;y(e);let s=c(4);return _(((o=s.historyEditForm.get("status"))==null?null:o.value)==="active"?s.forceEndDateToNull():s.enableEndDate())}),g(7,fr,3,4,"option",94),n()(),a(8,"td",201),m(9,"Editing... "),n(),a(10,"td",202)(11,"div",203)(12,"button",204),u(13,"app-icon",205),n(),a(14,"button",206),v("click",function(){y(e);let o=c(4);return _(o.cancelEditHistoryEntry())}),u(15,"app-icon",207),n()()(),ee()}if(r&2){let e=c(4);l(7),d("ngForOf",e.statusOptions),l(5),d("disabled",e.historyEditForm.invalid)}}function xr(r,t){if(r&1&&(a(0,"tr"),g(1,vr,19,15,"ng-container",11)(2,hr,16,2,"ng-container",11),n()),r&2){let e=t.$implicit,i=c(3);l(),d("ngIf",i.editingHistoryEntryId()!==e.id),l(),d("ngIf",i.editingHistoryEntryId()===e.id)}}function br(r,t){if(r&1){let e=b();a(0,"div")(1,"div",210)(2,"div",211),m(3,"Status"),n(),a(4,"div",212),m(5),C(6,"titlecase"),n(),a(7,"div",211),m(8,"Start Date "),n(),a(9,"div",213),m(10),C(11,"date"),n(),a(12,"div",211),m(13,"End Date"),n(),a(14,"div",213),m(15),C(16,"date"),n(),a(17,"div",211),m(18,"Logged"),n(),a(19,"div",214),m(20),C(21,"date"),n()(),a(22,"div",215)(23,"button",216),v("click",function(){y(e);let o=c().$implicit,s=c(3);return _(s.editHistoryEntry(o))}),u(24,"app-icon",217),m(25," EDIT "),n(),a(26,"button",218),v("click",function(){y(e);let o=c().$implicit,s=c(3);return _(s.removeProgramHistoryEntry(o.id))}),u(27,"app-icon",219),m(28," DELETE "),n()()()}if(r&2){let e=c().$implicit;l(5),E("",B(6,4,e.status)," "),l(5),P(e.startDate&&e.startDate!=="-"?M(11,6,e.startDate,"MMM d, yyyy"):"-"),l(5),P(e.endDate&&e.endDate!=="-"?M(16,9,e.endDate,"MMM d, yyyy"):"-"),l(5),P(e.date&&e.date!=="-"?M(21,12,e.date,"MMM d, yyyy HH:mm"):"-")}}function kr(r,t){if(r&1&&(a(0,"option",105),m(1),C(2,"titlecase"),n()),r&2){let e=t.$implicit;d("value",e),l(),P(B(2,2,e))}}function wr(r,t){if(r&1){let e=b();a(0,"div",220)(1,"div")(2,"label",221),m(3,"Status"),n(),a(4,"select",222),v("change",function(){let o;y(e);let s=c(4);return _(((o=s.historyEditForm.get("status"))==null?null:o.value)==="active"?s.forceEndDateToNull():s.enableEndDate())}),g(5,kr,3,4,"option",94),n()(),a(6,"div")(7,"label",221),m(8,"Start Date"),n(),u(9,"input",223),n(),a(10,"div")(11,"label",221),m(12,"End Date"),n(),u(13,"input",224),n(),a(14,"div",215)(15,"button",225),v("click",function(){y(e);let o=c(4);return _(o.cancelEditHistoryEntry())}),m(16," Cancel "),n(),a(17,"button",226),u(18,"app-icon",227),m(19," Save "),n()()()}if(r&2){let e=c(4);l(5),d("ngForOf",e.statusOptions),l(12),d("disabled",e.historyEditForm.invalid)}}function Cr(r,t){if(r&1&&(a(0,"div",208),g(1,br,29,15,"div",11)(2,wr,20,2,"div",209),n()),r&2){let e=t.$implicit,i=c(3);l(),d("ngIf",i.editingHistoryEntryId()!==e.id),l(),d("ngIf",i.editingHistoryEntryId()===e.id)}}function Sr(r,t){if(r&1){let e=b();a(0,"div")(1,"form",182),v("ngSubmit",function(){y(e);let o=c(2);return _(o.saveHistoryEntry())}),a(2,"table",183)(3,"thead")(4,"tr")(5,"th",184),m(6," Start"),n(),a(7,"th",184),m(8," End"),n(),a(9,"th",184),m(10," Status"),n(),a(11,"th",184),m(12," Logged"),n(),a(13,"th",185),m(14," Actions"),n()()(),a(15,"tbody",186),g(16,xr,3,2,"tr",187),n()(),a(17,"div",188),g(18,Cr,3,2,"div",189),n()()()}if(r&2){let e=c(2);l(),d("formGroup",e.historyEditForm),l(15),d("ngForOf",e.currentProgram==null?null:e.currentProgram.history),l(2),d("ngForOf",e.currentProgram==null?null:e.currentProgram.history)}}function Pr(r,t){r&1&&(a(0,"div",228),m(1," No previous executions found for this program. "),n())}function Tr(r,t){if(r&1){let e=b();a(0,"div",172)(1,"div",173),v("click",function(o){return y(e),_(o.stopPropagation())}),a(2,"div",174)(3,"h2",175),m(4,"Program History"),n(),a(5,"button",176),v("click",function(){y(e);let o=c();return _(o.closeProgramHistoryModal())}),u(6,"app-icon",157),n()(),a(7,"div",177),g(8,Sr,19,3,"div",178)(9,Pr,2,0,"ng-template",null,0,ue),n(),a(11,"div",179)(12,"button",180),v("click",function(){y(e);let o=c();return _(o.closeProgramHistoryModal())}),u(13,"app-icon",181),m(14," CLOSE "),n()()()()}if(r&2){let e=se(10),i=c();l(8),d("ngIf",i.currentProgram==null||i.currentProgram.history==null?null:i.currentProgram.history.length)("ngIfElse",e)}}var ot=class r{fb=T(Ge);router=T(we);route=T(ke);trainingProgramService=T(Je);workoutService=T(Ue);spinnerService=T(Xe);alertService=T(ze);toastService=T(qe);cdr=T(ge);trackingService=T(Ze);programForm;submitted=!1;isEditMode=!1;isNewMode=!1;isViewMode=!1;isEditableMode=V(()=>this.isEditMode||this.isNewMode);currentProgramId=null;currentProgram=null;isCurrentProgramActive=D(!1);routeSub;sanitizer=T(be);sanitizedDescription="";infoTooltipString="The total number of days in the repeating cycle, INCLUDING rest days. Example: For an Upper/Lower split with a rest day after each workout (Upper, Rest, Lower, Rest), set Cycle Length to 4.";isRoutineModalOpen=D(!1);availableRoutines=[];modalSearchTerm=D("");targetScheduleIndexForRoutine=null;targetIndicesForRoutine=null;dayOfWeekOptions=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"},{value:0,label:"Sunday"}];cycleLengthSignal=D(null);cycleDayOptions=V(()=>{let t=this.cycleLengthSignal();return t&&t>0?Array.from({length:t},(e,i)=>({value:i+1,label:`Day ${i+1}`})):[]});currentDayOptions=V(()=>{let t=this.cycleLengthSignal();return t&&t>0?this.cycleDayOptions():this.dayOfWeekOptions});filteredAvailableRoutines=V(()=>{let t=this.modalSearchTerm().toLowerCase();return t?this.availableRoutines.filter(e=>e.name.toLowerCase().includes(t)):this.availableRoutines});selectedGoals=D([]);programGoals=[{value:"hypertrophy",label:"Hypertrophy"},{value:"strength",label:"Strength"},{value:"tabata",label:"Tabata"},{value:"muscular endurance",label:"Muscular endurance"},{value:"cardiovascular endurance",label:"Cardiovascular endurance"},{value:"fat loss / body composition",label:"Fat loss / body composition"},{value:"mobility & flexibility",label:"Mobility & flexibility"},{value:"power / explosiveness",label:"Power / explosiveness"},{value:"speed & agility",label:"Speed & agility"},{value:"balance & coordination",label:"Balance & coordination"},{value:"skill acquisition",label:"Skill acquisition"},{value:"rehabilitation / injury prevention",label:"Rehabilitation / injury prevention"},{value:"mental health / stress relief",label:"Mental health"},{value:"general health & longevity",label:"General health & longevity"},{value:"sport-specific performance",label:"Sport-specific performance"},{value:"maintenance",label:"Maintenance"},{value:"rest",label:"Rest"},{value:"custom",label:"Custom"}];historyEditForm;editingHistoryEntryId=D(null);statusOptions=["active","completed","archived","cancelled"];constructor(){this.programForm=this.fb.group({name:["",A.required],programType:["cycled",A.required],goals:[""],description:[""],programNotes:[""],startDate:[null],cycleLength:[null,[A.min(1)]],iterationId:[null],schedule:this.fb.array([]),weeks:this.fb.array([])}),this.historyEditForm=this.fb.group({id:[null],startDate:[null],endDate:[""],status:["",A.required]})}platformId=T(oe);programProgress=V(()=>{let t=this.currentProgram,e=this.allWorkoutLogs();if(!t||!t.isActive||!t.startDate)return{completedCount:0,totalCount:0,percentage:0};let i=0,o=0,s=O(t.startDate);if(t.programType==="linear"&&t.weeks?.length){o=t.weeks.reduce((w,x)=>w+x.schedule.length,0);let f=e.filter(w=>w.programId===t.id&&O(w.date)>=s&&t.iterationId===w.iterationId);i=new Set(f.map(w=>`${w.date}-${w.routineId}`)).size}else if(t.programType==="cycled"&&t.schedule.length>0){let f=t.cycleLength||7;o=t.schedule.length;let k=U(new Date,s);if(k>=0){let w=Math.floor(k/f),x=q(s,w*f),h=e.filter(S=>{let I=O(S.date);return S.programId===t.id&&I>=x});i=new Set(h.map(S=>`${S.date}-${S.routineId}`)).size}}if(o===0)return{completedCount:0,totalCount:0,percentage:0};i=Math.min(i,o);let p=Math.round(i/o*100);return{completedCount:i,totalCount:o,percentage:p}});overallWeekProgress=V(()=>{let t=this.currentProgram,e=this.allWorkoutLogs();if(t?.programType!=="linear"||!t.isActive||!t.startDate||!t.weeks?.length)return[];let i=O(t.startDate),o=new Set(e.filter(s=>s.programId===t.id&&t.iterationId===s.iterationId).map(s=>`${s.date}-${s.routineId}`));return t.weeks.map(s=>{let p=s.schedule.every(f=>{let k=(s.weekNumber-1)*7+(f.dayOfWeek-Ye(i)+7)%7,w=q(i,k),x=Ke(w,"yyyy-MM-dd");return o.has(`${x}-${f.routineId}`)});return{weekNumber:s.weekNumber,name:s.name,isCompleted:p}})});currentWeekProgress=V(()=>{let t=this.currentProgram,e=this.allWorkoutLogs();if(t?.programType!=="linear"||!t.isActive||!t.startDate||!t.weeks?.length)return null;let i=new Date,o=O(t.startDate);if(i<o)return null;let s=U(i,o),p=Math.floor(s/7),f=t.weeks[p];if(!f)return null;let k=f.schedule.length;if(k===0)return null;let w=q(o,p*7),x=e.filter(I=>{if(I.programId!==t.id)return!1;let R=O(I.date),te=U(R,w);return te>=0&&te<7&&t.iterationId===I.iterationId}),h=new Set(x.map(I=>I.routineId)),W=0,S=f.schedule.map(I=>{let R=h.has(I.routineId);return R&&W++,{isCompleted:R}});return{weekName:f.name,completedCount:W,totalCount:k,segments:S}});allWorkoutLogs=D([]);workoutLogsSubscription;ngOnInit(){xe(this.platformId)&&window.scrollTo(0,0),this.loadAvailableRoutines(),this.workoutLogsSubscription=this.trackingService.workoutLogs$.subscribe(t=>this.allWorkoutLogs.set(t)),this.routeSub=this.route.data.pipe(re(t=>{let e=t.mode;return this.currentProgramId=this.route.snapshot.paramMap.get("programId"),this.submitted=!1,this.isNewMode=e==="new",this.isViewMode=e==="view"&&!!this.currentProgramId,this.isEditMode=e==="edit"&&!!this.currentProgramId,this.isNewMode?(this.programForm.reset({cycleLength:null,schedule:[]}),this.updateFormEnabledState(),Q(null)):this.currentProgramId?this.trainingProgramService.getProgramById(this.currentProgramId):Q(null)}),ie(t=>{t?this.patchFormWithProgramData(t):!this.isNewMode&&this.currentProgramId&&(this.toastService.error(`Program with ID ${this.currentProgramId} not found.`,0,"Error"),this.router.navigate(["/training-programs"])),this.currentProgram=t,this.updateFormEnabledState();let e=t?.isActive??!1;this.isCurrentProgramActive.set(e)})).subscribe(),this.programForm.get("cycleLength")?.valueChanges.subscribe(t=>{let e=parseInt(t,10);this.cycleLengthSignal.set(isNaN(e)?null:e),!isNaN(e)&&e>0&&this.scheduleFormArray.controls.forEach(i=>{let o=i.get("dayOfWeek");o&&o.value>e&&o.setValue(1)})}),this.programForm.get("programType")?.valueChanges.subscribe(t=>{this.handleProgramTypeChange(t)})}handleProgramTypeChange(t){t==="linear"?(this.scheduleFormArray.clear(),this.programForm.get("cycleLength")?.setValue(null),this.programForm.get("cycleLength")?.disable(),this.weeksFormArray.length===0&&!this.isViewMode&&this.addWeek()):(this.weeksFormArray.clear(),this.programForm.get("cycleLength")?.enable())}get scheduleFormArray(){return this.programForm.get("schedule")}get weeksFormArray(){return this.programForm.get("weeks")}getWeekScheduleGroups(t){return this.weeksFormArray.at(t).get("schedule").controls}createWeekGroup(t){let e=this.fb.group({id:[t?.id||L()],weekNumber:[t?.weekNumber??this.weeksFormArray.length+1],name:[t?.name??`Week ${this.weeksFormArray.length+1}`,A.required],schedule:this.fb.array([])});return t?.schedule?.forEach(i=>{e.get("schedule").push(this.createScheduledDayGroup(i))}),e}addWeek(){this.weeksFormArray.push(this.createWeekGroup()),this.cdr.detectChanges(),setTimeout(()=>{},50)}removeWeek(t){this.weeksFormArray.removeAt(t)}loadAvailableRoutines(){this.workoutService.routines$.pipe(G(1)).subscribe(t=>{this.availableRoutines=t.sort((e,i)=>e.name.localeCompare(i.name))})}patchFormWithProgramData(t){let e=t.programType||"cycled";if(this.programForm.patchValue({name:t.name,description:t.description?this.updateSanitizedDescription(t.description):"",programNotes:t.programNotes,startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:null,cycleLength:t.cycleLength??null,iterationId:t.iterationId??null,programType:t.programType||"cycled"}),this.cycleLengthSignal.set(t.cycleLength??null),e==="linear"&&t.weeks?(this.weeksFormArray.clear(),t.weeks.forEach(i=>{this.weeksFormArray.push(this.createWeekGroup(i))})):(this.scheduleFormArray.clear(),t.schedule.forEach(i=>{this.scheduleFormArray.push(this.createScheduledDayGroup(i))})),this.handleProgramTypeChange(e),this.updateFormEnabledState(),this.scheduleFormArray.clear(),t.schedule.forEach(i=>{this.scheduleFormArray.push(this.createScheduledDayGroup(i))}),this.updateFormEnabledState(),t.goals?.length){let i=new Set(t.goals.filter(o=>o!=null));this.programGoals.filter(o=>o.value!=null&&i.has(o.value)).forEach(o=>{this.toggleGoal(o)})}}createScheduledDayGroup(t){let e=this.currentDayOptions()[0]?.value??1;return this.fb.group({id:[t?.id||L()],dayOfWeek:[t?.dayOfWeek??e,A.required],routineId:[t?.routineId??"",A.required],routineName:[t?.routineName??""],notes:[t?.notes??""],timeOfDay:[t?.timeOfDay??""],programId:[t?.programId??this.currentProgramId],isUnscheduled:[t?.isUnscheduled||!1]})}addScheduledDay(t){if(this.isViewMode)return;let e=parseInt(this.programForm.get("cycleLength")?.value,10),i=!e||e===7;if(this.programForm.get("programType")?.value==="linear"&&t!==void 0){let s=this.weeksFormArray.at(t).get("schedule");if(s.length>=7){this.toastService.info("All 7 days of this week have been scheduled.",3e3);return}let p=new Set(s.controls.map(w=>w.get("dayOfWeek")?.value)),f=[1,2,3,4,5,6,0],k=1;for(let w of f)if(!p.has(w)){k=w;break}s.push(this.createScheduledDayGroup({dayOfWeek:k}))}else if(i){if(this.scheduleFormArray.length>=7){this.toastService.info("All 7 days of the week have been scheduled.",3e3);return}let s=new Set(this.scheduleFormArray.controls.map(k=>k.get("dayOfWeek")?.value)),p=[1,2,3,4,5,6,0],f=1;for(let k of p)if(!s.has(k)){f=k;break}this.scheduleFormArray.push(this.createScheduledDayGroup({dayOfWeek:f}))}else{if(this.scheduleFormArray.length>=e){this.toastService.info(`All ${e} days of the cycle have been scheduled.`,3e3);return}let s=new Set(this.scheduleFormArray.controls.map(f=>f.get("dayOfWeek")?.value)),p=1;for(let f=1;f<=e;f++)if(!s.has(f)){p=f;break}this.scheduleFormArray.push(this.createScheduledDayGroup({dayOfWeek:p}))}this.cdr.detectChanges(),setTimeout(()=>{let s=document.querySelectorAll(".scheduled-day-card");s.length>0&&s[s.length-1].scrollIntoView({behavior:"smooth",block:"center"})},50)}removeScheduledDay(t,e){if(this.isViewMode)return;this.programForm.get("programType")?.value==="linear"&&e!==void 0?this.weeksFormArray.at(e).get("schedule").removeAt(t):this.scheduleFormArray.removeAt(t)}get scheduleFormGroups(){return this.scheduleFormArray.controls}onScheduleDrop(t){this.isViewMode||(K(this.scheduleFormArray.controls,t.previousIndex,t.currentIndex),this.scheduleFormArray.updateValueAndValidity())}openRoutineSelectionModal(t,e){this.isViewMode||(e!==void 0?this.targetIndicesForRoutine={weekIndex:t,dayIndex:e}:this.targetIndicesForRoutine={dayIndex:t},this.modalSearchTerm.set(""),this.isRoutineModalOpen.set(!0))}closeRoutineSelectionModal(){this.isRoutineModalOpen.set(!1),this.targetScheduleIndexForRoutine=null}selectRoutineForDay(t){if(this.targetIndicesForRoutine){let e,{weekIndex:i,dayIndex:o}=this.targetIndicesForRoutine;i!==void 0?e=this.getWeekScheduleDayControl(i,o):e=this.scheduleFormArray.at(o),e?.patchValue({routineId:t.id,routineName:t.name})}this.closeRoutineSelectionModal()}updateFormEnabledState(){this.isViewMode?this.programForm.disable():this.programForm.enable()}enableEditModeFromView(){this.isViewMode&&this.currentProgramId&&this.router.navigate(["/training-programs/edit",this.currentProgramId])}onSubmit(){return N(this,null,function*(){if(this.submitted=!0,this.isViewMode)return;if(this.programForm.invalid){this.programForm.markAllAsTouched(),this.toastService.error("Please fill all required fields.",0,"Validation Error");return}let t=this.programForm.getRawValue(),e=this.currentProgramId||L(),i={id:e,name:t.name,programType:t.programType,goals:this.selectedGoals(),description:t.description,programNotes:t.programNotes,startDate:t.startDate||null,iterationId:t.iterationId||null,cycleLength:t.programType==="cycled"&&t.cycleLength||null,schedule:t.schedule.map(o=>({id:o.id||L(),dayOfWeek:Number(o.dayOfWeek),routineId:o.routineId,routineName:o.routineName,programId:e,notes:o.notes,timeOfDay:o.timeOfDay,isUnscheduled:o.isUnscheduled||!1})),weeks:t.programType==="linear"?t.weeks.map(o=>J(Z({},o),{schedule:o.schedule.map(s=>({id:s.id||L(),dayOfWeek:Number(s.dayOfWeek),routineId:s.routineId,routineName:s.routineName,programId:e,notes:s.notes,timeOfDay:s.timeOfDay,isUnscheduled:s.isUnscheduled||!1}))})):[],isActive:this.currentProgram?.isActive??!1};try{if(this.spinnerService.show("Saving program..."),this.isNewMode){let o=yield this.trainingProgramService.addProgram(i);this.isNewMode=!1,this.isEditMode=!0,this.currentProgramId=o.id}else if(this.isEditMode&&this.currentProgramId){let o=yield H(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(G(1)));i.isActive=o?.isActive??!1,yield this.trainingProgramService.updateProgram(i)}this.toastService.success("Program saved successfully",0,"Success")}catch(o){console.error("Error saving program:",o),this.toastService.error("Failed to save program",0,"Save Error")}finally{this.spinnerService.hide()}})}deleteProgram(){return N(this,null,function*(){if(!this.currentProgramId){this.toastService.error("No program selected for deletion",0,"Deletion Error");return}try{this.spinnerService.show("Deleting program..."),yield this.trainingProgramService.deleteProgram(this.currentProgramId),(this.router.url.includes(`/training-programs/edit/${this.currentProgramId}`)||this.router.url.includes(`/training-programs/view/${this.currentProgramId}`))&&this.router.navigate(["/training-programs"])}catch(t){console.error("Error during program deletion process in component:",t),this.toastService.error("An unexpected error occurred while deleting the program",0,"Deletion Error")}finally{this.spinnerService.hide()}})}ngOnDestroy(){this.routeSub&&this.routeSub.unsubscribe(),this.workoutLogsSubscription?.unsubscribe()}get f(){return this.programForm.controls}getScheduleDayControl(t){return this.scheduleFormArray.at(t)}getWeekScheduleDayControl(t,e){return this.weeksFormArray.at(t).get("schedule").at(e)}completeProgram(){return N(this,null,function*(){if(this.currentProgramId&&this.isCurrentProgramActive())try{let t=yield this.alertService.showConfirmationDialog("Finish Program","Are you sure you want to mark this program as completed?",[{text:"Cancel",role:"cancel",cssClass:"bg-gray-400 hover:bg-gray-600",icon:"cancel"},{text:"Finish Program",role:"confirm",cssClass:"bg-primary hover:bg-primary-dark",icon:"done"}]);if(!t||t.role!=="confirm")return;this.spinnerService.show("Completing program..."),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"completed")}catch{this.toastService.error("Failed to complete program",0,"Error")}finally{this.spinnerService.hide()}})}toggleActiveProgram(){return N(this,null,function*(){if(this.currentProgramId){if(this.isCurrentProgramActive()){let t=yield this.alertService.showConfirmationDialog("Program is currently active.","What would you like to do?",[{text:"Deactivate",role:"deactivate",data:"deactivate",icon:"deactivate"},{text:"Complete",role:"complete",data:"complete",icon:"goal",cssClass:"bg-green-500 hover:bg-green-600"},{text:"Cancel",role:"cancel",data:"cancel",icon:"cancel"}]);if(!t||!t.data||t.data==="cancel"){this.spinnerService.hide();return}if(t.data==="complete"){try{this.spinnerService.show("Completing program..."),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"completed"),this.toastService.success("Program is now completed")}catch{this.toastService.error("Failed to complete program",0,"Error")}finally{this.spinnerService.hide()}return}else try{this.spinnerService.show("Deactivating program..."),yield this.trainingProgramService.deactivateProgram(this.currentProgramId,"cancelled"),this.toastService.success("Program is now deactivated")}catch{this.toastService.error("Failed to deactivate",0,"Error")}finally{this.spinnerService.hide()}return}try{this.spinnerService.show("Setting active program..."),yield this.trainingProgramService.toggleProgramActivation(this.currentProgramId,"active"),this.toastService.success("Program is now active")}catch{this.toastService.error("Failed to set active program",0,"Error")}finally{this.spinnerService.hide()}}})}toggleProgramHistory(){if(!this.currentProgram?.history||this.currentProgram.history.length===0){this.toastService.info("No history available for this program.",3e3);return}this.isProgramHistoryModalOpen.set(!0)}isProgramHistoryModalOpen=D(!1);closeProgramHistoryModal(){this.isProgramHistoryModalOpen.set(!1),this.editingHistoryEntryId.set(null)}updateSanitizedDescription(t){this.sanitizedDescription=this.sanitizer.bypassSecurityTrustHtml(t)}toggleGoal(t){this.selectedGoals.update(e=>{let i=new Set(e);return t!==void 0&&t.value!==void 0&&(i.has(t.value)?i.delete(t.value):i.add(t.value)),Array.from(i)})}getProgramDropdownActionItems(t,e){let i="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-primary flex items-center text-sm hover:text-white dark:hover:text-gray-100 dark:hover:text-white",o="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-red-600 flex items-center text-sm hover:text-gray-100 hover:animate-pulse",s="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-green-600 flex items-center text-sm hover:text-gray-100",p="rounded text-left px-3 py-1.5 sm:px-4 sm:py-2 font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-500 flex items-center text-sm hover:text-gray-100",f=this.currentProgram,k={label:"EDIT",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{programId:t}},w={label:"ACTIVATE",actionKey:"activate",iconName:"activate",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+s,data:{programId:t}},x={label:"HISTORY",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{programId:t}},h={label:"FINISH",actionKey:"finish",iconName:"goal",iconClass:"w-8 h-8 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+i,data:{programId:t}},W={label:"DEACTIVATE",actionKey:"deactivate",iconSvg:'<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="45" stroke="currentColor" stroke-width="10"/><line x1="25" y1="50" x2="75" y2="50" stroke="currentColor" stroke-width="10"/></svg>',iconClass:"w-7 h-7 mr-2",buttonClass:(e==="dropdown"?"w-full ":"")+p,data:{programId:t}},S=[];return f?.isActive?(S.push(h),S.push(W)):S.push(w),S.push(x),this.isViewMode&&S.push(k),S}handleActionMenuItemClick(t,e){if(t.data?.programId)switch(t.actionKey){case"activate":this.toggleActiveProgram();break;case"deactivate":this.toggleActiveProgram();break;case"finish":this.completeProgram();break;case"history":this.toggleProgramHistory();break;case"edit":this.enableEditModeFromView();break}}activeRoutineIdActions=D(null);toggleActions(t,e){e.stopPropagation(),this.activeRoutineIdActions.update(i=>i===t?null:t)}areActionsVisible(t){return this.activeRoutineIdActions()===t}onCloseActionMenu(){this.activeRoutineIdActions.set(null)}navigateToPrograms(){this.router.navigate(["/training-programs"])}removeProgramHistoryEntry(t){return N(this,null,function*(){if(!this.currentProgramId||!t){this.toastService.error("Missing program or history entry ID.",0,"Error");return}try{this.spinnerService.show("Removing history entry..."),yield this.trainingProgramService.removeProgramHistoryEntry(this.currentProgramId,t),this.toastService.success("History entry removed.",0,"Success");let e=yield H(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(G(1)));this.currentProgram=e,e&&this.patchFormWithProgramData(e)}catch{this.toastService.error("Failed to remove history entry.",0,"Error")}finally{this.spinnerService.hide()}})}editHistoryEntry(t){this.editingHistoryEntryId.set(t.id),this.historyEditForm.patchValue({id:t.id,startDate:t.startDate&&t.startDate!=="-"?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate&&t.endDate!=="-"?new Date(t.endDate).toISOString().split("T")[0]:"",status:t.status})}cancelEditHistoryEntry(){this.editingHistoryEntryId.set(null)}saveHistoryEntry(){return N(this,null,function*(){if(this.historyEditForm.invalid){this.toastService.error("Please ensure all fields are valid.",0,"Validation Error");return}if(!this.currentProgramId)return;let t=this.historyEditForm.getRawValue(),e=J(Z({},t),{programId:this.currentProgramId,endDate:t.endDate||"-",date:new Date().toISOString()});try{this.spinnerService.show("Updating history..."),yield this.trainingProgramService.updateProgramHistory(this.currentProgramId,e);let i=yield H(this.trainingProgramService.getProgramById(this.currentProgramId).pipe(G(1)));this.currentProgram=i,this.editingHistoryEntryId.set(null)}catch{this.toastService.error("Failed to save history entry.",0,"Save Error")}finally{this.spinnerService.hide()}})}forceEndDateToNull(){this.historyEditForm.get("endDate")?.setValue(null),this.historyEditForm.get("endDate")?.disable()}enableEndDate(){this.historyEditForm.get("endDate")?.enable()}onWeekDrop(t){this.isViewMode||(K(this.weeksFormArray.controls,t.previousIndex,t.currentIndex),this.weeksFormArray.controls.forEach((e,i)=>{e.get("weekNumber")?.setValue(i+1)}),this.weeksFormArray.updateValueAndValidity())}onDayDropInWeek(t,e){if(this.isViewMode)return;let i=this.weeksFormArray.at(e).get("schedule");K(i.controls,t.previousIndex,t.currentIndex),i.updateValueAndValidity()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=le({type:r,selectors:[["app-training-program-builder"]],decls:34,vars:20,consts:[["noHistory",""],[1,"container","mx-auto","p-2","sm:p-4"],[1,"flex","items-center","justify-between","p-2"],[1,"flex","justify-between","items-center"],[1,"text-gray-600","dark:text-gray-300","hover:text-primary","dark:hover:text-primary-light","p-2","-ml-1",3,"routerLink"],["name","back",1,"w-6","h-6"],[1,"w-10","h-10"],[1,"flex","items-center","space-x-2","flex-shrink-0"],["class","",4,"ngIf"],[1,"space-y-6","mb-6",3,"ngSubmit","formGroup"],[1,"space-y-4","p-2","rounded-md"],[4,"ngIf"],["class","pt-2",4,"ngIf"],["class","pt-4 space-y-4",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","md:col-span-2",4,"ngIf"],["for","iterationId",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"text-red","dark:text-primary-light"],["type","text","id","iterationId","formControlName","iterationId","placeholder","",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],["class","pt-6 flex justify-end space-x-3",4,"ngIf"],["class","fixed inset-0 bg-gray-700 bg-opacity-75 transition-opacity overflow-y-auto h-full w-full z-[70] flex items-center justify-center p-4",3,"click",4,"ngIf"],["class","fixed inset-0 bg-gray-700 bg-opacity-75 z-[80] flex items-center justify-center p-4 backdrop-blur-sm",4,"ngIf"],[1,""],[1,"relative"],[1,"text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-full","focus:outline-none","flex","items-center",3,"click"],["name","menu-action",1,"h-7","w-7"],["displayMode","dropdown",3,"items","isVisible","itemClick","closeMenu",4,"ngIf"],["displayMode","dropdown",3,"itemClick","closeMenu","items","isVisible"],[1,"block","text-xl","font-black","text-gray-700","dark:text-gray-300"],[1,"flex","max-w-[100px]","px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors","duration-200","ease-in-out","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-green-800","bg-green-600","text-white","hover:bg-green-300","dark:bg-green-600","dark:hover:bg-green-500","focus:ring-green-400"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","ml-1"],["fill-rule","evenodd","d","M16.403 12.652a3 3 0 000-5.304 3 3 0 00-3.75-3.751 3 3 0 00-5.305 0 3 3 0 00-3.751 3.75 3 3 0 000 5.305 3 3 0 003.75 3.751 3 3 0 005.305 0 3 3 0 003.751-3.75Zm-2.546-4.46a.75.75 0 00-1.214-.883l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5Z","clip-rule","evenodd"],[1,"text-2xs","sm:text-xs","font-semibold","px-1.5","sm:px-2.5","py-0.5"],[1,"pt-2"],["class","space-y-1",4,"ngIf"],[1,"space-y-1"],[1,"flex","justify-between","items-baseline"],[1,"text-sm","font-medium","text-gray-600","dark:text-gray-300"],[1,"text-sm","font-semibold","text-primary","dark:text-primary-light"],[1,"w-full","bg-gray-200","rounded-full","h-2.5","dark:bg-gray-700"],[1,"bg-primary","h-2.5","rounded-full","transition-all","duration-500","ease-out"],[1,"pt-4","space-y-4"],[1,"flex","w-full","h-4","rounded-md","overflow-hidden","border","border-gray-300","dark:border-gray-600"],["class","flex-1 border-r border-gray-300 dark:border-gray-600 last:border-r-0 transition-colors duration-300",3,"ngClass","title",4,"ngFor","ngForOf"],[1,"flex-1","border-r","border-gray-300","dark:border-gray-600","last:border-r-0","transition-colors","duration-300",3,"ngClass","title"],[1,"font-semibold"],["class","flex-1 border-r border-gray-300 dark:border-gray-600 last:border-r-0 transition-colors duration-300",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex-1","border-r","border-gray-300","dark:border-gray-600","last:border-r-0","transition-colors","duration-300",3,"ngClass"],["for","programName",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","programName","formControlName","name","placeholder","Program name",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"ngClass"],["class","text-red-500 dark:text-red-400 text-xs mt-1",4,"ngIf"],[1,"text-red-500","dark:text-red-400","text-xs","mt-1"],[1,"mt-1","block","w-full","dark:text-gray-200",3,"innerHTML"],["for","description",1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300"],["id","description","formControlName","description","rows","3","placeholder","Description (optional)",1,"mt-1","block","w-full","p-2","border","border-gray-300","dark:border-gray-500","rounded-md","shadow-sm","dark:bg-gray-600","dark:text-gray-200"],[1,"mt-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"flex","flex-wrap","gap-2"],["type","button","class","px-3 py-1.5 text-xs font-semibold rounded-full transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800",3,"disabled","ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"px-3","py-1.5","text-xs","font-semibold","rounded-full","transition-colors","duration-200","ease-in-out","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-gray-800",3,"click","disabled","ngClass"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","date","id","startDate","formControlName","startDate",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],[1,"md:col-span-2"],[1,"block","text-m","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"flex","items-center","space-x-4","p-2","bg-gray-100","dark:bg-gray-700","rounded-md"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","radio","formControlName","programType","value","cycled",1,"form-radio","h-4","w-4","text-primary","focus:ring-primary-dark","dark:bg-gray-600","dark:border-gray-500"],[1,"text-gray-700","dark:text-gray-300"],["type","radio","formControlName","programType","value","linear",1,"form-radio","h-4","w-4","text-primary","focus:ring-primary-dark","dark:bg-gray-600","dark:border-gray-500"],["for","cycleLength",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","flex","items-center"],[1,"ml-1"],["name","info",1,"h-4","w-4","text-gray-400","dark:text-gray-500","cursor-help",3,"appTooltip"],["type","number","id","cycleLength","formControlName","cycleLength","min","1","placeholder","e.g., 4 for Upper/Lower/Rest/Rest",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],[1,"mt-1","text-xs","text-gray-500","dark:text-gray-400"],["for","programNotes",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","programNotes","formControlName","programNotes","rows","3",1,"mt-1","block","w-full","p-2","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xl","font-semibold","text-gray-700","dark:text-gray-300"],["type","button","appPress","","class","flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-1.5 px-3 rounded-md shadow-sm",3,"shortPress",4,"ngIf"],["cdkDropList","","formArrayName","schedule","class","space-y-4",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],["class","text-center py-6 text-gray-500 dark:text-gray-400 border border-dashed dark:border-gray-700 rounded-md",4,"ngIf"],["type","button","appPress","",1,"flex","items-center","justify-center","bg-blue-500","hover:bg-blue-600","text-white","text-sm","font-medium","py-1.5","px-3","rounded-md","shadow-sm",3,"shortPress"],["name","create",1,"h-4","w-4"],["cdkDropList","","formArrayName","schedule",1,"space-y-4",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","","class","scheduled-day-card p-3 border rounded-md shadow-sm bg-gray-50 dark:bg-gray-600/70 dark:border-gray-600 relative",3,"formGroupName","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","",1,"scheduled-day-card","p-3","border","rounded-md","shadow-sm","bg-gray-50","dark:bg-gray-600/70","dark:border-gray-600","relative",3,"formGroupName","cdkDragDisabled"],["cdkDragHandle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 cursor-pointer","title","Drag to reorder day",4,"ngIf"],[1,"flex","justify-between","items-center","mb-1",3,"ngClass"],[1,"text-md","font-medium","text-gray-800","dark:text-gray-100"],["type","button","appPress","","class","flex items-center text-xs text-red-600 bg-red-200 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 font-medium py-1 px-2 rounded-md hover:enabled:bg-red-100 dark:enabled:hover:bg-red-900/50 disabled:opacity-50",3,"shortPress",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3","dark:text-gray-300"],[1,"block","text-xs","font-medium","text-gray-700","dark:text-gray-300",3,"for"],["formControlName","dayOfWeek",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500","dark:text-gray-300",3,"id"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-1","flex","rounded-md","shadow-sm",3,"ngClass"],["type","text","readonly","",1,"flex-1","min-w-0","block","w-full","px-3","py-2","text-sm","rounded-none","rounded-l-md","border-gray-300","dark:border-gray-200","dark:bg-gray-400","cursor-default","focus:outline-none","focus:ring-0","focus:border-gray-300","dark:text-gray-800","font-medium",3,"id","value","ngClass"],["type","button","appPress","","class","inline-flex items-center px-3 py-2 border border-l-0 rounded-r-md text-sm transition-colors duration-150",3,"ngClass","shortPress",4,"ngIf"],["class","sm:col-span-2",4,"ngIf"],["cdkDragHandle","","title","Drag to reorder day",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"w-5","h-5"],["d","M 7 17 L 7 3 M 4 6 L 7 3 L 10 6 M 17 7 L 17 21 M 14 18 L 17 21 L 20 18","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","button","appPress","",1,"flex","items-center","text-xs","text-red-600","bg-red-200","hover:text-red-700","dark:text-red-400","dark:hover:text-red-300","font-medium","py-1","px-2","rounded-md","hover:enabled:bg-red-100","dark:enabled:hover:bg-red-900/50","disabled:opacity-50",3,"shortPress"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 16 16","fill","currentColor",1,"w-4","h-4","inline-block","mr-1"],["fill-rule","evenodd","d","M5 3.25A2.25 2.25 0 002.75 5.5v5A2.25 2.25 0 005 12.75h6a2.25 2.25 0 002.25-2.25v-5A2.25 2.25 0 0011 3.25H5Zm.97 3.97a.75.75 0 011.06 0L8 8.28l.97-.97a.75.75 0 111.06 1.06L9.06 9.25l.97.97a.75.75 0 11-1.06 1.06L8 10.43l-.97.97a.75.75 0 01-1.06-1.06L6.94 9.25l-.97-.97a.75.75 0 010-1.06Z","clip-rule","evenodd"],[3,"value"],["type","button","appPress","",1,"inline-flex","items-center","px-3","py-2","border","border-l-0","rounded-r-md","text-sm","transition-colors","duration-150",3,"shortPress","ngClass"],["name","change",1,"h-4","w-4"],[1,"sm:col-span-2"],["type","text","formControlName","timeOfDay","placeholder","e.g., AM, PM, 08:00",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500",3,"id"],["formControlName","notes","rows","2",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:border-gray-500",3,"id"],[1,"text-center","py-6","text-gray-500","dark:text-gray-400","border","border-dashed","dark:border-gray-700","rounded-md"],["type","button","class","mt-2 text-sm text-primary hover:underline",3,"click",4,"ngIf"],["type","button",1,"mt-2","text-sm","text-primary","hover:underline",3,"click"],["type","button","appPress","","class","flex items-center justify-center bg-green-500 hover:bg-green-600 text-white text-sm font-medium py-1.5 px-3 rounded-md shadow-sm",3,"shortPress",4,"ngIf"],["cdkDropList","","formArrayName","weeks",1,"space-y-6","mt-4",3,"cdkDropListDropped"],["cdkDrag","","class","p-4 border-2 border-dashed dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800/50",3,"formGroupName","cdkDragDisabled",4,"ngFor","ngForOf"],["type","button","appPress","",1,"flex","items-center","justify-center","bg-green-500","hover:bg-green-600","text-white","text-sm","font-medium","py-1.5","px-3","rounded-md","shadow-sm",3,"shortPress"],["cdkDrag","",1,"p-4","border-2","border-dashed","dark:border-gray-600","rounded-lg","bg-gray-50","dark:bg-gray-800/50",3,"formGroupName","cdkDragDisabled"],[1,"flex","justify-between","items-center","mb-3"],["cdkDragHandle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 cursor-move","title","Drag to reorder week",4,"ngIf"],[1,"flex-grow","mx-2"],[1,"sr-only",3,"for"],["type","text","formControlName","name","placeholder","e.g., Week 1: Volume",1,"text-lg","font-bold","bg-transparent","border-0","border-b-2","border-gray-300","dark:border-gray-500","focus:ring-0","focus:border-primary","dark:text-gray-100","p-1","w-full","sm:w-1/2",3,"id"],["cdkDrag","","class","scheduled-day-card p-3 border rounded-md shadow-sm bg-white dark:bg-gray-600/70 dark:border-gray-600 relative",3,"formGroupName","cdkDragDisabled",4,"ngFor","ngForOf"],["class","text-center mt-4",4,"ngIf"],["class","text-center text-sm text-gray-500 dark:text-gray-400 py-4",4,"ngIf"],["cdkDragHandle","","title","Drag to reorder week",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","cursor-move"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-6","h-6"],["d","M10 4h4v4h-4zM4 10h4v4H4zM10 10h4v4h-4zM16 10h4v4h-4zM10 16h4v4h-4z"],["cdkDrag","",1,"scheduled-day-card","p-3","border","rounded-md","shadow-sm","bg-white","dark:bg-gray-600/70","dark:border-gray-600","relative",3,"formGroupName","cdkDragDisabled"],["cdkDragHandle","","class","p-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 flex-shrink-0 cursor-grab","title","Drag to reorder day",4,"ngIf"],["formControlName","dayOfWeek",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-500",3,"id"],[1,"mt-1","flex","rounded-md","shadow-sm"],["type","text","readonly","",1,"flex-1","block","w-full","px-3","py-2","text-sm","rounded-md","dark:bg-gray-400","cursor-default","dark:text-gray-800","font-medium",3,"id","value"],["type","button","appPress","","class","inline-flex items-center px-3 py-2 border border-l-0 rounded-r-md text-sm",3,"shortPress",4,"ngIf"],["formControlName","notes","rows","2",1,"mt-1","block","w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-500",3,"id"],["cdkDragHandle","","title","Drag to reorder day",1,"p-1","text-gray-400","hover:text-gray-600","dark:text-gray-500","dark:hover:text-gray-300","flex-shrink-0","cursor-grab"],["type","button","appPress","",1,"inline-flex","items-center","px-3","py-2","border","border-l-0","rounded-r-md","text-sm",3,"shortPress"],[1,"text-center","mt-4"],[1,"text-center","text-sm","text-gray-500","dark:text-gray-400","py-4"],[1,"pt-6","flex","justify-end","space-x-3"],["appPress","",1,"flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","dark:text-gray-200","hover:bg-gray-50","dark:hover:bg-gray-700",3,"shortPress"],["name","cancel",1,"h-5","w-5"],["type","submit","appPress","",1,"flex","items-center","justify-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-primary","hover:bg-primary-dark","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-dark","disabled:opacity-50",3,"shortPress","disabled"],["name","create","class","h-5 w-5",4,"ngIf"],["name","save","class","h-5 w-5",4,"ngIf"],["name","create",1,"h-5","w-5"],["name","save",1,"h-5","w-5"],[1,"fixed","inset-0","bg-gray-700","bg-opacity-75","transition-opacity","overflow-y-auto","h-full","w-full","z-[70]","flex","items-center","justify-center","p-4",3,"click"],[1,"relative","transform","overflow-hidden","rounded-md","bg-white","dark:bg-gray-700","text-left","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-2xl",3,"click"],[1,"bg-white","dark:bg-gray-600","px-4","pt-5","pb-4","sm:p-6","sm:pb-4","backdrop-blur-sm"],[1,"sm:flex","sm:items-start","w-full"],[1,"mt-3","text-center","sm:mt-0","sm:text-left","w-full"],[1,"flex","justify-between","items-center","pb-3"],["id","modal-title",1,"text-xl","font-semibold","leading-6","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","focus:outline-none",3,"click"],["name","cancel",1,"h-6","w-6"],[1,"my-4"],["type","text","placeholder","Search routines...",1,"w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:text-gray-200",3,"ngModelChange","ngModel"],[1,"mt-2","max-h-80","overflow-y-auto","pr-2","custom-scrollbar"],["class","p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer transition-colors flex justify-between items-center",3,"click",4,"ngFor","ngForOf"],["class","text-gray-500 dark:text-gray-400 text-center p-4",4,"ngIf"],[1,"bg-gray-50","dark:bg-gray-600","px-4","py-3","sm:flex","sm:flex-row-reverse","sm:px-6"],["type","button",1,"mt-3","inline-flex","w-full","justify-center","rounded-md","bg-white","dark:bg-gray-700","px-3","py-2","text-sm","font-semibold","text-gray-900","dark:text-gray-200","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-500","hover:bg-gray-50","dark:hover:bg-gray-500","sm:mt-0","sm:w-auto",3,"click"],[1,"p-3","hover:bg-gray-100","dark:hover:bg-gray-700","rounded-md","cursor-pointer","transition-colors","flex","justify-between","items-center",3,"click"],[1,"text-left"],[1,"font-medium","text-gray-800","dark:text-gray-200"],[1,"block","text-xs","text-gray-500","dark:text-gray-400"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","text-primary","dark:text-primary-light"],["fill-rule","evenodd","d","M8.22 5.22a.75.75 0 011.06 0l4.25 4.25a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 010-1.06Z","clip-rule","evenodd"],[1,"text-gray-500","dark:text-gray-400","text-center","p-4"],[1,"fixed","inset-0","bg-gray-700","bg-opacity-75","z-[80]","flex","items-center","justify-center","p-4","backdrop-blur-sm"],[1,"relative","bg-white","dark:bg-gray-800","rounded-md","shadow-xl","w-full","max-w-3xl","h-full","max-h-[90vh]","flex","flex-col",3,"click"],[1,"flex","justify-between","items-center","px-4","py-3","border-b","dark:border-gray-700","flex-shrink-0"],[1,"text-lg","font-bold","text-gray-900","dark:text-gray-100"],["type","button",1,"p-1","rounded-full","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300",3,"click"],[1,"p-4","overflow-y-auto","flex-grow"],[4,"ngIf","ngIfElse"],[1,"px-4","py-3","border-t","dark:border-gray-700","flex","justify-end","flex-shrink-0"],["type","button",1,"px-4","py-2","rounded-md","bg-primary","text-white","hover:bg-primary-dark","flex","items-center",3,"click"],["name","cancel",1,"h-5","w-5","mr-1"],[3,"ngSubmit","formGroup"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700","hidden","sm:table"],[1,"px-4","py-2","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"px-4","py-2","text-center","text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],[4,"ngFor","ngForOf"],[1,"space-y-4","sm:hidden"],["class","p-3 border rounded-md dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",4,"ngFor","ngForOf"],[1,"px-4","py-3","text-sm","text-gray-700","dark:text-gray-200"],[1,"px-4","py-3"],[1,"flex","items-center","space-x-2","justify-center"],["type","button","title","Edit entry",1,"p-1.5","text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-md","flex","items-center",3,"click"],["name","edit",1,"w-8","h-8"],["type","button","title","Delete entry",1,"p-1.5","text-red-500","dark:text-red-400","hover:bg-red-100","dark:hover:bg-red-900/50","rounded-md",3,"click"],["name","trash",1,"w-8","h-8"],[1,"px-2","py-2"],["type","date","formControlName","startDate",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],["type","date","formControlName","endDate",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300","dark:[color-scheme:dark]"],["formControlName","status",1,"w-full","p-1.5","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-700","dark:border-gray-600","dark:text-gray-300",3,"change"],[1,"px-4","py-2","text-sm","text-gray-500","dark:text-gray-400","italic"],[1,"px-4","py-2"],[1,"flex","items-center","space-x-2"],["type","submit","title","Save changes",1,"p-1.5","text-green-600","dark:text-green-400","hover:bg-green-100","dark:hover:bg-green-900/50","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","save",1,"w-8","h-8"],["type","button","title","Cancel edit",1,"p-1.5","text-gray-500","dark:text-gray-400","hover:bg-gray-200","dark:hover:bg-gray-500","rounded-md","flex","items-center",3,"click"],["name","cancel",1,"w-8","h-8"],[1,"p-3","border","rounded-md","dark:border-gray-700","bg-gray-50","dark:bg-gray-700/50"],["class","space-y-3",4,"ngIf"],[1,"grid","grid-cols-2","gap-x-3","gap-y-2"],[1,"text-xs","font-medium","text-gray-500","dark:text-gray-400"],[1,"font-semibold","dark:text-gray-100"],[1,"dark:text-gray-300"],[1,"dark:text-gray-300","text-xs"],[1,"flex","justify-end","items-center","space-x-2","mt-3","pt-3","border-t","dark:border-gray-600"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-gray-600","dark:text-gray-300","hover:bg-gray-200","dark:hover:bg-gray-600",3,"click"],["name","edit",1,"w-8","h-8","mr-1"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-red-600","dark:text-red-400","hover:bg-red-100","dark:hover:bg-red-900/50",3,"click"],["name","trash",1,"w-8","h-8","mr-1"],[1,"space-y-3"],[1,"block","text-xs","font-medium","text-gray-500","dark:text-gray-400","mb-1"],["formControlName","status",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200",3,"change"],["type","date","formControlName","startDate",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200","dark:[color-scheme:dark]"],["type","date","formControlName","endDate",1,"w-full","p-2","text-sm","border","rounded-md","shadow-sm","dark:bg-gray-600","dark:border-gray-500","dark:text-gray-200","dark:[color-scheme:dark]"],["type","button",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-gray-600","dark:text-gray-300","bg-gray-200","hover:bg-gray-300","dark:bg-gray-600","dark:hover:bg-gray-500",3,"click"],["type","submit",1,"flex","items-center","text-sm","px-3","py-1.5","rounded-md","text-white","bg-green-600","hover:bg-green-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","save",1,"w-8","h-8","mr-1"],[1,"text-center","text-gray-500","dark:text-gray-400","py-6"]],template:function(e,i){if(e&1&&(a(0,"div",1)(1,"header",2)(2,"div",3)(3,"button",4),u(4,"app-icon",5),n(),u(5,"div",6),n(),a(6,"div",7),g(7,pt,5,1,"div",8),n()(),a(8,"form",9),v("ngSubmit",function(){return i.onSubmit()}),a(9,"section",10),g(10,yt,3,1,"div",11)(11,_t,6,0,"div",11)(12,ft,2,1,"div",12)(13,wt,3,2,"div",13)(14,Pt,5,5,"div",11)(15,Tt,2,1,"div",11)(16,Dt,4,0,"div",11)(17,It,5,1,"div",14),a(18,"div",15),g(19,Ft,4,0,"div",11)(20,Mt,12,0,"div",16)(21,Vt,8,1,"div",11),a(22,"div")(23,"label",17),m(24,"Based on Program Iteration"),n(),a(25,"span",18),m(26,"(EDIT IF YOU ONLY KNOW WHAT YOU ARE DOING)"),n(),u(27,"input",19),n()(),g(28,At,4,0,"div",11),n(),g(29,Kt,7,3,"section",11)(30,sr,8,3,"section",11)(31,ur,9,4,"div",20),n(),g(32,_r,20,4,"div",21)(33,Tr,15,2,"div",22),n()),e&2){let o,s,p,f,k;l(3),d("routerLink","/training-programs"),l(4),d("ngIf",i.currentProgram),l(),d("formGroup",i.programForm),l(2),d("ngIf",i.isViewMode),l(),d("ngIf",i.currentProgram==null?null:i.currentProgram.isActive),l(),d("ngIf",i.isViewMode&&(i.currentProgram==null?null:i.currentProgram.isActive)),l(),d("ngIf",i.isViewMode&&(i.currentProgram==null?null:i.currentProgram.programType)==="linear"&&(i.currentProgram==null?null:i.currentProgram.isActive)),l(),d("ngIf",i.isEditableMode()),l(),d("ngIf",i.isViewMode),l(),d("ngIf",i.isEditableMode()),l(),d("ngIf",i.isViewMode&&(i.currentProgram==null?null:i.currentProgram.goals)||i.isEditableMode()),l(2),d("ngIf",((o=i.programForm.get("startDate"))==null?null:o.value)||i.isEditableMode()),l(),d("ngIf",i.isEditableMode()),l(),d("ngIf",(((s=i.programForm.get("cycleLength"))==null?null:s.value)||i.isEditableMode())&&((s=i.programForm.get("programType"))==null?null:s.value)==="cycled"),l(7),d("ngIf",((p=i.programForm.get("programNotes"))==null?null:p.value)||i.isEditableMode()),l(),d("ngIf",((f=i.programForm.get("programType"))==null?null:f.value)==="cycled"),l(),d("ngIf",((k=i.programForm.get("programType"))==null?null:k.value)==="linear"),l(),d("ngIf",!i.isViewMode),l(),d("ngIf",i.isRoutineModalOpen()),l(),d("ngIf",i.isProgramHistoryModalOpen())}},dependencies:[he,pe,ye,_e,He,Ee,Oe,Le,Se,Ie,Be,Fe,Pe,Te,We,Me,Ne,Ve,Ae,Ce,nt,it,rt,tt,Re,De,et,$e,Qe,je,ve,fe,Y],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:.5rem;box-shadow:0 5px 5px -3px #0000001a,0 8px 10px 1px #00000012,0 3px 14px 2px #0000000f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2;border:2px dashed #9ca3af;background-color:#f3f4f6;transition:transform .25s cubic-bezier(0,0,.2,1);border-radius:.5rem}.dark[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{border-color:#4b5563;background-color:#374151}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.scheduled-day-card.cdk-drop-list-dragging[_ngcontent-%COMP%]   .scheduled-day-card[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#9ca3af;border-radius:3px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.dark[_ngcontent-%COMP%]   .custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563}.dark[_ngcontent-%COMP%]   .custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}"]})};export{ot as TrainingProgramBuilderComponent};

import{b as Ee,c as Ce}from"./chunk-FJXOIRY4.js";import"./chunk-MPFUNZLY.js";import{a as me,b as I,c as de,d as pe,g as ge,i as xe,k as ue,l as fe,m as _e,n as ye,o as ve,r as he,t as be}from"./chunk-G73VD3Q6.js";import{a as P}from"./chunk-WGYWCFJ2.js";import{$a as q,Aa as v,Ba as R,Bb as L,Ca as $,D as te,Ea as h,F as ie,Fa as x,Ga as m,Kb as H,M as _,Mb as M,Na as F,Nb as N,O as u,P as f,Q as B,Ra as o,Sa as g,Sb as z,Ta as S,Ua as re,V as E,_b as ce,a as J,ab as ne,ba as U,d as V,da as s,db as y,eb as C,fb as j,hb as k,kb as oe,l as O,la as T,n as Q,p as ee,qa as p,sb as ae,tb as A,ub as D,wb as Y,xa as l,xb as X,y as w,ya as n,yb as se,za as r,zb as le}from"./chunk-LBCPHAYK.js";var Ie=i=>["/library",i];function Te(i,t){if(i&1&&(n(0,"option",21),o(1),y(2,"titlecase"),r()),i&2){let e=t.$implicit;l("value",e),s(),g(C(2,2,e))}}function Fe(i,t){if(i&1&&(n(0,"option",21),o(1),y(2,"titlecase"),r()),i&2){let e=t.$implicit;l("value",e),s(),g(C(2,2,e))}}function Ae(i,t){if(i&1&&(n(0,"span"),o(1," of "),n(2,"strong",23),o(3),r()()),i&2){let e=m(2);s(3),g(e.allExercises().length)}}function De(i,t){if(i&1&&(n(0,"div",22),o(1," Showing "),n(2,"strong",23),o(3),r(),p(4,Ae,4,1,"span",24),o(5," exercises "),r()),i&2){let e=m();s(3),g(e.filteredExercises().length),s(),l("ngIf",e.searchTerm()||e.selectedCategory()||e.selectedMuscleGroup())}}function Le(i,t){if(i&1&&v(0,"img",40),i&2){let e=m().$implicit;l("src",e.imageUrls[0],U)("alt",e.name)}}function Me(i,t){i&1&&(n(0,"div",41)(1,"span",42),o(2,"No Image"),r()())}function Ne(i,t){if(i&1){let e=h();n(0,"div",28),x("click",function(){let c=u(e).$implicit,d=m(3);return f(d.goToExerciseDetails(c.id))}),p(1,Le,1,2,"img",29)(2,Me,3,0,"div",30),n(3,"div",31)(4,"h2",32),o(5),r(),n(6,"p",33),o(7),y(8,"titlecase"),r(),n(9,"p",34),o(10),y(11,"titlecase"),r(),n(12,"p",35),o(13),r(),n(14,"button",36),B(),n(15,"svg",37),v(16,"path",38)(17,"path",39),r(),o(18," View Details "),r()()()}if(i&2){let e=t.$implicit;s(),l("ngIf",e.imageUrls&&e.imageUrls.length>0),s(),l("ngIf",!e.imageUrls||e.imageUrls.length===0),s(3),g(e.name),s(2),g(C(8,7,e.category)),s(3),S("Primary Muscle: ",C(11,9,e.primaryMuscleGroup)),s(3),g(e.description),s(),l("routerLink",q(11,Ie,e.id))}}function Pe(i,t){if(i&1&&(n(0,"div",26),p(1,Ne,19,13,"div",27),r()),i&2){let e=m(2);s(),l("ngForOf",e.filteredExercises())}}function Ue(i,t){i&1&&(n(0,"div",43)(1,"p",44),o(2,"No exercises found matching your criteria."),r()())}function Ge(i,t){if(i&1&&(n(0,"div"),p(1,Pe,2,1,"div",25)(2,Ue,3,0,"ng-template",null,1,k),r()),i&2){let e=F(3),a=m();s(),l("ngIf",a.filteredExercises().length>0)("ngIfElse",e)}}function Ve(i,t){i&1&&(n(0,"div",43)(1,"p",44),o(2,"Loading exercises..."),r()())}var Z=class i{exerciseService=_(P);router=_(M);categories$;primaryMuscleGroups$;selectedCategory=E(null);selectedMuscleGroup=E(null);searchTerm=E("");allExercises=E([]);filteredExercises=oe(()=>{let t=this.allExercises(),e=this.selectedCategory();e&&(t=t.filter(d=>d.category===e));let a=this.selectedMuscleGroup();a&&(t=t.filter(d=>d.primaryMuscleGroup===a));let c=this.searchTerm();return c&&(t=t.filter(d=>d.name.toLowerCase().includes(c)||d.description.toLowerCase().includes(c))),t});constructor(){}ngOnInit(){window.scrollTo(0,0),this.categories$=this.exerciseService.getUniqueCategories(),this.primaryMuscleGroups$=this.exerciseService.getUniquePrimaryMuscleGroups(),this.exerciseService.getExercises().subscribe(t=>{this.allExercises.set(t)})}onCategoryChange(t){let e=t.target;this.selectedCategory.set(e.value||null)}onMuscleGroupChange(t){let e=t.target;this.selectedMuscleGroup.set(e.value||null)}onSearchTermChange(t){let e=t.target;this.searchTerm.set(e.value.toLowerCase())}clearFilters(){this.selectedCategory.set(null),this.selectedMuscleGroup.set(null),this.searchTerm.set("")}goToExerciseDetails(t){this.router.navigate(["/library",t])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-exercise-list"]],decls:37,vars:12,consts:[["loadingOrInitial",""],["noExercisesAfterFilter",""],[1,"container","mx-auto","p-4"],[1,"text-3xl","font-bold","mb-6","text-gray-800","dark:text-gray-200"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],["routerLink","/library/new",1,"bg-green-500","hover:bg-green-600","text-white","font-semibold","py-2","px-4","rounded-md","shadow-sm","transition-colors"],[1,"mb-8","p-4","bg-white","dark:bg-gray-800","rounded-lg","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","items-end"],["for","category-filter",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["id","category-filter",1,"block","w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:text-gray-200",3,"change","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","muscle-group-filter",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["id","muscle-group-filter",1,"block","w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:text-gray-200",3,"change","value"],["for","search-term",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","text","id","search-term","placeholder","Search by name or description...",1,"block","w-full","p-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:ring-primary","focus:border-primary","dark:bg-gray-700","dark:text-gray-200",3,"input","value"],[1,"mt-4","flex","justify-between","items-center"],[1,"px-4","py-2","bg-gray-200","dark:bg-gray-600","text-gray-700","dark:text-gray-200","rounded-md","hover:bg-gray-300","dark:hover:bg-gray-500","text-sm",3,"click"],["class","text-sm text-gray-600 dark:text-gray-400",4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"value"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"text-gray-800","dark:text-gray-200"],[4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf","ngIfElse"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300",3,"click",4,"ngFor","ngForOf"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300",3,"click"],["class","w-full h-48 object-cover",3,"src","alt",4,"ngIf"],["class","w-full h-48 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",4,"ngIf"],[1,"p-6","hover:cursor-pointer"],[1,"text-xl","font-semibold","mb-2","text-primary","dark:text-primary-light"],[1,"text-sm","text-gray-500","dark:text-gray-400","mb-1","capitalize"],[1,"text-sm","text-gray-700","dark:text-gray-300","mb-3"],[1,"text-gray-600","dark:text-gray-400","text-sm","mb-4","line-clamp-3"],["type","button",1,"flex","inline-block","bg-primary","hover:bg-primary-dark","text-white","font-semibold","py-2","px-4","rounded-md","transition-colors","duration-300","focus:outline-none","focus:ring-2","focus:ring-primary-light","focus:ring-opacity-75",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-6","mr-2"],["stroke-linecap","round","stroke-linejoin","round","d","M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"],["stroke-linecap","round","stroke-linejoin","round","d","M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"],[1,"w-full","h-48","object-cover",3,"src","alt"],[1,"w-full","h-48","bg-gray-200","dark:bg-gray-700","flex","items-center","justify-center"],[1,"text-gray-400","dark:text-gray-500"],[1,"text-center","py-10"],[1,"text-xl","text-gray-600","dark:text-gray-400"]],template:function(e,a){if(e&1){let c=h();n(0,"div",2)(1,"h1",3),o(2,"Exercise Library"),r(),n(3,"div",4)(4,"h1",5),o(5,"Exercise Library"),r(),n(6,"button",6),o(7," + Add New Exercise "),r()(),n(8,"div",7)(9,"div",8)(10,"div")(11,"label",9),o(12,"Category"),r(),n(13,"select",10),x("change",function(b){return u(c),f(a.onCategoryChange(b))}),n(14,"option",11),o(15,"All Categories"),r(),p(16,Te,3,4,"option",12),y(17,"async"),r()(),n(18,"div")(19,"label",13),o(20,"Primary Muscle Group"),r(),n(21,"select",14),x("change",function(b){return u(c),f(a.onMuscleGroupChange(b))}),n(22,"option",11),o(23,"All Muscle Groups"),r(),p(24,Fe,3,4,"option",12),y(25,"async"),r()(),n(26,"div")(27,"label",15),o(28,"Search"),r(),n(29,"input",16),x("input",function(b){return u(c),f(a.onSearchTermChange(b))}),r()()(),n(30,"div",17)(31,"button",18),x("click",function(){return u(c),f(a.clearFilters())}),o(32," Clear Filters "),r(),p(33,De,6,2,"div",19),r()(),p(34,Ge,4,2,"div",20)(35,Ve,3,0,"ng-template",null,0,k),r()}if(e&2){let c=F(36);s(13),l("value",a.selectedCategory()||""),s(3),l("ngForOf",C(17,8,a.categories$)),s(5),l("value",a.selectedMuscleGroup()||""),s(3),l("ngForOf",C(25,10,a.primaryMuscleGroups$)),s(5),l("value",a.searchTerm()),s(4),l("ngIf",a.allExercises().length>0),s(),l("ngIf",a.allExercises().length>0)("ngIfElse",c)}},dependencies:[L,A,D,Y,X,N],encapsulation:2})};var Oe=i=>["/library/edit",i],Be=(i,t)=>({"bg-white dark:bg-gray-300":i,"bg-gray-400 dark:bg-gray-600":t});function Re(i,t){if(i&1){let e=h();n(0,"div",9)(1,"button",10),o(2," Edit Exercise "),r(),n(3,"button",11),x("click",function(){let c=u(e).ngIf,d=m();return f(d.confirmDeleteExercise(c))}),o(4," Delete Exercise "),r()()}if(i&2){let e=t.ngIf;s(),l("routerLink",q(1,Oe,e.id))}}function $e(i,t){if(i&1){let e=h();n(0,"button",35),x("click",function(){u(e);let c=m(3);return f(c.prevImage())}),o(1," \u276E "),r()}}function qe(i,t){if(i&1){let e=h();n(0,"button",36),x("click",function(){u(e);let c=m(3);return f(c.nextImage())}),o(1," \u276F "),r()}}function je(i,t){if(i&1){let e=h();n(0,"span",39),x("click",function(){let c=u(e).index,d=m(4);return f(d.currentImageIndex.set(c))}),r()}if(i&2){let e=t.index,a=m(4);l("ngClass",ne(1,Be,a.currentImageIndex()===e,a.currentImageIndex()!==e))}}function Ye(i,t){if(i&1&&(n(0,"div",37),p(1,je,1,4,"span",38),r()),i&2){let e=m(2).ngIf;s(),l("ngForOf",e.imageUrls)}}function Xe(i,t){if(i&1&&(n(0,"div",30),v(1,"img",31),p(2,$e,2,0,"button",32)(3,qe,2,0,"button",33)(4,Ye,2,1,"div",34),r()),i&2){let e=m().ngIf,a=m();s(),l("src",e.imageUrls[a.currentImageIndex()],U)("alt",e.name+" form "+(a.currentImageIndex()+1)),s(),l("ngIf",e.imageUrls.length>1),s(),l("ngIf",e.imageUrls.length>1),s(),l("ngIf",e.imageUrls.length>1)}}function He(i,t){i&1&&(n(0,"div",40)(1,"p",41),o(2,"No image available"),r()())}function ze(i,t){if(i&1&&(n(0,"li"),o(1),r()),i&2){let e=t.$implicit;s(),g(e)}}function Ze(i,t){if(i&1&&(n(0,"li"),o(1),r()),i&2){let e=t.$implicit;s(),g(e)}}function We(i,t){if(i&1&&(n(0,"div",18)(1,"h3",22),o(2,"Equipment Needed"),r(),n(3,"ul",24),p(4,Ze,2,1,"li",25),r()()),i&2){let e=m().ngIf;s(4),l("ngForOf",e.equipmentNeeded)}}function Je(i,t){if(i&1&&(n(0,"div",18)(1,"h3",22),o(2,"Notes & Tips"),r(),n(3,"p",42),o(4),r()()),i&2){let e=m().ngIf;s(4),g(e.notes)}}function Ke(i,t){if(i&1&&(n(0,"div",18)(1,"a",43),B(),n(2,"svg",44),v(3,"path",45),r(),o(4," Watch Video "),r()()),i&2){let e=m().ngIf;s(),l("href",e.videoUrl,U)}}function Qe(i,t){if(i&1&&(n(0,"p",55),o(1),r()),i&2){let e=m().$implicit;l("title",e.notes),s(),S(" Notes: ",e.notes," ")}}function et(i,t){if(i&1&&(n(0,"div",50)(1,"p",51),o(2),r(),n(3,"p",52),o(4),r(),n(5,"p",53),o(6),y(7,"date"),r(),p(8,Qe,2,2,"p",54),r()),i&2){let e=t.$implicit,a=m(3);s(2),g(e.pbType),s(2),g(a.formatPbValue(e)),s(2),S(" Achieved on: ",j(7,4,e.timestamp,"mediumDate")," "),s(2),l("ngIf",e.notes)}}function tt(i,t){if(i&1&&(n(0,"div",46)(1,"h3",47),o(2,"Your Personal Bests"),r(),n(3,"div",48),p(4,et,9,7,"div",49),r()()),i&2){let e=m(2);s(4),l("ngForOf",e.exercisePBs())}}function it(i,t){i&1&&(n(0,"div",46)(1,"p",56),o(2,"No personal bests recorded for this exercise yet. "),r()())}function rt(i,t){if(i&1&&(R(0),p(1,it,3,0,"div",27),$()),i&2){let e=t.ngIf,a=m(2);s(),l("ngIf",a.exercise()&&a.exercisePBs().length===0&&e.length>0)}}function nt(i,t){if(i&1&&(n(0,"div"),o(1),r()),i&2){let e=m().model;s(),S("Reps: ",e.extra.reps)}}function ot(i,t){if(i&1&&(n(0,"div",61)(1,"div")(2,"strong"),o(3),y(4,"date"),r()(),n(5,"div"),o(6),y(7,"number"),r(),p(8,nt,2,1,"div",28),r()),i&2){let e=t.model;s(3),g(j(4,4,e.name,"mediumDate")),s(3),re("",e.series,": ",j(7,7,e.value,"1.0-2")," kg"),s(2),l("ngIf",e.extra&&e.extra.reps)}}function at(i,t){}function st(i,t){if(i&1){let e=h();n(0,"div",57)(1,"h3",58),o(2),r(),n(3,"div",59)(4,"ngx-charts-line-chart",60),x("select",function(c){u(e);let d=m(2);return f(d.onProgressChartSelect(c))}),p(5,ot,9,10,"ng-template",null,1,k)(7,at,0,0,"ng-template",null,2,k),r()()()}if(i&2){let e=m(2);s(2),S("Progress: ",e.progressChartYAxisLabel," Over Time"),s(2),l("view",e.progressChartView)("scheme",e.progressChartColorScheme)("results",e.exerciseProgressChartData())("legend",!1)("xAxis",e.progressChartShowXAxis)("yAxis",e.progressChartShowYAxis)("xAxisLabel",e.progressChartXAxisLabel)("yAxisLabel",e.progressChartYAxisLabel)("timeline",e.progressChartTimeline)("showXAxisLabel",e.progressChartShowXAxisLabel)("showYAxisLabel",e.progressChartShowYAxisLabel)("autoScale",e.progressChartAutoScale)}}function lt(i,t){if(i&1&&(n(0,"div",57)(1,"p",56),o(2," Not enough history for "),n(3,"strong",62),o(4),r(),o(5," to plot a progress trend (need at least 2 workouts for this exercise). Keep logging! "),r()()),i&2){let e,a=m(3);s(4),g((e=a.exercise())==null?null:e.name)}}function ct(i,t){if(i&1&&(R(0),p(1,lt,6,1,"div",29),$()),i&2){let e=t.ngIf,a=m(2);s(),l("ngIf",e&&e.length>0&&!a.hasSufficientProgressData)}}function mt(i,t){if(i&1&&(R(0),n(1,"div",12),p(2,Xe,5,5,"div",13)(3,He,3,0,"div",14),n(4,"div",15)(5,"h1",16),o(6),r(),n(7,"div",5)(8,"span",17),o(9),r()(),n(10,"div",18)(11,"h2",19),o(12,"Description"),r(),n(13,"p",20),o(14),r()(),n(15,"div",21)(16,"div")(17,"h3",22),o(18,"Primary Muscle Group"),r(),n(19,"p",23),o(20),r()(),n(21,"div")(22,"h3",22),o(23,"Other Muscle Groups"),r(),n(24,"ul",24),p(25,ze,2,1,"li",25),r()()(),p(26,We,5,1,"div",26)(27,Je,5,1,"div",26)(28,Ke,5,1,"div",26)(29,tt,5,1,"div",27)(30,rt,2,1,"ng-container",28),y(31,"async"),p(32,st,9,13,"div",29)(33,ct,2,1,"ng-container",28),y(34,"async"),r()(),$()),i&2){let e=t.ngIf,a=m();s(2),l("ngIf",e.imageUrls&&e.imageUrls.length>0),s(),l("ngIf",!e.imageUrls||e.imageUrls.length===0),s(3),g(e.name),s(3),S(" ",e.category," "),s(5),g(e.description),s(6),g(e.primaryMuscleGroup),s(5),l("ngForOf",e.muscleGroups),s(),l("ngIf",e.equipmentNeeded&&e.equipmentNeeded.length>0),s(),l("ngIf",e.notes),s(),l("ngIf",e.videoUrl),s(),l("ngIf",a.exercisePBs().length>0),s(),l("ngIf",C(31,14,a.trackingService.workoutLogs$)),s(2),l("ngIf",a.exercise()&&a.hasSufficientProgressData),s(),l("ngIf",a.exercise()&&C(34,16,a.trackingService.workoutLogs$))}}function dt(i,t){i&1&&(n(0,"div",64)(1,"p",65),o(2,"Loading exercise details..."),r()())}function pt(i,t){i&1&&(n(0,"div",64)(1,"h2",66),o(2,"Exercise Not Found"),r(),n(3,"p",23),o(4,"The exercise you are looking for does not exist or could not be loaded."),r(),n(5,"a",67),o(6,"Go to Library"),r()())}function gt(i,t){if(i&1&&p(0,dt,3,0,"div",63)(1,pt,7,0,"ng-template",null,3,k),i&2){let e=F(2),a=m();l("ngIf",a.exercise()===void 0)("ngIfElse",e)}}var W=class i{route=_(H);router=_(M);exerciseService=_(P);trackingService=_(ce);alertService=_(z);exercise=E(void 0);currentImageIndex=E(0);exercisePBs=E([]);exerciseProgressChartData=E([]);exerciseDetailSub;progressChartView=[700,300];progressChartColorScheme="cool";progressChartXAxisLabel="Date";progressChartYAxisLabel="Max Weight Lifted (kg)";progressChartShowXAxis=!0;progressChartShowYAxis=!0;progressChartGradient=!1;progressChartShowXAxisLabel=!0;progressChartShowYAxisLabel=!0;progressChartTimeline=!0;progressChartAutoScale=!0;id;ngOnInit(){let t=this.id?O(this.id):this.route.paramMap.pipe(Q(e=>e.get("id")));this.exerciseDetailSub=t.pipe(ie(e=>{this.exercise.set(void 0),this.exercisePBs.set([]),this.exerciseProgressChartData.set([]),e?this.loadExerciseData(e):this.exercise.set(null)})).subscribe()}loadExercise(t){this.exerciseService.getExerciseById(t).subscribe(e=>{this.exercise.set(e||null),this.currentImageIndex.set(0)})}nextImage(){let t=this.exercise();t&&t.imageUrls.length>1&&this.currentImageIndex.update(e=>(e+1)%t.imageUrls.length)}prevImage(){let t=this.exercise();t&&t.imageUrls.length>1&&this.currentImageIndex.update(e=>(e-1+t.imageUrls.length)%t.imageUrls.length)}loadExercisePBs(t){this.trackingService.getAllPersonalBestsForExercise(t).pipe(w(1)).subscribe(e=>{let a=e.sort((c,d)=>c.pbType.includes("RM (Actual)")&&!d.pbType.includes("RM (Actual)")?-1:!c.pbType.includes("RM (Actual)")&&d.pbType.includes("RM (Actual)")?1:c.pbType.includes("RM (Estimated)")&&!d.pbType.includes("RM (Estimated)")?-1:!c.pbType.includes("RM (Estimated)")&&d.pbType.includes("RM (Estimated)")?1:(d.weightUsed??0)-(c.weightUsed??0)||c.pbType.localeCompare(d.pbType));this.exercisePBs.set(a),console.log(`PBs for ${t}:`,a)})}formatPbValue(t){let e="";return t.weightUsed!==void 0&&t.weightUsed!==null?(e+=`${t.weightUsed}kg`,t.repsAchieved>1&&!t.pbType.includes("RM (Actual)")&&!t.pbType.includes("RM (Estimated)")?e+=` x ${t.repsAchieved}`:t.repsAchieved>1&&t.pbType==="Heaviest Lifted"&&(e+=` x ${t.repsAchieved}`)):t.repsAchieved>0&&t.pbType.includes("Max Reps")?e=`${t.repsAchieved} reps`:t.durationPerformed&&t.durationPerformed>0&&t.pbType.includes("Max Duration")&&(e=`${t.durationPerformed}s`),e||"N/A"}loadExerciseData(t){ee({baseExercise:this.exerciseService.getExerciseById(t).pipe(w(1)),pbs:this.trackingService.getAllPersonalBestsForExercise(t).pipe(w(1)),progress:this.trackingService.getExercisePerformanceHistory(t).pipe(w(1))}).subscribe(({baseExercise:e,pbs:a,progress:c})=>{this.exercise.set(e||null),this.currentImageIndex.set(0);let d=a.sort((b,K)=>(K.weightUsed??0)-(b.weightUsed??0)||b.pbType.localeCompare(K.pbType));this.exercisePBs.set(d),c&&c.length>0?this.exerciseProgressChartData.set([{name:e?.name||"Max Weight",series:c.map(b=>({name:b.date,value:b.value,extra:{reps:b.reps,logId:b.logId}}))}]):this.exerciseProgressChartData.set([])},e=>{console.error("Error loading exercise details page data:",e),this.exercise.set(null)})}onProgressChartSelect(t){console.log("Progress chart item selected:",t),t.extra&&t.extra.logId}get hasSufficientProgressData(){let t=this.exerciseProgressChartData();return t.length>0&&t[0]&&t[0].series&&t[0].series.length>1}confirmDeleteExercise(t){return V(this,null,function*(){if(!t)return;let e=[{text:"Cancel",role:"cancel",data:!1,cssClass:"bg-gray-300 hover:bg-gray-500"},{text:"Delete Exercise",role:"confirm",data:!0,cssClass:"button-danger"}],a=yield this.alertService.showConfirmationDialog("Confirm Deletion",`Are you sure you want to delete the exercise "${t.name}"? 
      If this exercise is part of any past workout logs, it will be removed from those logs. 
      If a log becomes empty as a result, the entire log might be deleted. This action cannot be undone.`,e);if(a&&a.data===!0)try{yield this.exerciseService.deleteExercise(t.id),this.alertService.showAlert("Success",`Exercise "${t.name}" deleted successfully.`),this.router.navigate(["/library"])}catch(c){console.error("Error deleting exercise:",c),this.alertService.showAlert("Error",`Failed to delete exercise: ${c.message||"Unknown error"}`)}})}ngOnDestroy(){this.exerciseDetailSub?.unsubscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-exercise-detail"]],inputs:{id:"id"},decls:8,vars:3,consts:[["loadingOrNotFound",""],["tooltipTemplate",""],["seriesTooltipTemplate",""],["notFound",""],[1,"container","mx-auto","p-4"],[1,"mb-4"],["routerLink","/library",1,"text-primary","dark:text-primary-light","hover:underline"],["class","space-x-2",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"space-x-2"],[1,"bg-yellow-500","hover:bg-yellow-600","text-white","text-sm","font-medium","py-2","px-3","rounded-md","shadow-sm",3,"routerLink"],[1,"bg-red-500","hover:bg-red-600","text-white","text-sm","font-medium","py-2","px-3","rounded-md","shadow-sm",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","overflow-hidden"],["class","relative",4,"ngIf"],["class","w-full h-64 sm:h-80 md:h-96 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",4,"ngIf"],[1,"p-6","md:p-8"],[1,"text-3xl","md:text-4xl","font-bold","mb-3","text-gray-800","dark:text-gray-100"],[1,"px-3","py-1","text-xs","font-semibold","rounded-full","bg-primary-light","text-primary-dark","dark:bg-primary-dark","dark:text-primary-light","capitalize"],[1,"mb-6"],[1,"text-xl","font-semibold","mb-2","text-gray-700","dark:text-gray-300"],[1,"text-gray-600","dark:text-gray-400","leading-relaxed"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"text-lg","font-semibold","mb-2","text-gray-700","dark:text-gray-300"],[1,"text-gray-600","dark:text-gray-400"],[1,"list-disc","list-inside","text-gray-600","dark:text-gray-400"],[4,"ngFor","ngForOf"],["class","mb-6",4,"ngIf"],["class","mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",4,"ngIf"],[4,"ngIf"],["class","mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"relative"],[1,"w-full","h-64","sm:h-80","md:h-96","object-contain","bg-gray-200","dark:bg-gray-700",3,"src","alt"],["class","absolute top-1/2 left-2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 focus:outline-none",3,"click",4,"ngIf"],["class","absolute top-1/2 right-2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 focus:outline-none",3,"click",4,"ngIf"],["class","absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2",4,"ngIf"],[1,"absolute","top-1/2","left-2","transform","-translate-y-1/2","bg-black","bg-opacity-50","text-white","p-2","rounded-full","hover:bg-opacity-75","focus:outline-none",3,"click"],[1,"absolute","top-1/2","right-2","transform","-translate-y-1/2","bg-black","bg-opacity-50","text-white","p-2","rounded-full","hover:bg-opacity-75","focus:outline-none",3,"click"],[1,"absolute","bottom-2","left-1/2","transform","-translate-x-1/2","flex","space-x-2"],["class","w-3 h-3 rounded-full cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"w-3","h-3","rounded-full","cursor-pointer",3,"click","ngClass"],[1,"w-full","h-64","sm:h-80","md:h-96","bg-gray-200","dark:bg-gray-700","flex","items-center","justify-center"],[1,"text-gray-500","dark:text-gray-400"],[1,"text-gray-600","dark:text-gray-400","whitespace-pre-line"],["target","_blank","rel","noopener noreferrer",1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","shadow-sm","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"href"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5","mr-2"],["d","M3 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H3Zm10 6.004a.75.75 0 0 0-.504-.705l-4.25-2.125a.75.75 0 0 0-1.042.705v4.25a.75.75 0 0 0 1.042.705l4.25-2.125A.75.75 0 0 0 13 10.004Z"],[1,"mt-6","pt-6","border-t","border-gray-200","dark:border-gray-700"],[1,"text-xl","font-semibold","mb-3","text-gray-700","dark:text-gray-300"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-4","mb-2"],["class","p-4 bg-gray-50 dark:bg-gray-750 rounded-lg border dark:border-gray-600 shadow-sm",4,"ngFor","ngForOf"],[1,"p-4","bg-gray-50","dark:bg-gray-750","rounded-lg","border","dark:border-gray-600","shadow-sm"],[1,"text-sm","font-medium","text-primary","dark:text-primary-light"],[1,"text-2xl","font-bold","text-gray-800","dark:text-gray-100","mt-1"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],["class","mt-2 text-xs italic text-gray-500 dark:text-gray-400 line-clamp-2",3,"title",4,"ngIf"],[1,"mt-2","text-xs","italic","text-gray-500","dark:text-gray-400","line-clamp-2",3,"title"],[1,"text-md","text-gray-600","dark:text-gray-400","italic"],[1,"mt-8","pt-6","border-t","border-gray-200","dark:border-gray-700"],[1,"text-xl","font-semibold","mb-4","text-gray-700","dark:text-gray-300"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow-md","min-h-[350px]"],[3,"select","view","scheme","results","legend","xAxis","yAxis","xAxisLabel","yAxisLabel","timeline","showXAxisLabel","showYAxisLabel","autoScale"],[1,"p-2","bg-gray-700","text-white","rounded","shadow-lg","text-xs"],[1,"dark:text-gray-200"],["class","text-center py-10",4,"ngIf","ngIfElse"],[1,"text-center","py-10"],[1,"text-xl","text-gray-600","dark:text-gray-400"],[1,"text-2xl","font-semibold","mb-4","text-gray-700","dark:text-gray-200"],["routerLink","/library",1,"mt-4","inline-block","bg-primary","hover:bg-primary-dark","text-white","font-semibold","py-2","px-4","rounded-md"]],template:function(e,a){if(e&1&&(n(0,"div",4)(1,"div",5)(2,"a",6),o(3,"\u2190 Back to Library"),r(),p(4,Re,5,3,"div",7),r()(),p(5,mt,35,18,"ng-container",8)(6,gt,3,2,"ng-template",null,0,k)),e&2){let c=F(7);s(4),l("ngIf",a.exercise()),s(),l("ngIf",a.exercise())("ngIfElse",c)}},dependencies:[L,ae,A,D,Y,le,se,N,Ce,Ee],encapsulation:2})};function xt(i,t){if(i&1&&(n(0,"option",27),o(1),y(2,"titlecase"),r()),i&2){let e=t.$implicit;l("value",e),s(),g(C(2,2,e))}}function ut(i,t){if(i&1&&(n(0,"option",27),o(1),r()),i&2){let e=t.$implicit;l("value",e),s(),g(e)}}function ft(i,t){if(i&1){let e=h();n(0,"div",28),v(1,"input",29),n(2,"button",30),x("click",function(){let c=u(e).index,d=m();return f(d.removeControlFromFormArray("muscleGroups",c))}),o(3,"Remove"),r()()}if(i&2){let e=t.index;s(),l("formControlName",e)}}function _t(i,t){if(i&1){let e=h();n(0,"div",28),v(1,"input",29),n(2,"button",30),x("click",function(){let c=u(e).index,d=m();return f(d.removeControlFromFormArray("equipmentNeeded",c))}),o(3,"Remove"),r()()}if(i&2){let e=t.index;s(),l("formControlName",e)}}function yt(i,t){if(i&1){let e=h();n(0,"div",28),v(1,"input",32),n(2,"button",30),x("click",function(){let c=u(e).index,d=m(2);return f(d.removeControlFromFormArray("imageUrls",c))}),o(3,"Remove"),r()()}if(i&2){let e=t.index;s(),l("formControlName",e)}}function vt(i,t){if(i&1){let e=h();n(0,"div",31)(1,"h3",15),o(2,"Image URLs (one per line)"),r(),p(3,yt,4,1,"div",16),n(4,"button",17),x("click",function(){u(e);let c=m();return f(c.addControlToFormArray("imageUrls"))}),o(5,"+ Add Image URL"),r()()}if(i&2){let e=m();s(3),l("ngForOf",e.getFormArray("imageUrls").controls)}}var G=class i{fb=_(he);router=_(M);route=_(H);exerciseService=_(P);alertService=_(z);exerciseForm;isEditMode=E(!1);editingExerciseId=null;pageTitle=E("Add New Exercise");categories=["barbells","dumbbells","bodyweight","machines","cables","kettlebells","bands","other"];availableMuscleGroups=["Chest","Back","Legs","Shoulders","Biceps","Triceps","Abs","Calves","Forearms","Glutes","Hamstrings","Lats","Quads","Traps"];constructor(){this.exerciseForm=this.fb.group({name:["",I.required],description:["",I.required],category:["bodyweight",I.required],primaryMuscleGroup:["",I.required],muscleGroups:this.fb.array([]),equipmentNeeded:this.fb.array([]),imageUrls:this.fb.array([]),videoUrl:[""],notes:[""]})}ngOnInit(){this.route.paramMap.pipe(te(t=>(this.editingExerciseId=t.get("id"),this.editingExerciseId?(this.isEditMode.set(!0),this.pageTitle.set("Edit Exercise"),this.exerciseService.getExerciseById(this.editingExerciseId)):O(null))),w(1)).subscribe(t=>{t&&this.isEditMode()&&this.patchFormForEditing(t)})}patchFormForEditing(t){this.exerciseForm.patchValue({name:t.name,description:t.description,category:t.category,primaryMuscleGroup:t.primaryMuscleGroup,videoUrl:t.videoUrl||"",notes:t.notes||""}),this.setFormArrayControls("muscleGroups",t.muscleGroups),this.setFormArrayControls("equipmentNeeded",t.equipmentNeeded||[]),this.setFormArrayControls("imageUrls",t.imageUrls)}getFormArray(t){return this.exerciseForm.get(t)}setFormArrayControls(t,e){let a=this.getFormArray(t);a.clear(),e.forEach(c=>a.push(this.fb.control(c,I.required)))}addControlToFormArray(t){this.getFormArray(t).push(this.fb.control("",I.required))}removeControlFromFormArray(t,e){this.getFormArray(t).removeAt(e)}onSubmit(){return V(this,null,function*(){if(this.exerciseForm.invalid){this.exerciseForm.markAllAsTouched(),this.alertService.showAlert("Error","Please fill in all required fields.");return}let t=this.exerciseForm.value,e=J({},t);try{if(this.isEditMode()&&this.editingExerciseId)yield this.exerciseService.updateExercise(J({id:this.editingExerciseId},e)).toPromise(),this.alertService.showAlert("Success","Exercise updated successfully!"),this.router.navigate(["/library",this.editingExerciseId]);else{let a=yield this.exerciseService.addExercise(e).toPromise();a?(this.alertService.showAlert("Success","Exercise added successfully!"),this.router.navigate(["/library",a.id])):(console.error("Failed to add exercise, newExercise is undefined."),this.alertService.showAlert("Error","Failed to add exercise. Please try again."))}}catch(a){console.error("Error saving exercise:",a),this.alertService.showAlert("Error",`Failed to save exercise: ${a.message}`)}})}get f(){return this.exerciseForm.controls}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-exercise-form"]],decls:51,vars:9,consts:[[1,"container","mx-auto","p-4"],[1,"mb-6","pb-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-3xl","font-bold","text-gray-800","dark:text-gray-200"],[1,"space-y-6","bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md",3,"ngSubmit","formGroup"],["for","name",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","name","formControlName","name",1,"mt-1","block","w-full","p-2","border","rounded-md"],["for","description",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","p-2","border","rounded-md"],["for","category",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","category","formControlName","category",1,"mt-1","block","w-full","p-2","border","rounded-md"],[3,"value",4,"ngFor","ngForOf"],["for","primaryMuscleGroup",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","primaryMuscleGroup","formControlName","primaryMuscleGroup",1,"mt-1","block","w-full","p-2","border","rounded-md"],["value",""],["formArrayName","muscleGroups"],[1,"text-lg","font-medium"],["class","flex items-center space-x-2 mb-2",4,"ngFor","ngForOf"],["type","button",1,"text-sm","text-blue-600",3,"click"],["formArrayName","equipmentNeeded"],["formArrayName","imageUrls",4,"ngIf"],["for","videoUrl",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","url","id","videoUrl","formControlName","videoUrl",1,"mt-1","block","w-full","p-2","border","rounded-md"],["for","notes",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","notes","formControlName","notes","rows","3",1,"mt-1","block","w-full","p-2","border","rounded-md"],[1,"pt-6","flex","justify-end","space-x-3"],["routerLink","/library",1,"px-4","py-2","border","rounded-md"],["type","submit",1,"px-4","py-2","bg-primary","text-white","rounded-md","disabled:opacity-50",3,"disabled"],[3,"value"],[1,"flex","items-center","space-x-2","mb-2"],["type","text",1,"block","w-full","p-2","border","rounded-md",3,"formControlName"],["type","button",1,"text-red-500",3,"click"],["formArrayName","imageUrls"],["type","url","placeholder","https://example.com/image.jpg",1,"block","w-full","p-2","border","rounded-md",3,"formControlName"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"header",1)(2,"h1",2),o(3),r()(),n(4,"form",3),x("ngSubmit",function(){return a.onSubmit()}),n(5,"div")(6,"label",4),o(7,"Name"),r(),v(8,"input",5),r(),n(9,"div")(10,"label",6),o(11,"Description"),r(),v(12,"textarea",7),r(),n(13,"div")(14,"label",8),o(15,"Category"),r(),n(16,"select",9),p(17,xt,3,4,"option",10),r()(),n(18,"div")(19,"label",11),o(20,"Primary Muscle Group"),r(),n(21,"select",12)(22,"option",13),o(23,"Select Primary Muscle"),r(),p(24,ut,2,2,"option",10),r()(),n(25,"div",14)(26,"h3",15),o(27,"Other Muscle Groups"),r(),p(28,ft,4,1,"div",16),n(29,"button",17),x("click",function(){return a.addControlToFormArray("muscleGroups")}),o(30,"+ Add Muscle Group"),r()(),n(31,"div",18)(32,"h3",15),o(33,"Equipment Needed"),r(),p(34,_t,4,1,"div",16),n(35,"button",17),x("click",function(){return a.addControlToFormArray("equipmentNeeded")}),o(36,"+ Add Equipment"),r()(),p(37,vt,6,1,"div",19),n(38,"div")(39,"label",20),o(40,"Video URL (Optional)"),r(),v(41,"input",21),r(),n(42,"div")(43,"label",22),o(44,"Notes & Tips (Optional)"),r(),v(45,"textarea",23),r(),n(46,"div",24)(47,"a",25),o(48,"Cancel"),r(),n(49,"button",26),o(50),r()()()()),e&2&&(s(3),g(a.pageTitle()),s(),l("formGroup",a.exerciseForm),s(13),l("ngForOf",a.categories),s(7),l("ngForOf",a.availableMuscleGroups),s(4),l("ngForOf",a.getFormArray("muscleGroups").controls),s(6),l("ngForOf",a.getFormArray("equipmentNeeded").controls),s(3),l("ngIf",!1),s(12),l("disabled",a.exerciseForm.invalid),s(),S(" ",a.isEditMode()?"Update Exercise":"Add Exercise"," "))},dependencies:[L,A,D,X,be,ge,ye,ve,me,_e,de,pe,xe,fe,ue,N],encapsulation:2})};var fi=[{path:"",component:Z,title:"Exercise Library"},{path:"new",component:G,title:"Add New Exercise"},{path:"edit/:id",component:G,title:"Edit Exercise"},{path:":id",component:W,title:"Exercise Details"}];export{fi as EXERCISE_LIBRARY_ROUTES};

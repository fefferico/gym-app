import{a as ge}from"./chunk-V7TNFXUY.js";import{b as A,c as E}from"./chunk-OIGCPF6S.js";import{b as de,d as ue,f as pe,g as W}from"./chunk-NTS7M73X.js";import{a as fe}from"./chunk-YMRCQEYM.js";import{c as T,d as h,g as y,h as w,i as M}from"./chunk-CODN2FZP.js";import{$ as H,Aa as s,Ab as oe,Ba as u,Bb as re,Ca as g,Cb as $,D as U,Da as b,Db as ae,Ea as P,Eb as se,Ec as me,Fa as j,Fc as O,Ha as I,Ia as x,Ja as c,Ka as X,Kb as le,L as q,La as Y,Lb as z,P as v,R as C,S as k,Sa as Z,T as J,Tb as ce,Ua as V,Va as ee,Wa as N,da as F,g as R,ga as L,ha as d,pa as B,sa as Q,sb as te,tb as ne,ua as p,ub as ie,va as G}from"./chunk-UP6OOZGM.js";function be(n,t){n&1&&b(0,"div",8)}function he(n,t){if(n&1&&b(0,"span",11),n&2){let e=c(2).$implicit,i=c(3);s("innerHTML",i.sanitizeSvg(e.iconSvg),F)("ngClass",e.iconClass||"w-4 h-4 mr-2")}}function Me(n,t){if(n&1){let e=I();u(0,"button",9),x("click",function(o){C(e);let r=c().$implicit,l=c(3);return k(l.onItemClicked(o,r))}),p(1,he,1,2,"span",10),V(2),g()}if(n&2){let e=c().$implicit;s("ngClass",e.buttonClass||"w-full text-left px-3 py-1.5 sm:px-4 sm:py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center text-sm"),d(),s("ngIf",e.iconSvg),d(),N(" ",e.label," ")}}function Se(n,t){if(n&1&&(P(0),p(1,be,1,0,"div",6)(2,Me,3,3,"button",7),j()),n&2){let e=t.$implicit;d(),s("ngIf",e.isDivider),d(),s("ngIf",!e.isDivider)}}function De(n,t){if(n&1&&(u(0,"div",4),p(1,Se,3,2,"ng-container",5),g()),n&2){let e=c(2);s("@dropdownMenu",void 0)("ngClass",e.dropdownMenuClass),d(),s("ngForOf",e.items)}}function Ie(n,t){if(n&1&&(u(0,"div"),p(1,De,2,3,"div",3),g()),n&2){let e=c();d(),s("ngIf",e.isVisible)}}function Te(n,t){if(n&1&&b(0,"span",11),n&2){let e=c(2).$implicit,i=c(3);Z("mr-1",i.showLabelInCompact(e)),s("innerHTML",i.sanitizeSvg(e.iconSvg),F)("ngClass",e.iconClass||"w-4 h-4")}}function Ee(n,t){if(n&1&&(u(0,"span"),V(1),g()),n&2){let e=c(2).$implicit;d(),ee(e.label)}}function Le(n,t){if(n&1){let e=I();u(0,"button",13),x("click",function(o){C(e);let r=c().$implicit,l=c(3);return k(l.onItemClicked(o,r))}),p(1,Te,1,4,"span",14)(2,Ee,2,1,"span",15),g()}if(n&2){let e=c().$implicit,i=c(3);s("title",e.label)("ngClass",e.buttonClass||`flex-1 text-xs min-w-[60px] flex items-center justify-center p-1.5
                rounded-md transition-colors `),d(),s("ngIf",e.iconSvg),d(),s("ngIf",i.showLabelInCompact(e))}}function Ve(n,t){if(n&1&&(P(0),p(1,Le,3,4,"button",12),j()),n&2){let e=t.$implicit;d(),s("ngIf",!e.isDivider)}}function Ae(n,t){if(n&1&&(u(0,"div",4),p(1,Ve,2,1,"ng-container",5),g()),n&2){let e=c(2);s("@compactBar",void 0)("ngClass",e.compactBarClass),d(),s("ngForOf",e.items)}}function We(n,t){if(n&1&&(u(0,"div"),p(1,Ae,2,3,"div",3),g()),n&2){let e=c();d(),s("ngIf",e.isVisible)}}var Oe=T("dropdownMenu",[M(":enter",[y({opacity:0,transform:"scale(0.95) translateY(-10px)"}),h("100ms ease-out",y({opacity:1,transform:"scale(1) translateY(0)"}))]),M(":leave",[h("75ms ease-in",y({opacity:0,transform:"scale(0.95) translateY(-10px)"}))])]),He=T("compactBar",[w("void",y({height:"0px",opacity:0,overflow:"hidden",paddingTop:"0",paddingBottom:"0",marginTop:"0",marginBottom:"0"})),w("*",y({height:"*",opacity:1,overflow:"hidden",paddingTop:"0.5rem",paddingBottom:"0.5rem"})),M("void <=> *",h("200ms ease-in-out"))]),_e=class n{sanitizer=v(ce);elRef=v(H);items=[];isVisible=!1;displayMode="dropdown";dropdownMenuClass="origin-top-right absolute right-0 top-full mt-1 sm:mt-2 w-40 sm:w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black dark:ring-gray-600 ring-opacity-5 focus:outline-none py-1 z-[60]";compactBarClass="flex flex-wrap gap-1.5 justify-center z-20 rounded-b-lg grid-cols-3";itemClick=new G;closeMenu=new G;onDocumentClick(t){this.isVisible&&!this.elRef.nativeElement.contains(t.target)&&this.closeMenu.emit()}onItemClicked(t,e){t.stopPropagation(),e.isDivider||(this.itemClick.emit({actionKey:e.actionKey??"",data:e.data}),this.displayMode==="dropdown"&&this.closeMenu.emit())}sanitizeSvg(t){return t?this.sanitizer.bypassSecurityTrustHtml(t):null}showLabelInCompact(t){return!!t.label}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["app-action-menu"]],hostBindings:function(e,i){e&1&&x("click",function(r){return i.onDocumentClick(r)},L)},inputs:{items:"items",isVisible:"isVisible",displayMode:"displayMode",dropdownMenuClass:"dropdownMenuClass",compactBarClass:"compactBarClass"},outputs:{itemClick:"itemClick",closeMenu:"closeMenu"},decls:4,vars:3,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"hidden","dark:hover:text-gray-100"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[4,"ngFor","ngForOf"],["class","my-0.5 sm:my-1 border-t border-gray-200 dark:border-gray-600",4,"ngIf"],["type","button","class","transition-colors duration-150 ease-in-out",3,"ngClass","click",4,"ngIf"],[1,"my-0.5","sm:my-1","border-t","border-gray-200","dark:border-gray-600"],["type","button",1,"transition-colors","duration-150","ease-in-out",3,"click","ngClass"],[3,"innerHTML","ngClass",4,"ngIf"],[3,"innerHTML","ngClass"],["type","button",3,"title","ngClass","click",4,"ngIf"],["type","button",3,"click","title","ngClass"],[3,"innerHTML","ngClass","mr-1",4,"ngIf"],[4,"ngIf"]],template:function(e,i){e&1&&(P(0,0),p(1,Ie,2,1,"div",1)(2,We,2,1,"div",1),j(),b(3,"div",2)),e&2&&(s("ngSwitch",i.displayMode),d(),s("ngSwitchCase","dropdown"),d(),s("ngSwitchCase","compact-bar"))},dependencies:[z,oe,re,$,ae,se],encapsulation:2,data:{animation:[Oe,He]},changeDetection:0})};var ye=class n{decimalPipe=v(le);unitsService=v(ge);transform(t,e="1.0-2"){if(t==null)return null;let i=this.unitsService.convertFromKg(t,this.unitsService.currentUnit()),o=this.decimalPipe.transform(i,e),r=this.unitsService.getUnitLabel();return`${o} ${r}`}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=Q({name:"weightUnit",type:n,pure:!0})};var Be=["*",[["","modal-footer",""]]],Pe=["*","[modal-footer]"];function je(n,t){if(n&1&&(u(0,"h3",11),V(1),g()),n&2){let e=c(3);d(),N(" ",e.modalTitle()," ")}}function Ne(n,t){if(n&1){let e=I();u(0,"div",6),p(1,je,2,1,"h3",7),u(2,"button",8),x("click",function(){C(e);let o=c(2);return k(o.closeModal())}),J(),u(3,"svg",9),b(4,"path",10),g()()()}if(n&2){let e=c(2);d(),s("ngIf",e.modalTitle())}}function $e(n,t){if(n&1){let e=I();u(0,"div",1),x("click",function(){C(e);let o=c();return k(o.closeModal())}),u(1,"div",2),x("click",function(o){C(e);let r=c();return k(r.onDialogClick(o))}),p(2,Ne,5,1,"div",3),u(3,"div",4),Y(4),g(),u(5,"div",5),Y(6,1),g()()()}if(n&2){let e=c();s("@modalAnimation",e.animationState),d(),s("@dialogAnimation",e.animationState),d(),s("ngIf",e.modalTitle()||!0)}}var ve=class n{elementRef=v(H);isOpen=ie(!1);modalTitle=ne();closed=te();get animationState(){return this.isOpen()?"open":"closed"}closeModal(){this.isOpen.set(!1),this.closed.emit()}onDialogClick(t){t.stopPropagation()}onDocumentMouseDown(t){this.isOpen()&&this.elementRef.nativeElement.contains(t.target)&&t.target.classList.contains("modal-container")&&this.closeModal()}onEscapeKey(){this.isOpen()&&this.closeModal()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=B({type:n,selectors:[["app-modal"]],hostBindings:function(e,i){e&1&&x("mousedown",function(r){return i.onDocumentMouseDown(r)},L)("keydown.escape",function(){return i.onEscapeKey()},L)},inputs:{isOpen:[1,"isOpen"],modalTitle:[1,"modalTitle"]},outputs:{isOpen:"isOpenChange",closed:"closed"},ngContentSelectors:Pe,decls:1,vars:1,consts:[["class","modal-container fixed inset-0 z-[1000] flex items-center justify-center bg-black bg-opacity-60",3,"click",4,"ngIf"],[1,"modal-container","fixed","inset-0","z-[1000]","flex","items-center","justify-center","bg-black","bg-opacity-60",3,"click"],[1,"modal-dialog","mx-2","bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","min-w-[300px]","w-full","max-w-lg","md:max-w-xl","lg:max-w-2xl","max-h-[90vh]","flex","flex-col","overflow-hidden",3,"click"],["class","modal-header flex items-center justify-between ml-1 p-1 md:p-1 border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"modal-body","p-1","md:p-1","space-y-4","overflow-y-auto","flex-grow"],[1,"modal-footer","flex","items-center","p-4","md:p-5","border-t","border-gray-200","dark:border-gray-700","rounded-b"],[1,"modal-header","flex","items-center","justify-between","ml-1","p-1","md:p-1","border-gray-200","dark:border-gray-700"],["class","text-xl font-semibold text-gray-900 dark:text-white",4,"ngIf"],["type","button","aria-label","Close modal",1,"modal-close-button","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","dark:hover:bg-gray-600","dark:hover:text-white","rounded-lg","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"]],template:function(e,i){e&1&&(X(Be),p(0,$e,7,3,"div",0)),e&2&&s("ngIf",i.isOpen())},dependencies:[z,$],styles:[".modal-footer[_ngcontent-%COMP%]:empty{display:none}"],data:{animation:[T("modalAnimation",[w("closed",y({opacity:0,visibility:"hidden"})),w("open",y({opacity:1,visibility:"visible"})),M("closed <=> open",[h("300ms ease-in-out")])]),T("dialogAnimation",[w("closed",y({opacity:0,transform:"scale(0.95) translateY(20px)",visibility:"hidden"})),w("open",y({opacity:1,transform:"scale(1) translateY(0)",visibility:"visible"})),M("closed <=> open",[h("300ms ease-in-out")])])]}})};function xe(n,t){return me(n,t?.in).getFullYear()}var we=class n{exerciseService=v(fe);constructor(){}calculateSetVolume(t){return(t.repsAchieved||0)*(t.weightUsed||0)}calculateWorkoutVolume(t){let e=0;return t.exercises.forEach(i=>{i.sets.forEach(o=>{e+=this.calculateSetVolume(o)})}),e}calculateTotalVolumeForAllLogs(t){return t.reduce((e,i)=>e+this.calculateWorkoutVolume(i),0)}getWeeklySummaries(t){if(!t||t.length===0)return[];let e=new Map;return t.forEach(i=>{let o=new Date(i.startTime),r=xe(o),l=pe(o,{weekStartsOn:1}),a=`${r}-W${String(l).padStart(2,"0")}`,f=de(o,{weekStartsOn:1}),S=`Week ${l}, ${r}`,m=W(f,"dd/MM"),_=W(E(f,-6),"dd/MM");e.has(a)||e.set(a,{weekNumber:l,year:r,weekLabel:S,weekLabelStart:m,weekLabelEnd:_,workoutCount:0,totalVolume:0});let D=e.get(a);D.workoutCount++,D.totalVolume+=this.calculateWorkoutVolume(i)}),Array.from(e.values()).sort((i,o)=>i.year===o.year?i.weekNumber-o.weekNumber:i.year-o.year)}getWeeklyVolumeForChart(t){return this.getWeeklySummaries(t).map(i=>({date:new Date(i.year,0,i.weekNumber*7-6),weekLabel:i.weekLabel,totalVolume:i.totalVolume})).sort((i,o)=>i.date.getTime()-o.date.getTime())}getPerformanceByMuscleGroup(t){return R(this,null,function*(){if(!t||t.length===0)return[];let e=new Map,i=yield new Promise(r=>{this.exerciseService.getExercises().pipe(U(1)).subscribe(l=>r(l))}),o=new Map(i.map(r=>[r.id,r]));return t.forEach(r=>{let l=new Set;r.exercises.forEach(a=>{let f=o.get(a.exerciseId);if(f&&f.muscleGroups){let S=a.sets.reduce((m,_)=>m+this.calculateSetVolume(_),0);f.muscleGroups.forEach(m=>{let _=m.toLowerCase().trim();e.has(_)||e.set(_,{volume:0,workoutCountSet:new Set});let D=e.get(_);D.volume+=S,l.add(_)})}}),l.forEach(a=>{e.get(a)?.workoutCountSet.add(r.id)})}),Array.from(e.entries()).map(([r,l])=>({muscleGroup:r,volume:Math.round(l.volume),workoutCount:l.workoutCountSet.size})).sort((r,l)=>l.volume-r.volume)})}calculateCurrentWorkoutStreak(t){let e={length:0};if(!t||t.length===0)return e;let i=[...new Set(t.map(m=>W(O(m.date),"yyyy-MM-dd")))].map(m=>O(m)).sort((m,_)=>_.getTime()-m.getTime());if(i.length===0)return e;let o=0,r,l,a=new Date;if(a.setHours(0,0,0,0),i.some(m=>A(m,a)))o=1,r=new Date(a),l=new Date(a),a=E(a,1);else{let m=E(a,1);if(i.some(D=>A(D,m)))o=1,r=new Date(m),l=new Date(m),a=E(m,1);else return e}let S=!1;for(let m of i){if(!S){A(m,r)&&(S=!0);continue}if(A(m,a))o++,l=new Date(m),a=E(a,1);else break}return{length:o,startDate:l,endDate:r}}calculateLongestWorkoutStreak(t){let e={length:0};if(!t||t.length<1)return e;let i=[...new Set(t.map(a=>W(O(a.date),"yyyy-MM-dd")))].map(a=>O(a)).sort((a,f)=>a.getTime()-f.getTime());if(i.length===0)return e;let o={length:0},r=0,l;for(let a=0;a<i.length;a++){let f=i[a];a===0||ue(f,i[a-1])!==1?(r=1,l=f):r++,r>o.length&&(o={length:r,startDate:l,endDate:f})}return o}static \u0275fac=function(e){return new(e||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})};export{_e as a,ye as b,ve as c,we as d};

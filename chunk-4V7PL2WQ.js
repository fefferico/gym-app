import{a as M,b as O,c as G}from"./chunk-4BTQAMDT.js";import{a as ie}from"./chunk-5VULP62F.js";import{f as ae,i as f,l as se}from"./chunk-LVDUNZXW.js";import{h as w,s as k}from"./chunk-7F2OANWO.js";import{Bb as F,Cb as Z,Db as E,Eb as ee,Ja as b,K as C,Ka as u,Kb as te,La as v,Ma as Y,Mb as oe,O as y,Qa as T,Ra as x,Sa as g,T as _,Ta as U,U as L,Ua as I,V as H,Xb as re,Y as B,ba as K,bb as q,db as J,ia as W,id as ne,ja as h,mb as Q,na as R,ra as $,rb as X,rc as j,sc as A,vc as S,wa as V,wc as D,xc as z,z as P}from"./chunk-D5SNA2MW.js";import{g as N}from"./chunk-GAL4ENT6.js";var le=class a{cardColors=["#7f1d1d","#86198f","#4a044e","#1e1b4b","#1e3a8a","#064e3b","#14532d","#b91c1c","#c026d3","#701a75","#312e81","#2563eb","#047857","#15803d","#f97316","#ca8a04","#4d7c0f","#0f766e","#0369a1","#1d4ed8","#5b21b6"];getCardColors(){return this.cardColors}getTailwindColorClass(o){return o?{"#7f1d1d":"border-routine-red-800","#86198f":"border-routine-purple-800","#4a044e":"border-routine-purple-900","#1e1b4b":"border-routine-indigo-900","#1e3a8a":"border-routine-blue-800","#064e3b":"border-routine-green-900","#14532d":"border-routine-green-800","#b91c1c":"border-routine-red-700","#c026d3":"border-routine-purple-700","#701a75":"border-routine-purple-850","#312e81":"border-routine-indigo-800","#2563eb":"border-routine-blue-700","#047857":"border-routine-green-700","#15803d":"border-routine-green-600","#f97316":"border-routine-orange-500","#ca8a04":"border-routine-yellow-600","#4d7c0f":"border-routine-lime-700","#0f766e":"border-routine-teal-700","#0369a1":"border-routine-teal-600","#1d4ed8":"border-routine-blue-900","#5b21b6":"border-routine-violet-700"}[o]||"bg-gray-200":""}static \u0275fac=function(e){return new(e||a)};static \u0275prov=C({token:a,factory:a.\u0275fac,providedIn:"root"})};var ge=["*",[["","modal-footer",""]]],ke=["*","[modal-footer]"],be=a=>({"items-center justify-center":a}),we=(a,o,e,r,n,t)=>({"rounded-md mx-2 min-w-[300px] w-full max-h-[90vh]":a,"max-w-sm":o,"max-w-md":e,"max-w-lg":r,"max-w-2xl":n,"w-screen h-screen rounded-none":t});function ye(a,o){if(a&1&&(u(0,"h3",11),q(1),v()),a&2){let e=g(3);h(),J(" ",e.modalTitle()," ")}}function he(a,o){if(a&1){let e=T();u(0,"div",6),V(1,ye,2,1,"h3",7),u(2,"button",8),x("click",function(){_(e);let n=g(2);return L(n.closeModal())}),H(),u(3,"svg",9),Y(4,"path",10),v()()()}if(a&2){let e=g(2);h(),b("ngIf",e.modalTitle())}}function ve(a,o){if(a&1){let e=T();u(0,"div",1),x("click",function(){_(e);let n=g();return L(n.closeModal())}),u(1,"div",2),x("click",function(n){_(e);let t=g();return L(t.onDialogClick(n))}),V(2,he,5,1,"div",3),u(3,"div",4),I(4),v(),u(5,"div",5),I(6,1),v()()()}if(a&2){let e=g();b("@modalAnimation",e.animationState)("ngClass",Q(5,be,e.size()!=="fullscreen"&&!e.forceFullScreen())),h(),b("@dialogAnimation",e.animationState)("ngClass",X(7,we,e.size()!=="fullscreen"&&!e.forceFullScreen(),e.size()==="sm"&&!e.forceFullScreen(),e.size()==="md"&&!e.forceFullScreen(),e.size()==="lg"&&!e.forceFullScreen(),e.size()==="xl"&&!e.forceFullScreen(),e.size()==="fullscreen"||e.forceFullScreen())),h(),b("ngIf",e.modalTitle()||!0)}}var de=class a{constructor(o){this.document=o;F(()=>{this.isOpen()?this.document.body.classList.add("overflow-hidden"):this.document.body.classList.remove("overflow-hidden")}),F(e=>{e(()=>{this.document.body.classList.remove("overflow-hidden")})})}elementRef=y(K);isOpen=ee(!1);modalTitle=E();closed=Z();size=E("lg");forceFullScreen=E(!1);get animationState(){return this.isOpen()?"open":"closed"}closeModal(){this.isOpen.set(!1),this.closed.emit()}onDialogClick(o){o.stopPropagation()}onDocumentMouseDown(o){this.isOpen()&&this.elementRef.nativeElement.contains(o.target)&&o.target.classList.contains("modal-container")&&this.closeModal()}onEscapeKey(){this.isOpen()&&this.closeModal()}static \u0275fac=function(e){return new(e||a)(R(B))};static \u0275cmp=$({type:a,selectors:[["app-modal"]],hostBindings:function(e,r){e&1&&x("mousedown",function(t){return r.onDocumentMouseDown(t)},W)("keydown.escape",function(){return r.onEscapeKey()},W)},inputs:{isOpen:[1,"isOpen"],modalTitle:[1,"modalTitle"],size:[1,"size"],forceFullScreen:[1,"forceFullScreen"]},outputs:{isOpen:"isOpenChange",closed:"closed"},ngContentSelectors:ke,decls:1,vars:1,consts:[["class","modal-container fixed inset-0 z-[1000] flex bg-black bg-opacity-60",3,"ngClass","click",4,"ngIf"],[1,"modal-container","fixed","inset-0","z-[1000]","flex","bg-black","bg-opacity-60",3,"click","ngClass"],[1,"modal-dialog","bg-white","dark:bg-gray-800","shadow-xl","flex","flex-col","overflow-hidden",3,"click","ngClass"],["class","modal-header flex items-center justify-between ml-1 p-1 md:p-1 border-gray-200 dark:border-gray-700 flex-shrink-0",4,"ngIf"],[1,"modal-body","p-1","md:p-1","space-y-4","overflow-y-auto","flex-grow","custom-scrollbar"],[1,"modal-footer","flex","items-center","p-4","md:p-5","border-t","border-gray-200","dark:border-gray-700","rounded-b","flex-shrink-0"],[1,"modal-header","flex","items-center","justify-between","ml-1","p-1","md:p-1","border-gray-200","dark:border-gray-700","flex-shrink-0"],["class","text-xl font-semibold text-gray-900 dark:text-white",4,"ngIf"],["type","button","aria-label","Close modal",1,"modal-close-button","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","dark:hover:bg-gray-600","dark:hover:text-white","rounded-md","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"]],template:function(e,r){e&1&&(U(ge),V(0,ve,7,14,"div",0)),e&2&&b("ngIf",r.isOpen())},dependencies:[re,te,oe],styles:[".modal-footer[_ngcontent-%COMP%]:empty{display:none}"],data:{animation:[j("modalAnimation",[D("closed",S({opacity:0,visibility:"hidden"})),D("open",S({opacity:1,visibility:"visible"})),z("closed <=> open",[A("300ms ease-in-out")])]),j("dialogAnimation",[D("closed",S({opacity:0,transform:"scale(0.95) translateY(20px)",visibility:"hidden"})),D("open",S({opacity:1,transform:"scale(1) translateY(0)",visibility:"visible"})),z("closed <=> open",[A("300ms ease-in-out")])])]}})};function ue(a){return o=>{let r=(a?Math[a]:Math.trunc)(o);return r===0?0:r}}function me(a,o,e){let r=ae(a,o,e)/7;return ue(e?.roundingMethod)(r)}var fe=class a{exerciseService=y(se);translate=y(ne);constructor(){}calculateSetVolume(o){return(o.repsLogged||0)*(o.weightLogged||0)}calculateWorkoutVolume(o){let e=0;return o.exercises.forEach(r=>{r.sets.forEach(n=>{e+=this.calculateSetVolume(n)})}),e}calculateTotalVolumeForAllLogs(o){return o.reduce((e,r)=>e+this.calculateWorkoutVolume(r),0)}getWeeklySummaries(o){if(!o||o.length===0)return[];let e={};o.forEach(n=>{let t=f(n.date),i=w(t,{weekStartsOn:1}),c=M(t,{weekStartsOn:1}),d=k(i,"yyyy-MM-dd");e[d]||(e[d]={logs:[],startDate:i,endDate:c}),e[d].logs.push(n)});let r=this.translate.instant("statsService.weekOf");return Object.entries(e).map(([n,t])=>{let i=this.calculateTotalVolumeForAllLogs(t.logs);return{weekLabel:`${r} ${k(t.startDate,"MMM d")}`,workoutCount:t.logs.length,totalVolume:i,weekStartDate:t.startDate,weekEndDate:t.endDate}}).sort((n,t)=>t.weekStartDate.getTime()-n.weekStartDate.getTime())}calculateTotalVolume(o){return o.exercises.reduce((e,r)=>{let n=r.sets.reduce((t,i)=>t+(i.weightLogged??0)*(i.repsLogged??0),0);return e+n},0)}getWeeklyVolumeForChart(o){if(!o||o.length===0)return[];let e={},r=this.translate.instant("statsService.weekPrefix");return o.forEach(t=>{let i=f(t.date),c=w(i,{weekStartsOn:1}),d=k(c,"yyyy-MM-dd");e[d]||(e[d]={totalVolume:0,weekLabel:`${r}${k(c,"w")} '${k(c,"yy")}`}),e[d].totalVolume+=this.calculateTotalVolume(t)}),Object.keys(e).sort((t,i)=>new Date(t).getTime()-new Date(i).getTime()).map(t=>({date:f(t),weekLabel:e[t].weekLabel,totalVolume:e[t].totalVolume}))}getPerformanceByMuscleGroup(o){return N(this,null,function*(){if(!o||o.length===0)return[];let e=new Map,r=yield new Promise(t=>{this.exerciseService.getExercises().pipe(P(1)).subscribe(i=>t(i))}),n=new Map(r.map(t=>[t.id,t]));return o.forEach(t=>{let i=new Set;t.exercises.forEach(c=>{let d=n.get(c.exerciseId);if(d&&d.muscleGroups){let m=c.sets.reduce((s,l)=>s+this.calculateSetVolume(l),0);d.muscleGroups.forEach(s=>{let l=s.toLowerCase().trim();e.has(l)||e.set(l,{volume:0,workoutCountSet:new Set});let p=e.get(l);p.volume+=m,i.add(l)})}}),i.forEach(c=>{e.get(c)?.workoutCountSet.add(t.id)})}),Array.from(e.entries()).map(([t,i])=>({muscleGroup:t,volume:Math.round(i.volume),workoutCount:i.workoutCountSet.size})).sort((t,i)=>i.volume-t.volume)})}calculateCurrentWorkoutStreak(o,e){let r=[...o.map(l=>f(l.date)),...e.map(l=>f(l.date))];if(r.length===0)return{length:0};r.sort((l,p)=>p.getTime()-l.getTime());let n=new Date,t=w(n,{weekStartsOn:1}),i=0,c,d=r[0],m=G(n,7);if(!O(d,n,{weekStartsOn:1})&&!O(d,m,{weekStartsOn:1}))return{length:0};for(let l=0;l<260&&r.some(pe=>O(pe,t,{weekStartsOn:1}));l++)c||(c=M(t,{weekStartsOn:1})),i++,t=G(t,7);if(i===0)return{length:0};let s=w(ie(t,7),{weekStartsOn:1});return{length:i,startDate:s,endDate:c}}calculateLongestWorkoutStreak(o,e){let r=[...o.map(s=>f(s.date)),...e.map(s=>f(s.date))];if(r.length<2)return this.calculateCurrentWorkoutStreak(o,e);let n=Array.from(new Set(r.map(s=>k(w(s,{weekStartsOn:1}),"yyyy-MM-dd")))).map(s=>new Date(s)).sort((s,l)=>s.getTime()-l.getTime());if(n.length===0)return{length:0};let t=0,i=0,c,d,m;for(let s=0;s<n.length;s++)if(s===0)i=1,m=n[s];else{let l=n[s-1],p=n[s];me(p,l)===1?i++:(i>t&&(t=i,c=m,d=M(l,{weekStartsOn:1})),i=1,m=p)}return i>t&&(t=i,c=m,d=M(n[n.length-1],{weekStartsOn:1})),{length:t,startDate:c,endDate:d}}static \u0275fac=function(e){return new(e||a)};static \u0275prov=C({token:a,factory:a.\u0275fac,providedIn:"root"})};export{le as a,de as b,fe as c};

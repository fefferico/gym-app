import{a as v,b as ne}from"./chunk-BWPENS2R.js";import{a as ee}from"./chunk-5I33CHYN.js";import{c as B,d as K,f as k,g as x,h as A}from"./chunk-4PTIEP3X.js";import{b as te,e as S,g as re}from"./chunk-TX66XDKO.js";import{f as Z,h as w,n as oe,o as C}from"./chunk-ASJIKGON.js";import{Aa as N,B as O,Cb as $,Db as q,Eb as J,Ha as f,Ia as u,Ja as h,Ka as H,N as R,Nb as Q,R as _,Ra as T,Sa as y,Ta as b,Ua as U,V as E,Va as L,W,X as j,Yb as X,cb as z,eb as Y,fa as P,ma as D,na as g,va as F,ya as G}from"./chunk-GDMH7CLR.js";import{g as V}from"./chunk-GAL4ENT6.js";var he={label:"Pause",actionKey:"pause",iconName:"pause",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-yellow-500 "},ye={label:"Add Exercise",actionKey:"addExercise",iconName:"plus-circle",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-blue-700 "},ke={label:"Jump to exercise",actionKey:"jumpToExercise",iconName:"dumbbell",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-fuchsia-600 "},xe={label:"Switch",actionKey:"switchExercise",iconName:[{name:"dumbbell"},{name:"none",display:"filled-padded",position:"bottom-right",class:"bg-white dark:bg-gray-800"},{name:"change",position:"bottom-right",size:"w-4 h-4",class:"text-primary",strokeWidth:2.5}],iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-cyan-600 "},we={label:"Session insight",actionKey:"insights",iconName:"chart",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-green-600 "},ve={label:"Exercise insights",actionKey:"exerciseInsights",iconName:"schedule",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-green-600 "},Ce={label:"Exit",actionKey:"exit",iconName:"exit-door",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-red-800 "},Se={label:"Warmup set",actionKey:"add_warmup_set",iconName:[{name:"flame"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-sky-600 "},Me={label:"Skip set",actionKey:"skipSet",iconName:"skip",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-blue-600 "},_e={label:"Skip exercise",actionKey:"skipExercise",iconName:"skip",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-indigo-600 "},Ee={label:"Do later",actionKey:"later",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-orange-600 "},We={label:"Finish early",actionKey:"finish",iconName:"done",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-teal-600 "},Ne={label:"Create Superset",actionKey:"create_superset",iconName:[{name:"link"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ie={label:"Add to Superset",actionKey:"add_to_superset",iconName:"link",buttonClass:" hover:bg-primary ",iconClass:"w-8 h-8 mr-2"},De={label:"Remove from Superset",actionKey:"remove_from_superset",iconName:[{name:"unlink"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"minus-circle",class:"text-primary",strokeWidth:3}],buttonClass:" hover:bg-red-800 ",iconClass:"w-8 h-8 mr-2"},Te={label:"Remove Exercise",actionKey:"remove",iconName:"trash",buttonClass:" hover:bg-red-800 ",iconClass:"w-8 h-8 mr-2"},Le={label:"Add Set",actionKey:"add_set",iconName:[{name:"dumbbell"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],buttonClass:" hover:bg-teal-800 ",iconClass:"w-8 h-8 mr-2"},Be={label:"Add Round",actionKey:"add_round",iconName:[{name:"dumbbell"},{name:"none",display:"filled-padded",class:"bg-white dark:bg-gray-800"},{name:"plus-circle",class:"text-primary",strokeWidth:3}],buttonClass:" hover:bg-teal-800 ",iconClass:"w-8 h-8 mr-2"},Ke={label:"Resume",actionKey:"play",iconName:"play",buttonClass:" bg-yellow-800 ",iconClass:"w-8 h-8 mr-2"},Ae={label:"Session notes",actionKey:"session_notes",iconName:"clipboard-list",buttonClass:" hover:bg-green-600 ",iconClass:"w-8 h-8 mr-2"},Ve={label:"HIDE",actionKey:"hide",iconName:"eye-off",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Oe={label:"UNHIDE",actionKey:"unhide",iconName:"eye",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Re={label:"MARK",actionKey:"markAsFavourite",iconName:"favourite",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},je={label:"UNMARK",actionKey:"unmarkAsFavourite",iconName:"unmark",iconClass:"w-8 h-8",buttonClass:" hover:bg-primary truncate"},Pe={label:"LOGS",actionKey:"history",iconName:"clock",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Fe={label:"VIEW",actionKey:"view",iconName:"eye",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ge={label:"START",actionKey:"start",iconName:"play",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},He={label:"EDIT",actionKey:"edit",iconName:"edit",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},Ue={label:"CLONE",actionKey:"clone",iconName:"copy",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},ze={label:"DELETE",actionKey:"delete",iconName:"trash",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-red-600 hover:animate-pulse"},Ye={label:"CREATE ROUTINE",actionKey:"create_routine",iconName:"create-folder",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "},$e={label:"ROUTINE",actionKey:"routine",iconName:"routines",iconClass:"w-8 h-8 mr-2",buttonClass:" hover:bg-primary "};var ae=class r{transform(t){return t?.sets?.length?t.sets.some(e=>typeof e.weightUsed=="number"||typeof e.weight=="number"||typeof e.targetWeight=="number"):!1}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=G({name:"isWeighted",type:r,pure:!0})};var de=["*",[["","modal-footer",""]]],pe=["*","[modal-footer]"];function be(r,t){if(r&1&&(u(0,"h3",11),z(1),h()),r&2){let e=b(3);g(),Y(" ",e.modalTitle()," ")}}function fe(r,t){if(r&1){let e=T();u(0,"div",6),N(1,be,2,1,"h3",7),u(2,"button",8),y("click",function(){E(e);let n=b(2);return W(n.closeModal())}),j(),u(3,"svg",9),H(4,"path",10),h()()()}if(r&2){let e=b(2);g(),f("ngIf",e.modalTitle())}}function ge(r,t){if(r&1){let e=T();u(0,"div",1),y("click",function(){E(e);let n=b();return W(n.closeModal())}),u(1,"div",2),y("click",function(n){E(e);let a=b();return W(a.onDialogClick(n))}),N(2,fe,5,1,"div",3),u(3,"div",4),L(4),h(),u(5,"div",5),L(6,1),h()()()}if(r&2){let e=b();f("@modalAnimation",e.animationState),g(),f("@dialogAnimation",e.animationState),g(),f("ngIf",e.modalTitle()||!0)}}var se=class r{elementRef=_(P);isOpen=J(!1);modalTitle=q();closed=$();get animationState(){return this.isOpen()?"open":"closed"}closeModal(){this.isOpen.set(!1),this.closed.emit()}onDialogClick(t){t.stopPropagation()}onDocumentMouseDown(t){this.isOpen()&&this.elementRef.nativeElement.contains(t.target)&&t.target.classList.contains("modal-container")&&this.closeModal()}onEscapeKey(){this.isOpen()&&this.closeModal()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-modal"]],hostBindings:function(e,o){e&1&&y("mousedown",function(a){return o.onDocumentMouseDown(a)},D)("keydown.escape",function(){return o.onEscapeKey()},D)},inputs:{isOpen:[1,"isOpen"],modalTitle:[1,"modalTitle"]},outputs:{isOpen:"isOpenChange",closed:"closed"},ngContentSelectors:pe,decls:1,vars:1,consts:[["class","modal-container fixed inset-0 z-[1000] flex items-center justify-center bg-black bg-opacity-60",3,"click",4,"ngIf"],[1,"modal-container","fixed","inset-0","z-[1000]","flex","items-center","justify-center","bg-black","bg-opacity-60",3,"click"],[1,"modal-dialog","mx-2","bg-white","dark:bg-gray-800","rounded-md","shadow-xl","min-w-[300px]","w-full","max-w-lg","md:max-w-xl","lg:max-w-2xl","max-h-[90vh]","flex","flex-col","overflow-hidden",3,"click"],["class","modal-header flex items-center justify-between ml-1 p-1 md:p-1 border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"modal-body","p-1","md:p-1","space-y-4","overflow-y-auto","flex-grow"],[1,"modal-footer","flex","items-center","p-4","md:p-5","border-t","border-gray-200","dark:border-gray-700","rounded-b"],[1,"modal-header","flex","items-center","justify-between","ml-1","p-1","md:p-1","border-gray-200","dark:border-gray-700"],["class","text-xl font-semibold text-gray-900 dark:text-white",4,"ngIf"],["type","button","aria-label","Close modal",1,"modal-close-button","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","dark:hover:bg-gray-600","dark:hover:text-white","rounded-md","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"]],template:function(e,o){e&1&&(U(de),N(0,ge,7,3,"div",0)),e&2&&f("ngIf",o.isOpen())},dependencies:[X,Q],styles:[".modal-footer[_ngcontent-%COMP%]:empty{display:none}"],data:{animation:[B("modalAnimation",[x("closed",k({opacity:0,visibility:"hidden"})),x("open",k({opacity:1,visibility:"visible"})),A("closed <=> open",[K("300ms ease-in-out")])]),B("dialogAnimation",[x("closed",k({opacity:0,transform:"scale(0.95) translateY(20px)",visibility:"hidden"})),x("open",k({opacity:1,transform:"scale(1) translateY(0)",visibility:"visible"})),A("closed <=> open",[K("300ms ease-in-out")])])]}})};function I(r,t,e){return ee(r,t*7,e)}function le(r){return t=>{let o=(r?Math[r]:Math.trunc)(t);return o===0?0:o}}function ce(r,t,e){let o=te(r,t,e)/7;return le(e?.roundingMethod)(o)}function me(r,t){return Z(r,t?.in).getFullYear()}function M(r,t,e){return I(r,-t,e)}var ue=class r{exerciseService=_(re);constructor(){}calculateSetVolume(t){return(t.repsAchieved||0)*(t.weightUsed||0)}calculateWorkoutVolume(t){let e=0;return t.exercises.forEach(o=>{o.sets.forEach(n=>{e+=this.calculateSetVolume(n)})}),e}calculateTotalVolumeForAllLogs(t){return t.reduce((e,o)=>e+this.calculateWorkoutVolume(o),0)}getWeeklySummaries(t){if(!t||t.length===0)return[];let e=new Map;return t.forEach(o=>{let n=new Date(o.startTime),a=me(n),s=oe(n,{weekStartsOn:1}),i=`${a}-W${String(s).padStart(2,"0")}`,c=w(n,{weekStartsOn:1}),m=`Week ${s}, ${a}`,d=C(c,"dd/MM"),l=C(ne(c,-6),"dd/MM");e.has(i)||e.set(i,{weekNumber:s,year:a,weekLabel:m,weekLabelStart:d,weekLabelEnd:l,workoutCount:0,totalVolume:0});let p=e.get(i);p.workoutCount++,p.totalVolume+=this.calculateWorkoutVolume(o)}),Array.from(e.values()).sort((o,n)=>o.year===n.year?o.weekNumber-n.weekNumber:o.year-n.year)}getWeeklyVolumeForChart(t){return this.getWeeklySummaries(t).map(o=>({date:new Date(o.year,0,o.weekNumber*7-6),weekLabel:o.weekLabel,totalVolume:o.totalVolume})).sort((o,n)=>o.date.getTime()-n.date.getTime())}getPerformanceByMuscleGroup(t){return V(this,null,function*(){if(!t||t.length===0)return[];let e=new Map,o=yield new Promise(a=>{this.exerciseService.getExercises().pipe(O(1)).subscribe(s=>a(s))}),n=new Map(o.map(a=>[a.id,a]));return t.forEach(a=>{let s=new Set;a.exercises.forEach(i=>{let c=n.get(i.exerciseId);if(c&&c.muscleGroups){let m=i.sets.reduce((d,l)=>d+this.calculateSetVolume(l),0);c.muscleGroups.forEach(d=>{let l=d.toLowerCase().trim();e.has(l)||e.set(l,{volume:0,workoutCountSet:new Set});let p=e.get(l);p.volume+=m,s.add(l)})}}),s.forEach(i=>{e.get(i)?.workoutCountSet.add(a.id)})}),Array.from(e.entries()).map(([a,s])=>({muscleGroup:a,volume:Math.round(s.volume),workoutCount:s.workoutCountSet.size})).sort((a,s)=>s.volume-a.volume)})}calculateCurrentWorkoutStreak(t){let e={length:0};if(!t||t.length===0)return e;let o=[...new Set(t.map(l=>C(w(S(l.date),{weekStartsOn:1}),"yyyy-MM-dd")))].map(l=>S(l)).sort((l,p)=>p.getTime()-l.getTime());if(o.length===0)return e;let n=0,a,s,i=w(new Date,{weekStartsOn:1}),c=M(i,1),m;if(o.some(l=>v(l,i)))n=1,a=i,s=i,m=M(i,1);else if(o.some(p=>v(p,c)))n=1,a=c,s=c,m=M(c,1);else return e;for(let l of o.slice(1))if(v(l,m))n++,s=l,m=M(m,1);else if(ce(m,l)>0)break;return{length:n,startDate:s,endDate:a}}calculateLongestWorkoutStreak(t){let e={length:0};if(!t||t.length<1)return e;let o=[...new Set(t.map(i=>C(w(S(i.date),{weekStartsOn:1}),"yyyy-MM-dd")))].map(i=>S(i)).sort((i,c)=>i.getTime()-c.getTime());if(o.length===0)return e;let n={length:0},a=0,s;for(let i=0;i<o.length;i++){let c=o[i];if(i===0)a=1,s=c;else{let m=o[i-1],d=I(m,1);v(c,d)?a++:(a=1,s=c)}a>n.length&&(n={length:a,startDate:s,endDate:c})}return n}static \u0275fac=function(e){return new(e||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};export{he as a,ye as b,ke as c,xe as d,we as e,ve as f,Ce as g,Se as h,Me as i,_e as j,Ee as k,We as l,Ne as m,Ie as n,De as o,Te as p,Le as q,Be as r,Ke as s,Ae as t,Ve as u,Oe as v,Re as w,je as x,Pe as y,Fe as z,Ge as A,He as B,Ue as C,ze as D,Ye as E,$e as F,ae as G,se as H,ue as I};
